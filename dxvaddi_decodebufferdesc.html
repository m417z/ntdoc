<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="DXVADDI_DECODEBUFFERDESC - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>DXVADDI_DECODEBUFFERDESC - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            DXVADDI_DECODEBUFFERDESC - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dumddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _DXVADDI_DECODEBUFFERDESC {
  [in] HANDLE            hBuffer;
  [in] <a href="d3dddiformat" title="typedef enum _D3DDDIFORMAT {&#10;  D3DDDIFMT_UNKNOWN,&#10;  D3DDDIFMT_R8G8B8,&#10;  D3DDDIFMT_A8R8G8B8,&#10;  D3DDDIFMT_X8R8G8B8,&#10;  D3DDDIFMT_R5G6B5,&#10;  D3DDDIFMT_X1R5G5B5,&#10;  D3DDDIFMT_A1R5G5B5,&#10;  D3DDDIFMT_A4R4G4B4,&#10;  D3DDDIFMT_R3G3B2,&#10;  D3DDDIFMT_A8,&#10;  D3DDDIFMT_A8R3G3B2,&#10;  D3DDDIFMT_X4R4G4B4,&#10;  D3DDDIFMT_A2B10G10R10,&#10;  D3DDDIFMT_A8B8G8R8,&#10;  D3DDDIFMT_X8B8G8R8,&#10;  D3DDDIFMT_G16R16,&#10;  D3DDDIFMT_A2R10G10B10,&#10;  D3DDDIFMT_A16B16G16R16,&#10;  D3DDDIFMT_A8P8,&#10;...">D3DDDIFORMAT</a>      CompressedBufferType;
  [in] <a href="uint" title="typedef unsigned int UINT;">UINT</a>              BufferIndex;
  [in] <a href="uint" title="typedef unsigned int UINT;">UINT</a>              DataOffset;
  [in] <a href="uint" title="typedef unsigned int UINT;">UINT</a>              DataSize;
  [in] <a href="uint" title="typedef unsigned int UINT;">UINT</a>              FirstMBaddress;
  [in] <a href="uint" title="typedef unsigned int UINT;">UINT</a>              NumMBsInBuffer;
  [in] <a href="uint" title="typedef unsigned int UINT;">UINT</a>              Width;
  [in] <a href="uint" title="typedef unsigned int UINT;">UINT</a>              Height;
  [in] <a href="uint" title="typedef unsigned int UINT;">UINT</a>              Stride;
  [in] <a href="uint" title="typedef unsigned int UINT;">UINT</a>              ReservedBits;
  [in] <a href="dxvaddi_pvp_hw_iv" title="typedef struct _DXVADDI_PVP_HW_IV {&#10;  [in] ULONGLONG IV;&#10;  [in] ULONGLONG Count;&#10;} DXVADDI_PVP_HW_IV;">DXVADDI_PVP_HW_IV</a> *pCipherCounter;
} DXVADDI_DECODEBUFFERDESC;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/ns-d3dumddi-_dxvaddi_decodebufferdesc">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/dxvaddi_decodebufferdesc.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-d3dumddi-_dxvaddi_decodebufferdesc)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_dxvaddi_decodebufferdesc-structure">_DXVADDI_DECODEBUFFERDESC structure</h1>

<h2 id="description">Description</h2>

<p>The DXVADDI_DECODEBUFFERDESC structure describes a buffer that is currently passed from the host decoder to the accelerator.</p>

<h2 id="members">Members</h2>

<h3 id="hbuffer-in"><code>hBuffer</code> [in]</h3>

<p>A handle to the buffer.</p>

<h3 id="compressedbuffertype-in"><code>CompressedBufferType</code> [in]</h3>

<p>A <a rel="noopener" target="_blank" href="d3dddiformat">D3DDDIFORMAT</a>-typed value that indicates the pixel format of the buffer.</p>

<h3 id="bufferindex-in"><code>BufferIndex</code> [in]</h3>

<p>Reserved. Do not use this member. For more information, see the Remarks section.</p>

<h3 id="dataoffset-in"><code>DataOffset</code> [in]</h3>

<p>The offset of the relevant data from the beginning of the buffer, in bytes. The use of this member is currently restricted to the value zero.</p>

<h3 id="datasize-in"><code>DataSize</code> [in]</h3>

<p>The amount of relevant data in the buffer, in bytes. The location of the last byte of content in the buffer is the value of <strong>DataOffset</strong> plus the value of <strong>DataSize</strong> minus 1.</p>

<h3 id="firstmbaddress-in"><code>FirstMBaddress</code> [in]</h3>

<p>The macroblock address of the first macroblock in the buffer that is passed to the accelerator. The macroblock address is given in raster scan order. The address is determined by the members of the <a rel="noopener" target="_blank" href="lpdxva_pictureparameters">DXVA_PictureParameters</a> structure. The following table shows examples of macroblock addresses.</p>

<table>
<thead>
<tr>
  <th style="text-align:left;"><strong>Macroblock</strong></th>
  <th style="text-align:left;"><strong>Address</strong></th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:left;">Top-left</td>
  <td style="text-align:left;">Zero</td>
</tr>
<tr>
  <td style="text-align:left;">Top-right</td>
  <td style="text-align:left;">wPicWidthInMBminus1 of <a href="lpdxva_pictureparameters" title="typedef struct _DXVA_PictureParameters {&#10;  WORD wDecodedPictureIndex;&#10;  WORD wDeblockedPictureIndex;&#10;  WORD wForwardRefPictureIndex;&#10;  WORD wBackwardRefPictureIndex;&#10;  WORD wPicWidthInMBminus1;&#10;  WORD wPicHeightInMBminus1;&#10;  BYTE bMacroblockWidthMinus1;&#10;  BYTE bMacroblockHeightMinus1;&#10;  BYTE bBlockWidthMinus1;&#10;  BYTE bBlockHeightMinus1;&#10;  BYTE bBPPminus1;&#10;  BYTE bPicStructure;&#10;  BYTE bSecondField;&#10;  BYTE bPicIntra;&#10;  BYTE bPicBackwardPrediction;&#10;  BYTE bBidirectionalAveragingMode;&#10;  BYTE bMVprecisionAndChromaRelation;&#10;  BYTE bChromaFormat;&#10;  BYTE bPicScanFixed;&#10;...">DXVA_PictureParameters</a>.</td>
</tr>
<tr>
  <td style="text-align:left;">Bottom-left</td>
  <td style="text-align:left;">wPicHeightInMBminus1 x (wPicWidthInMBminus1+1). Members of <a href="lpdxva_pictureparameters" title="typedef struct _DXVA_PictureParameters {&#10;  WORD wDecodedPictureIndex;&#10;  WORD wDeblockedPictureIndex;&#10;  WORD wForwardRefPictureIndex;&#10;  WORD wBackwardRefPictureIndex;&#10;  WORD wPicWidthInMBminus1;&#10;  WORD wPicHeightInMBminus1;&#10;  BYTE bMacroblockWidthMinus1;&#10;  BYTE bMacroblockHeightMinus1;&#10;  BYTE bBlockWidthMinus1;&#10;  BYTE bBlockHeightMinus1;&#10;  BYTE bBPPminus1;&#10;  BYTE bPicStructure;&#10;  BYTE bSecondField;&#10;  BYTE bPicIntra;&#10;  BYTE bPicBackwardPrediction;&#10;  BYTE bBidirectionalAveragingMode;&#10;  BYTE bMVprecisionAndChromaRelation;&#10;  BYTE bChromaFormat;&#10;  BYTE bPicScanFixed;&#10;...">DXVA_PictureParameters</a>.</td>
</tr>
<tr>
  <td style="text-align:left;">Bottom-right</td>
  <td style="text-align:left;">(wPicHeightInMBminus1+1) x (wPicWidthInMBminus1+1)-1. Members of DXVA_PictureParame</td>
</tr>
</tbody>
</table>

<p>The <strong>FirstMBaddress</strong> member must be zero if the data buffer is one of the following types: picture decoding parameters, inverse-quantization matrix, slice control, bitstream data, AYUV, IA44/AI44, DPXD, Highlight, and DCCMD.</p>

<p>If the data buffer is a residual difference block data buffer, <strong>FirstMBaddress</strong> must have the same value as for the corresponding macroblock control command buffer.</p>

<h3 id="nummbsinbuffer-in"><code>NumMBsInBuffer</code> [in]</h3>

<p>The number of macroblocks of data in the buffer, including skipped macroblocks. This member must be zero if the data buffer is one of the following types: picture decoding parameters, inverse-quantization matrix, AYUV, IA44/AI44, DPXD, Highlight, or DCCMD.</p>

<p>The value for <strong>NumMBsInBuffer</strong> depends on the type of data buffer that is being used, as shown in the following table.</p>

<table>
<thead>
<tr>
  <th style="text-align:left;"><strong>Buffer type</strong></th>
  <th style="text-align:left;"><strong>Value of NumMBsInBuffer</strong></th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:left;">Macroblock control command</td>
  <td style="text-align:left;">The sum of all of the values for MBskipsFollowing, added to the number of macroblock control commands in the macroblock control command buffer.</td>
</tr>
<tr>
  <td style="text-align:left;">Residual difference block</td>
  <td style="text-align:left;">The same value as for the corresponding macroblock control command buffer.</td>
</tr>
<tr>
  <td style="text-align:left;">Slice-control command</td>
  <td style="text-align:left;">The value of the wNumberMBsInSlice member of the <a rel="noopener" target="_blank" href="lpdxva_sliceinfo">DXVA_SliceInfo</a> structure in the slice-control buffer.</td>
</tr>
<tr>
  <td style="text-align:left;">Bitstream</td>
  <td style="text-align:left;">The same value as for the corresponding slice-control command buffer.</td>
</tr>
</tbody>
</table>

<h3 id="width-in"><code>Width</code> [in]</h3>

<p>Reserved. Do not use this member. For more information, see the Remarks section.</p>

<h3 id="height-in"><code>Height</code> [in]</h3>

<p>Reserved. Do not use this member. For more information, see the Remarks section.</p>

<h3 id="stride-in"><code>Stride</code> [in]</h3>

<p>Reserved. Do not use this member. For more information, see the Remarks section.</p>

<h3 id="reservedbits-in"><code>ReservedBits</code> [in]</h3>

<p>Reserved bits that are used for packing and alignment. This member must be zero.</p>

<h3 id="pciphercounter-in"><code>pCipherCounter</code> [in]</h3>

<p>A pointer to a <a rel="noopener" target="_blank" href="dxvaddi_pvp_hw_iv">DXVADDI_PVP_HW_IV</a> structure that contains a 128-bit protected video path (PVP) value.</p>

<h2 id="remarks">Remarks</h2>

<p>An array of DXVADDI_DECODEBUFFERDESC structures is referred to as a *buffer description list*. When a set of buffers is sent from the host decoder to the hardware accelerator, a buffer description list is sent to describe the buffers. The buffer description list contains one DXVADDI_DECODEBUFFERDESC structure for each buffer in this set. The buffer description list starts with a DXVADDI_DECODEBUFFERDESC structure for the first buffer of the first type, followed by a DXVADDI_DECODEBUFFERDESC structure for the next buffer of the same type, and so on. The buffer description list then continues with a DXVADDI_DECODEBUFFERDESC structure for the first buffer of the next type, and so on. This entire list is contained in a <a rel="noopener" target="_blank" href="d3dddiarg_decodeexecute">D3DDDIARG_DECODEEXECUTE</a> structure.</p>

<p>Because Microsoft DirectX Video Acceleration (VA) version 2.0 uses Microsoft Direct3D surfaces rather than the private surfaces that DirectX VA 1.0 uses, the user-mode display driver obtains values for the index, width, height, and stride from the given compressed buffer type rather than from the values in the <strong>BufferIndex</strong>, <strong>Width</strong>, <strong>Height</strong>, and <strong>Stride</strong> members. In fact, the Microsoft Direct3D runtime sets these members to zero.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="d3dddiarg_decodeexecute">D3DDDIARG_DECODEEXECUTE</a></p>

<p><a rel="noopener" target="_blank" href="dxvaddi_pvp_hw_iv">DXVADDI_PVP_HW_IV</a></p>

<p><a rel="noopener" target="_blank" href="lpdxva_pictureparameters">DXVA_PictureParameters</a></p>

<p><a rel="noopener" target="_blank" href="lpdxva_sliceinfo">DXVA_SliceInfo</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/ns-d3dumddi-_dxvaddi_decodebufferdesc">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dumddi/ns-d3dumddi-_dxvaddi_decodebufferdesc.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
