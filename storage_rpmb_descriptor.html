<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="STORAGE_RPMB_DESCRIPTOR - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>STORAGE_RPMB_DESCRIPTOR - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            STORAGE_RPMB_DESCRIPTOR - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddstor.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _STORAGE_RPMB_DESCRIPTOR {
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   Version;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   Size;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   SizeInBytes;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   MaxReliableWriteSizeInBytes;
  STORAGE_RPMB_FRAME_TYPE FrameFormat;
} STORAGE_RPMB_DESCRIPTOR, *PSTORAGE_RPMB_DESCRIPTOR;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddstor/ns-ntddstor-storage_rpmb_descriptor">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// winioctl.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _STORAGE_RPMB_DESCRIPTOR {
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>                   Version;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>                   Size;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>                   SizeInBytes;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>                   MaxReliableWriteSizeInBytes;
  STORAGE_RPMB_FRAME_TYPE FrameFormat;
} STORAGE_RPMB_DESCRIPTOR, *PSTORAGE_RPMB_DESCRIPTOR;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-storage_rpmb_descriptor">View the official Win32 API reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/storage_rpmb_descriptor.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddstor-storage_rpmb_descriptor)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2>Description</h2>

<p>The <strong>STORAGE_RPMB_DESCRIPTOR</strong> structure contains information about a device's Replay Protected Memory Block (RPMB) support.</p>

<h2>Members</h2>

<h3><code>Version</code></h3>

<p>Version of this structure. Set to STORAGE_RPMB_DESCRIPTOR_VERSION_1.</p>

<h3><code>Size</code></h3>

<p>Size of this structure, in bytes. Set to <code>sizeof(STORAGE_RPMB_DESCRIPTOR)</code>.</p>

<h3><code>SizeInBytes</code></h3>

<p>Size of the RPMB, in bytes. <strong>SizeInBytes</strong> cannot be zero.</p>

<h3><code>MaxReliableWriteSizeInBytes</code></h3>

<p>Maximum amount of data supported in one transaction, in bytes. <strong>MaxReliableWriteSizeInBytes</strong> cannot be zero.</p>

<h3><code>FrameFormat</code></h3>

<p>A <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddstor/ns-ntddstor-storage_rpmb_data_frame">**STORAGE_RPMB_FRAME_TYPE</a> structure identifying the frame format that the payload will be in.</p>

<h2>Remarks</h2>

<p>An application will issue <strong><a href="ioctl_storage_query_property" title="// CTL_CODE(0x002d, 0x500, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_STORAGE_QUERY_PROPERTY 0x002D1400">IOCTL_STORAGE_QUERY_PROPERTY</a></strong> with the <strong><a href="storage_property_id" title="typedef enum _STORAGE_PROPERTY_ID {&#10;  StorageDeviceProperty,&#10;  StorageAdapterProperty,&#10;  StorageDeviceIdProperty,&#10;  StorageDeviceUniqueIdProperty,&#10;  StorageDeviceWriteCacheProperty,&#10;  StorageMiniportProperty,&#10;  StorageAccessAlignmentProperty,&#10;  StorageDeviceSeekPenaltyProperty,&#10;  StorageDeviceTrimProperty,&#10;  StorageDeviceWriteAggregationProperty,&#10;  StorageDeviceDeviceTelemetryProperty,&#10;  StorageDeviceLBProvisioningProperty,&#10;  StorageDevicePowerProperty,&#10;  StorageDeviceCopyOffloadProperty,&#10;  StorageDeviceResiliencyProperty,&#10;  StorageDeviceMediumProductType,&#10;  StorageAdapterRpmbProperty,&#10;  StorageAdapterCryptoProperty,&#10;  StorageDeviceTieringProperty,&#10;...">STORAGE_PROPERTY_ID</a></strong> enumeration set to <strong>StorageAdapterRpmbProperty</strong> to determine whether the device contains an RPMB, and the maximum payload size the RPMB supports.</p>

<p>Storport responds with the payload information in this structure when the <strong><a href="storage_query_type" title="typedef enum _STORAGE_QUERY_TYPE {&#10;  PropertyStandardQuery,&#10;  PropertyExistsQuery,&#10;  PropertyMaskQuery,&#10;  PropertyQueryMaxDefined&#10;} STORAGE_QUERY_TYPE, *PSTORAGE_QUERY_TYPE;">STORAGE_QUERY_TYPE</a></strong> enumeration is set to <strong>PropertyStandardQuery</strong>.</p>

<h2>See also</h2>

<p><strong><a href="ioctl_storage_query_property" title="// CTL_CODE(0x002d, 0x500, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_STORAGE_QUERY_PROPERTY 0x002D1400">IOCTL_STORAGE_QUERY_PROPERTY</a></strong></p>

<p><strong><a href="storage_property_id" title="typedef enum _STORAGE_PROPERTY_ID {&#10;  StorageDeviceProperty,&#10;  StorageAdapterProperty,&#10;  StorageDeviceIdProperty,&#10;  StorageDeviceUniqueIdProperty,&#10;  StorageDeviceWriteCacheProperty,&#10;  StorageMiniportProperty,&#10;  StorageAccessAlignmentProperty,&#10;  StorageDeviceSeekPenaltyProperty,&#10;  StorageDeviceTrimProperty,&#10;  StorageDeviceWriteAggregationProperty,&#10;  StorageDeviceDeviceTelemetryProperty,&#10;  StorageDeviceLBProvisioningProperty,&#10;  StorageDevicePowerProperty,&#10;  StorageDeviceCopyOffloadProperty,&#10;  StorageDeviceResiliencyProperty,&#10;  StorageDeviceMediumProductType,&#10;  StorageAdapterRpmbProperty,&#10;  StorageAdapterCryptoProperty,&#10;  StorageDeviceTieringProperty,&#10;...">STORAGE_PROPERTY_ID</a></strong></p>

<p><strong><a href="storage_query_type" title="typedef enum _STORAGE_QUERY_TYPE {&#10;  PropertyStandardQuery,&#10;  PropertyExistsQuery,&#10;  PropertyMaskQuery,&#10;  PropertyQueryMaxDefined&#10;} STORAGE_QUERY_TYPE, *PSTORAGE_QUERY_TYPE;">STORAGE_QUERY_TYPE</a></strong></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddstor/ns-ntddstor-storage_rpmb_data_frame">**STORAGE_RPMB_FRAME_TYPE</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddstor/ns-ntddstor-storage_rpmb_descriptor">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddstor/ns-ntddstor-storage_rpmb_descriptor.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Win32 API reference (ns-winioctl-storage_rpmb_descriptor)</h1>
</div>
<div class="ntdoc-description">
<h2>Description</h2>

<p>To interface with the Replay Protected Memory Block (RPMB), applications first need to query whether the device contains an RPMB and the max payload size the RPMB supports. To do this, the application sends <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ni-winioctl-ioctl_storage_query_property">IOCTL_STORAGE_QUERY_PROPERTY IOCTL</a> with <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ne-winioctl-storage_property_id">STORAGE_PROPERTY_ID enumeration</a> set to StorageAdapterRpmbProperty (defined in <a href="storage_property_query" title="typedef struct _STORAGE_PROPERTY_QUERY {&#10;  STORAGE_PROPERTY_ID PropertyId;&#10;  STORAGE_QUERY_TYPE  QueryType;&#10;  UCHAR               AdditionalParameters[1];&#10;} STORAGE_PROPERTY_QUERY, *PSTORAGE_PROPERTY_QUERY;">STORAGE_PROPERTY_QUERY</a> in ntddstor.h). Storport then responds with the following payload (defined in ntddstor.h) when <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ne-winioctl-storage_query_type">STORAGE_QUERY_TYPE enumeration</a> is set to PropertyStandardQuery.</p>

<h2>Members</h2>

<h3><code>Version</code></h3>

<p>Shall be set to STORAGE_RPMB_DESCRIPTOR_VERSION_1</p>

<h3><code>Size</code></h3>

<p>Shall be set to sizeof(STORAGE_RPMB_DESCRIPTOR)</p>

<h3><code>SizeInBytes</code></h3>

<p>The size of the RPMB, in bytes. 0 if not supported, RPMB size in bytes otherwise.</p>

<h3><code>MaxReliableWriteSizeInBytes</code></h3>

<p>The maximum amount of data supported in one transaction in bytes. 0 if not supported, minimum 512 bytes.</p>

<h3><code>FrameFormat</code></h3>

<p>To support different RPMB frame formats, specifies which frame format the payload will be in so the port driver can take the appropriate action.</p>

<h2>Remarks</h2>

<h2>See also</h2>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-storage_rpmb_descriptor">View the official Win32 API reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/sdk-api/blob/docs/sdk-api-src/content/winioctl/ns-winioctl-storage_rpmb_descriptor.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
