<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NotifyTeredoPortChange - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NotifyTeredoPortChange - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NotifyTeredoPortChange - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// netioapi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NETIOAPI_API NotifyTeredoPortChange(
  _In_    PTEREDO_PORT_CHANGE_CALLBACK Callback,
  _In_    PVOID                        CallerContext,
  _In_    BOOLEAN                      InitialNotification,
  _Inout_ HANDLE *                     NotificationHandle
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/notifyteredoportchange">View the official Windows hardware development documentation</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/notifyteredoportchange.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows hardware development documentation (notifyteredoportchange)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="notifyteredoportchange-function">NotifyTeredoPortChange function</h1>

<p>The <strong>NotifyTeredoPortChange</strong> function registers the driver to be notified for changes to the UDP port number that the Teredo client uses for the Teredo service port on a local computer.</p>

<h2 id="parameters">Parameters</h2>

<ul>
<li><p><em>Callback</em> [in]
A pointer to the function to call when a Teredo client port change occurs. This function is called when a Teredo port change notification is received.</p></li>
<li><p><em>CallerContext</em> [in]
A user context that is passed to the callback function that is specified in the Callback parameter when a Teredo port change notification is received.</p></li>
<li><p><em>InitialNotification</em> [in]
A value that indicates whether the callback should be called immediately after registration for driver change notification completes. This initial notification does not indicate that a change occurred to the Teredo client port. This parameter provides confirmation that the callback is registered.</p></li>
<li><p><em>NotificationHandle</em> [in, out]
A pointer that is used to return a handle that your driver can later use to deregister the driver change notification. On success, a notification handle is returned in this parameter. If an error occurs, <strong>NULL</strong> is returned.</p></li>
</ul>

<h2 id="return-value">Return value</h2>

<p><strong>NotifyTeredoPortChange</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the function succeeds.</p>

<p>If the function fails, <strong>NotifyTeredoPortChange</strong> returns one of the following error codes:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>ERROR_INVALID_HANDLE</strong></td>
  <td>An internal error occurred where an invalid handle was encountered.</td>
</tr>
<tr>
  <td><strong>STATUS_INVALID_PARAMETER</strong></td>
  <td>An invalid parameter was passed to the function. This error is returned if the <em>Callback</em> parameter is a <strong>NULL</strong> pointer.</td>
</tr>
<tr>
  <td><strong>STATUS_NOT_ENOUGH_MEMORY</strong></td>
  <td>There was insufficient memory.</td>
</tr>
<tr>
  <td><strong>Other</strong></td>
  <td>Use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winbase/nf-winbase-formatmessage">FormatMessage</a> function to obtain the message string for the returned error.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>The invocation of the callback function that is specified in the <em>Callback</em> parameter is serialized. The callback function should be defined as a function of type <strong>VOID</strong>. The parameters that are passed to the callback function include the following.</p>

<table>
<thead>
<tr>
  <th>Parameter</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>IN PVOID <em>CallerContext</em></td>
  <td>The <em>CallerContext</em> parameter that is passed to the <strong>NotifyTeredoPortChange</strong> function when it is registering the driver for change notifications.</td>
</tr>
<tr>
  <td>IN <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a> <em>Port</em></td>
  <td>The UDP port number that the Teredo client currently uses. This parameter is zero when the <strong><a href="mib_notification_type" title="typedef enum _MIB_NOTIFICATION_TYPE { &#10;  MibParameterNotification  = 0,&#10;  MibAddInstance            = 1,&#10;  MibDeleteInstance         = 2,&#10;  MibInitialNotification    = 3&#10;} MIB_NOTIFICATION_TYPE, *PMIB_NOTIFICATION_TYPE;">MIB_NOTIFICATION_TYPE</a></strong> value that is passed in the <em>NotificationType</em> parameter to the callback function is set to <strong>MibInitialNotification</strong>. This situation can occur only if the <em>InitialNotification</em> parameter that is passed to <strong>NotifyTeredoPortChange</strong> was set to <strong>TRUE</strong> when registering the driver for change notifications.</td>
</tr>
<tr>
  <td>IN <a href="mib_notification_type" title="typedef enum _MIB_NOTIFICATION_TYPE { &#10;  MibParameterNotification  = 0,&#10;  MibAddInstance            = 1,&#10;  MibDeleteInstance         = 2,&#10;  MibInitialNotification    = 3&#10;} MIB_NOTIFICATION_TYPE, *PMIB_NOTIFICATION_TYPE;">MIB_NOTIFICATION_TYPE</a> <em>NotificationType</em></td>
  <td>The notification type. This member can be one of the values from the <strong><a href="mib_notification_type" title="typedef enum _MIB_NOTIFICATION_TYPE { &#10;  MibParameterNotification  = 0,&#10;  MibAddInstance            = 1,&#10;  MibDeleteInstance         = 2,&#10;  MibInitialNotification    = 3&#10;} MIB_NOTIFICATION_TYPE, *PMIB_NOTIFICATION_TYPE;">MIB_NOTIFICATION_TYPE</a></strong> enumeration type.</td>
</tr>
</tbody>
</table>

<p>Your driver can use the <strong><a href="getteredoport" title="NETIOAPI_API GetTeredoPort(&#10;  _Out_ USHORT *Port&#10;);">GetTeredoPort</a></strong> function to retrieve the initial UDP port number that the Teredo client used for the Teredo service port.</p>

<p>The Teredo port is dynamic and can change any time that the Teredo client is restarted on the local computer. A driver can register to be notified when the Teredo service port changes by calling the <strong>NotifyTeredoPortChange</strong> function.</p>

<p>The Teredo client also uses static UDP port 3544 for listening to multicast traffic that is sent on multicast IPv4 address 224.0.0.253 as defined in RFC 4380. For more information, see <a rel="noopener" target="_blank" href="https://go.microsoft.com/fwlink/p/?linkid=84066">Teredo: Tunneling IPv6 over UDPthrough Network Address Translations (NATs)</a>.</p>

<p>The <strong>NotifyTeredoPortChange</strong> function is used primarily by firewall drivers to configure the appropriate exceptions to enable incoming and outgoing Teredo traffic.</p>

<p>To deregister the driver for change notifications, call the <strong><a href="cancelmibchangenotify2" title="NETIOAPI_API CancelMibChangeNotify2(&#10;  _In_ HANDLE NotificationHandle&#10;);">CancelMibChangeNotify2</a></strong> function, passing the <em>NotificationHandle</em> parameter that the <strong>NotifyTeredoPortChange</strong> function returns.</p>

<h2 id="requirements">Requirements</h2>

<table>
<thead>
<tr>
  <th></th>
  <th></th>
</tr>
</thead>
<tbody>
<tr>
  <td>Target platform</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/develop/target-platforms">Universal</a></td>
</tr>
<tr>
  <td>Version</td>
  <td>Available in Windows Vista and later versions of the Windows operating systems.</td>
</tr>
<tr>
  <td>Header</td>
  <td>Netioapi.h (include Netioapi.h)</td>
</tr>
<tr>
  <td>Library</td>
  <td>Netio.lib</td>
</tr>
<tr>
  <td>IRQL</td>
  <td>&lt; DISPATCH_LEVEL</td>
</tr>
</tbody>
</table>

<h2 id="see-also">See also</h2>

<p><strong><a href="cancelmibchangenotify2" title="NETIOAPI_API CancelMibChangeNotify2(&#10;  _In_ HANDLE NotificationHandle&#10;);">CancelMibChangeNotify2</a></strong></p>

<p><strong><a href="getteredoport" title="NETIOAPI_API GetTeredoPort(&#10;  _Out_ USHORT *Port&#10;);">GetTeredoPort</a></strong></p>

<p><strong><a href="notifystableunicastipaddresstable" title="NETIOAPI_API NotifyStableUnicastIpAddressTable(&#10;  _In_    ADDRESS_FAMILY                           Family,&#10;  _Out_   PMIB_UNICASTIPADDRESS_TABLE              *Table,&#10;  _In_    PSTABLE_UNICAST_IPADDRESS_TABLE_CALLBACK CallerCallback,&#10;  _In_    PVOID                                    CallerContext,&#10;  _Inout_ HANDLE                                   *NotificationHandle&#10;);">NotifyStableUnicastIpAddressTable</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/notifyteredoportchange">View the official Windows hardware development documentation</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs/blob/staging/windows-driver-docs-pr/network/notifyteredoportchange.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
