<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NdisOpenConfigurationKeyByName - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NdisOpenConfigurationKeyByName - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NdisOpenConfigurationKeyByName - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">VOID NdisOpenConfigurationKeyByName(
  [out] PNDIS_STATUS Status,
  [in]  NDIS_HANDLE  ConfigurationHandle,
  [in]  PNDIS_STRING SubKeyName,
  [out] PNDIS_HANDLE SubKeyHandle
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndisopenconfigurationkeybyname">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndisopenconfigurationkeybyname.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ndis-ndisopenconfigurationkeybyname)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="ndisopenconfigurationkeybyname-function">NdisOpenConfigurationKeyByName function</h1>

<h2 id="description">Description</h2>

<p>The
<strong>NdisOpenConfigurationKeyByName</strong> function opens a named subkey of a given open registry key that is
designated by a caller-supplied handle.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="status-out"><code>Status</code> [out]</h3>

<p>A pointer to a caller-supplied variable in which this function returns the status of its attempt
to open the registry key. Possible return values are one of the following:</p>

<h4 id="ndis_status_success">NDIS_STATUS_SUCCESS</h4>

<p>NDIS has initialized accessed to the subkey specified by
<em>SubKeyName</em> .</p>

<h4 id="ndis_status_failure">NDIS_STATUS_FAILURE</h4>

<p>The key could not be opened.</p>

<h3 id="configurationhandle-in"><code>ConfigurationHandle</code> [in]</h3>

<p>The handle to a registry key for which a subkey should be opened. Typically,
<em>ConfigurationHandle</em> is returned by the
<a href="ndisopenconfigurationex" title="NDIS_STATUS NdisOpenConfigurationEx(&#10;  [in]  PNDIS_CONFIGURATION_OBJECT ConfigObject,&#10;  [out] PNDIS_HANDLE               ConfigurationHandle&#10;);">NdisOpenConfigurationEx</a> function.</p>

<h3 id="subkeyname-in"><code>SubKeyName</code> [in]</h3>

<p>A pointer to an NDIS_STRING type containing a caller-supplied, counted string in the
system-default character set that specifies the name of the registry subkey to open. For Microsoft
Windows 2000 and later drivers, this string contains Unicode characters. That is, for Windows 2000 and
later, NDIS defines the NDIS_STRING type as a
<a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a> type.</p>

<h3 id="subkeyhandle-out"><code>SubKeyHandle</code> [out]</h3>

<p>A pointer to a caller-supplied variable in which this function returns a handle to the opened
subkey if this call is successful.</p>

<h2 id="remarks">Remarks</h2>

<p><strong>NdisOpenConfigurationKeyByName</strong> allows a driver to access configuration information that is stored
in a named subkey in the registry.</p>

<p>Note that the
<em>ConfigurationHandle</em> passed in to
<strong>NdisOpenConfigurationKeyByName</strong> can be any valid handle to a registry key already opened by the
caller.
<strong>NdisOpenConfigurationKeyByName</strong> returns configuration information for subkeys relative to any valid
<em>ConfigurationHandle</em> .</p>

<p>After a driver has consumed and, possibly, modified the registry configuration information, it must
call the
<a href="ndiscloseconfiguration" title="VOID NdisCloseConfiguration(&#10;  [in] NDIS_HANDLE ConfigurationHandle&#10;);">NdisCloseConfiguration</a> function to
release the handle that was obtained from
<strong>NdisOpenConfigurationKeyByName</strong>.
<strong><a href="ndiscloseconfiguration" title="VOID NdisCloseConfiguration(&#10;  [in] NDIS_HANDLE ConfigurationHandle&#10;);">NdisCloseConfiguration</a></strong> also frees any temporary storage that NDIS allocated in the driver's calls
to the
<a href="ndisreadconfiguration" title="VOID NdisReadConfiguration(&#10;  [out] PNDIS_STATUS                  Status,&#10;  [out] PNDIS_CONFIGURATION_PARAMETER *ParameterValue,&#10;  [in]  NDIS_HANDLE                   ConfigurationHandle,&#10;  [in]  PNDIS_STRING                  Keyword,&#10;  [in]  NDIS_PARAMETER_TYPE           ParameterType&#10;);">NdisReadConfiguration</a>,
<a href="ndisreadnetworkaddress" title="VOID NdisReadNetworkAddress(&#10;  [out] PNDIS_STATUS Status,&#10;  [out] PVOID        *NetworkAddress,&#10;  [out] PUINT        NetworkAddressLength,&#10;  [in]  NDIS_HANDLE  ConfigurationHandle&#10;);">NdisReadNetworkAddress</a>, or
<a href="ndiswriteconfiguration" title="VOID NdisWriteConfiguration(&#10;  [out] PNDIS_STATUS                  Status,&#10;  [in]  NDIS_HANDLE                   ConfigurationHandle,&#10;  [in]  PNDIS_STRING                  Keyword,&#10;  [in]  PNDIS_CONFIGURATION_PARAMETER ParameterValue&#10;);">NdisWriteConfiguration</a> functions
with the
<em>SubKeyHandle</em> that
<strong>NdisOpenConfigurationKeyByName</strong> returned.</p>

<h2 id="see-also">See also</h2>

<p><a href="string" title="typedef struct _STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PCHAR Buffer;&#10;} STRING, *PSTRING, ANSI_STRING, *PANSI_STRING, OEM_STRING, *POEM_STRING;">ANSI_STRING</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-miniport_initialize">MiniportInitializeEx</a></p>

<p><a href="ndiscloseconfiguration" title="VOID NdisCloseConfiguration(&#10;  [in] NDIS_HANDLE ConfigurationHandle&#10;);">NdisCloseConfiguration</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/ndis-ndisopenconfigurationex">NdisOpenConfigurationEx</a></p>

<p><a href="ndisopenconfigurationkeybyindex" title="VOID NdisOpenConfigurationKeyByIndex(&#10;  [out] PNDIS_STATUS Status,&#10;  [in]  NDIS_HANDLE  ConfigurationHandle,&#10;  [in]  ULONG        Index,&#10;  [out] PNDIS_STRING KeyName,&#10;  [out] PNDIS_HANDLE KeyHandle&#10;);">NdisOpenConfigurationKeyByIndex</a></p>

<p><a href="ndisreadconfiguration" title="VOID NdisReadConfiguration(&#10;  [out] PNDIS_STATUS                  Status,&#10;  [out] PNDIS_CONFIGURATION_PARAMETER *ParameterValue,&#10;  [in]  NDIS_HANDLE                   ConfigurationHandle,&#10;  [in]  PNDIS_STRING                  Keyword,&#10;  [in]  NDIS_PARAMETER_TYPE           ParameterType&#10;);">NdisReadConfiguration</a></p>

<p><a href="ndiswriteconfiguration" title="VOID NdisWriteConfiguration(&#10;  [out] PNDIS_STATUS                  Status,&#10;  [in]  NDIS_HANDLE                   ConfigurationHandle,&#10;  [in]  PNDIS_STRING                  Keyword,&#10;  [in]  PNDIS_CONFIGURATION_PARAMETER ParameterValue&#10;);">NdisWriteConfiguration</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_bind_adapter_ex">ProtocolBindAdapterEx</a></p>

<p><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndisopenconfigurationkeybyname">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ndis/nf-ndis-ndisopenconfigurationkeybyname.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
