<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NdisMCmOidRequest - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NdisMCmOidRequest - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github.ntdoc.min.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github-dark-dimmed.ntdoc.min.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NdisMCmOidRequest - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NDIS_STATUS NdisMCmOidRequest(
  [in]           NDIS_HANDLE       NdisAfHandle,
  [in, optional] NDIS_HANDLE       NdisVcHandle,
  [in, optional] NDIS_HANDLE       NdisPartyHandle,
                 <a href="ndis_oid_request" title="typedef struct _NDIS_OID_REQUEST {&#10;  NDIS_OBJECT_HEADER       Header;&#10;  NDIS_REQUEST_TYPE        RequestType;&#10;  NDIS_PORT_NUMBER         PortNumber;&#10;  UINT                     Timeout;&#10;  PVOID                    RequestId;&#10;  NDIS_HANDLE              RequestHandle;&#10;  union {&#10;    NDIS_OID Oid;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;      UINT     BytesWritten;&#10;      UINT     BytesNeeded;&#10;    } QUERY_INFORMATION;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;...">PNDIS_OID_REQUEST</a> <a href="ndisoidrequest" title="NDIS_STATUS NdisOidRequest(&#10;  [in] NDIS_HANDLE       NdisBindingHandle,&#10;  [in] PNDIS_OID_REQUEST OidRequest&#10;);">NdisOidRequest</a>
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndismcmoidrequest">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndismcmoidrequest.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ndis-ndismcmoidrequest)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>NdisMCmOidRequest function</h1>
<h2>Description</h2>
<p>The
<strong>NdisMCmOidRequest</strong> function sends an OID request from a miniport call manager (MCM) driver to a CoNDIS
client.</p>
<h2>Parameters</h2>
<h3><code>NdisAfHandle</code> [in]</h3>
<p>A handle that identifies the address family (AF), and implicitly the client, that the OID request
is directed to. The MCM driver originally obtained this handle as an input parameter to its
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cm_open_af">ProtocolCmOpenAf</a> function.</p>
<h3><code>NdisVcHandle</code> [in, optional]</h3>
<p>A handle that identifies the virtual connection (VC) that the caller is requesting or setting
information for, if the request is VC-specific. Otherwise, if this request is not VC-specific, this
parameter is <strong>NULL</strong>. For any VC-specific request, the caller originally obtained this handle either when
it created the VC with the
<a href="ndismcmcreatevc" title="NDIS_STATUS NdisMCmCreateVc(&#10;  [in]  NDIS_HANDLE  MiniportAdapterHandle,&#10;  [in]  NDIS_HANDLE  NdisAfHandle,&#10;  [in]  NDIS_HANDLE  MiniportVcContext,&#10;  [out] PNDIS_HANDLE NdisVcHandle&#10;);">NdisMCmCreateVc</a> function, or as an input
parameter to its
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_create_vc">ProtocolCoCreateVc</a> function.</p>
<h3><code>NdisPartyHandle</code> [in, optional]</h3>
<p>A handle that identifies the party on a multipoint VC that the caller is requesting or setting
information for, if the request is party-specific. Otherwise, if this request is not party-specific,
this parameter is <strong>NULL</strong>. For any party-specific request, the MCM driver originally obtained this handle
as an input parameter to its
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cm_add_party">ProtocolCmAddParty</a> function.</p>
<h3><code><a href="ndisoidrequest" title="NDIS_STATUS NdisOidRequest(&#10;  [in] NDIS_HANDLE       NdisBindingHandle,&#10;  [in] PNDIS_OID_REQUEST OidRequest&#10;);">NdisOidRequest</a></code></h3>
<p>A pointer to a caller-allocated buffer that contains an
<a href="ndis_oid_request" title="typedef struct _NDIS_OID_REQUEST {&#10;  NDIS_OBJECT_HEADER       Header;&#10;  NDIS_REQUEST_TYPE        RequestType;&#10;  NDIS_PORT_NUMBER         PortNumber;&#10;  UINT                     Timeout;&#10;  PVOID                    RequestId;&#10;  NDIS_HANDLE              RequestHandle;&#10;  union {&#10;    NDIS_OID Oid;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;      UINT     BytesWritten;&#10;      UINT     BytesNeeded;&#10;    } QUERY_INFORMATION;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;...">NDIS_OID_REQUEST</a> structure.</p>
<h2>Return value</h2>
<p><strong>NdisMCmOidRequest</strong> returns one of the following values:</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>NDIS_STATUS_SUCCESS</strong></td>
<td>The request operation completed successfully.</td>
</tr>
<tr>
<td><strong>NDIS_STATUS_PENDING</strong></td>
<td>The request is being handled asynchronously, and NDIS will call the caller's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_oid_request_complete">ProtocolCoOidRequestComplete</a> function when the request is completed.</td>
</tr>
<tr>
<td><strong>NDIS_STATUS_INVALID_OID</strong></td>
<td>The OID_<em>XXX</em> code that was specified in the <strong>Oid</strong> member of the <a href="ndis_oid_request" title="typedef struct _NDIS_OID_REQUEST {&#10;  NDIS_OBJECT_HEADER       Header;&#10;  NDIS_REQUEST_TYPE        RequestType;&#10;  NDIS_PORT_NUMBER         PortNumber;&#10;  UINT                     Timeout;&#10;  PVOID                    RequestId;&#10;  NDIS_HANDLE              RequestHandle;&#10;  union {&#10;    NDIS_OID Oid;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;      UINT     BytesWritten;&#10;      UINT     BytesNeeded;&#10;    } QUERY_INFORMATION;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;...">NDIS_OID_REQUEST</a> structure at the <em>OidRequest</em> parameter is invalid or unsupported by the underlying driver.</td>
</tr>
<tr>
<td><strong>NDIS_STATUS_INVALID_LENGTH or NDIS_STATUS_BUFFER_TOO_SHORT</strong></td>
<td>The value that was specified in the <strong>InformationBufferLength</strong> member of the <a href="ndis_oid_request" title="typedef struct _NDIS_OID_REQUEST {&#10;  NDIS_OBJECT_HEADER       Header;&#10;  NDIS_REQUEST_TYPE        RequestType;&#10;  NDIS_PORT_NUMBER         PortNumber;&#10;  UINT                     Timeout;&#10;  PVOID                    RequestId;&#10;  NDIS_HANDLE              RequestHandle;&#10;  union {&#10;    NDIS_OID Oid;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;      UINT     BytesWritten;&#10;      UINT     BytesNeeded;&#10;    } QUERY_INFORMATION;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;...">NDIS_OID_REQUEST</a> structure at <em>OidRequest</em> does not match the requirements for the given OID_<em>XXX</em> code. If the information buffer is too small, the <strong>BytesNeeded</strong> member of <a href="ndis_oid_request" title="typedef struct _NDIS_OID_REQUEST {&#10;  NDIS_OBJECT_HEADER       Header;&#10;  NDIS_REQUEST_TYPE        RequestType;&#10;  NDIS_PORT_NUMBER         PortNumber;&#10;  UINT                     Timeout;&#10;  PVOID                    RequestId;&#10;  NDIS_HANDLE              RequestHandle;&#10;  union {&#10;    NDIS_OID Oid;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;      UINT     BytesWritten;&#10;      UINT     BytesNeeded;&#10;    } QUERY_INFORMATION;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;...">NDIS_OID_REQUEST</a> contains the correct value for <strong>InformationBufferLength</strong>, when <strong>NdisMCmOidRequest</strong> returns.</td>
</tr>
<tr>
<td><strong>NDIS_STATUS_INVALID_DATA</strong></td>
<td>The data that was supplied at <strong>InformationBuffer</strong> in the given <a href="ndis_oid_request" title="typedef struct _NDIS_OID_REQUEST {&#10;  NDIS_OBJECT_HEADER       Header;&#10;  NDIS_REQUEST_TYPE        RequestType;&#10;  NDIS_PORT_NUMBER         PortNumber;&#10;  UINT                     Timeout;&#10;  PVOID                    RequestId;&#10;  NDIS_HANDLE              RequestHandle;&#10;  union {&#10;    NDIS_OID Oid;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;      UINT     BytesWritten;&#10;      UINT     BytesNeeded;&#10;    } QUERY_INFORMATION;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;...">NDIS_OID_REQUEST</a> structure was invalid for the given OID_<em>XXX</em> code.</td>
</tr>
<tr>
<td><strong>NDIS_STATUS_NOT_SUPPORTED or NDIS_STATUS_NOT_RECOGNIZED</strong></td>
<td>The client driver does not support the requested operation.</td>
</tr>
<tr>
<td><strong>NDIS_STATUS_RESOURCES</strong></td>
<td>The request could not be satisfied because of a resource shortage. Usually, this return value indicates that an attempt to allocate memory was unsuccessful, but it does not necessarily indicate that the same request, if submitted later, will fail for the same reason.</td>
</tr>
<tr>
<td><strong>NDIS_STATUS_FAILURE</strong></td>
<td>This value typically is a nonspecific default that is returned when none of the more specific NDIS_STATUS_<em>XXX</em> status codes applies.</td>
</tr>
<tr>
<td><strong>NDIS_STATUS_REQUEST_ABORTED</strong></td>
<td>The target driver stopped processing the request.</td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>To initiate OID requests to CoNDIS clients, MCM drivers call the
<strong>NdisMCmOidRequest</strong> function. Before an MCM driver calls
<strong>NdisMCmOidRequest</strong>, the driver allocates memory for its request and initializes an
<a href="ndis_oid_request" title="typedef struct _NDIS_OID_REQUEST {&#10;  NDIS_OBJECT_HEADER       Header;&#10;  NDIS_REQUEST_TYPE        RequestType;&#10;  NDIS_PORT_NUMBER         PortNumber;&#10;  UINT                     Timeout;&#10;  PVOID                    RequestId;&#10;  NDIS_HANDLE              RequestHandle;&#10;  union {&#10;    NDIS_OID Oid;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;      UINT     BytesWritten;&#10;      UINT     BytesNeeded;&#10;    } QUERY_INFORMATION;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;...">NDIS_OID_REQUEST</a> structure. The MCM sets
the
<strong>Oid</strong> member of the <a href="ndis_oid_request" title="typedef struct _NDIS_OID_REQUEST {&#10;  NDIS_OBJECT_HEADER       Header;&#10;  NDIS_REQUEST_TYPE        RequestType;&#10;  NDIS_PORT_NUMBER         PortNumber;&#10;  UINT                     Timeout;&#10;  PVOID                    RequestId;&#10;  NDIS_HANDLE              RequestHandle;&#10;  union {&#10;    NDIS_OID Oid;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;      UINT     BytesWritten;&#10;      UINT     BytesNeeded;&#10;    } QUERY_INFORMATION;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;...">NDIS_OID_REQUEST</a> structure with a CoNDIS OID code.</p>
<p>An MCM driver can call
<strong>NdisMCmOidRequest</strong> to communicate connection-oriented information, such as a change in addresses to
the client that the
<em>NdisAfHandle</em> parameter identifies.</p>
<p>After the MCM calls
<strong>NdisMCmOidRequest</strong>, NDIS calls the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_oid_request">ProtocolCoOidRequest</a> function of
the client.</p>
<p>If the MCM driver's request is VC-specific or party-specific, the MCM driver also passes a non-<strong>NULL</strong>
value at the
<em>NdisVcHandle</em> or
<em>NdisPartyHandle</em> parameter, respectively.</p>
<p>If
<strong>NdisMCmOidRequest</strong> returns NDIS_STATUS_PENDING, the request is being handled asynchronously and NDIS
will call the MCM's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_oid_request_complete">ProtocolCoOidRequestComplete</a> function when the request is completed. If
<strong>NdisMCmOidRequest</strong> returns any other status, the request is complete when
<strong>NdisMCmOidRequest</strong> returns and NDIS does not call
<em>ProtocolCoOidRequestComplete</em>.</p>
<p>For more information about the OIDs that are defined to use with
<strong>NdisMCmOidRequest</strong>, see
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_netvista/">NDIS OIDs</a>.</p>
<h2>See also</h2>
<p><a href="ndis_oid_request" title="typedef struct _NDIS_OID_REQUEST {&#10;  NDIS_OBJECT_HEADER       Header;&#10;  NDIS_REQUEST_TYPE        RequestType;&#10;  NDIS_PORT_NUMBER         PortNumber;&#10;  UINT                     Timeout;&#10;  PVOID                    RequestId;&#10;  NDIS_HANDLE              RequestHandle;&#10;  union {&#10;    NDIS_OID Oid;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;      UINT     BytesWritten;&#10;      UINT     BytesNeeded;&#10;    } QUERY_INFORMATION;&#10;    struct {&#10;      NDIS_OID Oid;&#10;      PVOID    InformationBuffer;&#10;      UINT     InformationBufferLength;&#10;...">NDIS_OID_REQUEST</a></p>
<p><a href="ndismcmcreatevc" title="NDIS_STATUS NdisMCmCreateVc(&#10;  [in]  NDIS_HANDLE  MiniportAdapterHandle,&#10;  [in]  NDIS_HANDLE  NdisAfHandle,&#10;  [in]  NDIS_HANDLE  MiniportVcContext,&#10;  [out] PNDIS_HANDLE NdisVcHandle&#10;);">NdisMCmCreateVc</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cm_add_party">ProtocolCmAddParty</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cm_open_af">ProtocolCmOpenAf</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_create_vc">ProtocolCoCreateVc</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_oid_request">ProtocolCoOidRequest</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_oid_request_complete">ProtocolCoOidRequestComplete</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndismcmoidrequest">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ndis/nf-ndis-ndismcmoidrequest.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script src="modules/highlight.js/highlight.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
