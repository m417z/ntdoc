<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="ExtDeviceMode - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ExtDeviceMode - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            ExtDeviceMode - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// winspool.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="long" title="typedef long LONG;">LONG</a> ExtDeviceMode(
  [in, optional] HWND       hWnd,
  [in, optional] HANDLE     hInst,
  [in, out]      LPDEVMODEA pDevModeOutput,
  [in, optional] LPSTR      pDeviceName,
  [in, optional] LPSTR      pPort,
  [in, optional] LPDEVMODEA pDevModeInput,
  [in, optional] LPSTR      pProfile,
                 <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>      fMode
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winspool/nf-winspool-extdevicemode">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/extdevicemode.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-winspool-extdevicemode)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="extdevicemode-function">ExtDeviceMode function</h1>

<h2 id="description">Description</h2>

<p>The <strong>ExtDeviceMode</strong> function is provided only for compatibility with 16-bit applications. Printer drivers without this requirement should instead use the <strong>DocumentProperties</strong> function, which is described in the Microsoft Windows SDK documentation.</p>

<p>The <strong>ExtDeviceMode</strong> function retrieves or modifies printer initialization information for a given graphics driver, or displays a driver-supplied printer-configuration property sheet for the specified printer.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="hwnd-in-optional"><code>hWnd</code> [in, optional]</h3>

<p>Handle to the parent window for the printer-configuration property sheet.</p>

<h3 id="hinst-in-optional"><code>hInst</code> [in, optional]</h3>

<p>Not used. Handle to the module instance of the device driver.</p>

<h3 id="pdevmodeoutput-in-out"><code>pDevModeOutput</code> [in, out]</h3>

<p>Pointer to the DEVMODE structure that receives the printer configuration data supplied in the buffer pointed to by the <em>pDevModeInput</em> parameter.</p>

<h3 id="pdevicename-in-optional"><code>pDeviceName</code> [in, optional]</h3>

<p>Pointer to a NULL-terminated string that contains the name of the device for which the printer configuration property sheet is displayed.</p>

<h3 id="pport-in-optional"><code>pPort</code> [in, optional]</h3>

<p>Pointer to a NULL-terminated string that contains the name of the port to which the device is connected, such as LPT1.</p>

<h3 id="pdevmodeinput-in-optional"><code>pDevModeInput</code> [in, optional]</h3>

<p>Pointer to the DEVMODE structure that the operating system uses to initialize the property sheet fields.</p>

<p>This parameter is used only if the DM_IN_BUFFER flag is set in the <em>fMode</em> parameter. If DM_IN_BUFFER is not set, the operating system uses the printer's default DEVMODE structure.</p>

<h3 id="pprofile-in-optional"><code>pProfile</code> [in, optional]</h3>

<p>Not used. Pointer to a NULL-terminated string that contains the name of the initialization file in which initialization information is recorded and read from.</p>

<h3 id="fmode"><code>fMode</code></h3>

<p>Specifies the operations that the function performs. If this parameter is zero, the <strong>ExtDeviceMode</strong> function returns the number of bytes required by the printer driver's DEVMODE structure. Otherwise, this parameter can be set to one or more of the following flag values.</p>

<table>
<thead>
<tr>
  <th>Flag</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>DM_COPY</td>
  <td>Write the driver's current settings to the DEVMODE structure pointed to by the <em>pDevModeOutput</em> parameter. The calling application must allocate a buffer large enough to contain the information. If this flag is not set, <em>pDevModeOutput</em> can be <strong>NULL</strong>.</td>
</tr>
<tr>
  <td>DM_IN_BUFFER</td>
  <td>Merge the printer driver's current print settings with the settings in the DEVMODE structure pointed to by the <em>pDevModeInput</em> parameter. This occurs before prompting, copying, or updating. The function updates the structure only for those members specified by the DEVMODE structure's <strong>dmFields</strong> member. In cases of conflict during the merge, the settings in the DEVMODE structure pointed to by <em>pDevModeInput</em> override the printer driver's current print settings.</td>
</tr>
<tr>
  <td>DM_UPDATE</td>
  <td>Display a property sheet to allow the user to modify printer properties, and then write the driver's current "per user" settings to the user's hive in the registry.</td>
</tr>
</tbody>
</table>

<h2 id="return-value">Return value</h2>

<p>If the <em>wMode</em> parameter is zero, the function returns the size, in bytes, of the DEVMODE structure required to contain the printer-driver initialization data. Note that this value can be larger than the size of a DEVMODE structure if the printer driver appends private data to the structure. If the function displays the initialization-dialog box, the return value is either IDOK or IDCANCEL, depending on which button the user chose. If the function does not display the dialog box and was successful, the return value is IDOK. The return value is less than zero if the function failed.</p>

<h2 id="remarks">Remarks</h2>

<p>The <strong>ExtDeviceMode</strong> function calls the <strong>DocumentProperties</strong> function (described in the Windows SDK documentation) to display a property sheet that allows a user to select printer options such as paper size, paper orientation, and output quality. Printer drivers written for Windows 3.x and Windows 9x use this function.</p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winspool/nf-winspool-extdevicemode">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/winspool/nf-winspool-extdevicemode.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
