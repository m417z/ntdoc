<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="DXGK_GRAPHICSPOWER_REGISTER_INPUT_V_1_2 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>DXGK_GRAPHICSPOWER_REGISTER_INPUT_V_1_2 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            DXGK_GRAPHICSPOWER_REGISTER_INPUT_V_1_2 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dkmthk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _DXGK_GRAPHICSPOWER_REGISTER_INPUT_V_1_2 {
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                         Version;
  PVOID                         PrivateHandle;
  <a href="pdxgk_power_notification" title="PDXGK_POWER_NOTIFICATION PdxgkPowerNotification;&#10;&#10;VOID PdxgkPowerNotification(&#10;  PVOID GraphicsDeviceHandle,&#10;  DEVICE_POWER_STATE NewGrfxPowerState,&#10;  BOOLEAN PreNotification,&#10;  PVOID PrivateHandle&#10;)&#10;{...}">PDXGK_POWER_NOTIFICATION</a>      PowerNotificationCb;
  <a href="pdxgk_removal_notification" title="PDXGK_REMOVAL_NOTIFICATION PdxgkRemovalNotification;&#10;&#10;VOID PdxgkRemovalNotification(&#10;  PVOID GraphicsDeviceHandle,&#10;  PVOID PrivateHandle&#10;)&#10;{...}">PDXGK_REMOVAL_NOTIFICATION</a>    RemovalNotificationCb;
  <a href="pdxgk_fstate_notification" title="PDXGK_FSTATE_NOTIFICATION PdxgkFstateNotification;&#10;&#10;VOID PdxgkFstateNotification(&#10;  PVOID GraphicsDeviceHandle,&#10;  ULONG ComponentIndex,&#10;  UINT NewFState,&#10;  BOOLEAN PreNotification,&#10;  PVOID PrivateHandle&#10;)&#10;{...}">PDXGK_FSTATE_NOTIFICATION</a>     FStateNotificationCb;
  <a href="pdxgk_initial_component_state" title="PDXGK_INITIAL_COMPONENT_STATE PdxgkInitialComponentState;&#10;&#10;VOID PdxgkInitialComponentState(&#10;  PVOID GraphicsDeviceHandle,&#10;  PVOID PrivateHandle,&#10;  ULONG ComponentIndex,&#10;  BOOLEAN IsBlockingType,&#10;  UINT InitialFState,&#10;  GUID ComponentGuid,&#10;  UINT PowerComponentMappingFlag&#10;)&#10;{...}">PDXGK_INITIAL_COMPONENT_STATE</a> InitialComponentStateCb;
} DXGK_GRAPHICSPOWER_REGISTER_INPUT_V_1_2, *PDXGK_GRAPHICSPOWER_REGISTER_INPUT_V_1_2;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmthk/ns-d3dkmthk-_dxgk_graphicspower_register_input_v_1_2">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/dxgk_graphicspower_register_input_v_1_2.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-d3dkmthk-_dxgk_graphicspower_register_input_v_1_2)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="dxgk_graphicspower_register_input_v_1_2-structure">DXGK_GRAPHICSPOWER_REGISTER_INPUT_V_1_2 structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>DXGK_GRAPHICSPOWER_REGISTER_INPUT_V_1_2</strong> structure is used to register the power state of a new input.</p>

<h2 id="members">Members</h2>

<h3 id="version"><code>Version</code></h3>

<p>The current version being used. This value must be set to one of the following DXGK_GRAPHICSPOWER_VERSIONs:</p>

<div class="codehilite">
<pre><span></span><code><span class="cp">#define DXGK_GRAPHICSPOWER_VERSION_1_0 0x1000</span>
<span class="cp">#define DXGK_GRAPHICSPOWER_VERSION_1_1 0x1001</span>
<span class="cp">#define DXGK_GRAPHICSPOWER_VERSION_1_2 0x1002</span>
<span class="cp">#define DXGK_GRAPHICSPOWER_VERSION DXGK_GRAPHICSPOWER_VERSION_1_2</span>
</code></pre>
</div>

<p>By default, DXGK_GRAPHICSPOWER_VERSION represents the latest version. The graphics subsystem supports the current version and all previous versions. If this value is a version that isn't recognized, we will fail with STATUS_NOINTERFACE. This should only happen in the case the non-graphics driver was built for a newer OS than what is currently running, and in this case we expect the non-graphics driver to retry with a lower version number.</p>

<p>DXGK_GRAPHICSPOWER_VERSION_1_1 supports F-state change notifications.
DXGK_GRAPHICSPOWER_VERSION_1_2 supports initial enumeration of shared power component data and state.</p>

<h3 id="privatehandle"><code>PrivateHandle</code></h3>

<p>An opaque handle that will be provided in any callbacks. This handle must be globally unique, therefore, a pointer to the calling driver’s PDO or FDO should be used. This handle will be used as a key by graphics to track this specific registration, and will be associated with the non-graphics driver callbacks in order to handle their future removal.</p>

<h3 id="powernotificationcb"><code>PowerNotificationCb</code></h3>

<p>A callback providing notification that the graphics device will be undergoing a device power state transition, and provide a new <a href="device_power_state" title="typedef enum _DEVICE_POWER_STATE {&#10;  PowerDeviceUnspecified,&#10;  PowerDeviceD0,&#10;  PowerDeviceD1,&#10;  PowerDeviceD2,&#10;  PowerDeviceD3,&#10;  PowerDeviceMaximum&#10;} DEVICE_POWER_STATE, *PDEVICE_POWER_STATE;">DEVICE_POWER_STATE</a>. This callback is required to be implemented. See <strong><a href="pdxgk_power_notification" title="PDXGK_POWER_NOTIFICATION PdxgkPowerNotification;&#10;&#10;VOID PdxgkPowerNotification(&#10;  PVOID GraphicsDeviceHandle,&#10;  DEVICE_POWER_STATE NewGrfxPowerState,&#10;  BOOLEAN PreNotification,&#10;  PVOID PrivateHandle&#10;)&#10;{...}">PDXGK_POWER_NOTIFICATION</a></strong>.</p>

<h3 id="removalnotificationcb"><code>RemovalNotificationCb</code></h3>

<p>A callback notifying that the graphics device is being removed. Any further callbacks into graphics for this DeviceHandle will return a failing <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> code and will be blocked until you return from the RemovalNotificationCb callback. This callback is required to be implemented. See <strong><a href="pdxgk_removal_notification" title="PDXGK_REMOVAL_NOTIFICATION PdxgkRemovalNotification;&#10;&#10;VOID PdxgkRemovalNotification(&#10;  PVOID GraphicsDeviceHandle,&#10;  PVOID PrivateHandle&#10;)&#10;{...}">PDXGK_REMOVAL_NOTIFICATION</a></strong></p>

<h3 id="fstatenotificationcb"><code>FStateNotificationCb</code></h3>

<p>Issues a state notification. This callback is optional, and is used by non-graphics drivers. See <strong><a href="pdxgk_fstate_notification" title="PDXGK_FSTATE_NOTIFICATION PdxgkFstateNotification;&#10;&#10;VOID PdxgkFstateNotification(&#10;  PVOID GraphicsDeviceHandle,&#10;  ULONG ComponentIndex,&#10;  UINT NewFState,&#10;  BOOLEAN PreNotification,&#10;  PVOID PrivateHandle&#10;)&#10;{...}">PDXGK_FSTATE_NOTIFICATION</a></strong>.</p>

<h3 id="initialcomponentstatecb"><code>InitialComponentStateCb</code></h3>

<p>Initializes the component state. See <strong><a href="pdxgk_initial_component_state" title="PDXGK_INITIAL_COMPONENT_STATE PdxgkInitialComponentState;&#10;&#10;VOID PdxgkInitialComponentState(&#10;  PVOID GraphicsDeviceHandle,&#10;  PVOID PrivateHandle,&#10;  ULONG ComponentIndex,&#10;  BOOLEAN IsBlockingType,&#10;  UINT InitialFState,&#10;  GUID ComponentGuid,&#10;  UINT PowerComponentMappingFlag&#10;)&#10;{...}">PDXGK_INITIAL_COMPONENT_STATE</a></strong>.</p>

<h2 id="remarks">Remarks</h2>

<p>Graphics drivers indicate what power components exist by responding to the queries DXGKQAITYPE_NUMPOWERCOMPONENTS and DXGKQAITYPE_POWERCOMPONENTINFO in <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/ne-d3dkmddi-_dxgk_queryadapterinfotype">_DXGK_QUERYADAPTERINFOTYPE</a>.</p>

<p>If a graphics driver registers at least one <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/ne-d3dkmddi-_dxgk_power_component_type">DXGK_POWER_COMPONENT_SHARED</a> component, a GRAPHICSPOWER interface will be created for that adapter. The interface will not be registered for adapters that do not expose any of these components.</p>

<p>Graphics drivers can register a “blocking” component by setting the <a href="dxgk_power_runtime_component" title="typedef struct _DXGK_POWER_RUNTIME_COMPONENT {&#10;  ULONG                        StateCount;&#10;  DXGK_POWER_RUNTIME_STATE     States[DXGK_MAX_F_STATES];&#10;  DXGK_POWER_COMPONENT_MAPPING ComponentMapping;&#10;  DXGK_POWER_COMPONENT_FLAGS   Flags;&#10;  GUID                         ComponentGuid;&#10;  UCHAR                        ComponentName[DXGK_POWER_COMPONENT_NAME_SIZE];&#10;  ULONG                        ProviderCount;&#10;  ULONG                        Providers[DXGK_MAX_POWER_COMPONENT_PROVIDERS];&#10;} DXGK_POWER_RUNTIME_COMPONENT;">DXGK_POWER_RUNTIME_COMPONENT</a> flag <em>ActiveInD3</em> to <strong>0</strong>, or a “nonblocking” component by setting this flag to <strong>1</strong>.</p>

<p>A blocking power component will prevent the graphics device from powering down when in use while a non-blocking power component will not. Both allow the graphics driver to properly manage its power planes when in-use by the non-graphics driver.</p>

<p>A graphics driver may expose both a blocking and non-blocking power component for a single physical/logical component, if it wishes to provide the ability for the non-graphics driver to selectively choose blocking or non-blocking usage.</p>

<p>When the GRAPHICSPOWER driver interface is available and enabled, a non-graphics driver can make an IO call to the graphics driver to register itself with the graphics driver providing and obtaining callbacks which will be used to manage the shared power components. The IO call will use the <strong><a href="ioctl_internal_graphicspower_register" title="// CTL_CODE(0x0023, 0xa01, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define IOCTL_INTERNAL_GRAPHICSPOWER_REGISTER 0x00232807">IOCTL_INTERNAL_GRAPHICSPOWER_REGISTER</a></strong> control code, with input data <strong>DXGK_GRAPHICSPOWER_REGISTER_INPUT_V_1_2</strong> and output data <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmthk/ns-d3dkmthk-_dxgk_graphicspower_register_output">_DXGK_GRAPHICSPOWER_REGISTER_OUTPUT</a>.</p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmthk/ns-d3dkmthk-_dxgk_graphicspower_register_input_v_1_2">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dkmthk/ns-d3dkmthk-_dxgk_graphicspower_register_input_v_1_2.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
