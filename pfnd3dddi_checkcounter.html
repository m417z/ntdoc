<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PFND3DDDI_CHECKCOUNTER - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PFND3DDDI_CHECKCOUNTER - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PFND3DDDI_CHECKCOUNTER - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dumddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PFND3DDDI_CHECKCOUNTER Pfnd3dddiCheckcounter;

HRESULT Pfnd3dddiCheckcounter(
  HANDLE hDevice,
  <a href="d3dddiquerytype" title="typedef enum _D3DDDIQUERYTYPE {&#10;  D3DDDIQUERYTYPE_VCACHE,&#10;  D3DDDIQUERYTYPE_RESOURCEMANAGER,&#10;  D3DDDIQUERYTYPE_VERTEXSTATS,&#10;  D3DDDIQUERYTYPE_DDISTATS,&#10;  D3DDDIQUERYTYPE_EVENT,&#10;  D3DDDIQUERYTYPE_OCCLUSION,&#10;  D3DDDIQUERYTYPE_TIMESTAMP,&#10;  D3DDDIQUERYTYPE_TIMESTAMPDISJOINT,&#10;  D3DDDIQUERYTYPE_TIMESTAMPFREQ,&#10;  D3DDDIQUERYTYPE_PIPELINETIMINGS,&#10;  D3DDDIQUERYTYPE_INTERFACETIMINGS,&#10;  D3DDDIQUERYTYPE_VERTEXTIMINGS,&#10;  D3DDDIQUERYTYPE_PIXELTIMINGS,&#10;  D3DDDIQUERYTYPE_BANDWIDTHTIMINGS,&#10;  D3DDDIQUERYTYPE_CACHEUTILIZATION,&#10;  D3DDDIQUERYTYPE_COUNTER_DEVICE_DEPENDENT&#10;} D3DDDIQUERYTYPE;">D3DDDIQUERYTYPE</a> unnamedParam2,
  <a href="d3dddi_counter_type" title="typedef enum D3DDDI_COUNTER_TYPE {&#10;  D3DDDI_COUNTER_TYPE_FLOAT32,&#10;  D3DDDI_COUNTER_TYPE_UINT16,&#10;  D3DDDI_COUNTER_TYPE_UINT32,&#10;  D3DDDI_COUNTER_TYPE_UINT64&#10;} ;">D3DDDI_COUNTER_TYPE</a> *unnamedParam3,
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> *unnamedParam4,
  LPSTR unnamedParam5,
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> *pNameLength,
  LPSTR unnamedParam7,
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> *pUnitsLength,
  LPSTR unnamedParam9,
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> *pDescriptionLength
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_checkcounter">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pfnd3dddi_checkcounter.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-d3dumddi-pfnd3dddi_checkcounter)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>PFND3DDDI_CHECKCOUNTER callback function</h1>
<h2>Description</h2>
<p><strong>PFND3DDDI_CHECKCOUNTER</strong> is called by the Direct3D runtime to retrieve info that describes a counter. Must be implemented by Windows Display Driver Model (WDDM) 1.3 and later user-mode display drivers.</p>
<h2>Parameters</h2>
<h3><code>hDevice</code></h3>
<p>[in] A handle to the display device (graphics context).</p>
<h3><code>unnamedParam2</code></h3>
<p>[in] <strong>Counter</strong> is a value of type <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/ns-d3dumddi-_d3dddiarg_createquery"><strong>D3DDDIQUERYTYPE</strong></a> that identifies the counter identifier that info is retrieved for.</p>
<h3><code>unnamedParam3</code></h3>
<p>[out] <strong>pType</strong> is a pointer to a variable that receives a <strong><a href="d3dddi_counter_type" title="typedef enum D3DDDI_COUNTER_TYPE {&#10;  D3DDDI_COUNTER_TYPE_FLOAT32,&#10;  D3DDDI_COUNTER_TYPE_UINT16,&#10;  D3DDDI_COUNTER_TYPE_UINT32,&#10;  D3DDDI_COUNTER_TYPE_UINT64&#10;} ;">D3DDDI_COUNTER_TYPE</a></strong> enumeration value that identifies the data type that the counter outputs.</p>
<h3><code>unnamedParam4</code></h3>
<p><em>pActiveCounters</em> [out] <strong>pActiveCounters</strong> is a pointer to a variable that receives the number of simultaneously active counters that are allocated for the creation of the counter identifier that the <strong>Counter</strong> parameter identifies.</p>
<h3><code>unnamedParam5</code></h3>
<p>[out, optional] <strong>pszName</strong> is an optional pointer that the driver returns a NULL-terminated string to that contains the name of the counter identifier.</p>
<p>Can be NULL, in which case the app doesn't need the name.</p>
<h3><code>pNameLength</code></h3>
<p>[in, out, optional] An optional pointer to a variable that receives the size, in bytes, of the NULL-terminated string that the <strong>pszName</strong> parameter specifies.</p>
<p>Here are limitations on the values of the <strong>pNameLength</strong> and <strong>pszName</strong> parameters:</p>
<ul>
<li><strong>pNameLength</strong> can be NULL, in which case the app doesn't need the name or name length.</li>
<li>If <strong>pszName</strong> is NULL and <strong>pNameLength</strong> is not NULL, the input value of <strong>pNameLength</strong> is ignored, and the length of the string (including terminating NULL character) must be returned through the <strong>pNameLength</strong> parameter.</li>
<li>If both <strong>pszName</strong> and <strong>pNameLength</strong> are not NULL, the driver must check the input value of <strong>pNameLength</strong> to ensure that there's enough room in the allocated buffer, and then the length of the <strong>pszName</strong> string (including terminating NULL character) is passed out through the <strong>pNameLength</strong> parameter.</li>
</ul>
<h3><code>unnamedParam7</code></h3>
<p>[out, optional] <strong>pszUnits</strong> is an optional pointer that the driver returns a NULL-terminated string to that contains the name of the units that the counter identifier measures.</p>
<p>Can be NULL, in which case the app doesn't need the units info. See more info in the explanation of the <strong>pUnitsLength</strong> parameter.</p>
<h3><code>pUnitsLength</code></h3>
<p>[in, out, optional] <strong>pUnitsLength</strong> is an optional pointer to a variable that receives the size, in bytes, of the NULL-terminated string that the <strong>pszUnits</strong> parameter specifies.</p>
<p>Here are limitations on the values of the <strong>pUnitsLength</strong> and <strong>pszUnits</strong> parameters:</p>
<ul>
<li><strong>pUnitsLength</strong> can be NULL, in which case the app doesn't need the unit name or unit name length.</li>
<li>If <strong>pszUnits</strong> is NULL and <strong>pUnitsLength</strong> is not NULL, the input value of <strong>pUnitsLength</strong> is ignored, and the length of the string (including terminating NULL character) must be returned through the <strong>pUnitsLength</strong> parameter.</li>
<li>If both <strong>pszUnits</strong> and <strong>pUnitsLength</strong> are not NULL, the driver must check the input value of <strong>pUnitsLength</strong> to ensure that there's enough room in the allocated buffer, and then the length of the <strong>pszUnits</strong> string (including terminating NULL character) is passed out through the <strong>pUnitsLength</strong> parameter.</li>
</ul>
<h3><code>unnamedParam9</code></h3>
<p>[out, optional] <strong>pszDescription</strong> is an optional pointer that the driver returns a NULL-terminated string to that contains the description of what the counter identifier measures.</p>
<p>Can be NULL, in which case the app doesn't need the description info. See more info in the explanation of the <strong>pDescriptionLength</strong> parameter.</p>
<h3><code>pDescriptionLength</code></h3>
<p>[in, out, optional] <strong>pDescriptionLength</strong> is an optional pointer to a variable that receives the size, in bytes, of the NULL-terminated string that the <strong>pszDescription</strong> parameter specifies.</p>
<p>Here are limitations on the values of the <strong>pDescriptionLength</strong> and <strong>pszDescription</strong> parameters:</p>
<ul>
<li><strong>pDescriptionLength</strong> can be NULL, in which case the app doesn't need the unit name or unit name length.</li>
<li>If <strong>pszDescription</strong> is NULL and <strong>pDescriptionLength</strong> is not NULL, the input value of <strong>pDescriptionLength</strong> is ignored, and the length of the string (including terminating NULL character) must be returned through the <strong>pDescriptionLength</strong> parameter.</li>
<li>If both <strong>pszDescription</strong> and <strong>pDescriptionLength</strong> are not NULL, the driver must check the input value of <strong>pDescriptionLength</strong> to ensure that there's enough room in the allocated buffer, and then the length of the <strong>pszDescription</strong> string (including terminating NULL character) is passed out through the <strong>pDescriptionLength</strong> parameter.</li>
</ul>
<h2>Return value</h2>
<p>If this routine succeeds, it returns S_OK. Otherwise, it returns an HRESULT error code, including the following:</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>E_INVALIDARG</td>
<td>An out-of-range device-dependent counter is requested, or a string length is not large enough for a buffer to contain the entire string. Even though all strings used in this function are based on Unicode, they are always in the English locale and are not localized to other locales.</td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>This function should behave similarly to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d10umddi/nc-d3d10umddi-pfnd3d10ddi_checkcounter"><strong>CheckCounter</strong></a> function that supports Microsoft Direct3D 10 and later.</p>
<p>Counters are typically used by tools that capture a frame and play it back multiple times. The pass that records accurate timing info is separate from other passes. In later passes, a different set of counters is used each time.
The priority should be to obtain an accurate correlation of counter results to draw calls, and the overhead incurred during playback can be sacrificed. The driver must insert flush calls or wait-for-idle calls to ensure an accurate correlation.</p>
<p>Typically an app can simultaneously monitor only a small number of possible native counters, which might number in the hundreds. Additionally, the driver must indicate the number of active counters used by monitoring each supported counter ID from the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/ns-d3dumddi-_d3dddiarg_createquery"><strong>D3DDDIQUERYTYPE</strong></a> enumeration (both well-known counter IDs and device-specific counter IDs). For example, the driver can indicate that monitoring a <strong>FillRateUtilized</strong> variable requires 3 of the maximum 4 simultaneously active counters (indicated by the <strong>pActiveCounters</strong> parameter). The app can therefore also monitor another counter ID, as long as that counter ID requires one or fewer active counters.</p>
<p>If a counter ID can always be monitored (and it doesn't interfere with monitoring any other counter IDs), the number of simultaneous active counters required by the counter ID can be zero.</p>
<h2>See also</h2>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d10umddi/nc-d3d10umddi-pfnd3d10ddi_checkcounter"><strong>CheckCounter</strong></a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/ns-d3dumddi-_d3dddiarg_createquery"><strong>D3DDDIQUERYTYPE</strong></a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_checkcounter">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dumddi/nc-d3dumddi-pfnd3dddi_checkcounter.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
