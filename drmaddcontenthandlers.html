<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="DrmAddContentHandlers - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>DrmAddContentHandlers - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            DrmAddContentHandlers - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// drmk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> DrmAddContentHandlers(
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> ContentId,
  [in] PVOID *paHandlers,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> NumHandlers
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/drmk/nf-drmk-drmaddcontenthandlers">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/drmaddcontenthandlers.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-drmk-drmaddcontenthandlers)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="drmaddcontenthandlers-function">DrmAddContentHandlers function</h1>

<h2 id="description">Description</h2>

<p>The <code>DrmAddContentHandlers</code> function provides the system with a list of functions that handle protected content.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="contentid-in"><code>ContentId</code> [in]</h3>

<p>Specifies the DRM content ID. This parameter identifies a protected KS audio stream.</p>

<h3 id="pahandlers-in"><code>paHandlers</code> [in]</h3>

<p>Pointer to an array of function pointers. Each array element points to a content handler.</p>

<h3 id="numhandlers-in"><code>NumHandlers</code> [in]</h3>

<p>Specifies the number of function pointers in the <em>paHandlers</em> array.</p>

<h2 id="return-value">Return value</h2>

<p><code>DrmAddContentHandlers</code> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the call was successful. Otherwise, it returns an appropriate error code.</p>

<h2 id="remarks">Remarks</h2>

<p>Before allowing protected content to flow through a data path, the system verifies that the data path is secure. To do so, the system authenticates each module in the data path beginning at the upstream end of the data path and moving downstream. As each module is authenticated, that module gives the system information about the next module in the data path so that it can also be authenticated. To be successfully authenticated, a module's binary file must be signed as DRM-compliant.</p>

<p>If two adjacent modules communicate with each other through either the <a href="iocalldriver" title="#define IoCallDriver(a,b)   \&#10;        IofCallDriver(a,b)&#10;);">IoCallDriver</a> function or the downstream module's COM interface, the upstream module calls the <a href="drmforwardcontenttointerface" title="NTSTATUS DrmForwardContentToInterface(&#10;  [in] ULONG    ContentId,&#10;  [in] PUNKNOWN pUnknown,&#10;  [in] ULONG    NumMethods&#10;);">DrmForwardContentToInterface</a> or <a href="drmforwardcontenttodeviceobject" title="NTSTATUS DrmForwardContentToDeviceObject(&#10;  [in]           ULONG        ContentId,&#10;  [in, optional] PVOID        Reserved,&#10;  [in]           PCDRMFORWARD DrmForward&#10;);">DrmForwardContentToDeviceObject</a> function, respectively, to provide the system with information about the downstream module. However, if the two modules use any other type of interface to communicate, the upstream module calls the <code>DrmAddContentHandlers</code> function instead.</p>

<p>The <em>paHandlers</em> array contains function pointers to entry points in the downstream module. <code>DrmAddContentHandlers</code> authenticates the module that implements these functions. (If the entry points are distributed among several modules, the function authenticates all these modules.) The vendor-defined functions in this array make up an interface that is understood by both the module that calls the functions and the module that implements the functions. <code>DrmAddContentHandlers</code> does not directly call any of these functions.</p>

<p>The upstream module can pass both the content ID and content rights to the downstream module by using one of the functions in the <em>paHandlers</em> array for this purpose. The downstream module needs the content ID to advise the system of any modules to which it sends the protected content.</p>

<p><em>DrmAddContentHandlers</em> performs the same function as <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/portcls/nf-portcls-pcaddcontenthandlers">PcAddContentHandlers</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/portcls/nf-portcls-idrmport2-addcontenthandlers">IDrmPort2::AddContentHandlers</a>. For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/drm-functions-and-interfaces">DRM Functions and Interfaces</a>.</p>

<h2 id="see-also">See also</h2>

<p><a href="drmforwardcontenttodeviceobject" title="NTSTATUS DrmForwardContentToDeviceObject(&#10;  [in]           ULONG        ContentId,&#10;  [in, optional] PVOID        Reserved,&#10;  [in]           PCDRMFORWARD DrmForward&#10;);">DrmForwardContentToDeviceObject</a></p>

<p><a href="drmforwardcontenttointerface" title="NTSTATUS DrmForwardContentToInterface(&#10;  [in] ULONG    ContentId,&#10;  [in] PUNKNOWN pUnknown,&#10;  [in] ULONG    NumMethods&#10;);">DrmForwardContentToInterface</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/portcls/nf-portcls-idrmport2-addcontenthandlers">IDrmPort2::AddContentHandlers</a></p>

<p><a href="iocalldriver" title="#define IoCallDriver(a,b)   \&#10;        IofCallDriver(a,b)&#10;);">IoCallDriver</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/portcls/nf-portcls-pcaddcontenthandlers">PcAddContentHandlers</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/drmk/nf-drmk-drmaddcontenthandlers">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/drmk/nf-drmk-drmaddcontenthandlers.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
