<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="OPTITEM - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>OPTITEM - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            OPTITEM - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// compstui.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _OPTITEM {
  <a href="word" title="typedef unsigned short WORD;">WORD</a>      cbSize;
  <a href="byte" title="typedef unsigned char BYTE;">BYTE</a>      Level;
  <a href="byte" title="typedef unsigned char BYTE;">BYTE</a>      DlgPageIdx;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>     Flags;
  <a href="ulong_ptr" title="typedef [public] unsigned __int3264 ULONG_PTR;">ULONG_PTR</a> UserData;
  LPTSTR    pName;
  union {
    <a href="long" title="typedef long LONG;">LONG</a>   Sel;
    LPTSTR pSel;
  } DUMMYUNIONNAME;
  union {
    <a href="extchkbox" title="typedef struct _EXTCHKBOX {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  LPTSTR    pTitle;&#10;  LPTSTR    pSeparator;&#10;  LPTSTR    pCheckedName;&#10;  ULONG_PTR IconID;&#10;  WORD      wReserved[4];&#10;  ULONG_PTR dwReserved[2];&#10;} EXTCHKBOX, *PEXTCHKBOX;">PEXTCHKBOX</a> pExtChkBox;
    <a href="extpush" title="typedef struct _EXTPUSH {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  LPTSTR    pTitle;&#10;  union {&#10;    DLGPROC DlgProc;&#10;    FARPROC pfnCallBack;&#10;  } DUMMYUNIONNAME;&#10;  ULONG_PTR IconID;&#10;  union {&#10;    WORD   DlgTemplateID;&#10;    HANDLE hDlgTemplate;&#10;  } DUMMYUNIONNAME2;&#10;  ULONG_PTR dwReserved[3];&#10;} EXTPUSH, *PEXTPUSH;">PEXTPUSH</a>   pExtPush;
  } DUMMYUNIONNAME2;
  <a href="opttype" title="typedef struct _OPTTYPE {&#10;  WORD      cbSize;&#10;  BYTE      Type;&#10;  BYTE      Flags;&#10;  WORD      Count;&#10;  WORD      BegCtrlID;&#10;  POPTPARAM pOptParam;&#10;  WORD      Style;&#10;  WORD      wReserved[3];&#10;  ULONG_PTR dwReserved[3];&#10;} OPTTYPE, *POPTTYPE;">POPTTYPE</a>  pOptType;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>     HelpIndex;
  <a href="byte" title="typedef unsigned char BYTE;">BYTE</a>      DMPubID;
  <a href="byte" title="typedef unsigned char BYTE;">BYTE</a>      UserItemID;
  <a href="word" title="typedef unsigned short WORD;">WORD</a>      wReserved;
  <a href="oiext" title="typedef struct _OIEXT {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  HINSTANCE hInstCaller;&#10;  LPTSTR    pHelpFile;&#10;  ULONG_PTR dwReserved[4];&#10;} OIEXT, *POIEXT;">POIEXT</a>    pOIExt;
  <a href="ulong_ptr" title="typedef [public] unsigned __int3264 ULONG_PTR;">ULONG_PTR</a> dwReserved[3];
} OPTITEM, *POPTITEM;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/compstui/ns-compstui-_optitem">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/optitem.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-compstui-_optitem)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2 id="description">Description</h2>

<p>The <strong>OPTITEM</strong> structure is used by CPSUI applications (including printer interface DLLs) for describing one <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/property-sheet-options">property sheet option</a> on a property sheet page, if the page is described by a <strong><a href="compropsheetui" title="typedef struct _COMPROPSHEETUI {&#10;  WORD           cbSize;&#10;  WORD           Flags;&#10;  HINSTANCE      hInstCaller;&#10;  LPTSTR         pCallerName;&#10;  ULONG_PTR      UserData;&#10;  LPTSTR         pHelpFile;&#10;  _CPSUICALLBACK pfnCallBack;&#10;  POPTITEM       pOptItem;&#10;  PDLGPAGE       pDlgPage;&#10;  WORD           cOptItem;&#10;  WORD           cDlgPage;&#10;  ULONG_PTR      IconID;&#10;  LPTSTR         pOptItemName;&#10;  WORD           CallerVersion;&#10;  WORD           OptItemVersion;&#10;  ULONG_PTR      dwReserved[4];&#10;} COMPROPSHEETUI, *PCOMPROPSHEETUI;">COMPROPSHEETUI</a></strong> structure.</p>

<h2 id="members">Members</h2>

<h3 id="cbsize"><code>cbSize</code></h3>

<p>Size, in bytes, of the <strong>OPTITEM</strong> structure.</p>

<h3 id="level"><code>Level</code></h3>

<p>Specifies the level of this option in the treeview. For more information, see the Remarks section below.</p>

<h3 id="dlgpageidx"><code>DlgPageIdx</code></h3>

<p>Identifies the dialog to which the option belongs. Specifies an array index into the <a href="dlgpage" title="typedef struct _DLGPAGE {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  DLGPROC   DlgProc;&#10;  LPTSTR    pTabName;&#10;  ULONG_PTR IconID;&#10;  union {&#10;    WORD   DlgTemplateID;&#10;    HANDLE hDlgTemplate;&#10;  } DUMMYUNIONNAME;&#10;} DLGPAGE, *PDLGPAGE;">DLGPAGE</a> array pointed to by the <strong>pDlgPage</strong> member of the <strong><a href="compropsheetui" title="typedef struct _COMPROPSHEETUI {&#10;  WORD           cbSize;&#10;  WORD           Flags;&#10;  HINSTANCE      hInstCaller;&#10;  LPTSTR         pCallerName;&#10;  ULONG_PTR      UserData;&#10;  LPTSTR         pHelpFile;&#10;  _CPSUICALLBACK pfnCallBack;&#10;  POPTITEM       pOptItem;&#10;  PDLGPAGE       pDlgPage;&#10;  WORD           cOptItem;&#10;  WORD           cDlgPage;&#10;  ULONG_PTR      IconID;&#10;  LPTSTR         pOptItemName;&#10;  WORD           CallerVersion;&#10;  WORD           OptItemVersion;&#10;  ULONG_PTR      dwReserved[4];&#10;} COMPROPSHEETUI, *PCOMPROPSHEETUI;">COMPROPSHEETUI</a></strong> structure.</p>

<p>If <strong>pDlgPage</strong> points to a CPSUI-supplied, predefined <strong><a href="dlgpage" title="typedef struct _DLGPAGE {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  DLGPROC   DlgProc;&#10;  LPTSTR    pTabName;&#10;  ULONG_PTR IconID;&#10;  union {&#10;    WORD   DlgTemplateID;&#10;    HANDLE hDlgTemplate;&#10;  } DUMMYUNIONNAME;&#10;} DLGPAGE, *PDLGPAGE;">DLGPAGE</a></strong> structure, CPSUI supplies this index.</p>

<h3 id="flags"><code>Flags</code></h3>

<p>Optional bit flags that modify the option's characteristics. The OPTIF_CHANGEONCE flag is set by CPSUI; all other flags are set by the caller. Any combination of the following flags can be set.</p>

<h4 id="optif_callback">OPTIF_CALLBACK</h4>

<p>When a user modifies the option, CPSUI should call the <a href="_cpsuicallback" title="_CPSUICALLBACK Cpsuicallback;&#10;&#10;LONG Cpsuicallback(&#10;  PCPSUICBPARAM pCPSUICBParam&#10;)&#10;{...}">_CPSUICALLBACK</a>-typed callback function specified in the <strong><a href="compropsheetui" title="typedef struct _COMPROPSHEETUI {&#10;  WORD           cbSize;&#10;  WORD           Flags;&#10;  HINSTANCE      hInstCaller;&#10;  LPTSTR         pCallerName;&#10;  ULONG_PTR      UserData;&#10;  LPTSTR         pHelpFile;&#10;  _CPSUICALLBACK pfnCallBack;&#10;  POPTITEM       pOptItem;&#10;  PDLGPAGE       pDlgPage;&#10;  WORD           cOptItem;&#10;  WORD           cDlgPage;&#10;  ULONG_PTR      IconID;&#10;  LPTSTR         pOptItemName;&#10;  WORD           CallerVersion;&#10;  WORD           OptItemVersion;&#10;  ULONG_PTR      dwReserved[4];&#10;} COMPROPSHEETUI, *PCOMPROPSHEETUI;">COMPROPSHEETUI</a></strong> structure.</p>

<h4 id="optif_changed">OPTIF_CHANGED</h4>

<p>The <strong><a href="_cpsuicallback" title="_CPSUICALLBACK Cpsuicallback;&#10;&#10;LONG Cpsuicallback(&#10;  PCPSUICBPARAM pCPSUICBParam&#10;)&#10;{...}">_CPSUICALLBACK</a></strong>-typed callback function should set this flag if it modified the option, so that CPSUI will redisplay it.</p>

<h4 id="optif_changeonce">OPTIF_CHANGEONCE</h4>

<p>CPSUI sets this bit if a user modified the option.</p>

<h4 id="optif_collapse">OPTIF_COLLAPSE</h4>

<p>Collapse this option and its children so that it is not expanded in the treeview.</p>

<h4 id="optif_disabled">OPTIF_DISABLED</h4>

<p>Disables the option so that it is not user-modifiable.</p>

<h4 id="optif_ecb_checked">OPTIF_ECB_CHECKED</h4>

<p>The associated extended check box is in the checked state.</p>

<h4 id="optif_ext_is_extpush">OPTIF_EXT_IS_EXTPUSH</h4>

<p>If set, the <strong>pExtPush</strong> member is valid (unless <strong>NULL</strong>).</p>

<p>If not set, the <strong>pExtChkBox</strong> member is valid (unless <strong>NULL</strong>).</p>

<h4 id="optif_ext_disabled">OPTIF_EXT_DISABLED</h4>

<p>The extended check box or extended push button is not selectable.</p>

<h4 id="optif_ext_hide">OPTIF_EXT_HIDE</h4>

<p>CPSUI will not display the extended check box or extended push button.</p>

<h4 id="optif_has_poiext">OPTIF_HAS_POIEXT</h4>

<p>If set, the <strong>pOIExt</strong> member is valid.</p>

<h4 id="optif_hide">OPTIF_HIDE</h4>

<p>CPSUI will not display this option in the treeview. CPSUI examines this flag only when initially creating the treeview, so changing the flag from its initial value has no effect.</p>

<h4 id="optif_initial_tvitem">OPTIF_INITIAL_TVITEM</h4>

<p>If set, CPSUI sets the initial window focus to this option when it displays the treeview. CPSUI expands tree nodes and scrolls the option into view as necessary. If the option is hidden, or if this flag is not set for any OPTITEM structure, CPSUI chooses the initial focus.</p>

<h4 id="optif_no_groupbox_name">OPTIF_NO_GROUPBOX_NAME</h4>

<p>If not set, and <strong>pOptype</strong> is not zero, CPSUI uses the <strong>pName</strong> string as the groupbox title.</p>

<p>If set, CPSUI provides a groupbox title.</p>

<h4 id="optif_overlay_no_icon">OPTIF_OVERLAY_NO_ICON</h4>

<p>If set CPSUI overlays its IDI_CPSUI_NO icon onto the icon associated with the option. (See the <strong>Sel/pSel</strong> member.)</p>

<h4 id="optif_overlay_stop_icon">OPTIF_OVERLAY_STOP_ICON</h4>

<p>If set, CPSUI overlays its IDI_CPSUI_STOP icon onto the icon associated with the option. (See the <strong>Sel/pSel</strong> member.)</p>

<h4 id="optif_overlay_warning_icon">OPTIF_OVERLAY_WARNING_ICON</h4>

<p>If set, CPSUI overlays its IDI_CPSUI_WARNING icon onto the icon associated with the option. (See the <strong>Sel/pSel</strong> member.)</p>

<h4 id="optif_sel_as_hicon">OPTIF_SEL_AS_HICON</h4>

<p>If set, the <strong>Sel</strong> member contains an icon handle.</p>

<p>If not set, the <strong>Sel</strong> member contains an icon resource identifier.</p>

<p>This flag can only be used when <strong>pOptType</strong> contains <strong>NULL</strong>.</p>

<h3 id="userdata"><code>UserData</code></h3>

<p>Optional 32-bit value that can be set and used by the caller.</p>

<p>(Printer interface DLLs for <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/microsoft-universal-printer-driver">Unidrv</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/microsoft-postscript-printer-driver">Pscript</a> use this member to supply a pointer to a <strong><a href="userdata" title="typedef struct _USERDATA {&#10;  DWORD     dwSize;&#10;  ULONG_PTR dwItemID;&#10;  PSTR      pKeyWordName;&#10;  DWORD     dwReserved[8];&#10;} USERDATA, *PUSERDATA;">USERDATA</a></strong> structure. <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/user-interface-plug-ins">User interface plug-ins</a> can reference this structure.)</p>

<h3 id="pname"><code>pName</code></h3>

<p>String identifier representing a localized, displayable option name. This can be a 32-bit pointer to a NULL-terminated string, or it can be a 16-bit string resource identifier, with <a href="hiword" title="#define HIWORD(l) ((WORD)((((DWORD_PTR)(l)) &gt;&gt; 16) &amp; 0xffff))">HIWORD</a> set to zero. (Also see the description of <strong>DMPubID</strong>, below.)</p>

<h3 id="dummyunionname"><code>DUMMYUNIONNAME</code></h3>

<h3 id="dummyunionnamesel"><code>DUMMYUNIONNAME.Sel</code></h3>

<p>This union indicates the option's currently selected parameter value. Its usage is dependent on the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/cpsui-option-types">CPSUI option type</a>.</p>

<p>If <strong>pOptType</strong> is <strong>NULL</strong>, the option has no parameters, so this union identifies an icon to be associated with the treeview node for the option. The icon identifier can be either an icon handle or an icon resource identifier, as indicated by OPTIF_SEL_AS_HICON in <strong>Flags</strong>.</p>

<h3 id="dummyunionnamepsel"><code>DUMMYUNIONNAME.pSel</code></h3>

<p>This union indicates the option's currently selected parameter value. Its usage is dependent on the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/cpsui-option-types">CPSUI option type</a>.</p>

<p>If <strong>pOptType</strong> is <strong>NULL</strong>, the option has no parameters, so this union identifies an icon to be associated with the treeview node for the option. The icon identifier can be either an icon handle or an icon resource identifier, as indicated by OPTIF_SEL_AS_HICON in <strong>Flags</strong>.</p>

<h3 id="dummyunionname2"><code>DUMMYUNIONNAME2</code></h3>

<p>Defines the <strong>DUMMYUNIONNAME2</strong> union.</p>

<h3 id="dummyunionname2pextchkbox"><code>DUMMYUNIONNAME2.pExtChkBox</code></h3>

<p>Pointer to <a href="extchkbox" title="typedef struct _EXTCHKBOX {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  LPTSTR    pTitle;&#10;  LPTSTR    pSeparator;&#10;  LPTSTR    pCheckedName;&#10;  ULONG_PTR IconID;&#10;  WORD      wReserved[4];&#10;  ULONG_PTR dwReserved[2];&#10;} EXTCHKBOX, *PEXTCHKBOX;">EXTCHKBOX</a> structure</p>

<h3 id="dummyunionname2pextpush"><code>DUMMYUNIONNAME2.pExtPush</code></h3>

<p>This union can be a pointer to an <strong><a href="extchkbox" title="typedef struct _EXTCHKBOX {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  LPTSTR    pTitle;&#10;  LPTSTR    pSeparator;&#10;  LPTSTR    pCheckedName;&#10;  ULONG_PTR IconID;&#10;  WORD      wReserved[4];&#10;  ULONG_PTR dwReserved[2];&#10;} EXTCHKBOX, *PEXTCHKBOX;">EXTCHKBOX</a></strong> structure, a pointer to an <strong><a href="extpush" title="typedef struct _EXTPUSH {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  LPTSTR    pTitle;&#10;  union {&#10;    DLGPROC DlgProc;&#10;    FARPROC pfnCallBack;&#10;  } DUMMYUNIONNAME;&#10;  ULONG_PTR IconID;&#10;  union {&#10;    WORD   DlgTemplateID;&#10;    HANDLE hDlgTemplate;&#10;  } DUMMYUNIONNAME2;&#10;  ULONG_PTR dwReserved[3];&#10;} EXTPUSH, *PEXTPUSH;">EXTPUSH</a></strong> structure, or <strong>NULL</strong>.</p>

<p>An OPTITEM structure can optionally have an <a href="extchkbox" title="typedef struct _EXTCHKBOX {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  LPTSTR    pTitle;&#10;  LPTSTR    pSeparator;&#10;  LPTSTR    pCheckedName;&#10;  ULONG_PTR IconID;&#10;  WORD      wReserved[4];&#10;  ULONG_PTR dwReserved[2];&#10;} EXTCHKBOX, *PEXTCHKBOX;">EXTCHKBOX</a> structure, an <a href="extpush" title="typedef struct _EXTPUSH {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  LPTSTR    pTitle;&#10;  union {&#10;    DLGPROC DlgProc;&#10;    FARPROC pfnCallBack;&#10;  } DUMMYUNIONNAME;&#10;  ULONG_PTR IconID;&#10;  union {&#10;    WORD   DlgTemplateID;&#10;    HANDLE hDlgTemplate;&#10;  } DUMMYUNIONNAME2;&#10;  ULONG_PTR dwReserved[3];&#10;} EXTPUSH, *PEXTPUSH;">EXTPUSH</a> structure, or neither, associated with it. If this union is not <strong>NULL</strong>, and if OPTIF_EXT_IS_EXTPUSH is set in <strong>Flags</strong>, <strong>pExtPush</strong> is valid. If the flag is not set, <strong>pExtChkBox</strong> is valid.</p>

<h3 id="popttype"><code>pOptType</code></h3>

<p>Pointer to an <a href="opttype" title="typedef struct _OPTTYPE {&#10;  WORD      cbSize;&#10;  BYTE      Type;&#10;  BYTE      Flags;&#10;  WORD      Count;&#10;  WORD      BegCtrlID;&#10;  POPTPARAM pOptParam;&#10;  WORD      Style;&#10;  WORD      wReserved[3];&#10;  ULONG_PTR dwReserved[3];&#10;} OPTTYPE, *POPTTYPE;">OPTTYPE</a> structure that describes the option's display type. If <strong>NULL</strong>, the option has no parameters and is used as a parent to options with a higher <strong>Level</strong> value. The child options must immediately follow the parent in the OPTITEM array. (See the following Remarks section.)</p>

<h3 id="helpindex"><code>HelpIndex</code></h3>

<p>Help file index, which identifies help text to be associated with the option. If zero, help file text does not exist for this option. Note that the <strong>pOIExt</strong> member of this structure must be set with the address of an <a href="oiext" title="typedef struct _OIEXT {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  HINSTANCE hInstCaller;&#10;  LPTSTR    pHelpFile;&#10;  ULONG_PTR dwReserved[4];&#10;} OIEXT, *POIEXT;">OIEXT</a> structure in order for help text functionality to exist.</p>

<h3 id="dmpubid"><code>DMPubID</code></h3>

<p>This member is meant for use by printer interface DLLs, when creating a <strong>Document Properties</strong> property sheet (see <a href="drvdocumentpropertysheets" title="LONG DrvDocumentPropertySheets(&#10;  [in, optional] PPROPSHEETUI_INFO pPSUIInfo,&#10;                 LPARAM            lParam&#10;);">DrvDocumentPropertySheets</a>). It is a constant value specifying which, if any, public member of the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/wingdi/ns-wingdi-devmodew"><strong>DEVMODEW</strong></a> structure is associated with this option. The following table lists available constants, the associated DEVMODE structure member, and the required value for <strong>pName</strong> for each constant.</p>

<table>
<thead>
<tr>
  <th>Constant Value</th>
  <th>Required pName Value</th>
  <th>Structure Member</th>
</tr>
</thead>
<tbody>
<tr>
  <td>DMPUB_COLOR</td>
  <td><strong>dmColor</strong></td>
  <td>IDS_CPSUI_COLOR_APPERANCE</td>
</tr>
<tr>
  <td>DMPUB_COPIES_COLLATE</td>
  <td><strong>dmCopies</strong> and <strong>dmCollate</strong></td>
  <td>IDS_CPSUI_COPIES</td>
</tr>
<tr>
  <td>DMPUB_DEFSOURCE</td>
  <td><strong>dmDefSource</strong></td>
  <td>IDS_CPSUI_SOURCE</td>
</tr>
<tr>
  <td>DMPUB_DITHERTYPE</td>
  <td><strong>dmDitherType</strong></td>
  <td>IDS_CPSUI_DITHERING</td>
</tr>
<tr>
  <td>DMPUB_DUPLEX</td>
  <td><strong>dmDuplex</strong></td>
  <td>IDS_CPSUI_DUPLEX</td>
</tr>
<tr>
  <td>DMPUB_FORMNAME</td>
  <td><strong>dmFormName</strong></td>
  <td>IDS_CPSUI_FORMNAME</td>
</tr>
<tr>
  <td>DMPUB_ICMINTENT</td>
  <td><strong>dmICMIntent</strong></td>
  <td>IDS_CPSUI_ICMINTENT</td>
</tr>
<tr>
  <td>DMPUB_ICMMETHOD</td>
  <td><strong>dmICMMethod</strong></td>
  <td>IDS_CPSUI_ICMMETHOD</td>
</tr>
<tr>
  <td>DMPUB_MEDIATYPE</td>
  <td><strong>dmMediaType</strong></td>
  <td>IDS_CPSUI_MEDIA</td>
</tr>
<tr>
  <td>DMPUB_NUP</td>
  <td>Not contained in public section of DEVMODE.</td>
  <td>IDS_CPSUI_NUP</td>
</tr>
<tr>
  <td>DMPUB_ORIENTATION</td>
  <td><strong>dmOrientation</strong></td>
  <td>IDS_CPSUI_ORIENTATION</td>
</tr>
<tr>
  <td>DMPUB_OUTPUTBIN</td>
  <td>Not contained in public section of DEVMODE.</td>
  <td>IDS_CPSUI_OUTPUTBIN</td>
</tr>
<tr>
  <td>DMPUB_PAGEORDER</td>
  <td>Not contained in public section of DEVMODE.</td>
  <td>IDS_CPSUI_PAGEORDER</td>
</tr>
<tr>
  <td>DMPUB_PRINTQUALITY</td>
  <td><strong>dmPrintQuality</strong></td>
  <td>IDS_CPSUI_PRINTQUALITY or IDS_CPSUI_RESOLUTION. If not specified, the default name is IDS_CPSUI_RESOLUTION.</td>
</tr>
<tr>
  <td>DMPUB_QUALITY</td>
  <td>Not contained in public section of DEVMODE.</td>
  <td>IDS_CPSUI_QUALITY_SETTINGS</td>
</tr>
<tr>
  <td>DMPUB_SCALE</td>
  <td><strong>dmScale</strong></td>
  <td>IDS_CPSUI_SCALE</td>
</tr>
<tr>
  <td>DMPUB_TTOPTION</td>
  <td><strong>dmTTOption</strong></td>
  <td>IDS_CPSUI_TTOPTION</td>
</tr>
<tr>
  <td>DMPUB_NONE</td>
  <td>Not contained in public section of DEVMODE.</td>
  <td></td>
</tr>
<tr>
  <td>Greater than or equal to DMPUB_USER</td>
  <td>Ignored by CPSUI, can be a caller-defined value.</td>
  <td></td>
</tr>
</tbody>
</table>

<p>CPSUI does not maintain a DEVMODE structure. The application is responsible for copying user-selected option parameters into a <strong>DEVMODE</strong> structure. CPSUI uses <strong>DMPubID</strong> contents to determine treeview placement of standard options, and to determine the contents of the <strong>Layout</strong> and <strong>Paper/Quality</strong> tabs (see the <strong>pDlgPage</strong> member of the <strong><a href="compropsheetui" title="typedef struct _COMPROPSHEETUI {&#10;  WORD           cbSize;&#10;  WORD           Flags;&#10;  HINSTANCE      hInstCaller;&#10;  LPTSTR         pCallerName;&#10;  ULONG_PTR      UserData;&#10;  LPTSTR         pHelpFile;&#10;  _CPSUICALLBACK pfnCallBack;&#10;  POPTITEM       pOptItem;&#10;  PDLGPAGE       pDlgPage;&#10;  WORD           cOptItem;&#10;  WORD           cDlgPage;&#10;  ULONG_PTR      IconID;&#10;  LPTSTR         pOptItemName;&#10;  WORD           CallerVersion;&#10;  WORD           OptItemVersion;&#10;  ULONG_PTR      dwReserved[4];&#10;} COMPROPSHEETUI, *PCOMPROPSHEETUI;">COMPROPSHEETUI</a></strong> structure).</p>

<p>For additional information about using the <strong>DMPubID</strong> member, see the following Remarks section.</p>

<h3 id="useritemid"><code>UserItemID</code></h3>

<p>Optional application-supplied value that can be used for option identification purposes. Not referenced by CPSUI.</p>

<h3 id="wreserved"><code>wReserved</code></h3>

<p>Reserved, must be initialized to zero.</p>

<h3 id="poiext"><code>pOIExt</code></h3>

<p>Pointer to an optional <strong><a href="oiext" title="typedef struct _OIEXT {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  HINSTANCE hInstCaller;&#10;  LPTSTR    pHelpFile;&#10;  ULONG_PTR dwReserved[4];&#10;} OIEXT, *POIEXT;">OIEXT</a></strong> structure. The caller is responsible for allocating storage for this structure.</p>

<h3 id="dwreserved"><code>dwReserved</code></h3>

<p>Reserved, must be initialized to zero.</p>

<h2 id="remarks">Remarks</h2>

<p>OPTITEM structures should be placed in an array, and the array's address should be placed in the <strong>pOptItem</strong> member of a <strong><a href="compropsheetui" title="typedef struct _COMPROPSHEETUI {&#10;  WORD           cbSize;&#10;  WORD           Flags;&#10;  HINSTANCE      hInstCaller;&#10;  LPTSTR         pCallerName;&#10;  ULONG_PTR      UserData;&#10;  LPTSTR         pHelpFile;&#10;  _CPSUICALLBACK pfnCallBack;&#10;  POPTITEM       pOptItem;&#10;  PDLGPAGE       pDlgPage;&#10;  WORD           cOptItem;&#10;  WORD           cDlgPage;&#10;  ULONG_PTR      IconID;&#10;  LPTSTR         pOptItemName;&#10;  WORD           CallerVersion;&#10;  WORD           OptItemVersion;&#10;  ULONG_PTR      dwReserved[4];&#10;} COMPROPSHEETUI, *PCOMPROPSHEETUI;">COMPROPSHEETUI</a></strong> structure.</p>

<p>The <strong>Level</strong> member allows you to create child nodes in the treeview. For example, to create a set of option nodes under a level 1 parent node, specify level 2 for each child node and include their OPTITEM structures in the OPTITEM array, immediately after the parent's OPTITEM structure. In the parent's OPTITEM structure, <strong>pOptType</strong> should be <strong>NULL</strong>.</p>

<p>The treeview root node is level 0. Options displayed when a user expands the root node are level 1. The maximum number of levels is 256.</p>

<p>For option values that are stored in a printer's DEVMODE structure, the <strong>DMPubID</strong> member must identify the option. For each <strong>DMPubID</strong> value that is used, a printer interface DLL must specify the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/cpsui-option-types">CPSUI option type</a> listed in the following table.</p>

<table>
<thead>
<tr>
  <th>DMPubID Value</th>
  <th>Required CPSUI Option Type</th>
</tr>
</thead>
<tbody>
<tr>
  <td>DMPUB_COLOR</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-2states">TVOT_2STATES</a></td>
</tr>
<tr>
  <td>DMPUB_COPIES_COLLATE</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-udarrow">TVOT_UDARROW</a> plus <a href="extchkbox" title="typedef struct _EXTCHKBOX {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  LPTSTR    pTitle;&#10;  LPTSTR    pSeparator;&#10;  LPTSTR    pCheckedName;&#10;  ULONG_PTR IconID;&#10;  WORD      wReserved[4];&#10;  ULONG_PTR dwReserved[2];&#10;} EXTCHKBOX, *PEXTCHKBOX;">EXTCHKBOX</a> (See comments following this table.)</td>
</tr>
<tr>
  <td>DMPUB_DEFSOURCE</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-listbox">TVOT_LISTBOX</a></td>
</tr>
<tr>
  <td>DMPUB_DITHERTYPE</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-listbox">TVOT_LISTBOX</a></td>
</tr>
<tr>
  <td>DMPUB_DUPLEX</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-2states">TVOT_2STATES</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-3states">TVOT_3STATES</a></td>
</tr>
<tr>
  <td>DMPUB_FORMNAME</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-listbox">TVOT_LISTBOX</a></td>
</tr>
<tr>
  <td>DMPUB_ICMINTENT</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-2states">TVOT_2STATES</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-3states">TVOT_3STATES</a></td>
</tr>
<tr>
  <td>DMPUB_ICMMETHOD</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-2states">TVOT_2STATES</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-3states">TVOT_3STATES</a></td>
</tr>
<tr>
  <td>DMPUB_MEDIATYPE</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-listbox">TVOT_LISTBOX</a></td>
</tr>
<tr>
  <td>DMPUB_NUP</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-listbox">TVOT_LISTBOX</a></td>
</tr>
<tr>
  <td>DMPUB_ORIENTATION</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-2states">TVOT_2STATES</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-3states">TVOT_3STATES</a></td>
</tr>
<tr>
  <td>DMPUB_OUTPUTBIN</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-listbox">TVOT_LISTBOX</a></td>
</tr>
<tr>
  <td>DMPUB_PAGEORDER</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-2states">TVOT_2STATES</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-3states">TVOT_3STATES</a></td>
</tr>
<tr>
  <td>DMPUB_PRINTQUALITY</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-listbox">TVOT_LISTBOX</a></td>
</tr>
<tr>
  <td>DMPUB_QUALITY</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-2states">TVOT_2STATES</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-3states">TVOT_3STATES</a></td>
</tr>
<tr>
  <td>DMPUB_SCALE</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-udarrow">TVOT_UDARROW</a></td>
</tr>
<tr>
  <td>DMPUB_TTOPTION</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/tvot-listbox">TVOT_LISTBOX</a></td>
</tr>
</tbody>
</table>

<p>If <strong>DMPubID</strong> is DMPUB_COPIES_COLLATE and the printer can collate copies, an extended check box (<strong><a href="extchkbox" title="typedef struct _EXTCHKBOX {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  LPTSTR    pTitle;&#10;  LPTSTR    pSeparator;&#10;  LPTSTR    pCheckedName;&#10;  ULONG_PTR IconID;&#10;  WORD      wReserved[4];&#10;  ULONG_PTR dwReserved[2];&#10;} EXTCHKBOX, *PEXTCHKBOX;">EXTCHKBOX</a></strong> structure) must be provided. The <strong>EXTCHCKBOX</strong> structure's members must be set as follows:</p>

<p><!-- CODE_MARKER --></p>

<div class="codehilite">
<pre><span></span><code><span class="n">pExtCheckbox</span><span class="o">-&gt;</span><span class="n">cbSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n"><a href="extchkbox" title="typedef struct _EXTCHKBOX {&#10;  WORD      cbSize;&#10;  WORD      Flags;&#10;  LPTSTR    pTitle;&#10;  LPTSTR    pSeparator;&#10;  LPTSTR    pCheckedName;&#10;  ULONG_PTR IconID;&#10;  WORD      wReserved[4];&#10;  ULONG_PTR dwReserved[2];&#10;} EXTCHKBOX, *PEXTCHKBOX;">EXTCHKBOX</a></span><span class="p">);</span>
<span class="n">pExtCheckbox</span><span class="o">-&gt;</span><span class="n">pTitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">PWSTR</span><span class="p">)</span><span class="w"> </span><span class="n">IDS_CPSUI_COLLATE</span><span class="p">;</span>
<span class="n">pExtCheckbox</span><span class="o">-&gt;</span><span class="n">pCheckedName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">PWSTR</span><span class="p">)</span><span class="w"> </span><span class="n">IDS_CPSUI_COLLATED</span><span class="p">;</span>
<span class="n">pExtCheckbox</span><span class="o">-&gt;</span><span class="n">IconID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IDI_CPSUI_COLLATE</span><span class="p">;</span>
<span class="n">pExtCheckbox</span><span class="o">-&gt;</span><span class="n">Flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ECBF_CHECKNAME_ONLY_ENABLED</span><span class="p">;</span>
<span class="n">pExtCheckbox</span><span class="o">-&gt;</span><span class="n">pSeparator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">PWSTR</span><span class="p">)</span><span class="n">IDS_CPSUI_SLASH_SEP</span><span class="p">;</span>
</code></pre>
</div>

<p>If OPTIF_EXT_HIDE is not set in <strong>Flags</strong>, CPSUI enables the check box if a user requests more than one copy, and disables it if only one copy is requested.</p>

<p>Additionally, CPSUI sets the option's display text to <strong>copy</strong> for one copy and <strong>copies</strong> for more than one copy.</p>

<p>If <strong>DMPubID</strong> is DMPUB_COLOR, its first <strong><a href="optparam" title="typedef struct _OPTPARAM {&#10;  WORD      cbSize;&#10;  BYTE      Flags;&#10;  BYTE      Style;&#10;  LPTSTR    pData;&#10;  ULONG_PTR IconID;&#10;  LPARAM    lParam;&#10;  ULONG_PTR dwReserved[2];&#10;} OPTPARAM, *POPTPARAM;">OPTPARAM</a></strong> structure (<strong>Sel</strong>=0) must represent Gray Scale, and <strong>pData</strong> in the <a href="optparam" title="typedef struct _OPTPARAM {&#10;  WORD      cbSize;&#10;  BYTE      Flags;&#10;  BYTE      Style;&#10;  LPTSTR    pData;&#10;  ULONG_PTR IconID;&#10;  LPARAM    lParam;&#10;  ULONG_PTR dwReserved[2];&#10;} OPTPARAM, *POPTPARAM;">OPTPARAM</a> structure must be IDS_CPSUI_GRAYSCALE. Its second <a href="optparam" title="typedef struct _OPTPARAM {&#10;  WORD      cbSize;&#10;  BYTE      Flags;&#10;  BYTE      Style;&#10;  LPTSTR    pData;&#10;  ULONG_PTR IconID;&#10;  LPARAM    lParam;&#10;  ULONG_PTR dwReserved[2];&#10;} OPTPARAM, *POPTPARAM;">OPTPARAM</a> structure (<strong>Sel</strong>=1) must represent Color, and <strong>pData</strong> in the <a href="optparam" title="typedef struct _OPTPARAM {&#10;  WORD      cbSize;&#10;  BYTE      Flags;&#10;  BYTE      Style;&#10;  LPTSTR    pData;&#10;  ULONG_PTR IconID;&#10;  LPARAM    lParam;&#10;  ULONG_PTR dwReserved[2];&#10;} OPTPARAM, *POPTPARAM;">OPTPARAM</a> structure must be IDS_CPSUI_COLOR. If another option's <strong>DMPubID</strong> is DMPUB_ICMINTENT and if Color is not selected, CPSUI disables the option for which DMPUB_ICMINTENT is specified.</p>

<p>CPSUI disables color matching when Color is not selected.</p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/compstui/ns-compstui-_optitem">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/compstui/ns-compstui-_optitem.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
