<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="KeSetTimerEx - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>KeSetTimerEx - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github.ntdoc.min.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github-dark-dimmed.ntdoc.min.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            KeSetTimerEx - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header language-cpp">// wdm.h

</span><span class="ntdoc-code-intro language-cpp"></span><span class="ntdoc-code-body language-cpp">BOOLEAN KeSetTimerEx(
  [in, out]      PKTIMER       Timer,
  [in]           LARGE_INTEGER DueTime,
  [in]           <a href="long" title="typedef long LONG;">LONG</a>          Period,
  [in, optional] PKDPC         Dpc
);</span><span class="ntdoc-code-footer language-cpp"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-kesettimerex">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/kesettimerex.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-wdm-kesettimerex)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>KeSetTimerEx function</h1>
<h2>Description</h2>
<p>The <strong>KeSetTimerEx</strong> routine sets the absolute or relative interval at which a timer object is to be set to a signaled state, optionally supplies a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/using-a-customtimerdpc-routine">CustomTimerDpc</a> routine to be executed when that interval expires, and optionally supplies a recurring interval for the timer.</p>
<h2>Parameters</h2>
<h3><code>Timer</code> [in, out]</h3>
<p>Pointer to a timer object that was initialized with <a href="keinitializetimer" title="VOID KeInitializeTimer(&#10;  [out] PKTIMER Timer&#10;);">KeInitializeTimer</a> or <a href="keinitializetimerex" title="VOID KeInitializeTimerEx(&#10;  [out] PKTIMER    Timer,&#10;  [in]  TIMER_TYPE Type&#10;);">KeInitializeTimerEx</a>.</p>
<h3><code>DueTime</code> [in]</h3>
<p>Specifies the absolute or relative time at which the timer is to expire. If the value of the <em>DueTime</em> parameter is negative, the expiration time is relative to the current system time. Otherwise, the expiration time is absolute. The expiration time is expressed in system time units (100-nanosecond intervals). Absolute expiration times track any changes in the system time; relative expiration times are not affected by system time changes.</p>
<h3><code>Period</code> [in]</h3>
<p>Specifies an optional recurring interval for the timer in milliseconds. Must be a value that is greater than or equal to zero. If the value of this parameter is zero, the timer is a nonperiodic timer that does not automatically re-queue itself.</p>
<h3><code>Dpc</code> [in, optional]</h3>
<p>Pointer to a DPC object that was initialized by <a href="keinitializedpc" title="VOID KeInitializeDpc(&#10;  [out]          __drv_aliasesMem PRKDPC Dpc,&#10;  [in]           PKDEFERRED_ROUTINE      DeferredRoutine,&#10;  [in, optional] __drv_aliasesMem PVOID  DeferredContext&#10;);">KeInitializeDpc</a>. This parameter is optional.</p>
<h2>Return value</h2>
<p>If the timer object was already in the system timer queue, <strong>KeSetTimerEx</strong> returns <strong>TRUE</strong>.</p>
<h2>Remarks</h2>
<p>The <strong>KeSetTimerEx</strong> routine does the following:</p>
<ul>
<li>
<p>Computes the expiration time.</p>
</li>
<li>
<p>Sets the timer to a not-signaled state.</p>
</li>
<li>
<p>Sets the recurring interval for the timer, if one was specified.</p>
</li>
<li>
<p>Inserts the timer object in the system timer queue.</p>
</li>
</ul>
<p>If the timer object was already in the timer queue, it is implicitly canceled before being set to the new expiration time. A call to <strong>KeSetTimerEx</strong> before the previously specified <em>DueTime</em> has expired cancels both the timer and the call to the <em>Dpc</em>, if any, associated with the previous call.</p>
<p>Expiration times are measured relative to the system clock, and the accuracy with which the operating system can detect when a timer expires is limited by the granularity of the system clock. For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/timer-accuracy">Timer Accuracy</a>.</p>
<p>If the <em>Dpc</em> parameter is specified, a DPC object is associated with the timer object. When the timer expires, the timer object is removed from the system timer queue and it is set to a signaled state. If a DPC object was associated with the timer when it was set, the DPC object is inserted in the system DPC queue to be executed as soon as conditions permit after the timer interval expires.</p>
<p>A DPC routine cannot deallocate a periodic timer. A DPC routine can deallocate a nonperiodic timer.</p>
<p>Note that a periodic timer is automatically restarted as soon as it expires. Thus, on a multiprocessor machine, the DPC for a periodic timer can be running on two processors simultaneously.</p>
<p>Only one instantiation of a given DPC object can be queued at any given moment. To avoid potential race conditions, the DPC passed to <strong>KeSetTimerEx</strong> should not be passed to <a href="keinsertqueuedpc" title="BOOLEAN KeInsertQueueDpc(&#10;  [in, out]      PRKDPC                 Dpc,&#10;  [in, optional] PVOID                  SystemArgument1,&#10;  [in, optional] __drv_aliasesMem PVOID SystemArgument2&#10;);">KeInsertQueueDpc</a>.</p>
<p>Drivers must cancel any active timers in their <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-driver_unload">Unload</a> routines. Use <a href="kecanceltimer" title="BOOLEAN KeCancelTimer(&#10;  [in, out] PKTIMER unnamedParam1&#10;);">KeCancelTimer</a> to cancel any timers.</p>
<p>For more information about timer objects, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/timer-objects-and-dpcs">Timer Objects and DPCs</a>.</p>
<h2>See also</h2>
<p><a href="kecanceltimer" title="BOOLEAN KeCancelTimer(&#10;  [in, out] PKTIMER unnamedParam1&#10;);">KeCancelTimer</a></p>
<p><a href="keinitializedpc" title="VOID KeInitializeDpc(&#10;  [out]          __drv_aliasesMem PRKDPC Dpc,&#10;  [in]           PKDEFERRED_ROUTINE      DeferredRoutine,&#10;  [in, optional] __drv_aliasesMem PVOID  DeferredContext&#10;);">KeInitializeDpc</a></p>
<p><a href="keinitializetimer" title="VOID KeInitializeTimer(&#10;  [out] PKTIMER Timer&#10;);">KeInitializeTimer</a></p>
<p><a href="keinitializetimerex" title="VOID KeInitializeTimerEx(&#10;  [out] PKTIMER    Timer,&#10;  [in]  TIMER_TYPE Type&#10;);">KeInitializeTimerEx</a></p>
<p><a href="kereadstatetimer" title="BOOLEAN KeReadStateTimer(&#10;  [in] PKTIMER Timer&#10;);">KeReadStateTimer</a></p>
<p><a href="kewaitformultipleobjects" title="NTSTATUS&#10;KeWaitForMultipleObjects (&#10;    ULONG Count,&#10;    PVOID Object[],&#10;    WaitType,&#10;    KWAIT_REASON WaitReason,&#10;    KPROCESSOR_MODE WaitMode,&#10;    BOOLEAN Alertable,&#10;    PLARGE_INTEGER Timeout,&#10;    PKWAIT_BLOCK WaitBlockArray&#10;    );">KeWaitForMultipleObjects</a></p>
<p><a href="kewaitforsingleobject" title="NTSTATUS&#10;KeWaitForSingleObject (&#10;    PVOID Object,&#10;    KWAIT_REASON WaitReason,&#10;    KPROCESSOR_MODE WaitMode,&#10;    BOOLEAN Alertable,&#10;    PLARGE_INTEGER Timeout&#10;    );">KeWaitForSingleObject</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-kesettimerex">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/nf-wdm-kesettimerex.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script src="modules/highlight.js/highlight.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
