<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PO_FX_COMPONENT_V1 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PO_FX_COMPONENT_V1 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PO_FX_COMPONENT_V1 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _PO_FX_COMPONENT_V1 {
  GUID                        Id;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                       IdleStateCount;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                       DeepestWakeableIdleState;
  <a href="po_fx_component_idle_state" title="typedef struct _PO_FX_COMPONENT_IDLE_STATE {&#10;  ULONGLONG TransitionLatency;&#10;  ULONGLONG ResidencyRequirement;&#10;  ULONG     NominalPower;&#10;} PO_FX_COMPONENT_IDLE_STATE, *PPO_FX_COMPONENT_IDLE_STATE;">PPO_FX_COMPONENT_IDLE_STATE</a> IdleStates;
} PO_FX_COMPONENT_V1, *PPO_FX_COMPONENT_V1;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_po_fx_component_v1">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/po_fx_component_v1.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-wdm-_po_fx_component_v1)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_po_fx_component_v1-structure">_PO_FX_COMPONENT_V1 structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>PO_FX_COMPONENT</strong> structure describes the power state attributes of a component in a device.</p>

<h2 id="members">Members</h2>

<h3 id="id"><code>Id</code></h3>

<p>A component ID that uniquely identifies this component with respect to the other components in the device. The driver should specify a nonzero value for this member if the power management framework (PoFx) requires a component ID to distinguish this component from other, similar components in the same device. This member is optional. If this member is not used, it must be set to all zeros.</p>

<h3 id="idlestatecount"><code>IdleStateCount</code></h3>

<p>The number of elements in the array that is pointed to by the <strong>IdleStates</strong> member. Additionally, this member specifies the number of Fx power states that the component supports. A component must support at least one Fx state (F0).</p>

<h3 id="deepestwakeableidlestate"><code>DeepestWakeableIdleState</code></h3>

<p>The index of the deepest Fx state from which the component can wake. Specify 0 for F0, 1 for F1, and so on. This index must be less than <strong>IdleStateCount</strong>.</p>

<h3 id="idlestates"><code>IdleStates</code></h3>

<p>A pointer to a <a href="po_fx_component_idle_state" title="typedef struct _PO_FX_COMPONENT_IDLE_STATE {&#10;  ULONGLONG TransitionLatency;&#10;  ULONGLONG ResidencyRequirement;&#10;  ULONG     NominalPower;&#10;} PO_FX_COMPONENT_IDLE_STATE, *PPO_FX_COMPONENT_IDLE_STATE;">PO_FX_COMPONENT_IDLE_STATE</a> array. The length of this array is specified by the <strong>IdleStateCount</strong> member. Each array element specifies the attributes of an Fx power state that is supported by the component. Element 0 describes F0, element 1 describes F1, and so on.</p>

<h2 id="remarks">Remarks</h2>

<p>When a device driver registers a device with PoFx, the driver supplies a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_po_fx_device_v1">PO_FX_DEVICE</a> structure that holds the registration information. This structure contains an array of <strong>PO_FX_COMPONENT</strong> structures. The elements in this array describe the power attributes of the individual components in the device. PoFx uses the information in this array to manage the power settings of these components.</p>

<p>The <strong>Id</strong> member contains a component ID that PoFx can use to uniquely identify a component. Do not confuse the component ID with the component index, which a routine such as <a href="pofxactivatecomponent" title="VOID PoFxActivateComponent(&#10;  [in] POHANDLE Handle,&#10;  [in] ULONG    Component,&#10;  [in] ULONG    Flags&#10;);">PoFxActivateComponent</a> uses to identify a component in a registered device. A component index is an index into the <strong>Components</strong> array in the <strong>PO_FX_DEVICE</strong> structure that the device driver used to register the device with PoFx. If the <strong>Components</strong> array contains N elements, component indexes are integer values in the range 0 to Nâ€“1. In contrast, a component ID is a GUID value.</p>

<p>The <strong>Flags</strong> member may be set to the <strong>PO_FX_COMPONENT_FLAG_F0_ON_DX</strong> value if the driver specified support for <strong>PO_FX_VERSION_V2</strong> during registration with PoFx (that is, during the call to the <a href="pofxregisterdevice" title="NTSTATUS PoFxRegisterDevice(&#10;  [in]  PDEVICE_OBJECT Pdo,&#10;  [in]  PPO_FX_DEVICE  Device,&#10;  [out] POHANDLE       *Handle&#10;);">PoFxRegisterDevice</a> routine, the driver specified the value <strong>PO_FX_VERSION_V2</strong> for the <strong>Version</strong> member of the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_po_fx_device_v1">PO_FX_DEVICE</a> structure that was passed to the <em>Device</em> parameter). If the <strong>PO_FX_COMPONENT_FLAG_F0_ON_DX</strong> flag is specified, PoFx will place the component into the F0 power state during Dx transitions and for wait/wake IRPs.
Before dispatching a Dx <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a> or wait/wake <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a> to the device stack (whichever event happens first), the power manager will transition the component into the F0 state. The component will be kept in F0 until the wake/wait <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a> is canceled or completed, or the Dx <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a> is completed and driver has called the <a href="pofxreportdevicepoweredon" title="VOID PoFxReportDevicePoweredOn(&#10;  [in] POHANDLE Handle&#10;);">PoFxReportDevicePoweredOn</a> routine (whichever event happens last).</p>

<h3 id="component-dependencies">Component dependencies</h3>

<p>PoFx supports logical component dependencies within a device (but not across different devices). During device registration for each component, the driver can supply a number (the <em>ProviderCount</em> member) and an array of component indexes (the <em>Providers</em> member) this component depends on; these are known as <em>providers</em>. PoFx guarantees that the component will not become active until all of its providers are active.</p>

<p>Component dependencies form a directed graph where an edge points from a dependent component to a provider and represents a dependency. During device registration, PoFx validates the dependency graph: cycles and repeated edges are not allowed and the depth of the graph for the depth-first search traversal cannot exceed four. PoFx also sets the componentsâ€™ active reference count according to the dependency graph; that is, each providerâ€™s active reference count is incremented once for each component that depends on it.</p>

<p>During the component activation, PoFx asynchronously activates all providers first. After a component is active, PoFx checks every dependent component and continues their activation if necessary.</p>

<p>When the component transitions to the idle state, PoFx first makes the dependent components idle. After the driver completes the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_idle_condition_callback">ComponentIdleConditionCallback</a> and the platform extension plug-in (PEP) is notified that the component is idle, PoFx recursively traverses the dependency graph in breadth-first traversal and asynchronously idles each provider.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/component-level-power-management">Component-Level Power Management</a></p>

<p><a href="po_fx_component_idle_state" title="typedef struct _PO_FX_COMPONENT_IDLE_STATE {&#10;  ULONGLONG TransitionLatency;&#10;  ULONGLONG ResidencyRequirement;&#10;  ULONG     NominalPower;&#10;} PO_FX_COMPONENT_IDLE_STATE, *PPO_FX_COMPONENT_IDLE_STATE;">PO_FX_COMPONENT_IDLE_STATE</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_po_fx_device_v1">PO_FX_DEVICE</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_po_fx_component_v1">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/ns-wdm-_po_fx_component_v1.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
