<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NDIS_PM_WOL_PATTERN - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NDIS_PM_WOL_PATTERN - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NDIS_PM_WOL_PATTERN - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _NDIS_PM_WOL_PATTERN {
  <a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a>     Header;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                  Flags;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                  Priority;
  <a href="ndis_pm_wol_packet" title="typedef enum _NDIS_PM_WOL_PACKET {&#10;  NdisPMWoLPacketUnspecified,&#10;  NdisPMWoLPacketBitmapPattern,&#10;  NdisPMWoLPacketMagicPacket,&#10;  NdisPMWoLPacketIPv4TcpSyn,&#10;  NdisPMWoLPacketIPv6TcpSyn,&#10;  NdisPMWoLPacketEapolRequestIdMessage,&#10;  NdisPMWoLPacketMaximum&#10;} NDIS_PM_WOL_PACKET, *PNDIS_PM_WOL_PACKET;">NDIS_PM_WOL_PACKET</a>     WoLPacketType;
  <a href="ndis_pm_counted_string" title="typedef struct _NDIS_PM_COUNTED_STRING {&#10;  USHORT Length;&#10;  WCHAR  String[NDIS_PM_MAX_STRING_SIZE + 1];&#10;} NDIS_PM_COUNTED_STRING, *PNDIS_PM_COUNTED_STRING;">NDIS_PM_COUNTED_STRING</a> FriendlyName;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                  PatternId;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                  NextWoLPatternOffset;
  union {
    struct {
      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  Flags;
      <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>  IPv4SourceAddress[4];
      <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>  IPv4DestAddress[4];
      <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a> TCPSourcePortNumber;
      <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a> TCPDestPortNumber;
    } IPv4TcpSynParameters;
    struct {
      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  Flags;
      <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>  IPv6SourceAddress[16];
      <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>  IPv6DestAddress[16];
      <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a> TCPSourcePortNumber;
      <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a> TCPDestPortNumber;
    } IPv6TcpSynParameters;
    struct {
      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Flags;
    } EapolRequestIdMessageParameters;
    struct {
      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Flags;
      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> MaskOffset;
      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> MaskSize;
      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> PatternOffset;
      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> PatternSize;
    } WoLBitMapPattern;
  } WoLPattern;
  _WOL_PATTERN           _WOL_PATTERN;
} NDIS_PM_WOL_PATTERN, *PNDIS_PM_WOL_PATTERN;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_pm_wol_pattern">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndis_pm_wol_pattern.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddndis-_ndis_pm_wol_pattern)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_ndis_pm_wol_pattern-structure">_NDIS_PM_WOL_PATTERN structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>NDIS_PM_WOL_PATTERN</strong> structure defines a wake-on-LAN (WOL) pattern.</p>

<h2 id="members">Members</h2>

<h3 id="header"><code>Header</code></h3>

<p>The type, revision, and size of the <strong>NDIS_PM_WOL_PATTERN</strong> structure. This member is formatted as an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/objectheader/ns-objectheader-ndis_object_header">NDIS_OBJECT_HEADER</a> structure.</p>

<p>The miniport driver must set the <strong>Type</strong> member of <strong>Header</strong> to NDIS_OBJECT_TYPE_DEFAULT. To specify the version of the <strong>NDIS_PM_WOL_PATTERN</strong> structure, the driver must set the <strong>Revision</strong> member of <strong>Header</strong> to the following value:</p>

<h4 id="ndis_pm_wol_pattern_revision_2">NDIS_PM_WOL_PATTERN_REVISION_2</h4>

<p>Revisions made to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ne-ntddndis-_ndis_pm_wol_packet">NDIS_PM_WOL_PACKET</a> enumeration for NDIS 6.30.</p>

<p>Set the <strong>Size</strong> member to NDIS_SIZEOF_NDIS_PM_WOL_PATTERN_REVISION_2.</p>

<h4 id="ndis_pm_wol_pattern_revision_1">NDIS_PM_WOL_PATTERN_REVISION_1</h4>

<p>Original version for NDIS 6.20.</p>

<p>Set the <strong>Size</strong> member to NDIS_SIZEOF_NDIS_PM_WOL_PATTERN_REVISION_1.</p>

<h3 id="flags"><code>Flags</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains a bitwise OR of flags. This member is reserved for NDIS.</p>

<h3 id="priority"><code>Priority</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains the priority of the WOL pattern. If an overlying driver adds a higher
priority WOL pattern when there are no resources that are available for more WOL patterns, NDIS might remove a
lower priority WOL pattern to free resources. Miniport drivers should ignore this member. A protocol
driver can specify any priority that is within the predefined range. The following values are
predefined:</p>

<h4 id="ndis_pm_wol_priority_lowest">NDIS_PM_WOL_PRIORITY_LOWEST</h4>

<p>Specifies the lowest priority WOL pattern.</p>

<h4 id="ndis_pm_wol_priority_normal">NDIS_PM_WOL_PRIORITY_NORMAL</h4>

<p>Specifies a normal priority WOL pattern.</p>

<h4 id="ndis_pm_wol_priority_highest">NDIS_PM_WOL_PRIORITY_HIGHEST</h4>

<p>Specifies the highest priority WOL pattern.</p>

<h3 id="wolpackettype"><code>WoLPacketType</code></h3>

<p>An
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ne-ntddndis-_ndis_pm_wol_packet">NDIS_PM_WOL_PACKET</a> enumeration value that
specifies the type of the WOL packet.</p>

<h3 id="friendlyname"><code>FriendlyName</code></h3>

<p>An
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_pm_counted_string">NDIS_PM_COUNTED_STRING</a> structure
that contains the user-readable description of the WOL packet.</p>

<h3 id="patternid"><code>PatternId</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains an NDIS-provided value that identifies the WOL pattern. Before NDIS
sends the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-pm-add-wol-pattern">OID_PM_ADD_WOL_PATTERN</a> OID request down
to the underlying NDIS drivers or completes the request to the overlying driver, NDIS sets
<strong>PatternId</strong> to a value that is unique among the WOL patterns on a network adapter.</p>

<h3 id="nextwolpatternoffset"><code>NextWoLPatternOffset</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains an offset, in bytes. The
<strong>NextWoLPatternOffset</strong> member of each NDIS_PM_WOL_PATTERN structure in a list is set to the offset
(from the beginning of the OID request
**InformationBuffer**) of the next NDIS_PM_WOL_PATTERN structure in the list. If
<strong>NextWoLPatternOffset</strong> is zero, the current structure is the last structure in the list.</p>

<h3 id="wolpattern"><code>WoLPattern</code></h3>

<p>A union that contains the following member structures.</p>

<h3 id="wolpatternipv4tcpsynparameters"><code>WoLPattern.IPv4TcpSynParameters</code></h3>

<p>A structure that contains IPv4 TCP SYN information. This structure contains the following
members:</p>

<h3 id="wolpatternipv4tcpsynparametersflags"><code>WoLPattern.IPv4TcpSynParameters.Flags</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains a bitwise OR of flags. This member is reserved for NDIS.</p>

<h3 id="wolpatternipv4tcpsynparametersipv4sourceaddress"><code>WoLPattern.IPv4TcpSynParameters.IPv4SourceAddress</code></h3>

<p>The IPv4 source address in the TCP SYN packet.</p>

<h3 id="wolpatternipv4tcpsynparametersipv4destaddress"><code>WoLPattern.IPv4TcpSynParameters.IPv4DestAddress</code></h3>

<p>The IPv4 destination address in the TCP SYN packet.</p>

<h3 id="wolpatternipv4tcpsynparameterstcpsourceportnumber"><code>WoLPattern.IPv4TcpSynParameters.TCPSourcePortNumber</code></h3>

<p>The TCP source port number in the TCP SYN packet.</p>

<h3 id="wolpatternipv4tcpsynparameterstcpdestportnumber"><code>WoLPattern.IPv4TcpSynParameters.TCPDestPortNumber</code></h3>

<p>The TCP destination port number in the TCP SYN packet.</p>

<h3 id="wolpatternipv6tcpsynparameters"><code>WoLPattern.IPv6TcpSynParameters</code></h3>

<p>A structure that contains IPv6 TCP SYN information. This structure contains the following
members:</p>

<h3 id="wolpatternipv6tcpsynparametersflags"><code>WoLPattern.IPv6TcpSynParameters.Flags</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains a bitwise OR of flags. This member is reserved for NDIS.</p>

<h3 id="wolpatternipv6tcpsynparametersipv6sourceaddress"><code>WoLPattern.IPv6TcpSynParameters.IPv6SourceAddress</code></h3>

<p>The IPv6 source address in the TCP SYN packet.</p>

<h3 id="wolpatternipv6tcpsynparametersipv6destaddress"><code>WoLPattern.IPv6TcpSynParameters.IPv6DestAddress</code></h3>

<p>The IPv6 destination address in the TCP SYN packet.</p>

<h3 id="wolpatternipv6tcpsynparameterstcpsourceportnumber"><code>WoLPattern.IPv6TcpSynParameters.TCPSourcePortNumber</code></h3>

<p>The TCP source port in the TCP SYN packet.</p>

<h3 id="wolpatternipv6tcpsynparameterstcpdestportnumber"><code>WoLPattern.IPv6TcpSynParameters.TCPDestPortNumber</code></h3>

<p>The TCP destination port in the TCP SYN packet.</p>

<h3 id="wolpatterneapolrequestidmessageparameters"><code>WoLPattern.EapolRequestIdMessageParameters</code></h3>

<p>A structure that contains 802.1X EAPOL request identity message parameters. This structure
contains the following members:</p>

<h3 id="wolpatterneapolrequestidmessageparametersflags"><code>WoLPattern.EapolRequestIdMessageParameters.Flags</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains a bitwise OR of flags. This member is reserved for NDIS.</p>

<h3 id="wolpatternwolbitmappattern"><code>WoLPattern.WoLBitMapPattern</code></h3>

<p>A structure that specifies a WOL bitmap pattern. For more information about bitmap patterns, see
the Remarks section. The structure has the following members:</p>

<h3 id="wolpatternwolbitmappatternflags"><code>WoLPattern.WoLBitMapPattern.Flags</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains a bitwise OR of flags. This member is reserved for NDIS.</p>

<h3 id="wolpatternwolbitmappatternmaskoffset"><code>WoLPattern.WoLBitMapPattern.MaskOffset</code></h3>

<p>The offset, in bytes, for a mask buffer from the beginning of the NDIS_PM_WOL_PATTERN
structure.</p>

<p>The mask specifies which bytes in incoming packets should be matched against the bitmap pattern.
Each bit in the bitmask corresponds to a byte in the pattern. If a bit is zero, the corresponding
byte in the incoming packet should not be pattern-matched. If the bit is one, the network adapter compares the
byte to the incoming packet with the byte specified in the pattern.</p>

<h3 id="wolpatternwolbitmappatternmasksize"><code>WoLPattern.WoLBitMapPattern.MaskSize</code></h3>

<p>The size, in bytes, of the mask.</p>

<h3 id="wolpatternwolbitmappatternpatternoffset"><code>WoLPattern.WoLBitMapPattern.PatternOffset</code></h3>

<p>The offset, in bytes, for a pattern buffer from the beginning of the NDIS_PM_WOL_PATTERN
structure.</p>

<h3 id="wolpatternwolbitmappatternpatternsize"><code>WoLPattern.WoLBitMapPattern.PatternSize</code></h3>

<p>The size, in bytes, of the pattern.</p>

<h3 id="_wol_pattern"><code>_WOL_PATTERN</code></h3>

<h2 id="remarks">Remarks</h2>

<p>The NDIS_PM_WOL_PATTERN structure is used in the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-pm-add-wol-pattern">OID_PM_ADD_WOL_PATTERN</a> and
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-pm-wol-pattern-list">OID_PM_WOL_PATTERN_LIST</a> OID
requests.</p>

<p>An upper-layer driver can specify a generic WOL pattern with the
<strong>WoLBitMapPattern</strong> member. A bitmap pattern is specified as a sequence of
bytes and a mask bitmap. Each bit in the mask corresponds to a byte in the pattern, and specifies whether
the corresponding byte in the incoming packet should be matched against the corresponding byte in the
pattern. If all the bytes compared by the network adapter match, the packet is a match and the network adapter should generate a
wake-up event.</p>

<p>An upper-layer driver can specify a zero-filled, or
<em>unspecified</em>, IPv4 address and TCP port values in the
<strong>IPv4TcpSynParameters</strong> member structure. If the NDIS_PM_WOL_IPV4_DEST_ADDR_WILDCARD_ENABLED flag is
set in the
**EnabledWoLPacketPatterns** member of the <a href="ndis_pm_parameters" title="typedef struct _NDIS_PM_PARAMETERS {&#10;  NDIS_OBJECT_HEADER Header;&#10;  ULONG              EnabledWoLPacketPatterns;&#10;  ULONG              EnabledProtocolOffloads;&#10;  ULONG              WakeUpFlags;&#10;  ULONG              MediaSpecificWakeUpEvents;&#10;} NDIS_PM_PARAMETERS, *PNDIS_PM_PARAMETERS;">NDIS_PM_PARAMETERS</a>, the network adapter must use the unspecified address
or port value to match any source or destination IPv4 address or TCP port value in the IPv4 TCP SYN
packet.</p>

<p>Similarly, an upper layer driver can specify an unspecified
IPv6 address and TCP port values in the
<strong>IPv6TcpSynParameters</strong> member structure. If the NDIS_PM_WOL_IPV6_DEST_ADDR_WILDCARD_ENABLED flag is
set in the
**EnabledWoLPacketPatterns** member of the <a href="ndis_pm_parameters" title="typedef struct _NDIS_PM_PARAMETERS {&#10;  NDIS_OBJECT_HEADER Header;&#10;  ULONG              EnabledWoLPacketPatterns;&#10;  ULONG              EnabledProtocolOffloads;&#10;  ULONG              WakeUpFlags;&#10;  ULONG              MediaSpecificWakeUpEvents;&#10;} NDIS_PM_PARAMETERS, *PNDIS_PM_PARAMETERS;">NDIS_PM_PARAMETERS</a>, the network adapter must use the unspecified address
or port value to match any source or destination IPv6 address or TCP port value in the IPv4 TCP SYN
packet.</p>

<p>The upper layer driver sets the NDIS_PM_WOL_IPV4_DEST_ADDR_WILDCARD_ENABLED and
NDIS_PM_WOL_IPV6_DEST_ADDR_WILDCARD_ENABLED flags by issuing a set request of the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-pm-parameters">OID_PM_PARAMETERS</a> OID.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/objectheader/ns-objectheader-ndis_object_header">NDIS_OBJECT_HEADER</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_pm_counted_string">NDIS_PM_COUNTED_STRING</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ne-ntddndis-_ndis_pm_wol_packet">NDIS_PM_WOL_PACKET</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-pm-add-wol-pattern">OID_PM_ADD_WOL_PATTERN</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-pm-wol-pattern-list">OID_PM_WOL_PATTERN_LIST</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_pm_wol_pattern">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddndis/ns-ntddndis-_ndis_pm_wol_pattern.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
