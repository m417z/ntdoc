<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="D3D12DDI_VIDEO_DECODE_TIER_0020 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>D3D12DDI_VIDEO_DECODE_TIER_0020 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            D3D12DDI_VIDEO_DECODE_TIER_0020 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3d12umddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef enum D3D12DDI_VIDEO_DECODE_TIER_0020 {
  D3D12DDI_VIDEO_DECODE_TIER_0020_NOT_SUPPORTED,
  D3D12DDI_VIDEO_DECODE_TIER_0020_1,
  D3D12DDI_VIDEO_DECODE_TIER_0020_2,
  D3D12DDI_VIDEO_DECODE_TIER_0020_3
} ;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d12umddi/ne-d3d12umddi-d3d12ddi_video_decode_tier_0020">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/d3d12ddi_video_decode_tier_0020.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ne-d3d12umddi-d3d12ddi_video_decode_tier_0020)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="d3d12ddi_video_decode_tier_0020-enumeration">D3D12DDI_VIDEO_DECODE_TIER_0020 enumeration</h1>

<h2 id="description">Description</h2>

<p>Specifies the video decode tier. Decode video tiers define a set of hardware capabilities. The higher the tier, the more capable the hardware.</p>

<h2 id="constants">Constants</h2>

<h3 id="d3d12ddi_video_decode_tier_0020_not_supported"><code>D3D12DDI_VIDEO_DECODE_TIER_0020_NOT_SUPPORTED</code></h3>

<p>The decode profile is not supported.</p>

<h3 id="d3d12ddi_video_decode_tier_0020_1"><code>D3D12DDI_VIDEO_DECODE_TIER_0020_1</code></h3>

<p>Video decode tier 1. In video decode tier 1, hardware requires decode output textures and reference textures for decoding a stream to be physically contiguous when video operations reference them.</p>

<p>The reference resources are allocated by the application as a D3D12 texture array. The driver does not receive explicit hints that the allocation targets video scenarios and may initially allocate non-physically contiguous memory. Drivers are expected to use a new <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/test/hlk/testref/51f5ec4f-bfcb-41c2-bb01-fef1403c93e4">Update Allocation Properties</a> feature provided by the memory manager, to schedule a conversion to physically contiguous upon submission of the video work that actually requires it to be physically contiguous.</p>

<p>Hardware characteristics that place hardware in Tier 1:</p>

<ul>
<li><p>Decode hardware requires physically contiguous memory for decode output and references. Input buffers with the compressed bitstream may also require physically contiguous.</p></li>
<li><p>Decode hardware may have a special tiling format or other memory layout definition that is incompatible with other engines or video operations.</p></li>
</ul>

<p>Compressed input buffer requirements:</p>

<ul>
<li><p>All slices for a given frame must be placed in order and contiguous (no gaps between slices).</p></li>
<li><p>Drivers must not perform additional copies of the bitstream data.</p></li>
<li><p>The first slice must begin on a 128-byte boundary.</p></li>
<li><p>Hardware must support decoding from a buffer allocated from D3D12DDI_MEMORY_POOL_L0 (always system memory).</p></li>
<li><p>Hardware must support decoding from D3D12DDI_MEMORY_POOL_L1 (default pool) with D3D12DDI_CPU_PAGE_PROPERTY_NOT_AVAILABLE.</p></li>
</ul>

<h3 id="d3d12ddi_video_decode_tier_0020_2"><code>D3D12DDI_VIDEO_DECODE_TIER_0020_2</code></h3>

<p>Video decode tier 2. Decode tier 2 allows the caller to allocate reference and output textures as separate 2D texture resources. The application is no longer required to allocate texture arrays, but this must be supported.</p>

<p>Decode Tier 2 does not have physically contiguous requirements. Hardware may have contiguous VA (video decoding acceleration) requirements in this tier, and applications are required to create a texture array to support this.</p>

<p>To enable Tier 2, reserved resources, also called Tiled or Sparse resources, must be supported for the reference and output formats that are supported by the driver. This can be done in two ways:</p>

<ul>
<li><p>If hardware has support for per-process GPU VA and has a tile pattern that supports the tile shape requirements of reserved resources, the pre-existing D3D12 tiled resource mechanism can be used.</p></li>
<li><p>If hardware has support for per-process GPU VA, but the tile pattern does not conform to the tile shape requirements of reserved resources, and hardware can support a tile mapping that maps and unmaps tiles for an entire subresource, for each plane of a planar resource that is a separate subresource in D3D12, the mechanism requires that they can be tile mapped and tile unmapped independently. Note that this mechanism is in development, but will obfuscate tile shape at the API.</p></li>
</ul>

<p>Hardware characteristics that place hardware in Tier 2:</p>

<ul>
<li><p>Does not require physically contiguous memory.</p></li>
<li><p>Hardware has a contiguous VA requirement.</p></li>
<li><p>Decode hardware may have a special tiling format or other memory layout definition that is incompatible with other engines or video operations.</p></li>
</ul>

<p>The compressed input buffer requirements are the same as Tier 1.</p>

<h3 id="d3d12ddi_video_decode_tier_0020_3"><code>D3D12DDI_VIDEO_DECODE_TIER_0020_3</code></h3>

<p>Video decode tier 3. This tier is supported started in WDDM 2.3.</p>

<p>Decode Tier 3 allows the caller to allocate reference and output textures as standard 2D texture resources. The application is no longer required to allocate texture arrays, but this must be supported.</p>

<p>Decode Tier 3 does not require physically contiguous allocations. Hardware must no longer require the D3D12DDI_RESOURCE_FLAG_VIDEO_DECODE_REFERENCE_ONLY, but must still support it. When queried, the D3D12DDI_RESOURCE_FLAG_VIDEO_DECODE_REFERENCE_ONLY member of the <a href="d3d12ddi_video_decode_support_data_0020" title="typedef struct D3D12DDI_VIDEO_DECODE_SUPPORT_DATA_0020 {&#10;  UINT                                           NodeIndex;&#10;  D3D12DDI_VIDEO_DECODE_CONFIGURATION_0020       Configuration;&#10;  UINT                                           Width;&#10;  UINT                                           Height;&#10;  DXGI_FORMAT                                    DecodeFormat;&#10;  DXGI_RATIONAL                                  FrameRate;&#10;  UINT                                           BitRate;&#10;  D3D12DDI_VIDEO_DECODE_SUPPORT_FLAGS_0020       SupportFlags;&#10;  D3D12DDI_VIDEO_DECODE_CONFIGURATION_FLAGS_0020 ConfigurationFlags;&#10;  D3D12DDI_VIDEO_DECODE_TIER_0020                DecodeTier;&#10;} D3D12DDI_VIDEO_DECODE_SUPPORT_DATA_0020;">D3D12DDI_VIDEO_DECODE_SUPPORT_DATA_0020</a> structure must be set to FALSE.</p>

<p>To enable Tier 3, reserved resources (also called Tiled or Sparse resources) must be supported for the reference and output formats supported by the driver. This can happen in two ways:</p>

<ul>
<li><p>If hardware has support for per-process GPU VA and has a tile pattern that supports the tile shape requirements of reserved resources, the pre-existing D3D12 tiled resource mechanism can be used.</p></li>
<li><p>If hardware has support for per-process GPU VA, but the tile pattern does not conform to the tile shape requirements of reserved resources, and hardware can support a tile mapping that maps and unmaps tiles for an entire subresource, for each plane of a planar resource that is a separate subresource in D3D12, the mechanism requires that they can be tile mapped and tile unmapped independently. Note that this mechanism is in development, but will obfuscate tile shape at the API.</p></li>
</ul>

<p>The compressed input buffer requirements are the same as Tier 1.</p>

<h2 id="remarks">Remarks</h2>

<p>If decode hardware requires a unique tiling format that is not supported for operations on other engines or different video operations, the decoder may set D3D12DDI_RESOURCE_FLAG_VIDEO_DECODE_REFERENCE_ONLY in the <a href="d3d12ddi_video_decode_support_data_0020" title="typedef struct D3D12DDI_VIDEO_DECODE_SUPPORT_DATA_0020 {&#10;  UINT                                           NodeIndex;&#10;  D3D12DDI_VIDEO_DECODE_CONFIGURATION_0020       Configuration;&#10;  UINT                                           Width;&#10;  UINT                                           Height;&#10;  DXGI_FORMAT                                    DecodeFormat;&#10;  DXGI_RATIONAL                                  FrameRate;&#10;  UINT                                           BitRate;&#10;  D3D12DDI_VIDEO_DECODE_SUPPORT_FLAGS_0020       SupportFlags;&#10;  D3D12DDI_VIDEO_DECODE_CONFIGURATION_FLAGS_0020 ConfigurationFlags;&#10;  D3D12DDI_VIDEO_DECODE_TIER_0020                DecodeTier;&#10;} D3D12DDI_VIDEO_DECODE_SUPPORT_DATA_0020;">D3D12DDI_VIDEO_DECODE_SUPPORT_DATA_0020</a> structure when querying for profile support. This flag indicates that the application must allocate references with the D3D12DDI_RESOURCE_FLAG_VIDEO_DECODE_REFERENCE_ONLY flag. If the output is needed as a future reference frame, the output frame passed to PFND3D12DDI_VIDEO_DECODE_FRAME is a D3D12 resource that can be consumed by other portions of the pipeline, and must not have the D3D12DDI_RESOURCE_FLAG_VIDEO_DECODE_REFERENCE_ONLY flag.</p>

<p>The following table shows the different capabilities for each tier:</p>

<table>
<thead>
<tr>
  <th>Capability</th>
  <th>Tier 1</th>
  <th>Tier 2</th>
  <th>Tier 3</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Supports individually allocated reference frames and output.</td>
  <td>No</td>
  <td>No</td>
  <td>Required</td>
</tr>
<tr>
  <td>Supports references and allocated as a texture array.</td>
  <td>Required</td>
  <td>Required</td>
  <td>Required</td>
</tr>
<tr>
  <td>May optionally require the REFERENCE_ONLY resource flag. Note that all tiers are required to work with flag present, even when its not required.</td>
  <td>Optional</td>
  <td>Optional</td>
  <td>No</td>
</tr>
<tr>
  <td>Support for references allocated with REFERENCE_ONLY, even when caps do not require it.</td>
  <td>Required</td>
  <td>Required</td>
  <td>Required</td>
</tr>
<tr>
  <td>Supports Tiled/Sparse resources for references, input and output.</td>
  <td>No</td>
  <td>Required</td>
  <td>Required</td>
</tr>
<tr>
  <td>Compressed bit stream input buffers may be allocated as L0 (main system memory) or L1 (for dGPU, video memory).</td>
  <td>Required</td>
  <td>Required</td>
  <td>Required</td>
</tr>
<tr>
  <td>Requires compressed bitstream data for slices to be located in a single buffer allocation with no gaps between slices.</td>
  <td>Required</td>
  <td>Required</td>
  <td>Required</td>
</tr>
<tr>
  <td>Offset to first slice in the compressed input buffer must be 256 byte aligned.</td>
  <td>Required</td>
  <td>Required</td>
  <td>Required</td>
</tr>
<tr>
  <td>Drivers must not perform additional copies of the compressed bitstream data.</td>
  <td>Required</td>
  <td>Required</td>
  <td>Required</td>
</tr>
</tbody>
</table>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d12umddi/ne-d3d12umddi-d3d12ddi_video_decode_tier_0020">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3d12umddi/ne-d3d12umddi-d3d12ddi_video_decode_tier_0020.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
