<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="BDCB_IMAGE_INFORMATION - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>BDCB_IMAGE_INFORMATION - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            BDCB_IMAGE_INFORMATION - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _BDCB_IMAGE_INFORMATION {
  <a href="bdcb_classification" title="typedef enum _BDCB_CLASSIFICATION {&#10;  BdCbClassificationUnknownImage,&#10;  BdCbClassificationKnownGoodImage,&#10;  BdCbClassificationKnownBadImage,&#10;  BdCbClassificationKnownBadImageBootCritical,&#10;  BdCbClassificationEnd&#10;} BDCB_CLASSIFICATION, *PBDCB_CLASSIFICATION;">BDCB_CLASSIFICATION</a> Classification;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>               ImageFlags;
  <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a>      ImageName;
  <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a>      RegistryPath;
  <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a>      CertificatePublisher;
  <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a>      CertificateIssuer;
  PVOID               ImageHash;
  PVOID               CertificateThumbprint;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>               ImageHashAlgorithm;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>               ThumbprintHashAlgorithm;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>               ImageHashLength;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>               CertificateThumbprintLength;
} BDCB_IMAGE_INFORMATION, *PBDCB_IMAGE_INFORMATION;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddk/ns-ntddk-_bdcb_image_information">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/bdcb_image_information.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddk-_bdcb_image_information)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>_BDCB_IMAGE_INFORMATION structure</h1>

<h2>Description</h2>

<p>The <strong>BDCB_IMAGE_INFORMATION</strong> structure describes information about a boot-start driver that is about to
be initialized, provided by Windows to a boot-start driver's
<a href="boot_driver_callback_function" title="BOOT_DRIVER_CALLBACK_FUNCTION BootDriverCallbackFunction;&#10;&#10;VOID BootDriverCallbackFunction(&#10;  PVOID CallbackContext,&#10;  BDCB_CALLBACK_TYPE Classification,&#10;  PBDCB_IMAGE_INFORMATION ImageInformation&#10;)&#10;{...}">BOOT_DRIVER_CALLBACK_FUNCTION</a> routine.</p>

<h2>Members</h2>

<h3><code>Classification</code></h3>

<p>An enumeration of type <strong><a href="bdcb_classification" title="typedef enum _BDCB_CLASSIFICATION {&#10;  BdCbClassificationUnknownImage,&#10;  BdCbClassificationKnownGoodImage,&#10;  BdCbClassificationKnownBadImage,&#10;  BdCbClassificationKnownBadImageBootCritical,&#10;  BdCbClassificationEnd&#10;} BDCB_CLASSIFICATION, *PBDCB_CLASSIFICATION;">BDCB_CLASSIFICATION</a></strong> that the ELAM driver sets to specify the classification of the boot start image.</p>

<h3><code>ImageFlags</code></h3>

<p>Bit flags that describe the image. The following values are defined.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Bit 0</td>
  <td>The boot start image is a dependent DLL.</td>
</tr>
<tr>
  <td>Bit 1</td>
  <td>The boot start image failed code integrity but load was allowed because of boot policy (code integrity not required on the platform, or code integrity disabled because of boot setting, debugging, or both). The symbolic name for bit 1 is <code>BDCB_IMAGEFLAGS_FAILED_CODE_INTEGRITY.</code></td>
</tr>
<tr>
  <td>Bits 2-31</td>
  <td>Do not use. Reserved.</td>
</tr>
</tbody>
</table>

<h3><code>ImageName</code></h3>

<p>The name of the boot-start driver's binary image.</p>

<h3><code>RegistryPath</code></h3>

<p>The path in the registry where the boot-start driver is registered.</p>

<h3><code>CertificatePublisher</code></h3>

<p>The publisher of the image's certificate. If the image is not signed, the string is empty ("").</p>

<h3><code>CertificateIssuer</code></h3>

<p>The issuer of the image's certificate. If the image is not signed, the string is empty ("").</p>

<h3><code>ImageHash</code></h3>

<p>The Authenticode hash of the image, which can be calculated by using SignTool.exe (Sign Tool).</p>

<h3><code>CertificateThumbprint</code></h3>

<p>The hash of the certificate of the signer to be signed. Run <strong>certutil â€“dump x,cer</strong> to view this value as "Signature Hash".</p>

<h3><code>ImageHashAlgorithm</code></h3>

<p>The algorithm of the image hash. The following values are listed for reference.</p>

<table>
<thead>
<tr>
  <th>Value</th>
</tr>
</thead>
<tbody>
<tr>
  <td>ALG_CLASS_HASH</td>
</tr>
<tr>
  <td>ALG_CLASS_ANY</td>
</tr>
<tr>
  <td>ALG_SID_MD5</td>
</tr>
<tr>
  <td>ALG_SID_SHA1</td>
</tr>
<tr>
  <td>ALG_SID_SHA_256</td>
</tr>
<tr>
  <td>ALG_SID_SHA_384</td>
</tr>
<tr>
  <td>ALG_SID_SHA_512</td>
</tr>
<tr>
  <td>CALG_MD5</td>
</tr>
<tr>
  <td>CALG_SHA1</td>
</tr>
<tr>
  <td>CALG_SHA_256</td>
</tr>
<tr>
  <td>CALG_SHA_384</td>
</tr>
<tr>
  <td>CALG_SHA_512</td>
</tr>
</tbody>
</table>

<h3><code>ThumbprintHashAlgorithm</code></h3>

<p>The algorithm of the certificate thumbprint. This member should be ignored if <strong>CertificateThumbprint</strong> is NULL.</p>

<h3><code>ImageHashLength</code></h3>

<p>The length of data pointed to by the <strong>ImageHash</strong> member.</p>

<h3><code>CertificateThumbprintLength</code></h3>

<p>The length of data pointed to by the <strong>CertificateThumbprint</strong> member.</p>

<h2>See also</h2>

<p><a href="bdcb_classification" title="typedef enum _BDCB_CLASSIFICATION {&#10;  BdCbClassificationUnknownImage,&#10;  BdCbClassificationKnownGoodImage,&#10;  BdCbClassificationKnownBadImage,&#10;  BdCbClassificationKnownBadImageBootCritical,&#10;  BdCbClassificationEnd&#10;} BDCB_CLASSIFICATION, *PBDCB_CLASSIFICATION;">BDCB_CLASSIFICATION</a></p>

<p><strong><a href="boot_driver_callback_function" title="BOOT_DRIVER_CALLBACK_FUNCTION BootDriverCallbackFunction;&#10;&#10;VOID BootDriverCallbackFunction(&#10;  PVOID CallbackContext,&#10;  BDCB_CALLBACK_TYPE Classification,&#10;  PBDCB_IMAGE_INFORMATION ImageInformation&#10;)&#10;{...}">BOOT_DRIVER_CALLBACK_FUNCTION</a></strong></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/seccrypto/alg-id"><strong>ALG_ID</strong></a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddk/ns-ntddk-_bdcb_image_information">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddk/ns-ntddk-_bdcb_image_information.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
