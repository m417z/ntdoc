<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="EVT_IDD_CX_MONITOR_ASSIGN_SWAPCHAIN - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>EVT_IDD_CX_MONITOR_ASSIGN_SWAPCHAIN - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            EVT_IDD_CX_MONITOR_ASSIGN_SWAPCHAIN - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// iddcx.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">EVT_IDD_CX_MONITOR_ASSIGN_SWAPCHAIN EvtIddCxMonitorAssignSwapchain;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> EvtIddCxMonitorAssignSwapchain(
  [in] IDDCX_MONITOR MonitorObject,
  [in] const <a href="idarg_in_setswapchain" title="struct IDARG_IN_SETSWAPCHAIN {&#10;  [in] IDDCX_SWAPCHAIN hSwapChain;&#10;  [in] HANDLE          hNextSurfaceAvailable;&#10;  [In] LUID            RenderAdapterLuid;&#10;};">IDARG_IN_SETSWAPCHAIN</a> *pInArgs
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/iddcx/nc-iddcx-evt_idd_cx_monitor_assign_swapchain">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/evt_idd_cx_monitor_assign_swapchain.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-iddcx-evt_idd_cx_monitor_assign_swapchain)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>EVT_IDD_CX_MONITOR_ASSIGN_SWAPCHAIN callback function</h1>

<h2>Description</h2>

<p><strong>EVT_IDD_CX_MONITOR_ASSIGN_SWAPCHAIN</strong> is called by the OS to inform the indirect display driver (IDD) of a mode change for monitors on the adapter.</p>

<h2>Parameters</h2>

<h3><code>MonitorObject</code> [in]</h3>

<p>An opaque, driver-created IDDCX_MONITOR handle used by the OS to identify the monitor that has been affected by the mode change.</p>

<h3><code>pInArgs</code> [in]</h3>

<p>Pointer to an <strong><a href="idarg_in_setswapchain" title="struct IDARG_IN_SETSWAPCHAIN {&#10;  [in] IDDCX_SWAPCHAIN hSwapChain;&#10;  [in] HANDLE          hNextSurfaceAvailable;&#10;  [In] LUID            RenderAdapterLuid;&#10;};">IDARG_IN_SETSWAPCHAIN</a></strong> structure containing information for the driver to use to set the indirect swapchain.</p>

<h2>Return value</h2>

<p>(<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>) If the operation is successful, the callback function must return <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a>, or another status value for which <a href="nt_success" title="#define NT_SUCCESS(Status) (((NTSTATUS)(Status)) &gt;= 0)">NT_SUCCESS</a>(status) equals TRUE. If an error occurs, the IDD should return <strong>STATUS_GRAPHICS_INDIRECT_DISPLAY_ABANDON_SWAPCHAIN</strong> if there is a good chance that the error will not occur again. Otherwise, it should return an appropriate <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/ntstatus-values">NTSTATUS</a> error code. See Remarks.</p>

<h2>Remarks</h2>

<p>The OS calls <strong>EvtIddCxMonitorAssignSwapChain</strong> so that the IDD can setup its frame processing mechanism. For example, an IDD might create a new thread to initialize D3D devices and then loop on processing frames (see the <a rel="noopener" target="_blank" href="https://github.com/microsoft/Windows-driver-samples/tree/master/video/IndirectDisplay">ID driver sample</a>).</p>

<p>If <strong>EvtIddCxMonitorAssignSwapChain</strong> returns success, the IDD then owns the <strong><a href="idarg_in_setswapchain" title="struct IDARG_IN_SETSWAPCHAIN {&#10;  [in] IDDCX_SWAPCHAIN hSwapChain;&#10;  [in] HANDLE          hNextSurfaceAvailable;&#10;  [In] LUID            RenderAdapterLuid;&#10;};">IDARG_IN_SETSWAPCHAIN</a>.hSwapChain</strong> object and is responsible for calling <strong><a href="wdfobjectdelete" title="VOID WdfObjectDelete(&#10;  [in] WDFOBJECT Object&#10;);">WdfObjectDelete</a></strong> to release the swapchain object when it stops processing frames. The swapchain processing can stop processing frames when <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/iddcx/nc-iddcx-evt_idd_cx_monitor_unassign_swapchain"><strong>EvtIddCxMonitorUnassignSwapChain</strong></a> is called or when an error occurs in the frame processing loop after success is returned to <strong>EvtIddCxMonitorAssignSwapChain</strong>. This applies to both console and remote ID adapters and all IddCx versions.</p>

<p>Starting with Windows 10, version 1903, to reduce user impact (for example, time spent waiting for IddCx to bugcheck the driver), IddCx will immediately
bugcheck the driver if <strong>EvtIddCxMonitorAssignSwapChain</strong> reports an error code other than <strong>STATUS_GRAPHICS_INDIRECT_DISPLAY_ABANDON_SWAPCHAIN</strong>.</p>

<p>If the driver returns <strong>STATUS_GRAPHICS_INDIRECT_DISPLAY_ABANDON_SWAPCHAIN</strong>, IddCx will inform the desktop compositor. A new swapchain needs to be created, so the OS will again call <strong>EvtIddCxMonitorAssignSwapChain</strong>. An ID driver should use this return code only if there is a good chance that the error that just occurred will not occur again. That is, an ID driver should not leave users with an unusable desktop because it returned the error code yet did nothing to ensure the same failure will not occur again. For example, if a driver encounters an error while creating the D3D device on the render adapter it could call <strong><a href="iddcxadaptersetrenderadapter" title="VOID IddCxAdapterSetRenderAdapter(&#10;  [in] IDDCX_ADAPTER                          AdapterObject,&#10;  [in] const IDARG_IN_ADAPTERSETRENDERADAPTER *pInArgs&#10;);">IddCxAdapterSetRenderAdapter</a></strong> to change to another adapter (perhaps another GPU or WARP) and then return <strong>STATUS_GRAPHICS_INDIRECT_DISPLAY_ABANDON_SWAPCHAIN</strong>. The OS will create a new swapchain on the new render adapter and hopefully avoid the error. Although this error code is defined starting with Windows 10 version 1903, an ID driver can return this error code on previous OS releases resulting in no effect.</p>

<p>The resolution of the surfaces in the swapchain will always be the same resolution as the target mode set.</p>

<p>The format of the surfaces will be one of the formats supported by the driver, but the format of each acquired buffer can change between the formats supported from frame to frame. The driver should check the format of each buffer acquired.</p>

<h2>See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/iddcx/nc-iddcx-evt_idd_cx_monitor_unassign_swapchain"><strong>EvtIddCxMonitorUnassignSwapChain</strong></a></p>

<p><strong><a href="idarg_in_setswapchain" title="struct IDARG_IN_SETSWAPCHAIN {&#10;  [in] IDDCX_SWAPCHAIN hSwapChain;&#10;  [in] HANDLE          hNextSurfaceAvailable;&#10;  [In] LUID            RenderAdapterLuid;&#10;};">IDARG_IN_SETSWAPCHAIN</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/iddcx/nc-iddcx-evt_idd_cx_monitor_assign_swapchain">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/iddcx/nc-iddcx-evt_idd_cx_monitor_assign_swapchain.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
