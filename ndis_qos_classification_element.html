<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NDIS_QOS_CLASSIFICATION_ELEMENT - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NDIS_QOS_CLASSIFICATION_ELEMENT - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NDIS_QOS_CLASSIFICATION_ELEMENT - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _NDIS_QOS_CLASSIFICATION_ELEMENT {
  <a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a> Header;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              Flags;
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>             ConditionSelector;
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>             ConditionField;
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>             ActionSelector;
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>             ActionField;
} NDIS_QOS_CLASSIFICATION_ELEMENT, *PNDIS_QOS_CLASSIFICATION_ELEMENT;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_qos_classification_element">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndis_qos_classification_element.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddndis-_ndis_qos_classification_element)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>_NDIS_QOS_CLASSIFICATION_ELEMENT structure</h1>
<h2>Description</h2>
<p>The <strong>NDIS_QOS_CLASSIFICATION_ELEMENT</strong> structure specifies an NDIS Quality of Service (QoS) traffic classification for a network adapter that supports the IEEE 802.1 Data Center Bridging (DCB) interface.</p>
<p>Each traffic classification specifies the following:</p>
<ul>
<li>
<p>A classification <em>condition</em> that is based on a data pattern within the egress packet data.</p>
<p>Starting with NDIS 6.30, classification conditions are based on a 16-bit value, such as a UDP or TCP destination port or a media access control (MAC) EtherType.</p>
</li>
<li>
<p>A classification <em>action</em> that defines the traffic class to be used to handle the egress packet.</p>
<p>Starting with NDIS 6.30, classification actions specify an 802.1p priority level.</p>
</li>
</ul>
<p>For example, a traffic classification could specify that all egress packets for destination TCP port number 3260 (<em>condition</em>) are assigned an 802.1p priority level 3 (<em>action</em>).</p>
<h2>Members</h2>
<h3><code>Header</code></h3>
<p>The type, revision, and size of the <strong>NDIS_QOS_CLASSIFICATION_ELEMENT</strong> structure. This member is formatted as an <a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a> structure.</p>
<p>The miniport driver must set the <strong>Type</strong> member of <strong>Header</strong> to NDIS_OBJECT_TYPE_QOS_CLASSIFICATION_ELEMENT. To specify the version of the <strong>NDIS_QOS_CLASSIFICATION_ELEMENT</strong> structure, the driver must set the <strong>Revision</strong> member of <strong>Header</strong> to the following value:</p>
<h4>NDIS_QOS_CLASSIFICATION_ELEMENT_REVISION_1</h4>
<p>Original version for NDIS 6.30.</p>
<p>Set the <strong>Size</strong> member to NDIS_SIZEOF_QOS_CLASSIFICATION_ELEMENT_REVISION_1.</p>
<h3><code>Flags</code></h3>
<p>A <strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></strong> value that contains a bitwise OR of flags that specify the state of the NDIS QoS traffic classifications that a miniport driver supports. The following flags are defined:</p>
<h4>NDIS_QOS_CLASSIFICATION_ENFORCED_BY_MINIPORT</h4>
<p>If this flag is set, the miniport driver accepts the traffic classification parameters that are specified in the <strong>NDIS_QOS_CLASSIFICATION_ELEMENT</strong> structure. If the driver accepts the parameters, it must configure the network adapter to perform the traffic classification as specified by the parameters.</p>
<p><strong>Note</strong> This flag is set only in the <strong>NDIS_QOS_CLASSIFICATION_ELEMENT</strong> structures that the miniport driver returns to NDIS from an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-qos-parameters">OID_QOS_PARAMETERS</a> OID method request.</p>
<h3><code>ConditionSelector</code></h3>
<p>A <strong><a href="ushort" title="typedef unsigned short USHORT;">USHORT</a></strong> value that specifies the type of the data pattern that is contained in the <strong>ConditionField</strong> member. For example, the data pattern type could specify a destination UDP port whose value is specified by the <strong>ConditionField</strong> member.</p>
<p>For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/">Guidelines for Setting the ConditionSelector and ConditionField Members</a>.</p>
<h3><code>ConditionField</code></h3>
<p>A <strong><a href="ushort" title="typedef unsigned short USHORT;">USHORT</a></strong> value that contains the data pattern whose type is specified by the <strong>ConditionSelector</strong> member.</p>
<p>For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/">Guidelines for Setting the ConditionSelector and ConditionField Members</a>.</p>
<h3><code>ActionSelector</code></h3>
<p>A <strong><a href="ushort" title="typedef unsigned short USHORT;">USHORT</a></strong> value that specifies the type of action data that is contained in the <strong>ActionField</strong> member. Starting with NDIS 6.30, the action data type specifies an 802.1p priority level whose value is specified by the <strong>ConditionField</strong> member.</p>
<p>For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/">Guidelines for Setting the ActionSelector and ActionField Members</a>.</p>
<h3><code>ActionField</code></h3>
<p>A <strong><a href="ushort" title="typedef unsigned short USHORT;">USHORT</a></strong> value that contains an action value whose type is specified by the <strong>ActionSelector</strong> member.</p>
<p>For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/">Guidelines for Setting the ActionSelector and ActionField Members</a>.</p>
<h2>Remarks</h2>
<p>A traffic classification specifies a <em>condition</em> and an <em>action</em> that the network adapter applies to egress packet data. When the adapter inspects the egress packet data and finds a matching classification condition, it applies the corresponding action to the egress packet.</p>
<p><strong>Note</strong> Starting with NDIS 6.30, all actions are based on 802.1p priority levels. However, after the network adapter determines the priority level, it must use the egress policies for the NDIS QoS traffic class that is associated with the priority level. The association of priority levels to traffic classes is specified in the <a href="ndis_qos_parameters" title="typedef struct _NDIS_QOS_PARAMETERS {&#10;  NDIS_OBJECT_HEADER Header;&#10;  ULONG              Flags;&#10;  ULONG              NumTrafficClasses;&#10;  UCHAR              PriorityAssignmentTable[NDIS_QOS_MAXIMUM_PRIORITIES];&#10;  UCHAR              TcBandwidthAssignmentTable[NDIS_QOS_MAXIMUM_TRAFFIC_CLASSES];&#10;  UCHAR              TsaAssignmentTable[NDIS_QOS_MAXIMUM_TRAFFIC_CLASSES];&#10;  ULONG              PfcEnable;&#10;  ULONG              NumClassificationElements;&#10;  ULONG              ClassificationElementSize;&#10;  ULONG              FirstClassificationElementOffset;&#10;} NDIS_QOS_PARAMETERS, *PNDIS_QOS_PARAMETERS;">NDIS_QOS_PARAMETERS</a> structure.</p>
<p>The <strong>NDIS_QOS_CLASSIFICATION_ELEMENT</strong> structure specifies each traffic classification element within the array that is specified by the <a href="ndis_qos_parameters" title="typedef struct _NDIS_QOS_PARAMETERS {&#10;  NDIS_OBJECT_HEADER Header;&#10;  ULONG              Flags;&#10;  ULONG              NumTrafficClasses;&#10;  UCHAR              PriorityAssignmentTable[NDIS_QOS_MAXIMUM_PRIORITIES];&#10;  UCHAR              TcBandwidthAssignmentTable[NDIS_QOS_MAXIMUM_TRAFFIC_CLASSES];&#10;  UCHAR              TsaAssignmentTable[NDIS_QOS_MAXIMUM_TRAFFIC_CLASSES];&#10;  ULONG              PfcEnable;&#10;  ULONG              NumClassificationElements;&#10;  ULONG              ClassificationElementSize;&#10;  ULONG              FirstClassificationElementOffset;&#10;} NDIS_QOS_PARAMETERS, *PNDIS_QOS_PARAMETERS;">NDIS_QOS_PARAMETERS</a> structure. This structure is used in the following OID requests:</p>
<ul>
<li>OID query requests of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-qos-operational-parameters">OID_QOS_OPERATIONAL_PARAMETERS</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-qos-remote-parameters">OID_QOS_REMOTE_PARAMETERS</a>.</li>
<li>OID method requests of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-qos-parameters">OID_QOS_PARAMETERS</a>.</li>
</ul>
<p>The miniport driver also returns an <a href="ndis_qos_parameters" title="typedef struct _NDIS_QOS_PARAMETERS {&#10;  NDIS_OBJECT_HEADER Header;&#10;  ULONG              Flags;&#10;  ULONG              NumTrafficClasses;&#10;  UCHAR              PriorityAssignmentTable[NDIS_QOS_MAXIMUM_PRIORITIES];&#10;  UCHAR              TcBandwidthAssignmentTable[NDIS_QOS_MAXIMUM_TRAFFIC_CLASSES];&#10;  UCHAR              TsaAssignmentTable[NDIS_QOS_MAXIMUM_TRAFFIC_CLASSES];&#10;  ULONG              PfcEnable;&#10;  ULONG              NumClassificationElements;&#10;  ULONG              ClassificationElementSize;&#10;  ULONG              FirstClassificationElementOffset;&#10;} NDIS_QOS_PARAMETERS, *PNDIS_QOS_PARAMETERS;">NDIS_QOS_PARAMETERS</a> structure that contains an array of <strong>NDIS_QOS_CLASSIFICATION_ELEMENT</strong> structures in the following NDIS status indications:</p>
<ul>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-qos-operational-parameters-change">NDIS_STATUS_QOS_OPERATIONAL_PARAMETERS_CHANGE</a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-qos-remote-parameters-change">NDIS_STATUS_QOS_REMOTE_PARAMETERS_CHANGE</a></li>
</ul>
<p>For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-qos-traffic-classifications">NDIS QoS Traffic Classifications</a>.</p>
<h3>Guidelines for Setting the ConditionSelector and ConditionField Members</h3>
<p>The following table defines the range of values for the <strong>ConditionSelector</strong> and <strong>ConditionField</strong> members.</p>
<table>
<thead>
<tr>
<th>ConditionSelector value</th>
<th>ConditionField value</th>
</tr>
</thead>
<tbody>
<tr>
<td>NDIS_QOS_CONDITION_RESERVED</td>
<td>The <strong>ConditionField</strong> member must be set to zero.<br><br><strong>Note</strong> This condition is reserved for future use.</td>
</tr>
<tr>
<td>NDIS_QOS_CONDITION_DEFAULT</td>
<td>The <strong>ConditionField</strong> member must be set to zero.</td>
</tr>
<tr>
<td>NDIS_QOS_CONDITION_TCP_PORT</td>
<td>The <strong>ConditionField</strong> member contains a 16-bit destination TCP port value.</td>
</tr>
<tr>
<td>NDIS_QOS_CONDITION_UDP_PORT</td>
<td>The <strong>ConditionField</strong> member contains a 16-bit destination UDP port value.</td>
</tr>
<tr>
<td>NDIS_QOS_CONDITION_TCP_OR_UDP_PORT</td>
<td>The <strong>ConditionField</strong> member contains a 16-bit destination TCP or UDP port value.</td>
</tr>
<tr>
<td>NDIS_QOS_CONDITION_ETHERTYPE</td>
<td>The <strong>ConditionField</strong> member contains a 16-bit IEEE EtherType value.<br><br><strong>Note</strong> The network adapter needs to determine the frame layout of the packet in order to inspect the EtherType. For example, the location of the EtherType field is different between an Ethernet II and 802.3 frame.</td>
</tr>
<tr>
<td>NDIS_QOS_CONDITION_NETDIRECT_PORT</td>
<td>The <strong>ConditionField</strong> member contains a 16-bit NetworkDirect port value.</td>
</tr>
</tbody>
</table>
<p>If the <strong>ConditionSelector</strong> member contains a value of NDIS_QOS_CONDITION_DEFAULT, the associated classification action must be applied to all egress packets that did not match any other classification conditions. When the DCB component issues an OID method request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-qos-parameters">OID_QOS_PARAMETERS</a>, it may set the <strong>ConditionSelector</strong> to NDIS_QOS_CONDITION_DEFAULT in only the first <strong>NDIS_QOS_CLASSIFICATION_ELEMENT</strong> structure in the <a href="ndis_qos_parameters" title="typedef struct _NDIS_QOS_PARAMETERS {&#10;  NDIS_OBJECT_HEADER Header;&#10;  ULONG              Flags;&#10;  ULONG              NumTrafficClasses;&#10;  UCHAR              PriorityAssignmentTable[NDIS_QOS_MAXIMUM_PRIORITIES];&#10;  UCHAR              TcBandwidthAssignmentTable[NDIS_QOS_MAXIMUM_TRAFFIC_CLASSES];&#10;  UCHAR              TsaAssignmentTable[NDIS_QOS_MAXIMUM_TRAFFIC_CLASSES];&#10;  ULONG              PfcEnable;&#10;  ULONG              NumClassificationElements;&#10;  ULONG              ClassificationElementSize;&#10;  ULONG              FirstClassificationElementOffset;&#10;} NDIS_QOS_PARAMETERS, *PNDIS_QOS_PARAMETERS;">NDIS_QOS_PARAMETERS</a> array.</p>
<p>If the <strong>ConditionSelector</strong> member contains a value of NDIS_QOS_CONDITION_NETDIRECT_PORT, the miniport driver must match the <strong>ConditionField</strong> member against either the source or destination port of a NetworkDirect connection. If the miniport driver accepts a NetDirect connection, the driver must match the <strong>ConditionField</strong> member against the source port of any packet it sends over that connection. If the miniport driver initiates a NetDirect connection, it must match the <strong>ConditionField</strong> member against the destination port of any packet it sends over that connection.</p>
<p>For more information on the DCB component, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-qos-architecture-for-data-center-bridging">NDIS QoS Architecture for Data Center Bridging</a>.</p>
<h3>Guidelines for Setting the ActionSelector and ActionField Members</h3>
<p>The following table defines the range of values for the <strong>ActionSelector</strong> and <strong>ActionField</strong> members.</p>
<table>
<thead>
<tr>
<th>ActionSelector value</th>
<th>ActionField value</th>
</tr>
</thead>
<tbody>
<tr>
<td>NDIS_QOS_ACTION_PRIORITY</td>
<td>The <strong>ActionField</strong> member contains a 3-bit IEEE 802.1p priority level value. For more information on these priority levels, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ieee-802-1p-priority-levels">IEEE 802.1p Priority Levels</a>.</td>
</tr>
</tbody>
</table>
<p>Starting with NDIS 6.30, traffic classification actions define an IEEE 802.1p priority level to which the egress packet is assigned. When the network adapter assigns a priority level to an egress packet, the adapter also applies the parameters for the NDIS QoS traffic class associated with the specified priority level. These parameters determine how the network adapter transmits the packet, and include bandwidth allocation and transmission selection algorithm (TSA).</p>
<p>For more information on NDIS QoS traffic classes, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-qos-traffic-classes">NDIS QoS Traffic Classes</a>.</p>
<h2>See also</h2>
<p><a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a></p>
<p><a href="ndis_qos_parameters" title="typedef struct _NDIS_QOS_PARAMETERS {&#10;  NDIS_OBJECT_HEADER Header;&#10;  ULONG              Flags;&#10;  ULONG              NumTrafficClasses;&#10;  UCHAR              PriorityAssignmentTable[NDIS_QOS_MAXIMUM_PRIORITIES];&#10;  UCHAR              TcBandwidthAssignmentTable[NDIS_QOS_MAXIMUM_TRAFFIC_CLASSES];&#10;  UCHAR              TsaAssignmentTable[NDIS_QOS_MAXIMUM_TRAFFIC_CLASSES];&#10;  ULONG              PfcEnable;&#10;  ULONG              NumClassificationElements;&#10;  ULONG              ClassificationElementSize;&#10;  ULONG              FirstClassificationElementOffset;&#10;} NDIS_QOS_PARAMETERS, *PNDIS_QOS_PARAMETERS;">NDIS_QOS_PARAMETERS</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-qos-operational-parameters-change">NDIS_STATUS_QOS_OPERATIONAL_PARAMETERS_CHANGE</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-qos-remote-parameters-change">NDIS_STATUS_QOS_REMOTE_PARAMETERS_CHANGE</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-qos-operational-parameters">OID_QOS_OPERATIONAL_PARAMETERS</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-qos-parameters">OID_QOS_PARAMETERS</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-qos-remote-parameters">OID_QOS_REMOTE_PARAMETERS</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_qos_classification_element">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddndis/ns-ntddndis-_ndis_qos_classification_element.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
