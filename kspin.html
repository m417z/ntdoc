<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="KSPIN - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>KSPIN - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            KSPIN - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ks.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _KSPIN {
  const <a href="kspin_descriptor_ex" title="typedef struct _KSPIN_DESCRIPTOR_EX {&#10;  const KSPIN_DISPATCH         *Dispatch;&#10;  const KSAUTOMATION_TABLE     *AutomationTable;&#10;  KSPIN_DESCRIPTOR             PinDescriptor;&#10;  ULONG                        Flags;&#10;  ULONG                        InstancesPossible;&#10;  ULONG                        InstancesNecessary;&#10;  const KSALLOCATOR_FRAMING_EX *AllocatorFraming;&#10;  PFNKSINTERSECTHANDLEREX      IntersectHandler;&#10;} KSPIN_DESCRIPTOR_EX, *PKSPIN_DESCRIPTOR_EX;">KSPIN_DESCRIPTOR_EX</a> *Descriptor;
  KSOBJECT_BAG              Bag;
  PVOID                     Context;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                     Id;
  <a href="kspin_communication" title="typedef enum {&#10;  KSPIN_COMMUNICATION_NONE,&#10;  KSPIN_COMMUNICATION_SINK,&#10;  KSPIN_COMMUNICATION_SOURCE,&#10;  KSPIN_COMMUNICATION_BOTH,&#10;  KSPIN_COMMUNICATION_BRIDGE&#10;} KSPIN_COMMUNICATION, *PKSPIN_COMMUNICATION;">KSPIN_COMMUNICATION</a>       Communication;
  BOOLEAN                   ConnectionIsExternal;
  <a href="kspin_interface" title="struct KSPIN_INTERFACE {&#10;  GUID Set;&#10;  ULONG Id;&#10;  ULONG Flags;&#10;};">KSPIN_INTERFACE</a>           ConnectionInterface;
  <a href="kspin_medium" title="struct KSPIN_MEDIUM {&#10;  GUID Set;&#10;  ULONG Id;&#10;  ULONG Flags;&#10;};">KSPIN_MEDIUM</a>              ConnectionMedium;
  <a href="kspriority" title="typedef struct {&#10;  ULONG PriorityClass;&#10;  ULONG PrioritySubClass;&#10;} KSPRIORITY, *PKSPRIORITY;">KSPRIORITY</a>                ConnectionPriority;
  <a href="ksdataformat" title="typedef struct {&#10;  ULONG FormatSize;&#10;  ULONG Flags;&#10;  ULONG SampleSize;&#10;  ULONG Reserved;&#10;  GUID  MajorFormat;&#10;  GUID  SubFormat;&#10;  GUID  Specifier;&#10;} KSDATAFORMAT, *PKSDATAFORMAT, KSDATARANGE, *PKSDATARANGE;">PKSDATAFORMAT</a>             ConnectionFormat;
  <a href="ksmultiple_item" title="typedef struct {&#10;  ULONG Size;&#10;  ULONG Count;&#10;} KSMULTIPLE_ITEM, *PKSMULTIPLE_ITEM;">PKSMULTIPLE_ITEM</a>          AttributeList;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                     StreamHeaderSize;
  <a href="kspin_dataflow" title="typedef enum {&#10;  KSPIN_DATAFLOW_IN,&#10;  KSPIN_DATAFLOW_OUT&#10;} KSPIN_DATAFLOW, *PKSPIN_DATAFLOW;">KSPIN_DATAFLOW</a>            DataFlow;
  <a href="ksstate" title="typedef enum {&#10;  KSSTATE_STOP,&#10;  KSSTATE_ACQUIRE,&#10;  KSSTATE_PAUSE,&#10;  KSSTATE_RUN&#10;} KSSTATE, *PKSSTATE;">KSSTATE</a>                   DeviceState;
  <a href="ksreset" title="typedef enum {&#10;  KSRESET_BEGIN,&#10;  KSRESET_END&#10;} KSRESET;">KSRESET</a>                   ResetState;
  <a href="ksstate" title="typedef enum {&#10;  KSSTATE_STOP,&#10;  KSSTATE_ACQUIRE,&#10;  KSSTATE_PAUSE,&#10;  KSSTATE_RUN&#10;} KSSTATE, *PKSSTATE;">KSSTATE</a>                   ClientState;
} KSPIN, *PKSPIN;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/ns-ks-_kspin">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/kspin.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ks-_kspin)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_kspin-structure">_KSPIN structure</h1>

<h2 id="description">Description</h2>

<p>The KSPIN structure describes an instantiated pin.</p>

<h2 id="members">Members</h2>

<h3 id="descriptor"><code>Descriptor</code></h3>

<p>A pointer to the pin descriptor for this particular pin. See <a href="kspin_descriptor_ex" title="typedef struct _KSPIN_DESCRIPTOR_EX {&#10;  const KSPIN_DISPATCH         *Dispatch;&#10;  const KSAUTOMATION_TABLE     *AutomationTable;&#10;  KSPIN_DESCRIPTOR             PinDescriptor;&#10;  ULONG                        Flags;&#10;  ULONG                        InstancesPossible;&#10;  ULONG                        InstancesNecessary;&#10;  const KSALLOCATOR_FRAMING_EX *AllocatorFraming;&#10;  PFNKSINTERSECTHANDLEREX      IntersectHandler;&#10;} KSPIN_DESCRIPTOR_EX, *PKSPIN_DESCRIPTOR_EX;">KSPIN_DESCRIPTOR_EX</a> for more information.</p>

<h3 id="bag"><code>Bag</code></h3>

<p>This member specifies the KSOBJECT_BAG (the KSOBJECT_BAG structure is equivalent to type PVOID) for this particular pin instance. <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/object-bags">Object Bags</a> are structures used to associate dynamic memory with a specific AVStream object. Anything in the pin object bag is automatically cleaned up when the pin is closed.</p>

<h3 id="context"><code>Context</code></h3>

<p>A pointer to a buffer. Clients can use <strong>Context</strong> to associate context information with a specific pin instance. Typically, this is used for pin/stream extensions and is allocated in the create dispatch provided in the pin dispatch table. Note that any dynamic memory allocated for context information should be placed in the pin instance's object bag using <a href="ksadditemtoobjectbag" title="KSDDKAPI NTSTATUS KsAddItemToObjectBag(&#10;  [in]           KSOBJECT_BAG           ObjectBag,&#10;  [in]           __drv_aliasesMem PVOID Item,&#10;  [in, optional] PFNKSFREE              Free&#10;);">KsAddItemToObjectBag</a>. <strong>Context</strong> is initialized to the value of the <strong>Context</strong> member of the parent <a href="ksfilter" title="typedef struct _KSFILTER {&#10;  const KSFILTER_DESCRIPTOR *Descriptor;&#10;  KSOBJECT_BAG              Bag;&#10;  PVOID                     Context;&#10;} KSFILTER, *PKSFILTER;">KSFILTER</a> at the time the pin is created. See <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/avstream-object-hierarchy">AVStream Object Hierarchy</a>.</p>

<h3 id="id"><code>Id</code></h3>

<p>This member specifies the pin type identifier. This is the index into the array of pin descriptors provided for the given filter type.</p>

<h3 id="communication"><code>Communication</code></h3>

<p>This member specifies KSPIN_COMMUNICATION_NONE, KSPIN_COMMUNICATION_SINK, KSPIN_COMMUNICATION_SOURCE, KSPIN_COMMUNICATION_BOTH or KSPIN_COMMUNICATION_BRIDGE. See <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ksproperty-pin-communication">KSPROPERTY_PIN_COMMUNICATION</a> for the meaning of each value.</p>

<h3 id="connectionisexternal"><code>ConnectionIsExternal</code></h3>

<p>This member specifies a Boolean value that, if <strong>TRUE</strong>, indicates that the connected pin does not support the AVStream connection handshake. If <strong>FALSE</strong>, indicates that the connected pin supports the AVStream connection handshake. This is an indication of whether the connection between this pin and the pin it is connected to is a connection between two AVStream pins.</p>

<h3 id="connectioninterface"><code>ConnectionInterface</code></h3>

<p>This member contains a <a href="kspin_interface" title="struct KSPIN_INTERFACE {&#10;  GUID Set;&#10;  ULONG Id;&#10;  ULONG Flags;&#10;};">KSPIN_INTERFACE</a> structure that identifies the interface being used for the connection. This information is supplied by the graph builder when the pin is created.</p>

<h3 id="connectionmedium"><code>ConnectionMedium</code></h3>

<p>This member contains a <a href="kspin_medium" title="struct KSPIN_MEDIUM {&#10;  GUID Set;&#10;  ULONG Id;&#10;  ULONG Flags;&#10;};">KSPIN_MEDIUM</a> structure that identifies the connection medium this pin should use. This information is supplied by the graph builder when the pin is created.</p>

<h3 id="connectionpriority"><code>ConnectionPriority</code></h3>

<p>This member contains a <a href="kspriority" title="typedef struct {&#10;  ULONG PriorityClass;&#10;  ULONG PrioritySubClass;&#10;} KSPRIORITY, *PKSPRIORITY;">KSPRIORITY</a> structure that specifies the priority of the connection. This information is supplied by the graph builder when the pin is created.</p>

<h3 id="connectionformat"><code>ConnectionFormat</code></h3>

<p>A pointer to a <a href="ksdataformat" title="typedef struct {&#10;  ULONG FormatSize;&#10;  ULONG Flags;&#10;  ULONG SampleSize;&#10;  ULONG Reserved;&#10;  GUID  MajorFormat;&#10;  GUID  SubFormat;&#10;  GUID  Specifier;&#10;} KSDATAFORMAT, *PKSDATAFORMAT, KSDATARANGE, *PKSDATARANGE;">KSDATAFORMAT</a> structure that specifies the data format of the connection. This information is initially supplied by the graph builder when the pin is created and may be changed through property access or by format change messages inserted into the stream. Access to this member is synchronized by the filter control mutex. This member should not be changed by the client.</p>

<h3 id="attributelist"><code>AttributeList</code></h3>

<p>A pointer to a <a href="ksmultiple_item" title="typedef struct {&#10;  ULONG Size;&#10;  ULONG Count;&#10;} KSMULTIPLE_ITEM, *PKSMULTIPLE_ITEM;">KSMULTIPLE_ITEM</a> structure that specifies the list of attributes, supplied during pin creation, to describe the connection. Specifies the direction of data flow for this pin (KSPIN_DATAFLOW_IN or KSPIN_DATAFLOW_OUT). This information is a static attribute of the pin and appears in the pin descriptor. It is cached here for access at IRQL above PASSIVE_LEVEL.</p>

<h3 id="streamheadersize"><code>StreamHeaderSize</code></h3>

<p>This member indicates the size in bytes of each <a href="ksstream_header" title="typedef struct {&#10;  ULONG    Size;&#10;  ULONG    TypeSpecificFlags;&#10;  KSTIME   PresentationTime;&#10;  LONGLONG Duration;&#10;  ULONG    FrameExtent;&#10;  ULONG    DataUsed;&#10;  PVOID    Data;&#10;  ULONG    OptionsFlags;&#10;  ULONG    Reserved;&#10;} KSSTREAM_HEADER, *PKSSTREAM_HEADER;">KSSTREAM_HEADER</a> structure for this pin. Typically used for output pins, a client can set this to any value greater than <strong>sizeof</strong> <em>(<a href="ksstream_header" title="typedef struct {&#10;  ULONG    Size;&#10;  ULONG    TypeSpecificFlags;&#10;  KSTIME   PresentationTime;&#10;  LONGLONG Duration;&#10;  ULONG    FrameExtent;&#10;  ULONG    DataUsed;&#10;  PVOID    Data;&#10;  ULONG    OptionsFlags;&#10;  ULONG    Reserved;&#10;} KSSTREAM_HEADER, *PKSSTREAM_HEADER;">KSSTREAM_HEADER</a>)</em> and have extended stream headers allocated (each stream header will be <strong>StreamHeaderSize</strong> bytes long). If a client does not set this member, this indicates that no extended information follows stream headers. In such a situation, each stream header is precisely <strong>sizeof</strong> <em>(<a href="ksstream_header" title="typedef struct {&#10;  ULONG    Size;&#10;  ULONG    TypeSpecificFlags;&#10;  KSTIME   PresentationTime;&#10;  LONGLONG Duration;&#10;  ULONG    FrameExtent;&#10;  ULONG    DataUsed;&#10;  PVOID    Data;&#10;  ULONG    OptionsFlags;&#10;  ULONG    Reserved;&#10;} KSSTREAM_HEADER, *PKSSTREAM_HEADER;">KSSTREAM_HEADER</a>)</em>. Clients can set this in the pin creation dispatch.</p>

<h3 id="dataflow"><code>DataFlow</code></h3>

<p>This member specifies the direction of data flow for the pin. Possible settings are <strong>KSPIN_DATAFLOW_IN</strong> and KSPIN_DATAFLOW_OUT. This information is a static attribute of the pin and appears in relevant <a href="kspin_descriptor" title="typedef struct {&#10;  ULONG                 InterfacesCount;&#10;  const KSPIN_INTERFACE *Interfaces;&#10;  ULONG                 MediumsCount;&#10;  const KSPIN_MEDIUM    *Mediums;&#10;  ULONG                 DataRangesCount;&#10;  const PKSDATARANGE    *DataRanges;&#10;  KSPIN_DATAFLOW        DataFlow;&#10;  KSPIN_COMMUNICATION   Communication;&#10;  const GUID            *Category;&#10;  const GUID            *Name;&#10;  union {&#10;    LONGLONG Reserved;&#10;    struct {&#10;      ULONG        ConstrainedDataRangesCount;&#10;      PKSDATARANGE *ConstrainedDataRanges;&#10;    };&#10;  };&#10;} KSPIN_DESCRIPTOR, *PKSPIN_DESCRIPTOR;">KSPIN_DESCRIPTOR</a> structure. It is cached here for access at IRQL above PASSIVE_LEVEL.</p>

<h3 id="devicestate"><code>DeviceState</code></h3>

<p>This member contains an enumeration of type <a href="ksstate" title="typedef enum {&#10;  KSSTATE_STOP,&#10;  KSSTATE_ACQUIRE,&#10;  KSSTATE_PAUSE,&#10;  KSSTATE_RUN&#10;} KSSTATE, *PKSSTATE;">KSSTATE</a> that identifies the state to which the pin has been told to transition. Not necessarily the same as the state of the pipe, which is reported through <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/nc-ks-pfnkspinsetdevicestate">AVStrMiniPinSetDeviceState</a>. Initially KSSTATE_STOP, this member is changed when AVStream receives a connection state property set IOCTL. Access is synchronized using the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/filter-control-mutex-in-avstream">filter control mutex</a>. Minidrivers should not change this member. See note in Remarks section below. Also see the <em>ClientState</em> member.</p>

<h3 id="resetstate"><code>ResetState</code></h3>

<p>This member contains an enumeration of type <a href="ksreset" title="typedef enum {&#10;  KSRESET_BEGIN,&#10;  KSRESET_END&#10;} KSRESET;">KSRESET</a> that identifies the current reset state of the pin. Possible settings are KSRESET_BEGIN and KSRESET_END. This member is initially set to KSRESET_END and is changed through property access. Access to this member is synchronized by the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/filter-control-mutex-in-avstream">filter control mutex</a>. The client should not change this member.</p>

<h3 id="clientstate"><code>ClientState</code></h3>

<p>This member specifies the <a href="ksstate" title="typedef enum {&#10;  KSSTATE_STOP,&#10;  KSSTATE_ACQUIRE,&#10;  KSSTATE_PAUSE,&#10;  KSSTATE_RUN&#10;} KSSTATE, *PKSSTATE;">KSSTATE</a> at which the pin is currently set. Updated immediately before <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/nc-ks-pfnkspinsetdevicestate">AVStrMiniPinSetDeviceState</a> is called. If this callback routine fails, AVStream rolls back <em>ClientState</em> to its previous value. Minidrivers that fail state transitions and that check this member during processing should be aware of this sequence of events.</p>

<h2 id="remarks">Remarks</h2>

<p>In many ways, pins are the focus of filter behavior. This is reflected in the fact that the pin structure has a large number of members. Many minidrivers need to refine pin behavior and maintain additional pin-associated context. For filters with fairly conventional pin behavior, no additional refinement or context is required. In many cases, default pin behavior is sufficient; the pins are accessed using <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/filter-centric-processing">Filter-Centric Processing</a>.</p>

<p>For synchronization purposes, the lifetime of this object is the interval starting when the minidriver's PreCreate dispatch function is called and ending when the minidriver's Close dispatch function returns, assuming the function does not return STATUS_PENDING. If it does return STATUS_PENDING, the object's lifetime ends when the client indicates completion of the close request by calling <a href="kscompletependingrequest" title="void KsCompletePendingRequest(&#10;  [in] PIRP Irp&#10;);">KsCompletePendingRequest</a>.</p>

<p>If the minidriver needs to determine whether it has been told to go to a specific <a href="ksstate" title="typedef enum {&#10;  KSSTATE_STOP,&#10;  KSSTATE_ACQUIRE,&#10;  KSSTATE_PAUSE,&#10;  KSSTATE_RUN&#10;} KSSTATE, *PKSSTATE;">KSSTATE</a>, comparing the value of the <strong>DeviceState</strong> member of KSPIN to that state is not a reliable method. Instead, either look at the <em>ClientState</em> member, or create a variable in the <strong>SetDeviceState</strong> callback and then check this variable. <strong>SetDeviceState</strong> is a member of <a href="kspin_dispatch" title="typedef struct _KSPIN_DISPATCH {&#10;  PFNKSPINIRP                Create;&#10;  PFNKSPINIRP                Close;&#10;  PFNKSPIN                   Process;&#10;  PFNKSPINVOID               Reset;&#10;  PFNKSPINSETDATAFORMAT      SetDataFormat;&#10;  PFNKSPINSETDEVICESTATE     SetDeviceState;&#10;  PFNKSPIN                   Connect;&#10;  PFNKSPINVOID               Disconnect;&#10;  const KSCLOCK_DISPATCH     *Clock;&#10;  const KSALLOCATOR_DISPATCH *Allocator;&#10;} KSPIN_DISPATCH, *PKSPIN_DISPATCH;">KSPIN_DISPATCH</a>.</p>

<p>Also see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/object-bags">Object Bags</a>.</p>

<h2 id="see-also">See also</h2>

<p><a href="kspin_descriptor" title="typedef struct {&#10;  ULONG                 InterfacesCount;&#10;  const KSPIN_INTERFACE *Interfaces;&#10;  ULONG                 MediumsCount;&#10;  const KSPIN_MEDIUM    *Mediums;&#10;  ULONG                 DataRangesCount;&#10;  const PKSDATARANGE    *DataRanges;&#10;  KSPIN_DATAFLOW        DataFlow;&#10;  KSPIN_COMMUNICATION   Communication;&#10;  const GUID            *Category;&#10;  const GUID            *Name;&#10;  union {&#10;    LONGLONG Reserved;&#10;    struct {&#10;      ULONG        ConstrainedDataRangesCount;&#10;      PKSDATARANGE *ConstrainedDataRanges;&#10;    };&#10;  };&#10;} KSPIN_DESCRIPTOR, *PKSPIN_DESCRIPTOR;">KSPIN_DESCRIPTOR</a></p>

<p><a href="kspin_descriptor_ex" title="typedef struct _KSPIN_DESCRIPTOR_EX {&#10;  const KSPIN_DISPATCH         *Dispatch;&#10;  const KSAUTOMATION_TABLE     *AutomationTable;&#10;  KSPIN_DESCRIPTOR             PinDescriptor;&#10;  ULONG                        Flags;&#10;  ULONG                        InstancesPossible;&#10;  ULONG                        InstancesNecessary;&#10;  const KSALLOCATOR_FRAMING_EX *AllocatorFraming;&#10;  PFNKSINTERSECTHANDLEREX      IntersectHandler;&#10;} KSPIN_DESCRIPTOR_EX, *PKSPIN_DESCRIPTOR_EX;">KSPIN_DESCRIPTOR_EX</a></p>

<p><a href="kspin_dispatch" title="typedef struct _KSPIN_DISPATCH {&#10;  PFNKSPINIRP                Create;&#10;  PFNKSPINIRP                Close;&#10;  PFNKSPIN                   Process;&#10;  PFNKSPINVOID               Reset;&#10;  PFNKSPINSETDATAFORMAT      SetDataFormat;&#10;  PFNKSPINSETDEVICESTATE     SetDeviceState;&#10;  PFNKSPIN                   Connect;&#10;  PFNKSPINVOID               Disconnect;&#10;  const KSCLOCK_DISPATCH     *Clock;&#10;  const KSALLOCATOR_DISPATCH *Allocator;&#10;} KSPIN_DISPATCH, *PKSPIN_DISPATCH;">KSPIN_DISPATCH</a></p>

<p><a href="ksadditemtoobjectbag" title="KSDDKAPI NTSTATUS KsAddItemToObjectBag(&#10;  [in]           KSOBJECT_BAG           ObjectBag,&#10;  [in]           __drv_aliasesMem PVOID Item,&#10;  [in, optional] PFNKSFREE              Free&#10;);">KsAddItemToObjectBag</a></p>

<p><a href="kscompletependingrequest" title="void KsCompletePendingRequest(&#10;  [in] PIRP Irp&#10;);">KsCompletePendingRequest</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/ns-ks-_kspin">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ks/ns-ks-_kspin.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
