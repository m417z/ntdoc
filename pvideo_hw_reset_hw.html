<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PVIDEO_HW_RESET_HW - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PVIDEO_HW_RESET_HW - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PVIDEO_HW_RESET_HW - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// video.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PVIDEO_HW_RESET_HW PvideoHwResetHw;

BOOLEAN PvideoHwResetHw(
  PVOID HwDeviceExtension,
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Columns,
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Rows
)
{...}</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/video/nc-video-pvideo_hw_reset_hw">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pvideo_hw_reset_hw.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-video-pvideo_hw_reset_hw)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pvideo_hw_reset_hw-callback-function">PVIDEO_HW_RESET_HW callback function</h1>

<h2 id="description">Description</h2>

<p><em>HwVidResetHw</em> resets the adapter to character mode.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="hwdeviceextension"><code>HwDeviceExtension</code></h3>

<p>Pointer to the miniport driver's per-adapter storage area. For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/device-extensions">Device Extensions</a>.</p>

<h3 id="columns"><code>Columns</code></h3>

<p>Specifies the number of columns of the mode to be set up.</p>

<h3 id="rows"><code>Rows</code></h3>

<p>Specifies the number of rows of the mode to be set up.</p>

<h2 id="return-value">Return value</h2>

<p><em>HwVidResetHw</em> should return <strong>TRUE</strong> if it completely resets the adapter to the given character mode. Otherwise, it should return <strong>FALSE</strong> to indicate that the HAL should perform the equivalent of an INT10, MODE3-type BIOS call after <em>HwVidResetHw</em> returns control.</p>

<h2 id="remarks">Remarks</h2>

<p>A video miniport driver must have a <em>HwVidResetHw</em> function if its adapter cannot be reset to a fully initialized state without a hard boot of the machine. For example, if the adapter's ROM initialization code cannot reset the adapter state to a boot-up mode, the miniport driver must have a <em>HwVidResetHw</em> function. Another reason the miniport driver must implement this function is to clean up the adapter's interrupt lines when the adapter is powered down, thereby avoiding a deluge of interrupts the next time the system boots.</p>

<p>The HAL calls <em>HwVidResetHw</em> if the system is about to crash, so that the HAL can display information on the screen while the system is being shut down. This call can occur at any IRQL, and the driver must be ready to handle it at any time. The HAL also calls <em>HwVidResetHw</em> just before the machine is rebooted when a soft boot occurs.</p>

<p>Most miniport drivers must provide this function, except for drivers of adapters that are reset to a VGA standard character mode on receipt of an INT10, MODE3-type command.</p>

<p><em>HwVidResetHw</em> resets the adapter to character mode, according to the given <em>Columns</em> and <em>Rows</em> values. However, because the system is shutting down, <em>HwVidResetHw</em> cannot call the BIOS or any pageable code. <em>HwVidResetHw</em> should call only the <strong>VideoPortRead/<a href="writeport" title="BOOL WritePort(&#10;  _In_  HANDLE  hPort,&#10;  _In_  LPBYTE  pBuffer,&#10;        DWORD   cbBuf,&#10;  _Out_ LPDWORD pcbWritten&#10;);">WritePort</a></strong><em>Xxx</em> and/or <strong>VideoPortRead/WriteRegister</strong><em>Xxx</em> functions. (See <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/">Functions Exported by the Video Port Driver</a>.)</p>

<p>If <em>HwVidResetHw</em> cannot change the mode of the adapter by simply programming the adapter registers, it can set up the appropriate values in adapter registers and return <strong>FALSE</strong>. This causes the HAL to perform an extended INT10-type operation to reset the video adapter to character mode.</p>

<p><em>HwVidResetHw</em> must not call <a href="videoportint10" title="VIDEOPORT_DEPRECATED VIDEOPORT_API VP_STATUS VideoPortInt10(&#10;  PVOID                     HwDeviceExtension,&#10;  PVIDEO_X86_BIOS_ARGUMENTS BiosArguments&#10;);">VideoPortInt10</a>. A miniport driver's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/video/nc-video-pvideo_hw_start_io">HwVidStartIO</a> function is called with the <a href="ioctl_video_reset_device" title="// CTL_CODE(0x0023, 0x104, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_VIDEO_RESET_DEVICE 0x00230410">IOCTL_VIDEO_RESET_DEVICE</a><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/">VRP</a> to reset the adapter whenever the Display program is used to test or change the graphics display mode, <em>not</em> the miniport driver's <em>HwVidResetHw</em> function.</p>

<p><em>HwVidResetHw</em> must not be made pageable.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/">Functions Exported by the Video Port Driver</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/video/nc-video-pvideo_hw_initialize">HwVidInitialize</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/video/nc-video-pvideo_hw_start_io">HwVidStartIO</a></p>

<p><a href="ioctl_video_reset_device" title="// CTL_CODE(0x0023, 0x104, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_VIDEO_RESET_DEVICE 0x00230410">IOCTL_VIDEO_RESET_DEVICE</a></p>

<p><a href="videoportint10" title="VIDEOPORT_DEPRECATED VIDEOPORT_API VP_STATUS VideoPortInt10(&#10;  PVOID                     HwDeviceExtension,&#10;  PVIDEO_X86_BIOS_ARGUMENTS BiosArguments&#10;);">VideoPortInt10</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/video/nc-video-pvideo_hw_reset_hw">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/video/nc-video-pvideo_hw_reset_hw.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
