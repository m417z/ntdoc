<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="ISOCH_DESCRIPTOR - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ISOCH_DESCRIPTOR - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            ISOCH_DESCRIPTOR - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// 1394.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _ISOCH_DESCRIPTOR {
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                         fulFlags;
  <a href="mdl" title="typedef struct _MDL {&#10;  struct _MDL      *Next;&#10;  CSHORT           Size;&#10;  CSHORT           MdlFlags;&#10;  struct _EPROCESS *Process;&#10;  PVOID            MappedSystemVa;&#10;  PVOID            StartVa;&#10;  ULONG            ByteCount;&#10;  ULONG            ByteOffset;&#10;} MDL, *PMDL;">PMDL</a>                          Mdl;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                         ulLength;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                         nMaxBytesPerFrame;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                         ulSynch;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                         ulTag;
  <a href="cycle_time" title="typedef struct _CYCLE_TIME {&#10;  ULONG CL_CycleOffset : 12;&#10;  ULONG CL_CycleCount : 13;&#10;  ULONG CL_SecondCount : 7;&#10;} CYCLE_TIME, *PCYCLE_TIME;">CYCLE_TIME</a>                    CycleTime;
  PBUS_ISOCH_DESCRIPTOR_ROUTINE Callback;
  PVOID                         Context1;
  PVOID                         Context2;
  <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>                      status;
  <a href="ulong_ptr" title="typedef [public] unsigned __int3264 ULONG_PTR;">ULONG_PTR</a>                     DeviceReserved[8];
  <a href="ulong_ptr" title="typedef [public] unsigned __int3264 ULONG_PTR;">ULONG_PTR</a>                     BusReserved[8];
  <a href="ulong_ptr" title="typedef [public] unsigned __int3264 ULONG_PTR;">ULONG_PTR</a>                     PortReserved[16];
} ISOCH_DESCRIPTOR, *PISOCH_DESCRIPTOR;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/1394/ns-1394-_isoch_descriptor">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/isoch_descriptor.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-1394-_isoch_descriptor)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_isoch_descriptor-structure">_ISOCH_DESCRIPTOR structure</h1>

<h2 id="description">Description</h2>

<p>The ISOCH_DESCRIPTOR structure describes a buffer to be attached or detailed from a resource handle, using the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/1394/ni-1394-ioctl_1394_class">REQUEST_ISOCH_ATTACH_BUFFERS</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/1394/ni-1394-ioctl_1394_class">REQUEST_ISOCH_DETACH_BUFFERS</a> requests.</p>

<h2 id="members">Members</h2>

<h3 id="fulflags"><code>fulFlags</code></h3>

<p>Specifies various flags for this isochronous descriptor. Each attached buffer on the channel has an associated isoch descriptor.</p>

<p>Before using a particular buffer for an I/O operation, the host controller examines the flags in the buffer's isoch descriptor for instructions on how to handle the data. In some cases, the host controller will continue to observe the behavior specified by these flags during I/O operations with subsequent buffers. For instance, if the isoch descriptor flags indicate that the host controller should filter out packets that do not have a certain Sy value recorded in <strong>ulSynch</strong>, the host controller will continue this filtering operation with the data in the buffers that follow, even if the isoch descriptors associated with these buffers do not have the same flags set.</p>

<p>The following table describes the flags that can be assigned to this member.</p>

<table>
<thead>
<tr>
  <th>Flag</th>
  <th>Isochronous Transaction</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>DESCRIPTOR_SYNCH_ON_SY</td>
  <td>Listen</td>
  <td>Starting with the data in current buffer, the host controller ignores all packets not containing a particular Sy value that is embedded in the isochronous packet. The Sy value is specified in <strong>ulSynch</strong>. If the DESCRIPTOR_USE_SY_TAG_IN_FIRST flag is set, the host controller resumes reading all packets after encountering the first packet with the Sy value specified in *<em>ulSynch</em>*. If the DESCRIPTOR_USE_SY_TAG_IN_FIRST flag is not set, the host controller continues filtering, reading packets with the indicated Sy value and ignoring all others.</td>
</tr>
<tr>
  <td>DESCRIPTOR_SYNCH_ON_TAG</td>
  <td>Listen</td>
  <td>Starting with the data in current buffer, the host controller ignores all packets not containing a particular tag value that is embedded in the isochronous packet. The tag value is specified in <strong>ulTag</strong>. If the DESCRIPTOR_USE_SY_TAG_IN_FIRST flag is set, the host controller resumes reading all packets after encountering the first packet with the tag value specified in *<em>ulTag</em>*. If the DESCRIPTOR_USE_SY_TAG_IN_FIRST flag is not set, the host controller continues filtering, reading packets with the indicated tag value and ignoring all others.</td>
</tr>
<tr>
  <td>DESCRIPTOR_SYNCH_ON_TIME</td>
  <td>Listen, Talk</td>
  <td>The host controller waits for a particular isochronous cycle time before continuing the operation. The cycle time is specified in the <strong>CycleTime</strong> member. Starting with the data in the current buffer, the host controller ignores all packets not containing a cycle time of <strong>CycleTime</strong>. After finding a packet with the indicated cycle time, the host controller resumes processing all packets.</td>
</tr>
<tr>
  <td>DESCRIPTOR_USE_SY_TAG_IN_FIRST</td>
  <td>Listen</td>
  <td>Filtering on the <strong>Sy</strong> or <strong>Tag</strong> members occurs only until the first matching packet is received. This flag is used in conjunction with the flags DESCRIPTOR_SYNCH_ON_SY and DESCRIPTOR_SYNCH_ON_TAG. These two flags initiate a filtering operation based on the values in <strong>Sy</strong> or <strong>Tag</strong>, unless DESCRIPTOR_USE_SY_TAG_IN_FIRST is also set, in which case these flags initiate a synchronization rather than a filtering operation. In this synchronization operation the host controller ignores all packets until discovering a packet with the right *<em>Sy</em>* or <strong>Tag</strong> value. After discovering a packet with the indicated <strong>Sy</strong> or <strong>Tag</strong> value, the host controller resumes processing all packets.</td>
</tr>
<tr>
  <td>DESCRIPTOR_TIME_STAMP_ON_COMPLETION</td>
  <td>Listen, Talk</td>
  <td>Once the host controller completes its DMA to or from this buffer, store the cycle time in the <strong>CycleTime</strong> member of the ISOCH_DESCRIPTOR.</td>
</tr>
<tr>
  <td>DESCRIPTOR_PRIORITY_TIME_DELIVERY</td>
  <td>Talk</td>
  <td>If the local host controller is not ready for a write, do not retry the write later. (The default behavior is to retry until the host controller is ready.)</td>
</tr>
<tr>
  <td>DESCRIPTOR_HEADER_SCATTER_GATHER</td>
  <td>Talk</td>
  <td>The host controller treats the data in this buffer as a sequence of headers. The host controller prepends a header from this buffer to each packet it assembles from the data in the next buffer attached.</td>
</tr>
</tbody>
</table>

<h3 id="mdl"><code>Mdl</code></h3>

<p>Specifies the <a href="mdl" title="typedef struct _MDL {&#10;  struct _MDL      *Next;&#10;  CSHORT           Size;&#10;  CSHORT           MdlFlags;&#10;  struct _EPROCESS *Process;&#10;  PVOID            MappedSystemVa;&#10;  PVOID            StartVa;&#10;  ULONG            ByteCount;&#10;  ULONG            ByteOffset;&#10;} MDL, *PMDL;">MDL</a> representing a buffer in which the data is, or will be, contained.</p>

<h3 id="ullength"><code>ulLength</code></h3>

<p>Specifies the length of the <strong>Mdl</strong>.</p>

<h3 id="nmaxbytesperframe"><code>nMaxBytesPerFrame</code></h3>

<p>Specifies the maximum bytes contained in each isochronous frame. On writes, the data in the buffer is split into isochronous packets of this size.</p>

<h3 id="ulsynch"><code>ulSynch</code></h3>

<p>For IsochTalk requests, if the DESCRIPTOR_SYNCH_ON_SY flag is set, this member specifies the Sy field of the outgoing packet. For REQUEST_ISOCH_LISTEN requests, if the DESCRIPTOR_SYNCH_ON_SY flag is set, this member specifies the value the host controller will match against the Sy field in isochronous packet headers.</p>

<h3 id="ultag"><code>ulTag</code></h3>

<p>For IsochTalk requests, this member specifies the Tag field of the outgoing packet. For REQUEST_ISOCH_LISTEN requests, if the DESCRIPTOR_SYNCH_ON_TAG flag is set, this member specifies the value the host controller will match against the Tag field in isochronous packet headers.</p>

<h3 id="cycletime"><code>CycleTime</code></h3>

<p>If the DESCRIPTOR_SYNCH_ON_TIME flag is set, this member specifies the isochronous cycle time to synchronize on. (The timing resolution is per isochronous cycle. The **CycleOffset** member of the cycle time is not used.) If the DESCRIPTOR_TIME_STAMP_ON_COMPLETION flag is set, the bus driver fills this member with the isochronous cycle time on completion of the operation that used this buffer.</p>

<h3 id="callback"><code>Callback</code></h3>

<p>Pointer to a callback routine. If non-NULL, the bus driver calls this routine to indicate that the associated attached buffers are ready to be detached. The callback executes at IRQL DISPATCH_LEVEL. The callback is of the following type:</p>

<pre><code>void Callback(IN PVOID Context1, IN PVOID Context2);
</code></pre>

<h3 id="context1"><code>Context1</code></h3>

<p>Specifies the first parameter when the bus driver calls the routine passed in <strong>Callback</strong>.</p>

<h3 id="context2"><code>Context2</code></h3>

<p>Specifies the second parameter when the bus driver calls the routine passed in <strong>Callback</strong>.</p>

<h3 id="status"><code>status</code></h3>

<p>For <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/1394/ni-1394-ioctl_1394_class">REQUEST_ISOCH_ATTACH_BUFFERS</a> requests, this member specifies the status of the attach operation on this buffer. If an error occurs during the processing of the <strong>REQUEST_ISOCH_ATTACH_BUFFERS</strong> request, the bus driver fills in the <strong>status</strong> member with an appropriate error code.</p>

<p><strong>Note</strong> The <strong>status</strong> member must be initialized to <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> before the <strong>REQUEST_ISOCH_ATTACH_BUFFERS</strong> request is made.</p>

<h3 id="devicereserved"><code>DeviceReserved</code></h3>

<p>Reserved.</p>

<h3 id="busreserved"><code>BusReserved</code></h3>

<p>Reserved.</p>

<h3 id="portreserved"><code>PortReserved</code></h3>

<p>Reserved.</p>

<h2 id="remarks">Remarks</h2>

<p>Not all DESCRIPTOR_XXX flags are supported on all hardware. The device driver can use the REQUEST_GET_LOCAL_HOST_INFO request, with **nLevel** = GET_HOST_CAPABILITIES, to determine which DESCRIPTOR_XXX flags are supported. The bus driver returns a pointer to a <a href="get_local_host_info2" title="typedef struct _GET_LOCAL_HOST_INFO2 {&#10;  ULONG HostCapabilities;&#10;  ULONG MaxAsyncReadRequest;&#10;  ULONG MaxAsyncWriteRequest;&#10;} GET_LOCAL_HOST_INFO2, *PGET_LOCAL_HOST_INFO2;">GET_LOCAL_HOST_INFO2</a> structure, whose **HostCapabilities** member contains flags that determine which flags the host controller supports. The following table lists which DESCRIPTOR_XXX flags require hardware support, and the corresponding <strong>HostCapabilities</strong> flag the driver should check.</p>

<table>
<thead>
<tr>
  <th>DESCRIPTOR_XXX flags</th>
  <th>HostCapabilities</th>
</tr>
</thead>
<tbody>
<tr>
  <td>DESCRIPTOR_SYNCH_ON_TIME</td>
  <td>HOST_INFO_SUPPORTS_START_ON_CYCLE</td>
</tr>
<tr>
  <td>DESCRIPTOR_HEADER_SCATTER_GATHER</td>
  <td>HOST_INFO_SUPPORTS_ISO_HDR_INSERTION</td>
</tr>
</tbody>
</table>

<p>If the driver sets the DESCRIPTOR_HEADER_SCATTER_GATHER flag, the host controller combines the data of the buffer specified in **Mdl** with the data of the next buffer attached. (Subsequent buffers are unaffected.) Each frame of the buffer is prepended to a frame of the next buffer (in the order the data in the buffer is split into frames), and sent as the data of the next isochronous packet. The number of frames of each buffer must match, or the bus driver returns STATUS_INVALID_PARAMETER for the next REQUEST_ISOCH_ATTACH_BUFFER request.</p>

<h2 id="see-also">See also</h2>

<p><a href="get_local_host_info2" title="typedef struct _GET_LOCAL_HOST_INFO2 {&#10;  ULONG HostCapabilities;&#10;  ULONG MaxAsyncReadRequest;&#10;  ULONG MaxAsyncWriteRequest;&#10;} GET_LOCAL_HOST_INFO2, *PGET_LOCAL_HOST_INFO2;">GET_LOCAL_HOST_INFO2</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/1394/ni-1394-ioctl_1394_class">REQUEST_ISOCH_ALLOCATE_RESOURCES</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/1394/ni-1394-ioctl_1394_class">REQUEST_ISOCH_ATTACH_BUFFERS</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/1394/ni-1394-ioctl_1394_class">REQUEST_ISOCH_DETACH_BUFFERS</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/1394/ni-1394-ioctl_1394_class">REQUEST_ISOCH_LISTEN</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/1394/ni-1394-ioctl_1394_class">REQUEST_ISOCH_TALK</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/1394/ns-1394-_isoch_descriptor">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/1394/ns-1394-_isoch_descriptor.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
