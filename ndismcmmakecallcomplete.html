<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NdisMCmMakeCallComplete - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NdisMCmMakeCallComplete - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NdisMCmMakeCallComplete - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">void NdisMCmMakeCallComplete(
  _S_,
  _VH_,
  _PH_,
  _CC_,
  _CP_
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndismcmmakecallcomplete">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndismcmmakecallcomplete.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ndis-ndismcmmakecallcomplete)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="ndismcmmakecallcomplete-macro">NdisMCmMakeCallComplete macro</h1>

<h2 id="description">Description</h2>

<p><strong>NdisMCmMakeCallComplete</strong> returns the final status of a client's request, for which the MCM driver
previously returned NDIS_STATUS_PENDING, to make an outgoing call.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="_s_"><code>_S_</code></h3>

<p>Specifies the final status of the attempt to make the connection, either NDIS_STATUS_SUCCESS or
any caller-determined NDIS_STATUS_
<em>XXX</em> except NDIS_STATUS_PENDING.</p>

<h3 id="_vh_"><code>_VH_</code></h3>

<p>Specifies the handle to the client-created VC, which the MCM driver obtained as an input parameter
to its
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_create_vc">ProtocolCoCreateVc</a> function and,
more recently, from the
<em>CallMgrVcContext</em> passed to its
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cm_make_call">ProtocolCmMakeCall</a> function.</p>

<h3 id="_ph_"><code>_PH_</code></h3>

<p>Specifies the handle to the initial party on the client-created multipoint VC, which the MCM
driver obtained as an input parameter to its
<em>ProtocolCmMakeCall</em> function. If the given
<em>NdisVcHandle</em> represented a point-to-point VC, this parameter was <strong>NULL</strong>.</p>

<h3 id="_cc_"><code>_CC_</code></h3>

<p>Specifies the handle to a caller-allocated resident context area, in which the MCM driver will
maintain per-party state information, or this parameter is <strong>NULL</strong> if
<em>NdisPartyHandle</em> is <strong>NULL</strong>. For a multipoint VC, NDIS passes this MCM-driver-supplied
<em>CallManagerPartyContext</em> handle in all subsequent calls to the ProtocolCm<em>Xxx</em> functions that concern this party. If
<em>Status</em> is anything other than NDIS_STATUS_SUCCESS, NDIS ignores this parameter.</p>

<h3 id="_cp_"><code>_CP_</code></h3>

<p>Pointer to a structure of type
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/hardware/network/ff545384(v=vs.85)">CO_CALL_PARAMETERS</a> that specifies the call
parameters set up for this connection if
<em>Status</em> is NDIS_STATUS_SUCCESS.</p>

<h2 id="remarks">Remarks</h2>

<p>An MCM driver should call
<strong>NdisMCmMakeCallComplete</strong> with NDIS_STATUS_SUCCESS only if it is ready to make data transfers on the
VC. That is, the MCM driver has negotiated with the network to establish the call parameters for the VC,
set up a NIC for those call parameters, and called
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndismcmactivatevc">NdisMCmActivateVc</a> to notify NDIS of the
VC activation.</p>

<p>An MCM driver must call
<strong>NdisMCmMakeCallComplete</strong> if its
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cm_make_call">ProtocolCmMakeCall</a> function
previously returned NDIS_STATUS_PENDING for the given
<em>NdisVcHandle</em> .The client, which initiated the pending outgoing call, cannot use the VC to make
transfers until the miniport driver calls
<strong>NdisMCmMakeCallComplete</strong> with NDIS_STATUS_SUCCESS.</p>

<p>Even if the attempted connection failed, neither NDIS nor the client can release the resources they
allocated to maintain state until the MCM driver's call to
<strong>NdisMCmMakeCallComplete</strong> causes a call to that client's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cl_make_call_complete">ProtocolClMakeCallComplete</a> function. In fact, neglecting to call
<strong>NdisMCmMakeCallComplete</strong> for a failed attempt to set up such a connection causes a memory leak in
the MCM driver as well; it prevents the client from tearing down the VC it created for its failed
outgoing call, so the MCM driver's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_delete_vc">ProtocolCoDeleteVc</a> function is not
called to release the resources the miniport driver allocated for that VC.</p>

<p>If the MCM driver passes an error, such as NDIS_STATUS_FAILURE, for the
<em>Status</em>, it must consider the
<em>NdisPartyHandle</em>, if any, invalid when
<strong>NdisMCmMakeCallComplete</strong> returns control. The CM can release (or reinitialize for reuse) any
resources that it allocated to maintain state for the given party after
<strong>NdisMCmMakeCallComplete</strong> returns control. The MCM driver's
<em>ProtocolCoDeleteVc</em> function will subsequently be called to release any resources that the miniport
driver allocated for tracking the state of the client-created VC whenever the MCM driver passes an error
status to
<strong>NdisMCmMakeCallComplete</strong>.</p>

<p>In the course of setting up a client-initiated outgoing call, the MCM driver can modify the
client-supplied call parameters originally passed in to its
<em>ProtocolCmMakeCall</em> function. If it does, the MCM driver must pass its modifications in the buffer
at
<em>CallParameters</em> when it calls
<strong>NdisMCmMakeCallComplete</strong>. If the client finds these modified call parameters unacceptable, it will
then tear down the call, which also causes a call to the MCM driver's
<em>ProtocolCoDeleteVc</em> function.</p>

<p>Only connection-oriented miniport drivers that provide integrated call-management support can call
<strong>NdisMCmMakeCallComplete</strong>. Stand-alone call managers, which register themselves with NDIS as
protocol drivers, call
<strong><a href="ndiscmmakecallcomplete" title="VOID NdisCmMakeCallComplete(&#10;  [in]           NDIS_STATUS         Status,&#10;  [in]           NDIS_HANDLE         NdisVcHandle,&#10;  [in, optional] NDIS_HANDLE         NdisPartyHandle,&#10;  [in, optional] NDIS_HANDLE         CallMgrPartyContext,&#10;  [in]           PCO_CALL_PARAMETERS CallParameters&#10;);">NdisCmMakeCallComplete</a></strong> instead.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/hardware/network/ff545384(v=vs.85)">CO_CALL_PARAMETERS</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndisallocatefromnpagedlookasidelist">NdisAllocateFromNPagedLookasideList</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndisclmakecall">NdisClMakeCall</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndiscmmakecallcomplete">NdisCmMakeCallComplete</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cl_make_call_complete">ProtocolClMakeCallComplete</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cm_make_call">ProtocolCmMakeCall</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_delete_vc">ProtocolCoDeleteVc</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndismcmmakecallcomplete">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ndis/nf-ndis-ndismcmmakecallcomplete.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
