<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="D3DKMTMapGpuVirtualAddress - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>D3DKMTMapGpuVirtualAddress - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            D3DKMTMapGpuVirtualAddress - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dkmthk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> D3DKMTMapGpuVirtualAddress(
  <a href="d3dddi_mapgpuvirtualaddress" title="typedef struct D3DDDI_MAPGPUVIRTUALADDRESS {&#10;  D3DKMT_HANDLE                           hPagingQueue;&#10;  D3DKMT_ALIGN64 D3DGPU_VIRTUAL_ADDRESS   BaseAddress;&#10;  D3DKMT_ALIGN64 D3DGPU_VIRTUAL_ADDRESS   MinimumAddress;&#10;  D3DKMT_ALIGN64 D3DGPU_VIRTUAL_ADDRESS   MaximumAddress;&#10;  D3DKMT_HANDLE                           hAllocation;&#10;  D3DKMT_ALIGN64 D3DGPU_SIZE_T            OffsetInPages;&#10;  D3DKMT_ALIGN64 D3DGPU_SIZE_T            SizeInPages;&#10;  D3DDDIGPUVIRTUALADDRESS_PROTECTION_TYPE Protection;&#10;  D3DKMT_ALIGN64 UINT64                   DriverProtection;&#10;  UINT                                    Reserved0;&#10;  D3DKMT_ALIGN64 UINT64                   Reserved1;&#10;  D3DKMT_ALIGN64 D3DGPU_VIRTUAL_ADDRESS   VirtualAddress;&#10;  D3DKMT_ALIGN64 UINT64                   PagingFenceValue;&#10;} D3DDDI_MAPGPUVIRTUALADDRESS;">D3DDDI_MAPGPUVIRTUALADDRESS</a> *unnamedParam1
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmthk/nf-d3dkmthk-d3dkmtmapgpuvirtualaddress">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/d3dkmtmapgpuvirtualaddress.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-d3dkmthk-d3dkmtmapgpuvirtualaddress)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="d3dkmtmapgpuvirtualaddress-function">D3DKMTMapGpuVirtualAddress function</h1>

<h2 id="description">Description</h2>

<p><strong>D3DKMTMapGpuVirtualAddress</strong> maps a GPU virtual address range to a specific allocation range or puts it to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dukmdt/ns-d3dukmdt-_d3dddigpuvirtualaddress_protection_type">*Invalid* or <em>Zero</em></a> state.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="unnamedparam1"><code>unnamedParam1</code></h3>

<p>[in/out] <strong>pData</strong> is a pointer to a <strong><a href="d3dddi_mapgpuvirtualaddress" title="typedef struct D3DDDI_MAPGPUVIRTUALADDRESS {&#10;  D3DKMT_HANDLE                           hPagingQueue;&#10;  D3DKMT_ALIGN64 D3DGPU_VIRTUAL_ADDRESS   BaseAddress;&#10;  D3DKMT_ALIGN64 D3DGPU_VIRTUAL_ADDRESS   MinimumAddress;&#10;  D3DKMT_ALIGN64 D3DGPU_VIRTUAL_ADDRESS   MaximumAddress;&#10;  D3DKMT_HANDLE                           hAllocation;&#10;  D3DKMT_ALIGN64 D3DGPU_SIZE_T            OffsetInPages;&#10;  D3DKMT_ALIGN64 D3DGPU_SIZE_T            SizeInPages;&#10;  D3DDDIGPUVIRTUALADDRESS_PROTECTION_TYPE Protection;&#10;  D3DKMT_ALIGN64 UINT64                   DriverProtection;&#10;  UINT                                    Reserved0;&#10;  D3DKMT_ALIGN64 UINT64                   Reserved1;&#10;  D3DKMT_ALIGN64 D3DGPU_VIRTUAL_ADDRESS   VirtualAddress;&#10;  D3DKMT_ALIGN64 UINT64                   PagingFenceValue;&#10;} D3DDDI_MAPGPUVIRTUALADDRESS;">D3DDDI_MAPGPUVIRTUALADDRESS</a></strong> structure that describes the operation.</p>

<h2 id="return-value">Return value</h2>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a></td>
  <td>The device context was successfully created.</td>
</tr>
<tr>
  <td>STATUS_INVALID_PARAMETER</td>
  <td>Parameters were validated and determined to be incorrect.</td>
</tr>
</tbody>
</table>

<p>This function might also return other <strong><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a></strong> values.</p>

<h2 id="remarks">Remarks</h2>

<p>The driver can specify a base GPU virtual address (VA) to map or let the video memory manager automatically pick one. When specifying a non-NULL <strong>BaseAddress</strong> value, the entire range from <strong>BaseAddress</strong> to <strong>BaseAddress</strong>+<strong>Size</strong> must be in a freed state or belong to a VA range that was obtained by calling <strong>D3DKMTMapGpuVirtualAddress</strong> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkcb_reservegpuvirtualaddressrange"><strong>DxgkCbReserveGpuVirtualAddressRange</strong></a>. When <strong>Protection.Zero</strong> or <strong>Protection.NoAccess</strong> is specified, the VA range can't belong to a range that was obtained by calling <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmthk/nc-d3dkmthk-pfnd3dkmt_mapgpuvirtualaddress"><strong>MapGpuVirtualAddressCb</strong></a>.</p>

<p>The driver can specify whether the mapping should allow for write and execute privileges in addition to read privileges, which always exist by default.</p>

<p>In the linked display adapter (LDA) configuration, the paging queue defines a physical GPU whose page tables are modified, and the allocation handle (if not NULL) defines where the page table entries are pointing to. The allocation can be resident in any physical GPU memory segment.</p>

<p>The GPU VA range, which is allocated by the API, is freed when the allocation (the GPU VA is mapped to) is destroyed. The VA range can also be freed by calling <strong><a href="d3dkmtfreegpuvirtualaddress" title="NTSTATUS D3DKMTFreeGpuVirtualAddress(&#10;  [in] const D3DKMT_FREEGPUVIRTUALADDRESS *unnamedParam1&#10;);">D3DKMTFreeGpuVirtualAddress</a></strong>, but this needs to be synchronized with allocation destruction if necessary.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkcb_reservegpuvirtualaddressrange"><strong>DxgkCbReserveGpuVirtualAddressRange</strong></a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmthk/nf-d3dkmthk-d3dkmtmapgpuvirtualaddress">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dkmthk/nf-d3dkmthk-d3dkmtmapgpuvirtualaddress.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
