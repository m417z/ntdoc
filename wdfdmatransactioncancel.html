<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="WdfDmaTransactionCancel - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>WdfDmaTransactionCancel - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            WdfDmaTransactionCancel - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdfdmatransaction.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">BOOLEAN WdfDmaTransactionCancel(
  [in] WDFDMATRANSACTION DmaTransaction
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfdmatransaction/nf-wdfdmatransaction-wdfdmatransactioncancel">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/wdfdmatransactioncancel.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-wdfdmatransaction-wdfdmatransactioncancel)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="wdfdmatransactioncancel-function">WdfDmaTransactionCancel function</h1>

<h2 id="description">Description</h2>

<p>[Applies to KMDF only]</p>

<p>The <strong>WdfDmaTransactionCancel</strong> method attempts to cancel a DMA transaction that is waiting for the allocation of map registers.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="dmatransaction-in"><code>DmaTransaction</code> [in]</h3>

<p>A handle to the DMA transaction object that represents the transaction that is being canceled. This transaction must have already been initialized by the driver.</p>

<h2 id="return-value">Return value</h2>

<p><strong>WdfDmaTransactionCancel</strong> returns TRUE if the framework successfully cancels map register allocation. In this case, no transfers are completed, and the framework makes no additional DMA callbacks on the transaction until it is reinitiated.</p>

<p>The method returns FALSE if another thread is already processing this transaction, or if the driver has not yet called <a rel="noopener" target="_blank" href="wdfdmatransactionexecute">WdfDmaTransactionExecute</a>. In the first case, the framework is currently calling or will call <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfdmatransaction/nc-wdfdmatransaction-evt_wdf_program_dma">EvtProgramDma</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfdmatransaction/nc-wdfdmatransaction-evt_wdf_reserve_dma">EvtReserveDma</a>. At this point, a driver that specified a system-mode DMA profile might call <a rel="noopener" target="_blank" href="wdfdmatransactionstopsystemtransfer">WdfDmaTransactionStopSystemTransfer</a>.</p>

<p>The method also returns FALSE if called with a transaction that was allocated from a DMA version 2 enabler.</p>

<h2 id="remarks">Remarks</h2>

<p>The driver might call <strong>WdfDmaTransactionCancel</strong> from an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfrequest/nc-wdfrequest-evt_wdf_request_cancel">EvtRequestCancel</a> event callback function that it supplies in a call to <a rel="noopener" target="_blank" href="wdfrequestmarkcancelableex">WdfRequestMarkCancelableEx</a>. For a code example that shows how to do this, see <a rel="noopener" target="_blank" href="wdfdmatransactionstopsystemtransfer">WdfDmaTransactionStopSystemTransfer</a>.</p>

<p>The driver might also call <strong>WdfDmaTransactionCancel</strong> from an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfio/nc-wdfio-evt_wdf_io_queue_io_canceled_on_queue">EvtIoCanceledOnQueue</a> event callback function.</p>

<p>Cancellation can only succeed if the call to <strong>WdfDmaTransactionCancel</strong> occurs after the call to <a rel="noopener" target="_blank" href="wdfdmatransactionexecute">WdfDmaTransactionExecute</a>, but before the <strong><a href="wdfdmatransactionexecute" title="NTSTATUS WdfDmaTransactionExecute(&#10;  [in]           WDFDMATRANSACTION DmaTransaction,&#10;  [in, optional] WDFCONTEXT        Context&#10;);">WdfDmaTransactionExecute</a></strong> method has started the DMA allocation. For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/wdf/canceling-dma-transactions">Canceling DMA Transactions</a>.</p>

<p>The driver must call <strong>WdfDmaTransactionCancel</strong> after calling <a rel="noopener" target="_blank" href="wdfdmatransactioninitialize">WdfDmaTransactionInitialize</a>, but before calling <a rel="noopener" target="_blank" href="wdfdmatransactionrelease">WdfDmaTransactionRelease</a> or <a rel="noopener" target="_blank" href="wdfobjectdelete">WdfObjectDelete</a> to delete the transaction object.</p>

<p>Do not call <strong>WdfDmaTransactionCancel</strong> after the framework has called <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfdmatransaction/nc-wdfdmatransaction-evt_wdf_program_dma">EvtProgramDma</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfdmatransaction/nc-wdfdmatransaction-evt_wdf_reserve_dma">EvtReserveDma</a>.</p>

<p>A driver must request use of DMA version 3 prior to calling <strong>WdfDmaTransactionCancel</strong>.
To select DMA version 3, set the <strong>WdmDmaVersionOverride</strong> member of <a rel="noopener" target="_blank" href="wdf_dma_enabler_config">WDF_DMA_ENABLER_CONFIG</a> to 3.</p>

<p>If a driver calls <strong>WdfDmaTransactionCancel</strong> on a transaction that was allocated from a DMA version 2 enabler, the framework generates a verifier error and <strong>WdfDmaTransactionCancel</strong> returns FALSE. In this case, no attempt is made to cancel the transaction.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfdmatransaction/nc-wdfdmatransaction-evt_wdf_program_dma">EvtProgramDma</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfdmatransaction/nc-wdfdmatransaction-evt_wdf_reserve_dma">EvtReserveDma</a></p>

<p><a rel="noopener" target="_blank" href="wdfdmatransactionstopsystemtransfer">WdfDmaTransactionStopSystemTransfer</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfdmatransaction/nf-wdfdmatransaction-wdfdmatransactioncancel">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdfdmatransaction/nf-wdfdmatransaction-wdfdmatransactioncancel.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
