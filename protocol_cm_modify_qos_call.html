<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PROTOCOL_CM_MODIFY_QOS_CALL - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PROTOCOL_CM_MODIFY_QOS_CALL - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PROTOCOL_CM_MODIFY_QOS_CALL - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PROTOCOL_CM_MODIFY_QOS_CALL ProtocolCmModifyQosCall;

NDIS_STATUS ProtocolCmModifyQosCall(
  [in] NDIS_HANDLE CallMgrVcContext,
  [in] PCO_CALL_PARAMETERS CallParameters
)
{...}</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cm_modify_qos_call">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/protocol_cm_modify_qos_call.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-ndis-protocol_cm_modify_qos_call)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="protocol_cm_modify_qos_call-callback-function">PROTOCOL_CM_MODIFY_QOS_CALL callback function</h1>

<h2 id="description">Description</h2>

<p>The
<em>ProtocolCmModifyCallQoS</em> function is required.
<em>ProtocolCmModifyCallQoS</em> is called by NDIS when a connection-oriented client requests that the call
parameters be changed for an existing virtual connection (VC). If the underlying network medium does not
support QoS,
<em>ProtocolCmModifyQoS</em> should simply return NDIS_STATUS_NOT_SUPPORTED.</p>

<p><strong>Note</strong> You must declare the function by using the <strong>PROTOCOL_CM_MODIFY_QOS_CALL</strong> type.
For more information, see the following Examples section.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="callmgrvccontext-in"><code>CallMgrVcContext</code> [in]</h3>

<p>Specifies the handle to a call manager-allocated context area in which the call manager maintains
its per-VC state. The call manager supplied this handle to NDIS for its
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_create_vc">ProtocolCoCreateVc</a> function.</p>

<h3 id="callparameters-in"><code>CallParameters</code> [in]</h3>

<p>Pointer to a
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/hardware/network/ff545384(v=vs.85)">CO_CALL_PARAMETERS</a> structure that contains
the new call parameters, as specified by a connection-oriented client, for the VC.</p>

<h2 id="return-value">Return value</h2>

<p><em>ProtocolCmModifyQoS</em> returns the status of its operation(s) as one of the following values:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_STATUS_SUCCESS</strong></td>
  <td>Indicates that the call manager successfully changed the parameters of the call with the network to the call parameters specified at <em>CallParameters</em> .</td>
</tr>
<tr>
  <td><strong>NDIS_STATUS_PENDING</strong></td>
  <td>Indicates that the call manager will complete the request to modify the call parameters asynchronously. When the call manager has completed all operations necessary to modify the call parameters, it must call <a href="ndiscmmodifycallqoscomplete" title="VOID NdisCmModifyCallQoSComplete(&#10;  [in] NDIS_STATUS         Status,&#10;  [in] NDIS_HANDLE         NdisVcHandle,&#10;  [in] PCO_CALL_PARAMETERS CallParameters&#10;);">NdisCmModifyCallQoSComplete</a>.</td>
</tr>
<tr>
  <td><strong>NDIS_STATUS_RESOURCES</strong></td>
  <td>Indicates that the call manager could not change the call parameters of the VC because dynamically allocated resources were not available.</td>
</tr>
<tr>
  <td><strong>NDIS_STATUS_INVALID_DATA</strong></td>
  <td>Indicates that the call manager was unable to change the call parameters of the VC because the call parameters provided at <em>CallParameters</em> were illegal or invalid.</td>
</tr>
<tr>
  <td><strong>NDIS_STATUS_FAILURE</strong></td>
  <td>Indicates that the call parameters could not be set to the call parameters provided because of a failure in the network or in another connection-oriented network component.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p><em>ProtocolCmModifyQoS</em> communicates with network control devices or other media-specific agents, as
necessitated by its media, to modify the media-specific call parameters for an established virtual
connection. If the call manager is required to communicate with network control agents (in other words, a
networking switch) it should use a virtual connection to the network control agents that it established
in its
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_bind_adapter_ex">ProtocolBindAdapterEx</a> function.
Stand-alone call managers communicated to the network agents by calling
<a href="ndiscosendnetbufferlists" title="VOID NdisCoSendNetBufferLists(&#10;  [in] NDIS_HANDLE      NdisVcHandle,&#10;  [in] PNET_BUFFER_LIST NetBufferLists,&#10;  [in] ULONG            SendFlags&#10;);">NdisCoSendNetBufferLists</a>.
Miniport drivers with integrated call-management support never call
<strong><a href="ndiscosendnetbufferlists" title="VOID NdisCoSendNetBufferLists(&#10;  [in] NDIS_HANDLE      NdisVcHandle,&#10;  [in] PNET_BUFFER_LIST NetBufferLists,&#10;  [in] ULONG            SendFlags&#10;);">NdisCoSendNetBufferLists</a></strong>. Instead, such a driver simply transfers the data over the network to the
target network agent.</p>

<p>After communicating with the network and if the changes were successful, the call manager must then
call
<a href="ndiscmactivatevc" title="NDIS_STATUS NdisCmActivateVc(&#10;  [in]      NDIS_HANDLE         NdisVcHandle,&#10;  [in, out] PCO_CALL_PARAMETERS CallParameters&#10;);">NdisCmActivateVc</a> with the new call
parameters. This notifies NDIS and/or the connection-oriented miniport driver that the call parameters
have changed and provides the miniport driver with an opportunity to validate those parameters.</p>

<p>If either the network cannot accept the new call parameters or the underlying miniport driver cannot
accept the parameters, the call manager must restore the virtual connection to the state that existed
before any modifications were attempted, and return NDIS_STATUS_FAILURE.</p>

<h3 id="examples">Examples</h3>

<p>To define a <em>ProtocolCmModifyCallQoS</em> function, you must first provide a function declaration that identifies the type of function you're defining. Windows provides a set of function types for drivers. Declaring a function using the function types helps <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/code-analysis-for-drivers">Code Analysis for Drivers</a>, <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/static-driver-verifier">Static Driver Verifier</a> (SDV), and other verification tools find errors, and it's a requirement for writing drivers for the Windows operating system.</p>

<p>For example, to define a <em>ProtocolCmModifyCallQoS</em> function that is named "MyCmModifyCallQoS", use the <strong>PROTOCOL_CM_MODIFY_QOS_CALL</strong> type as shown in this code example:</p>

<pre><code>PROTOCOL_CM_MODIFY_QOS_CALL MyCmModifyCallQoS;
</code></pre>

<p>Then, implement your function as follows:</p>

<pre><code>_Use_decl_annotations_
NDIS_STATUS
 MyCmModifyCallQoS(
    NDIS_HANDLE  CallMgrVcContext,
    PCO_CALL_PARAMETERS  CallParameters
    )
  {...}
</code></pre>

<p>The <strong>PROTOCOL_CM_MODIFY_QOS_CALL</strong> function type is defined in the Ndis.h header file. To more accurately identify errors when you run the code analysis tools, be sure to add the _Use_decl_annotations_ annotation to your function definition. The _Use_decl_annotations_ annotation ensures that the annotations that are applied to the <strong>PROTOCOL_CM_MODIFY_QOS_CALL</strong> function type in the header file are used. For more information about the requirements for function declarations, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/declaring-functions-by-using-function-role-types-for-ndis-drivers">Declaring Functions by Using Function Role Types for NDIS Drivers</a>.</p>

<p>For information about _Use_decl_annotations_, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/visualstudio/code-quality/annotating-function-behavior">Annotating Function Behavior</a>.</p>

<h2 id="see-also">See also</h2>

<p><a href="ndiscmactivatevc" title="NDIS_STATUS NdisCmActivateVc(&#10;  [in]      NDIS_HANDLE         NdisVcHandle,&#10;  [in, out] PCO_CALL_PARAMETERS CallParameters&#10;);">NdisCmActivateVc</a></p>

<p><a href="ndiscmmodifycallqoscomplete" title="VOID NdisCmModifyCallQoSComplete(&#10;  [in] NDIS_STATUS         Status,&#10;  [in] NDIS_HANDLE         NdisVcHandle,&#10;  [in] PCO_CALL_PARAMETERS CallParameters&#10;);">NdisCmModifyCallQoSComplete</a></p>

<p><a href="ndiscosendnetbufferlists" title="VOID NdisCoSendNetBufferLists(&#10;  [in] NDIS_HANDLE      NdisVcHandle,&#10;  [in] PNET_BUFFER_LIST NetBufferLists,&#10;  [in] ULONG            SendFlags&#10;);">NdisCoSendNetBufferLists</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_create_vc">ProtocolCoCreateVc</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cm_modify_qos_call">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ndis/nc-ndis-protocol_cm_modify_qos_call.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
