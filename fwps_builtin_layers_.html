<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FWPS_BUILTIN_LAYERS_ - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FWPS_BUILTIN_LAYERS_ - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FWPS_BUILTIN_LAYERS_ - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// fwpsk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef enum FWPS_BUILTIN_LAYERS_ {
  FWPS_LAYER_INBOUND_IPPACKET_V4,
  FWPS_LAYER_INBOUND_IPPACKET_V4_DISCARD,
  FWPS_LAYER_INBOUND_IPPACKET_V6,
  FWPS_LAYER_INBOUND_IPPACKET_V6_DISCARD,
  FWPS_LAYER_OUTBOUND_IPPACKET_V4,
  FWPS_LAYER_OUTBOUND_IPPACKET_V4_DISCARD,
  FWPS_LAYER_OUTBOUND_IPPACKET_V6,
  FWPS_LAYER_OUTBOUND_IPPACKET_V6_DISCARD,
  FWPS_LAYER_IPFORWARD_V4,
  FWPS_LAYER_IPFORWARD_V4_DISCARD,
  FWPS_LAYER_IPFORWARD_V6,
  FWPS_LAYER_IPFORWARD_V6_DISCARD,
  FWPS_LAYER_INBOUND_TRANSPORT_V4,
  FWPS_LAYER_INBOUND_TRANSPORT_V4_DISCARD,
  FWPS_LAYER_INBOUND_TRANSPORT_V6,
  FWPS_LAYER_INBOUND_TRANSPORT_V6_DISCARD,
  FWPS_LAYER_OUTBOUND_TRANSPORT_V4,
  FWPS_LAYER_OUTBOUND_TRANSPORT_V4_DISCARD,
  FWPS_LAYER_OUTBOUND_TRANSPORT_V6,
  FWPS_LAYER_OUTBOUND_TRANSPORT_V6_DISCARD,
  FWPS_LAYER_STREAM_V4,
  FWPS_LAYER_STREAM_V4_DISCARD,
  FWPS_LAYER_STREAM_V6,
  FWPS_LAYER_STREAM_V6_DISCARD,
  FWPS_LAYER_DATAGRAM_DATA_V4,
  FWPS_LAYER_DATAGRAM_DATA_V4_DISCARD,
  FWPS_LAYER_DATAGRAM_DATA_V6,
  FWPS_LAYER_DATAGRAM_DATA_V6_DISCARD,
  FWPS_LAYER_INBOUND_ICMP_ERROR_V4,
  FWPS_LAYER_INBOUND_ICMP_ERROR_V4_DISCARD,
  FWPS_LAYER_INBOUND_ICMP_ERROR_V6,
  FWPS_LAYER_INBOUND_ICMP_ERROR_V6_DISCARD,
  FWPS_LAYER_OUTBOUND_ICMP_ERROR_V4,
  FWPS_LAYER_OUTBOUND_ICMP_ERROR_V4_DISCARD,
  FWPS_LAYER_OUTBOUND_ICMP_ERROR_V6,
  FWPS_LAYER_OUTBOUND_ICMP_ERROR_V6_DISCARD,
  FWPS_LAYER_ALE_RESOURCE_ASSIGNMENT_V4,
  FWPS_LAYER_ALE_RESOURCE_ASSIGNMENT_V4_DISCARD,
  FWPS_LAYER_ALE_RESOURCE_ASSIGNMENT_V6,
  FWPS_LAYER_ALE_RESOURCE_ASSIGNMENT_V6_DISCARD,
  FWPS_LAYER_ALE_AUTH_LISTEN_V4,
  FWPS_LAYER_ALE_AUTH_LISTEN_V4_DISCARD,
  FWPS_LAYER_ALE_AUTH_LISTEN_V6,
  FWPS_LAYER_ALE_AUTH_LISTEN_V6_DISCARD,
  FWPS_LAYER_ALE_AUTH_RECV_ACCEPT_V4,
  FWPS_LAYER_ALE_AUTH_RECV_ACCEPT_V4_DISCARD,
  FWPS_LAYER_ALE_AUTH_RECV_ACCEPT_V6,
  FWPS_LAYER_ALE_AUTH_RECV_ACCEPT_V6_DISCARD,
  FWPS_LAYER_ALE_AUTH_CONNECT_V4,
  FWPS_LAYER_ALE_AUTH_CONNECT_V4_DISCARD,
  FWPS_LAYER_ALE_AUTH_CONNECT_V6,
  FWPS_LAYER_ALE_AUTH_CONNECT_V6_DISCARD,
  FWPS_LAYER_ALE_FLOW_ESTABLISHED_V4,
  FWPS_LAYER_ALE_FLOW_ESTABLISHED_V4_DISCARD,
  FWPS_LAYER_ALE_FLOW_ESTABLISHED_V6,
  FWPS_LAYER_ALE_FLOW_ESTABLISHED_V6_DISCARD,
  FWPS_LAYER_INBOUND_MAC_FRAME_ETHERNET,
  FWPS_LAYER_OUTBOUND_MAC_FRAME_ETHERNET,
  FWPS_LAYER_RESERVED1_V4,
  FWPS_LAYER_RESERVED1_V6,
  FWPS_LAYER_NAME_RESOLUTION_CACHE_V4,
  FWPS_LAYER_NAME_RESOLUTION_CACHE_V6,
  FWPS_LAYER_ALE_RESOURCE_RELEASE_V4,
  FWPS_LAYER_ALE_RESOURCE_RELEASE_V6,
  FWPS_LAYER_ALE_ENDPOINT_CLOSURE_V4,
  FWPS_LAYER_ALE_ENDPOINT_CLOSURE_V6,
  FWPS_LAYER_ALE_CONNECT_REDIRECT_V4,
  FWPS_LAYER_ALE_CONNECT_REDIRECT_V6,
  FWPS_LAYER_ALE_BIND_REDIRECT_V4,
  FWPS_LAYER_ALE_BIND_REDIRECT_V6,
  FWPS_LAYER_STREAM_PACKET_V4,
  FWPS_LAYER_STREAM_PACKET_V6,
  FWPS_LAYER_INGRESS_VSWITCH_ETHERNET,
  FWPS_LAYER_EGRESS_VSWITCH_ETHERNET,
  FWPS_LAYER_INGRESS_VSWITCH_TRANSPORT_V4,
  FWPS_LAYER_INGRESS_VSWITCH_TRANSPORT_V6,
  FWPS_LAYER_EGRESS_VSWITCH_TRANSPORT_V4,
  FWPS_LAYER_EGRESS_VSWITCH_TRANSPORT_V6,
  FWPS_LAYER_INBOUND_TRANSPORT_FAST,
  FWPS_LAYER_OUTBOUND_TRANSPORT_FAST,
  FWPS_LAYER_INBOUND_MAC_FRAME_NATIVE_FAST,
  FWPS_LAYER_OUTBOUND_MAC_FRAME_NATIVE_FAST,
  FWPS_LAYER_INBOUND_RESERVED2,
  FWPS_LAYER_RESERVED_LAYER_9,
  FWPS_LAYER_RESERVED_LAYER_10,
  FWPS_LAYER_OUTBOUND_NETWORK_CONNECTION_POLICY_V4,
  FWPS_LAYER_OUTBOUND_NETWORK_CONNECTION_POLICY_V6,
  FWPS_LAYER_IPSEC_KM_DEMUX_V4,
  FWPS_LAYER_IPSEC_KM_DEMUX_V6,
  FWPS_LAYER_IPSEC_V4,
  FWPS_LAYER_IPSEC_V6,
  FWPS_LAYER_IKEEXT_V4,
  FWPS_LAYER_IKEEXT_V6,
  FWPS_LAYER_RPC_UM,
  FWPS_LAYER_RPC_EPMAP,
  FWPS_LAYER_RPC_EP_ADD,
  FWPS_LAYER_RPC_PROXY_CONN,
  FWPS_LAYER_RPC_PROXY_IF,
  FWPS_LAYER_KM_AUTHORIZATION,
  FWPS_BUILTIN_LAYER_MAX
} FWPS_BUILTIN_LAYERS;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/ne-fwpsk-fwps_builtin_layers">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/fwps_builtin_layers_.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ne-fwpsk-fwps_builtin_layers)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2 id="description">Description</h2>

<p>Defines constants that specify built-in run-time filtering layer identifiers. Each is represented by a locally unique identifier (<a href="luid" title="typedef struct _LUID {&#10;  DWORD LowPart;&#10;  LONG  HighPart;&#10;} LUID, *PLUID;">LUID</a>), which is 64 bits in size.</p>

<h2 id="constants">Constants</h2>

<h3 id="fwps_layer_inbound_ippacket_v4"><code>FWPS_LAYER_INBOUND_IPPACKET_V4</code></h3>

<p>This filtering layer is located in the receive path just after the IP header of a received packet has been parsed but before any IP header processing takes place. No IPsec decryption or reassembly has occurred.</p>

<h3 id="fwps_layer_inbound_ippacket_v4_discard"><code>FWPS_LAYER_INBOUND_IPPACKET_V4_DISCARD</code></h3>

<p>This filtering layer is located in the receive path for processing any received packets that have been discarded at the network layer.</p>

<h3 id="fwps_layer_inbound_ippacket_v6"><code>FWPS_LAYER_INBOUND_IPPACKET_V6</code></h3>

<p>This filtering layer is located in the receive path just after the IP header of a received packet has been parsed but before any IP header processing takes place. No IPsec decryption or reassembly has occurred.</p>

<h3 id="fwps_layer_inbound_ippacket_v6_discard"><code>FWPS_LAYER_INBOUND_IPPACKET_V6_DISCARD</code></h3>

<p>This filtering layer is located in the receive path for processing any received packets that have been discarded at the network layer.</p>

<h3 id="fwps_layer_outbound_ippacket_v4"><code>FWPS_LAYER_OUTBOUND_IPPACKET_V4</code></h3>

<p>This filtering layer is located in the send path just before the sent packet is evaluated for fragmentation. All IP header processing is complete and all extension headers are in place. Any IPsec authentication and encryption has already occurred.</p>

<h3 id="fwps_layer_outbound_ippacket_v4_discard"><code>FWPS_LAYER_OUTBOUND_IPPACKET_V4_DISCARD</code></h3>

<p>This filtering layer is located in the send path for processing any sent packets that have been discarded at the network layer.</p>

<h3 id="fwps_layer_outbound_ippacket_v6"><code>FWPS_LAYER_OUTBOUND_IPPACKET_V6</code></h3>

<p>This filtering layer is located in the send path just before the sent packet is evaluated for fragmentation. All IP header processing is complete and all extension headers are in place. Any IPsec authentication and encryption has already occurred.</p>

<h3 id="fwps_layer_outbound_ippacket_v6_discard"><code>FWPS_LAYER_OUTBOUND_IPPACKET_V6_DISCARD</code></h3>

<p>This filtering layer is located in the send path for processing any sent packets that have been discarded at the network layer.</p>

<h3 id="fwps_layer_ipforward_v4"><code>FWPS_LAYER_IPFORWARD_V4</code></h3>

<p>This filtering layer is located in the forwarding path at the point where a received packet is forwarded.</p>

<h3 id="fwps_layer_ipforward_v4_discard"><code>FWPS_LAYER_IPFORWARD_V4_DISCARD</code></h3>

<p>This filtering layer is located in the forwarding path for processing any forwarded packets that have been discarded at the forward layer.</p>

<h3 id="fwps_layer_ipforward_v6"><code>FWPS_LAYER_IPFORWARD_V6</code></h3>

<p>This filtering layer is located in the forwarding path at the point where a received packet is forwarded.</p>

<h3 id="fwps_layer_ipforward_v6_discard"><code>FWPS_LAYER_IPFORWARD_V6_DISCARD</code></h3>

<p>This filtering layer is located in the forwarding path for processing any forwarded packets that have been discarded at the forward layer.</p>

<h3 id="fwps_layer_inbound_transport_v4"><code>FWPS_LAYER_INBOUND_TRANSPORT_V4</code></h3>

<p>This filtering layer is located in the receive path just after a received packet's header has been parsed by the network stack at the transport layer, but before any transport layer processing takes place.</p>

<h3 id="fwps_layer_inbound_transport_v4_discard"><code>FWPS_LAYER_INBOUND_TRANSPORT_V4_DISCARD</code></h3>

<p>This filtering layer is located in the receive path for processing any received packets that have been discarded at the transport layer.</p>

<h3 id="fwps_layer_inbound_transport_v6"><code>FWPS_LAYER_INBOUND_TRANSPORT_V6</code></h3>

<p>This filtering layer is located in the receive path just after a received packet's header has been parsed by the network stack at the transport layer, but before any transport layer processing takes place.</p>

<h3 id="fwps_layer_inbound_transport_v6_discard"><code>FWPS_LAYER_INBOUND_TRANSPORT_V6_DISCARD</code></h3>

<p>This filtering layer is located in the receive path for processing any received packets that have been discarded at the transport layer.</p>

<h3 id="fwps_layer_outbound_transport_v4"><code>FWPS_LAYER_OUTBOUND_TRANSPORT_V4</code></h3>

<p>This filtering layer is located in the send path just after a sent packet has been passed to the network layer for processing but before any network layer processing takes place. This filtering layer is located at the top of the network layer instead of at the bottom of the transport layer so that any packets that are sent by third-party transports or as raw packets are filtered at this layer.</p>

<h3 id="fwps_layer_outbound_transport_v4_discard"><code>FWPS_LAYER_OUTBOUND_TRANSPORT_V4_DISCARD</code></h3>

<p>This filtering layer is located in the send path for processing any sent packets that have been discarded at the transport layer.</p>

<h3 id="fwps_layer_outbound_transport_v6"><code>FWPS_LAYER_OUTBOUND_TRANSPORT_V6</code></h3>

<p>This filtering layer is located in the send path just after a sent packet has been passed to the network layer for processing but before any network layer processing takes place. This filtering layer is located at the top of the network layer instead of at the bottom of the transport layer so that any packets that are sent by third-party transports or as raw packets are filtered at this layer.</p>

<h3 id="fwps_layer_outbound_transport_v6_discard"><code>FWPS_LAYER_OUTBOUND_TRANSPORT_V6_DISCARD</code></h3>

<p>This filtering layer is located in the send path for processing any sent packets that have been discarded at the transport layer.</p>

<h3 id="fwps_layer_stream_v4"><code>FWPS_LAYER_STREAM_V4</code></h3>

<p>This filtering layer is located in the stream data path. This layer allows for processing network data on a per stream basis. At the stream layer, the network data is bidirectional.</p>

<h3 id="fwps_layer_stream_v4_discard"><code>FWPS_LAYER_STREAM_V4_DISCARD</code></h3>

<p>This filtering layer is reserved for future use.</p>

<h3 id="fwps_layer_stream_v6"><code>FWPS_LAYER_STREAM_V6</code></h3>

<p>This filtering layer is located in the stream data path. This layer allows for processing network data on a per stream basis. At the stream layer, the network data is bidirectional.</p>

<h3 id="fwps_layer_stream_v6_discard"><code>FWPS_LAYER_STREAM_V6_DISCARD</code></h3>

<p>This filtering layer is reserved for future use.</p>

<h3 id="fwps_layer_datagram_data_v4"><code>FWPS_LAYER_DATAGRAM_DATA_V4</code></h3>

<p>This filtering layer is located in the datagram data path. This layer allows for processing network data on a per datagram basis. At the datagram layer, the network data is bidirectional.</p>

<h3 id="fwps_layer_datagram_data_v4_discard"><code>FWPS_LAYER_DATAGRAM_DATA_V4_DISCARD</code></h3>

<p>This filtering layer is located in the datagram data path for processing any datagrams that have been discarded.</p>

<h3 id="fwps_layer_datagram_data_v6"><code>FWPS_LAYER_DATAGRAM_DATA_V6</code></h3>

<p>This filtering layer is located in the datagram data path. This layer allows for processing network data on a per datagram basis. At the datagram layer, the network data is bidirectional.</p>

<h3 id="fwps_layer_datagram_data_v6_discard"><code>FWPS_LAYER_DATAGRAM_DATA_V6_DISCARD</code></h3>

<p>This filtering layer is located in the datagram data path for processing any datagrams that have been discarded.</p>

<h3 id="fwps_layer_inbound_icmp_error_v4"><code>FWPS_LAYER_INBOUND_ICMP_ERROR_V4</code></h3>

<p>This filtering layer is located in the receive path for processing received ICMP messages for the transport protocol.</p>

<h3 id="fwps_layer_inbound_icmp_error_v4_discard"><code>FWPS_LAYER_INBOUND_ICMP_ERROR_V4_DISCARD</code></h3>

<p>This filtering layer is located in the receive path for processing received ICMP messages that have been discarded.</p>

<h3 id="fwps_layer_inbound_icmp_error_v6"><code>FWPS_LAYER_INBOUND_ICMP_ERROR_V6</code></h3>

<p>This filtering layer is located in the receive path for processing received ICMP messages for the transport protocol.</p>

<h3 id="fwps_layer_inbound_icmp_error_v6_discard"><code>FWPS_LAYER_INBOUND_ICMP_ERROR_V6_DISCARD</code></h3>

<p>This filtering layer is located in the receive path for processing received ICMP messages that have been discarded.</p>

<h3 id="fwps_layer_outbound_icmp_error_v4"><code>FWPS_LAYER_OUTBOUND_ICMP_ERROR_V4</code></h3>

<p>This filtering layer is located in the send path for processing sent ICMP messages for the transport protocol.</p>

<h3 id="fwps_layer_outbound_icmp_error_v4_discard"><code>FWPS_LAYER_OUTBOUND_ICMP_ERROR_V4_DISCARD</code></h3>

<p>This filtering layer is located in the send path for processing sent ICMP messages that have been discarded.</p>

<h3 id="fwps_layer_outbound_icmp_error_v6"><code>FWPS_LAYER_OUTBOUND_ICMP_ERROR_V6</code></h3>

<p>This filtering layer is located in the send path for processing sent ICMP messages for the transport protocol.</p>

<h3 id="fwps_layer_outbound_icmp_error_v6_discard"><code>FWPS_LAYER_OUTBOUND_ICMP_ERROR_V6_DISCARD</code></h3>

<p>This filtering layer is located in the send path for processing sent ICMP messages that have been discarded.</p>

<h3 id="fwps_layer_ale_resource_assignment_v4"><code>FWPS_LAYER_ALE_RESOURCE_ASSIGNMENT_V4</code></h3>

<p>This filtering layer allows for authorizing transport port assignments, bind requests, promiscuous mode requests, and raw mode requests.</p>

<h3 id="fwps_layer_ale_resource_assignment_v4_discard"><code>FWPS_LAYER_ALE_RESOURCE_ASSIGNMENT_V4_DISCARD</code></h3>

<p>This filtering layer allows for processing the following discarded items: transport port assignments, bind requests, promiscuous mode requests, and raw mode requests.</p>

<h3 id="fwps_layer_ale_resource_assignment_v6"><code>FWPS_LAYER_ALE_RESOURCE_ASSIGNMENT_V6</code></h3>

<p>This filtering layer allows for authorizing transport port assignments, bind requests, promiscuous mode requests, and raw mode requests.</p>

<h3 id="fwps_layer_ale_resource_assignment_v6_discard"><code>FWPS_LAYER_ALE_RESOURCE_ASSIGNMENT_V6_DISCARD</code></h3>

<p>This filtering layer allows for processing the following discarded items: transport port assignments, bind requests, promiscuous mode requests, and raw mode requests.</p>

<h3 id="fwps_layer_ale_auth_listen_v4"><code>FWPS_LAYER_ALE_AUTH_LISTEN_V4</code></h3>

<p>This filtering layer allows for authorizing TCP listen requests.</p>

<h3 id="fwps_layer_ale_auth_listen_v4_discard"><code>FWPS_LAYER_ALE_AUTH_LISTEN_V4_DISCARD</code></h3>

<p>This filtering layer allows for processing TCP listen requests that have been discarded.</p>

<h3 id="fwps_layer_ale_auth_listen_v6"><code>FWPS_LAYER_ALE_AUTH_LISTEN_V6</code></h3>

<p>This filtering layer allows for authorizing TCP listen requests.</p>

<h3 id="fwps_layer_ale_auth_listen_v6_discard"><code>FWPS_LAYER_ALE_AUTH_LISTEN_V6_DISCARD</code></h3>

<p>This filtering layer allows for processing TCP listen requests that have been discarded.</p>

<h3 id="fwps_layer_ale_auth_recv_accept_v4"><code>FWPS_LAYER_ALE_AUTH_RECV_ACCEPT_V4</code></h3>

<p>This filtering layer allows for authorizing accept requests for incoming TCP connections, as well as authorizing incoming non-TCP traffic based on the first packet received.</p>

<h3 id="fwps_layer_ale_auth_recv_accept_v4_discard"><code>FWPS_LAYER_ALE_AUTH_RECV_ACCEPT_V4_DISCARD</code></h3>

<p>This filtering layer allows for processing accept requests for incoming TCP connections that have been discarded, as well as processing authorizations for incoming non-TCP traffic that have been discarded.</p>

<h3 id="fwps_layer_ale_auth_recv_accept_v6"><code>FWPS_LAYER_ALE_AUTH_RECV_ACCEPT_V6</code></h3>

<p>This filtering layer allows for authorizing accept requests for incoming TCP connections, as well as authorizing incoming non-TCP traffic based on the first packet received.</p>

<h3 id="fwps_layer_ale_auth_recv_accept_v6_discard"><code>FWPS_LAYER_ALE_AUTH_RECV_ACCEPT_V6_DISCARD</code></h3>

<p>This filtering layer allows for processing accept requests for incoming TCP connections that have been discarded, as well as processing authorizations for incoming non-TCP traffic that have been discarded.</p>

<h3 id="fwps_layer_ale_auth_connect_v4"><code>FWPS_LAYER_ALE_AUTH_CONNECT_V4</code></h3>

<p>This filtering layer allows for authorizing connect requests for outgoing TCP connections, as well as authorizing outgoing non-TCP traffic based on the first packet sent.</p>

<h3 id="fwps_layer_ale_auth_connect_v4_discard"><code>FWPS_LAYER_ALE_AUTH_CONNECT_V4_DISCARD</code></h3>

<p>This filtering layer allows for processing connect requests for outgoing TCP connections that have been discarded, as well as processing authorizations for outgoing non-TCP traffic that have been discarded.</p>

<h3 id="fwps_layer_ale_auth_connect_v6"><code>FWPS_LAYER_ALE_AUTH_CONNECT_V6</code></h3>

<p>This filtering layer allows for authorizing connect requests for outgoing TCP connections, as well as authorizing outgoing non-TCP traffic based on the first packet sent.</p>

<h3 id="fwps_layer_ale_auth_connect_v6_discard"><code>FWPS_LAYER_ALE_AUTH_CONNECT_V6_DISCARD</code></h3>

<p>This filtering layer allows for processing connect requests for outgoing TCP connections that have been discarded, as well as processing authorizations for outgoing non-TCP traffic that have been discarded.</p>

<h3 id="fwps_layer_ale_flow_established_v4"><code>FWPS_LAYER_ALE_FLOW_ESTABLISHED_V4</code></h3>

<p>This filtering layer allows for notification of when a TCP connection has been established, or when non-TCP traffic has been authorized.</p>

<h3 id="fwps_layer_ale_flow_established_v4_discard"><code>FWPS_LAYER_ALE_FLOW_ESTABLISHED_V4_DISCARD</code></h3>

<p>This filtering layer allows for processing when an established TCP connection has been discarded at the flow established layer, as well as when authorized non-TCP traffic has been discarded at the flow established layer.</p>

<h3 id="fwps_layer_ale_flow_established_v6"><code>FWPS_LAYER_ALE_FLOW_ESTABLISHED_V6</code></h3>

<p>This filtering layer allows for notification of when a TCP connection has been established, or when non-TCP traffic has been authorized.</p>

<h3 id="fwps_layer_ale_flow_established_v6_discard"><code>FWPS_LAYER_ALE_FLOW_ESTABLISHED_V6_DISCARD</code></h3>

<p>This filtering layer allows for processing when an established TCP connection has been discarded at the flow established layer, as well as when authorized non-TCP traffic has been discarded at the flow established layer.</p>

<h3 id="fwps_layer_inbound_mac_frame_ethernet"><code>FWPS_LAYER_INBOUND_MAC_FRAME_ETHERNET</code></h3>

<p>This filtering layer allows for inspecting the MAC frame data at the inbound lower (to the NDIS protocol driver) layer. Note: Available only on Windows 8 and later.</p>

<h3 id="fwps_layer_outbound_mac_frame_ethernet"><code>FWPS_LAYER_OUTBOUND_MAC_FRAME_ETHERNET</code></h3>

<p>This filtering layer allows for inspecting the MAC frame data at the outbound upper (to the NDIS protocol driver) layer. Note: Available only on Windows 8 and later.</p>

<h3 id="fwps_layer_reserved1_v4"><code>FWPS_LAYER_RESERVED1_V4</code></h3>

<p>This filtering layer is not supported.</p>

<h3 id="fwps_layer_reserved1_v6"><code>FWPS_LAYER_RESERVED1_V6</code></h3>

<p>This filtering layer is not supported.</p>

<h3 id="fwps_layer_name_resolution_cache_v4"><code>FWPS_LAYER_NAME_RESOLUTION_CACHE_V4</code></h3>

<p>This filtering layer allows for querying the names recently resolved by the system.</p>

<h3 id="fwps_layer_name_resolution_cache_v6"><code>FWPS_LAYER_NAME_RESOLUTION_CACHE_V6</code></h3>

<p>This filtering layer allows for querying the names recently resolved by the system.</p>

<h3 id="fwps_layer_ale_resource_release_v4"><code>FWPS_LAYER_ALE_RESOURCE_RELEASE_V4</code></h3>

<p>This filtering layer is used as an opportunity to reclaim resources allocated by the callout driver in any of the ALE_RESOURCE_ASSIGNMENT layers.</p>

<h3 id="fwps_layer_ale_resource_release_v6"><code>FWPS_LAYER_ALE_RESOURCE_RELEASE_V6</code></h3>

<p>This filtering layer is used as an opportunity to reclaim resources allocated by the callout driver in any of the ALE_RESOURCE_ASSIGNMENT layers.</p>

<h3 id="fwps_layer_ale_endpoint_closure_v4"><code>FWPS_LAYER_ALE_ENDPOINT_CLOSURE_V4</code></h3>

<p>This filtering layer is used as an opportunity to reclaim resources allocated by the callout driver in any of the ALE_AUTH_CONNECT or ALE_AUTH_RECV_ACCEPT layers.</p>

<h3 id="fwps_layer_ale_endpoint_closure_v6"><code>FWPS_LAYER_ALE_ENDPOINT_CLOSURE_V6</code></h3>

<p>This filtering layer is used as an opportunity to reclaim resources allocated by the callout driver in any of the ALE_AUTH_CONNECT or ALE_AUTH_RECV_ACCEPT layers.</p>

<h3 id="fwps_layer_ale_connect_redirect_v4"><code>FWPS_LAYER_ALE_CONNECT_REDIRECT_V4</code></h3>

<p>This filtering layer allows for the redirecting of connect requests to a different IPV4/ IPV6 address and TCP/UDP port.</p>

<h3 id="fwps_layer_ale_connect_redirect_v6"><code>FWPS_LAYER_ALE_CONNECT_REDIRECT_V6</code></h3>

<p>This filtering layer allows for the redirecting of connect requests to a different IPV4/ IPV6 address and TCP/UDP port.</p>

<h3 id="fwps_layer_ale_bind_redirect_v4"><code>FWPS_LAYER_ALE_BIND_REDIRECT_V4</code></h3>

<p>This filtering layer allows for the redirecting of bind requests to a different local IPV4/ IPV6 address and/or local TCP/UDP port.</p>

<h3 id="fwps_layer_ale_bind_redirect_v6"><code>FWPS_LAYER_ALE_BIND_REDIRECT_V6</code></h3>

<p>This filtering layer allows for the redirecting of bind requests to a different local IPV4/ IPV6 address and/or local TCP/UDP port.</p>

<h3 id="fwps_layer_stream_packet_v4"><code>FWPS_LAYER_STREAM_PACKET_V4</code></h3>

<p>This filtering layer allows for inspection of network data on a per-TCP packet basis, including handshake and flow control exchanges. At the stream packet layer, the network data is bidirectional.</p>

<h3 id="fwps_layer_stream_packet_v6"><code>FWPS_LAYER_STREAM_PACKET_V6</code></h3>

<p>This filtering layer allows for inspection of network data on a per-TCP packet basis, including handshake and flow control exchanges. At the stream packet layer, the network data is bidirectional.</p>

<h3 id="fwps_layer_ingress_vswitch_ethernet"><code>FWPS_LAYER_INGRESS_VSWITCH_ETHERNET</code></h3>

<p>This filtering layer allows for inspecting the ingress 802.3 data of the Hyper-V extensible switch. Note: Available only on Windows 8 and later.</p>

<h3 id="fwps_layer_egress_vswitch_ethernet"><code>FWPS_LAYER_EGRESS_VSWITCH_ETHERNET</code></h3>

<p>This filtering layer allows for inspecting the egress 802.3 data of the Hyper-V extensible switch. Note: Available only on Windows 8 and later.</p>

<h3 id="fwps_layer_ingress_vswitch_transport_v4"><code>FWPS_LAYER_INGRESS_VSWITCH_TRANSPORT_V4</code></h3>

<p>This filtering layer allows for inspecting the ingress transport data of the Hyper-V extensible switch. Note: Available only on Windows 8 and later.</p>

<h3 id="fwps_layer_ingress_vswitch_transport_v6"><code>FWPS_LAYER_INGRESS_VSWITCH_TRANSPORT_V6</code></h3>

<p>This filtering layer allows for inspecting the ingress transport data of the Hyper-V extensible switch. Note: Available only on Windows 8 and later.</p>

<h3 id="fwps_layer_egress_vswitch_transport_v4"><code>FWPS_LAYER_EGRESS_VSWITCH_TRANSPORT_V4</code></h3>

<p>This filtering layer allows for inspecting the egress transport data of the Hyper-V extensible switch. Note: Available only on Windows 8 and later.</p>

<h3 id="fwps_layer_egress_vswitch_transport_v6"><code>FWPS_LAYER_EGRESS_VSWITCH_TRANSPORT_V6</code></h3>

<p>This filtering layer allows for inspecting the egress transport data of the Hyper-V extensible switch. Note: Available only on Windows 8 and later.</p>

<h3 id="fwps_layer_inbound_transport_fast"><code>FWPS_LAYER_INBOUND_TRANSPORT_FAST</code></h3>

<p>For internal use only.</p>

<h3 id="fwps_layer_outbound_transport_fast"><code>FWPS_LAYER_OUTBOUND_TRANSPORT_FAST</code></h3>

<p>For internal use only.</p>

<h3 id="fwps_layer_inbound_mac_frame_native_fast"><code>FWPS_LAYER_INBOUND_MAC_FRAME_NATIVE_FAST</code></h3>

<p>This filtering layer allows for inspecting the MAC frame data at the inbound lower (to the NDIS miniport driver) layer. Note: Available only on Windows 8 and later.</p>

<h3 id="fwps_layer_outbound_mac_frame_native_fast"><code>FWPS_LAYER_OUTBOUND_MAC_FRAME_NATIVE_FAST</code></h3>

<p>This filtering layer allows for inspecting the MAC frame data at the outbound lower (to the NDIS miniport driver) layer. Note: Available only on Windows 8 and later.</p>

<h3 id="fwps_layer_inbound_reserved2"><code>FWPS_LAYER_INBOUND_RESERVED2</code></h3>

<p>Reserved for system use.</p>

<h3 id="fwps_layer_reserved_layer_9"><code>FWPS_LAYER_RESERVED_LAYER_9</code></h3>

<p>Reserved for system use.</p>

<h3 id="fwps_layer_reserved_layer_10"><code>FWPS_LAYER_RESERVED_LAYER_10</code></h3>

<p>Reserved for system use.</p>

<h3 id="fwps_layer_outbound_network_connection_policy_v4"><code>FWPS_LAYER_OUTBOUND_NETWORK_CONNECTION_POLICY_V4</code></h3>

<p>A callout layer where a WFP filter driver can inspect an outgoing IPv4 connection and read or write the routing policy that was configured for this connection. See <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpmk/nf-fwpmk-fwpmconnectionpolicyadd0">FwpmConnectionPolicyAdd0</a>.</p>

<h3 id="fwps_layer_outbound_network_connection_policy_v6"><code>FWPS_LAYER_OUTBOUND_NETWORK_CONNECTION_POLICY_V6</code></h3>

<p>A callout layer where a WFP Filter Driver can inspect an outgoing IPv6 connection and read/write the routing policy that was configured for this connection. See <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpmk/nf-fwpmk-fwpmconnectionpolicyadd0">FwpmConnectionPolicyAdd0</a>.</p>

<h3 id="fwps_layer_ipsec_km_demux_v4"><code>FWPS_LAYER_IPSEC_KM_DEMUX_V4</code></h3>

<p>This filtering layer is used to determine which keying modules are invoked when the local system is the initiator. This is a user-mode filtering layer.</p>

<h3 id="fwps_layer_ipsec_km_demux_v6"><code>FWPS_LAYER_IPSEC_KM_DEMUX_V6</code></h3>

<p>This filtering layer is used to determine which keying modules are invoked when the local system is the initiator. This is a user-mode filtering layer.</p>

<h3 id="fwps_layer_ipsec_v4"><code>FWPS_LAYER_IPSEC_V4</code></h3>

<p>This filtering layer allows the keying module to look up quick-mode policy information when negotiating quick-mode security associations. This is a user-mode filtering layer.</p>

<h3 id="fwps_layer_ipsec_v6"><code>FWPS_LAYER_IPSEC_V6</code></h3>

<p>This filtering layer allows the keying module to look up quick-mode policy information when negotiating quick-mode security associations. This is a user-mode filtering layer.</p>

<h3 id="fwps_layer_ikeext_v4"><code>FWPS_LAYER_IKEEXT_V4</code></h3>

<p>This filtering layer allows the IKE and authenticated IP modules to look up main-mode policy information when negotiating main-mode security associations. This is a user-mode filtering layer.</p>

<h3 id="fwps_layer_ikeext_v6"><code>FWPS_LAYER_IKEEXT_V6</code></h3>

<p>This filtering layer allows the IKE and authenticated IP modules to look up main-mode policy information when negotiating main-mode security associations. This is a user-mode filtering layer.</p>

<h3 id="fwps_layer_rpc_um"><code>FWPS_LAYER_RPC_UM</code></h3>

<p>This filtering layer allows for inspecting the RPC data fields that are available in user mode. This is a user-mode filtering layer.</p>

<h3 id="fwps_layer_rpc_epmap"><code>FWPS_LAYER_RPC_EPMAP</code></h3>

<p>This filtering layer allows for inspecting the RPC data fields that are available in user mode during endpoint resolution. This is a user-mode filtering layer.</p>

<h3 id="fwps_layer_rpc_ep_add"><code>FWPS_LAYER_RPC_EP_ADD</code></h3>

<p>This filtering layer allows for inspecting the RPC data fields that are available in user mode when a new endpoint is added. This is a user-mode filtering layer.</p>

<h3 id="fwps_layer_rpc_proxy_conn"><code>FWPS_LAYER_RPC_PROXY_CONN</code></h3>

<p>This filtering layer allows for inspecting RpcProxy connection requests. This is a user-mode filtering layer.</p>

<h3 id="fwps_layer_rpc_proxy_if"><code>FWPS_LAYER_RPC_PROXY_IF</code></h3>

<p>This filtering layer allows for inspecting the interface used for RpcProxy connections. This is a user-mode filtering layer.</p>

<h3 id="fwps_layer_km_authorization"><code>FWPS_LAYER_KM_AUTHORIZATION</code></h3>

<p>This filtering layer allows for authorizing security association establishment.</p>

<h3 id="fwps_builtin_layer_max"><code>FWPS_BUILTIN_LAYER_MAX</code></h3>

<p>TBD</p>

<h2 id="remarks">Remarks</h2>

<p>The V4 and V6 suffixes at the end of the run-time layer identifiers indicate whether the layer is located in the IPv4 network stack or in the IPv6 network stack.</p>

<p>Each run-time layer identifier has an associated run-time data field identifier that represents a set of constant values. These data field identifiers are declared as <strong>FWPS_FIELDS_XXX</strong> enumerations in <code>fwpsk.h</code>. For more info, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/data-field-identifiers">Data field identifiers</a>.</p>

<h2 id="see-also">See also</h2>

<ul>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpmk/nf-fwpmk-fwpmconnectionpolicyadd0">FwpmConnectionPolicyAdd0</a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/data-field-identifiers">Data field identifiers</a></li>
</ul>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/ne-fwpsk-fwps_builtin_layers">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/fwpsk/ne-fwpsk-fwps_builtin_layers.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
