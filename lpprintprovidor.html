<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="LPPRINTPROVIDOR - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>LPPRINTPROVIDOR - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            LPPRINTPROVIDOR - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// winsplp.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _PRINTPROVIDOR {
  BOOL( )(PWSTR pPrinterName,PHANDLE phPrinter,PPRINTER_DEFAULTS pDefault)    *fpOpenPrinter;
  BOOL( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> JobId,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pJob,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Command)    *fpSetJob;
  BOOL( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> JobId,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pJob,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded)    *fpGetJob;
  BOOL( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> FirstJob,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> NoJobs,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pJob,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded,LPDWORD pcReturned)    *fpEnumJobs;
  HANDLE( )(LPWSTR pName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pPrinter)  *fpAddPrinter;
  BOOL( )(HANDLE hPrinter)    *fpDeletePrinter;
  BOOL( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Command)    *fpSetPrinter;
  BOOL( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded)    *fpGetPrinter;
  BOOL( )(<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Flags,LPWSTR Name,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pPrinterEnum,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded,LPDWORD pcReturned)    *fpEnumPrinters;
  BOOL( )(LPWSTR pName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pDriverInfo)    *fpAddPrinterDriver;
  BOOL( )(LPWSTR pName,LPWSTR pEnvironment,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pDriverInfo,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded,LPDWORD pcReturned)    *fpEnumPrinterDrivers;
  BOOL( )(HANDLE hPrinter,LPWSTR pEnvironment,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pDriverInfo,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded)    *fpGetPrinterDriver;
  BOOL( )(LPWSTR pName,LPWSTR pEnvironment,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pDriverDirectory,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded)    *fpGetPrinterDriverDirectory;
  BOOL( )(LPWSTR pName,LPWSTR pEnvironment,LPWSTR pDriverName)    *fpDeletePrinterDriver;
  BOOL( )(LPWSTR pName,LPWSTR pEnvironment,LPWSTR pPathName,LPWSTR pPrintProcessorName)    *fpAddPrintProcessor;
  BOOL( )(LPWSTR pName,LPWSTR pEnvironment,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pPrintProcessorInfo,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded,LPDWORD pcReturned)    *fpEnumPrintProcessors;
  BOOL( )(LPWSTR pName,LPWSTR pEnvironment,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pPrintProcessorInfo,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded)    *fpGetPrintProcessorDirectory;
  BOOL( )(LPWSTR pName,LPWSTR pEnvironment,LPWSTR pPrintProcessorName)    *fpDeletePrintProcessor;
  BOOL( )(LPWSTR pName,LPWSTR pPrintProcessorName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pDataypes,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded,LPDWORD pcReturned)    *fpEnumPrintProcessorDatatypes;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pDocInfo)   *fpStartDocPrinter;
  BOOL( )(HANDLE hPrinter)    *fpStartPagePrinter;
  BOOL( )(HANDLE hPrinter,LPVOID pBuf,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcWritten)    *fpWritePrinter;
  BOOL( )(HANDLE hPrinter)    *fpEndPagePrinter;
  BOOL( )(HANDLE hPrinter)    *fpAbortPrinter;
  BOOL( )(HANDLE hPrinter,LPVOID pBuf,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pNoBytesRead)    *fpReadPrinter;
  BOOL( )(HANDLE hPrinter)    *fpEndDocPrinter;
  BOOL( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pData,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded)    *fpAddJob;
  BOOL( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> JobId)    *fpScheduleJob;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,LPWSTR pValueName,LPDWORD pType,LPBYTE pData,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> nSize,LPDWORD pcbNeeded)   *fpGetPrinterData;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,LPWSTR pValueName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Type,LPBYTE pData,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbData)   *fpSetPrinterData;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Flags)   *fpWaitForPrinterChange;
  BOOL( )(HANDLE hPrinter)    *fpClosePrinter;
  BOOL( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pForm)    *fpAddForm;
  BOOL( )(HANDLE hPrinter,LPWSTR pFormName)    *fpDeleteForm;
  BOOL( )(HANDLE hPrinter,LPWSTR pFormName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pForm,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded)    *fpGetForm;
  BOOL( )(HANDLE hPrinter,LPWSTR pFormName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pForm)    *fpSetForm;
  BOOL( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pForm,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded,LPDWORD pcReturned)    *fpEnumForms;
  BOOL( )(LPWSTR pName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pMonitors,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded,LPDWORD pcReturned)    *fpEnumMonitors;
  BOOL( )(LPWSTR pName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pPorts,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded,LPDWORD pcReturned)    *fpEnumPorts;
  BOOL( )(LPWSTR pName,HWND hWnd,LPWSTR pMonitorName)    *fpAddPort;
  BOOL( )(LPWSTR pName,HWND hWnd,LPWSTR pPortName)    *fpConfigurePort;
  BOOL( )(LPWSTR pName,HWND hWnd,LPWSTR pPortName)    *fpDeletePort;
  HANDLE( )(HANDLE hPrinter,LPDEVMODEW pDevMode)  *fpCreatePrinterIC;
  BOOL( )(HANDLE hPrinterIC,LPBYTE pIn,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cIn,LPBYTE pOut,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cOut,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> ul)    *fpPlayGdiScriptOnPrinterIC;
  BOOL( )(HANDLE hPrinterIC)    *fpDeletePrinterIC;
  BOOL( )(LPWSTR pName)    *fpAddPrinterConnection;
  BOOL( )(LPWSTR pName)    *fpDeletePrinterConnection;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Error,HWND hWnd,LPWSTR pText,LPWSTR pCaption,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwType)   *fpPrinterMessageBox;
  BOOL( )(LPWSTR pName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pMonitorInfo)    *fpAddMonitor;
  BOOL( )(LPWSTR pName,LPWSTR pEnvironment,LPWSTR pMonitorName)    *fpDeleteMonitor;
  BOOL( )(HANDLE hPrinter,LPPRINTER_DEFAULTS pDefault)    *fpResetPrinter;
  BOOL( )(HANDLE hPrinter,LPWSTR pEnvironment,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pDriverInfo,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwClientMajorVersion,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwClientMinorVersion,PDWORD pdwServerMajorVersion,PDWORD pdwServerMinorVersion)    *fpGetPrinterDriverEx;
  BOOL( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> fdwFlags,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> fdwOptions,HANDLE hNotify,PDWORD pfdwStatus,PVOID pPrinterNotifyOptions,PVOID pPrinterNotifyInit)    *fpFindFirstPrinterChangeNotification;
  BOOL( )(HANDLE hPrinter)    *fpFindClosePrinterChangeNotification;
  BOOL( )(LPWSTR pName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE lpBuffer,LPWSTR lpMonitorName)    *fpAddPortEx;
  BOOL( )(LPVOID pvReserved)    *fpShutDown;
  BOOL( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Reserved,PVOID pvReserved,PVOID pPrinterNotifyInfo)    *fpRefreshPrinterChangeNotification;
  BOOL( )(LPWSTR pPrinterName,LPHANDLE phPrinter,LPPRINTER_DEFAULTS pDefault,LPBYTE pClientInfo,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level)    *fpOpenPrinterEx;
  HANDLE( )(LPWSTR pName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pPrinter,LPBYTE pClientInfo,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> ClientInfoLevel)  *fpAddPrinterEx;
  BOOL( )(LPWSTR pName,LPWSTR pPortName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pPortInfo)    *fpSetPort;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwIndex,LPWSTR pValueName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbValueName,LPDWORD pcbValueName,LPDWORD pType,LPBYTE pData,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbData,LPDWORD pcbData)   *fpEnumPrinterData;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,LPWSTR pValueName)   *fpDeletePrinterData;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(LPCTSTR pszServer,LPCTSTR pszResource,PHANDLE phSpooler,LPCTSTR pszName,LPCTSTR pszAddress)   *fpClusterSplOpen;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hSpooler)   *fpClusterSplClose;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hSpooler)   *fpClusterSplIsAlive;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,LPCWSTR pKeyName,LPCWSTR pValueName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Type,LPBYTE pData,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbData)   *fpSetPrinterDataEx;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,LPCWSTR pKeyName,LPCWSTR pValueName,LPDWORD pType,LPBYTE pData,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> nSize,LPDWORD pcbNeeded)   *fpGetPrinterDataEx;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,LPCWSTR pKeyName,LPBYTE pEnumValues,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbEnumValues,LPDWORD pcbEnumValues,LPDWORD pnEnumValues)   *fpEnumPrinterDataEx;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,LPCWSTR pKeyName,LPWSTR pSubkey,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbSubkey,LPDWORD pcbSubkey)   *fpEnumPrinterKey;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,LPCWSTR pKeyName,LPCWSTR pValueName)   *fpDeletePrinterDataEx;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,LPCWSTR pKeyName)   *fpDeletePrinterKey;
  BOOL( )(HANDLE hPrinter,LARGE_INTEGER liDistanceToMove,PLARGE_INTEGER pliNewPointer,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwMoveMethod,BOOL bWrite)    *fpSeekPrinter;
  BOOL( )(LPWSTR pName,LPWSTR pEnvironment,LPWSTR pDriverName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwDeleteFlag,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwVersionNum)    *fpDeletePrinterDriverEx;
  BOOL( )(LPCWSTR pServer,LPCWSTR pPrinterName,LPCWSTR pPrintServer,LPCWSTR pProvider)    *fpAddPerMachineConnection;
  BOOL( )(LPCWSTR pServer,LPCWSTR pPrinterName)    *fpDeletePerMachineConnection;
  BOOL( )(LPCWSTR pServer,LPBYTE pPrinterEnum,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded,LPDWORD pcReturned)    *fpEnumPerMachineConnections;
  BOOL( )(HANDLE hXcv,LPCWSTR pszDataName,PBYTE pInputData,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbInputData,PBYTE pOutputData,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbOutputData,PDWORD pcbOutputNeeded,PDWORD pdwStatus)    *fpXcvData;
  BOOL( )(LPWSTR pName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pDriverInfo,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwFileCopyFlags)    *fpAddPrinterDriverEx;
  BOOL()(HANDLE hPrinter,LPBYTE *pBuf,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf)    * fpSplReadPrinter;
  BOOL( )(LPWSTR pDriverFile)    *fpDriverUnloadComplete;
  BOOL()(HANDLE hPrinter,LPWSTR *pSpoolDir,LPHANDLE phFile,HANDLE hSpoolerProcess,HANDLE hAppProcess)    * fpGetSpoolFileInfo;
  BOOL( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbCommit)    *fpCommitSpoolData;
  BOOL( )(HANDLE hPrinter)    *fpCloseSpoolFileHandle;
  BOOL( )(HANDLE hPrinter,LPBYTE pBuf,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcWritten,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cSleep)    *fpFlushPrinter;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>()(HANDLE hPrinter,LPCWSTR pAction,<a href="bidi_request_container" title="typedef struct _BIDI_REQUEST_CONTAINER {&#10;  DWORD             Version;&#10;  DWORD             Flags;&#10;  DWORD             Count;&#10;  BIDI_REQUEST_DATA aData[1];&#10;} BIDI_REQUEST_CONTAINER, *PBIDI_REQUEST_CONTAINER, *LPBIDI_REQUEST_CONTAINER;">PBIDI_REQUEST_CONTAINER</a> pReqData,<a href="bidi_response_container" title="typedef struct _BIDI_RESPONSE_CONTAINER {&#10;  DWORD              Version;&#10;  DWORD              Flags;&#10;  DWORD              Count;&#10;  BIDI_RESPONSE_DATA aData[1];&#10;} BIDI_RESPONSE_CONTAINER, *PBIDI_RESPONSE_CONTAINER, *LPBIDI_RESPONSE_CONTAINER;">PBIDI_RESPONSE_CONTAINER</a> *ppResData)   * fpSendRecvBidiData;
  BOOL( )(LPCWSTR pName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwLevel,PVOID pInfo)    *fpAddPrinterConnection2;
#if ...
  HRESULT((PCWSTR, const IID &amp;,VOID **) * )fpGetPrintClassObject;
#else
  HRESULT(PCWSTR, const IID *,VOID **) * )(fpGetPrintClassObject;
#endif
  HRESULT( )(HANDLE hPrinter,<a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> jobId,<a href="eprintxpsjoboperation" title="typedef enum {&#10;  kJobProduction,&#10;  kJobConsumption&#10;} EPrintXPSJobOperation;">EPrintXPSJobOperation</a> jobOperation,<a href="eprintxpsjobprogress" title="typedef enum {&#10;  kAddingDocumentSequence,&#10;  kDocumentSequenceAdded,&#10;  kAddingFixedDocument,&#10;  kFixedDocumentAdded,&#10;  kAddingFixedPage,&#10;  kFixedPageAdded,&#10;  kResourceAdded,&#10;  kFontAdded,&#10;  kImageAdded,&#10;  kXpsDocumentCommitted&#10;} EPrintXPSJobProgress;">EPrintXPSJobProgress</a> jobProgress) *fpReportJobProcessingProgress;
  VOID()(<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwLevel,VOID *pfOut)    * fpEnumAndLogProvidorObjects;
  HRESULT( )(HANDLE hPrinter,LPWSTR pEnvironment,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> Level,LPBYTE pDriverInfo,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbBuf,LPDWORD pcbNeeded,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwClientMajorVersion,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwClientMinorVersion,PDWORD pdwServerMajorVersion,PDWORD pdwServerMinorVersion) *fpInternalGetPrinterDriver;
  HRESULT( )(LPCWSTR pcszPnpId,LPCWSTR pcszPortName,LPWSTR pszManufacturerName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cchManufacturerName,LPDWORD pcchRequiredManufacturerNameSize,LPWSTR pszModelName,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cchModelName,LPDWORD pcchRequiredModelNameSize,LPDWORD pdwRank0Matches) *fpFindCompatibleDriver;
  HRESULT( )(LPCWSTR pcszConnectionName) *fpInstallPrinterDriverPackageFromConnection;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>()(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> JobId,PCWSTR pszName,<a href="printpropertyvalue" title="typedef struct {&#10;  EPrintPropertyType ePropertyType;&#10;  union {&#10;    BYTE     propertyByte;&#10;    PWSTR    propertyString;&#10;    LONG     propertyInt32;&#10;    LONGLONG propertyInt64;&#10;    struct {&#10;      DWORD  cbBuf;&#10;      LPVOID pBuf;&#10;    } propertyBlob;&#10;  } value;&#10;} PrintPropertyValue;">PrintPropertyValue</a> *pValue)   * fpGetJobNamedPropertyValue;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>()(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> JobId, const <a href="printnamedproperty" title="typedef struct {&#10;  WCHAR              *propertyName;&#10;  PrintPropertyValue propertyValue;&#10;} PrintNamedProperty;">PrintNamedProperty</a> *pProperty)   * fpSetJobNamedProperty;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> JobId,PCWSTR pszName)   *fpDeleteJobNamedProperty;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> JobId,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> *pcProperties,<a href="printnamedproperty" title="typedef struct {&#10;  WCHAR              *propertyName;&#10;  PrintPropertyValue propertyValue;&#10;} PrintNamedProperty;">PrintNamedProperty</a> **ppProperties)   * )(fpEnumJobNamedProperties;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>()(<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> event,POWERBROADCAST_SETTING *pPowerSetting)   * fpPowerEvent;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>()(HANDLE hPrinter,HKEY *phKey)   * fpGetUserPropertyBag;
  BOOL( )()    *fpCanShutdown;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter,<a href="branchofficejobdatacontainer" title="typedef struct {&#10;  DWORD               cJobDataEntries;&#10;  BranchOfficeJobData JobData[1];&#10;} BranchOfficeJobDataContainer, *PBranchOfficeJobDataContainer, *LPBranchOfficeJobDataContainer;">PBranchOfficeJobDataContainer</a> pJobDataContainer)   *fpLogJobInfoForBranchOffice;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>( )(HANDLE hPrinter)   *fpRegeneratePrintDeviceCapabilities;
  HRESULT( )(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> JobId,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwOperationType,LPBYTE pInputData,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> cbInputData,LPDWORD pcWritten) *fpPrintSupportOperation;
  HRESULT()(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> jobId,PCWSTR pdlFormat,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> jobAttributesBufferSize,PBYTE jobAttributeGroupBuffer,PDWORD ippResponseBufferSize,PBYTE *ippResponseBuffer) * fpIppCreateJobOnPrinter;
  HRESULT(NDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> JobId,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> attributeNameCount, const wchar_t **attributeNames,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> *ippResponseBufferSize,<a href="byte" title="typedef unsigned char BYTE;">BYTE</a> **ippResponseBuffer) * )(HAfpIppGetJobAttributes;
  HRESULT(ANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> JobId,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> jobAttributeGroupBufferSize,<a href="byte" title="typedef unsigned char BYTE;">BYTE</a> *jobAttributeGroupBuffer,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> *ippResponseBufferSize,<a href="byte" title="typedef unsigned char BYTE;">BYTE</a> **ippResponseBuffer) * )(HfpIppSetJobAttributes;
  HRESULT(NDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> attributeNameCount, const wchar_t **attributeNames,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> *ippResponseBufferSize,<a href="byte" title="typedef unsigned char BYTE;">BYTE</a> **ippResponseBuffer) * )(HAfpIppGetPrinterAttributes;
  HRESULT(ANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> jobAttributeGroupBufferSize,<a href="byte" title="typedef unsigned char BYTE;">BYTE</a> *jobAttributeGroupBuffer,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> *ippResponseBufferSize,<a href="byte" title="typedef unsigned char BYTE;">BYTE</a> **ippResponseBuffer) * )(HfpIppSetPrinterAttributes;
  HRESULT()(HANDLE hPrinter,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> jobId,PCWSTR pdlFormat,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> jobAttributesBufferSize,PBYTE jobAttributeGroupBuffer,<a href="dword" title="typedef unsigned long DWORD;">DWORD</a> operationAttributesBufferSize,PBYTE operationAttributeGroupBuffer,PDWORD ippResponseBufferSize,PBYTE *ippResponseBuffer) * fpIppCreateJobOnPrinterWithAttributes;
} PRINTPROVIDOR, *LPPRINTPROVIDOR;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winsplp/ns-winsplp-_printprovidor">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/lpprintprovidor.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-winsplp-_printprovidor)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2 id="description">Description</h2>

<blockquote>
  <p>[!WARNING]
  Starting with Windows 10, the APIs which support third-party print providers are deprecated. Microsoft does not recommend any investment into third-party print providers. Additionally, on Windows 8 and newer products where the v4 print driver model is available, third-party print providers may not create or manage queues which use v4 print drivers.</p>
</blockquote>

<p>The PRINTPROVIDOR structure is used as a parameter to a print provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winsplp/nf-winsplp-initializeprintprovidor">InitializePrintProvidor</a> function. All structure member values are supplied by the provider.</p>

<h2 id="members">Members</h2>

<h3 id="fpopenprinter"><code>fpOpenPrinter</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/openprinter">OpenPrinter</a> function. However, at the provider level, this function must supply one of the <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> return values listed in the following table.</p>

<table>
<thead>
<tr>
  <th>Return value</th>
  <th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
  <td>ROUTER_SUCCESS</td>
  <td>The provider supports the specified printer and has opened it.</td>
</tr>
<tr>
  <td>ROUTER_STOP_ROUTING</td>
  <td>The provider supports the specified printer, but an error occurred and the printer could not be opened. It is assumed that no other provider can support the printer. The function must call <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a>.</td>
</tr>
<tr>
  <td>ROUTER_UNKNOWN</td>
  <td>The provider does not support the specified printer. The function must call <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a> and specify ERROR_INVALID_NAME.</td>
</tr>
</tbody>
</table>

<p>The router calls each provider until one of them returns ROUTER_SUCCESS or ROUTER_STOP_ROUTING. If the provider returns ROUTER_SUCCESS, it must also return a unique handle. For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/introduction-to-print-providers">Introduction to Print Providers</a>.) The router first attempts to call the provider's <strong>OpenPrinterEx</strong> function. If that function is not supported, the router calls <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/openprinter">OpenPrinter</a>.</p>

<h3 id="fpsetjob"><code>fpSetJob</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/setjob">SetJob</a> function.</p>

<h3 id="fpgetjob"><code>fpGetJob</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/getjob">GetJob</a> function.</p>

<h3 id="fpenumjobs"><code>fpEnumJobs</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/enumjobs">EnumJobs</a> function.</p>

<h3 id="fpaddprinter"><code>fpAddPrinter</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/addprinter">AddPrinter</a> function.</p>

<h3 id="fpdeleteprinter"><code>fpDeletePrinter</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/deleteprinter">DeletePrinter</a> function.</p>

<h3 id="fpsetprinter"><code>fpSetPrinter</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/setprinter">SetPrinter</a> function.</p>

<h3 id="fpgetprinter"><code>fpGetPrinter</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/getprinter">GetPrinter</a> function. If you are <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/writing-a-network-print-provider">writing a network print provider</a> and <strong>GetPrinter</strong> is returning a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/printer-info-2">PRINTER_INFO_2</a> structure, the function should supply only the <strong>cJobs</strong> and <strong>Status</strong> structure members. The <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/local-print-provider">local print provider</a>) supplies the rest of the structure members.</p>

<h3 id="fpenumprinters"><code>fpEnumPrinters</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/enumprinters">EnumPrinters</a> function.</p>

<h3 id="fpaddprinterdriver"><code>fpAddPrinterDriver</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/addprinterdriver">AddPrinterDriver</a> function. If the provider does not support the specified driver or server, it should specify ERROR_INVALID_NAME to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a> before returning <strong>FALSE</strong>.</p>

<h3 id="fpenumprinterdrivers"><code>fpEnumPrinterDrivers</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/enumprinterdrivers">EnumPrinterDrivers</a> function. If the provider does not support the specified server, it should specify ERROR_INVALID_NAME to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a> before returning <strong>FALSE</strong>.</p>

<h3 id="fpgetprinterdriver"><code>fpGetPrinterDriver</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/getprinterdriver">GetPrinterDriver</a> function. The router first attempts to call the provider's <strong>GetPrinterDriverEx</strong> function. If that function is not supported, the router calls <strong>GetPrinterDriver</strong>.</p>

<h3 id="fpgetprinterdriverdirectory"><code>fpGetPrinterDriverDirectory</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/getprinterdriverdirectory">GetPrinterDriverDirectory</a> function. If the provider does not support the specified server, it should specify ERROR_INVALID_NAME to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a> before returning <strong>FALSE</strong>.</p>

<h3 id="fpdeleteprinterdriver"><code>fpDeletePrinterDriver</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/deleteprinterdriver">DeletePrinterDriver</a> function. If the provider does not support the specified server, it should specify ERROR_INVALID_NAME to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a> before returning <strong>FALSE</strong>.</p>

<h3 id="fpaddprintprocessor"><code>fpAddPrintProcessor</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/addprintprocessor">AddPrintProcessor</a> function.</p>

<h3 id="fpenumprintprocessors"><code>fpEnumPrintProcessors</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/enumprintprocessors">EnumPrintProcessors</a> function.</p>

<h3 id="fpgetprintprocessordirectory"><code>fpGetPrintProcessorDirectory</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/getprintprocessordirectory">GetPrintProcessorDirectory</a> function.</p>

<h3 id="fpdeleteprintprocessor"><code>fpDeletePrintProcessor</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/deleteprintprocessor">DeletePrintProcessor</a> function.</p>

<h3 id="fpenumprintprocessordatatypes"><code>fpEnumPrintProcessorDatatypes</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/enumprintprocessordatatypes">EnumPrintProcessorDatatypes</a> function.</p>

<h3 id="fpstartdocprinter"><code>fpStartDocPrinter</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/startdocprinter">StartDocPrinter</a> function.</p>

<h3 id="fpstartpageprinter"><code>fpStartPagePrinter</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/startpageprinter">StartPagePrinter</a> function.</p>

<h3 id="fpwriteprinter"><code>fpWritePrinter</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/writeprinter">WritePrinter</a> function.</p>

<h3 id="fpendpageprinter"><code>fpEndPagePrinter</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/endpageprinter">EndPagePrinter</a>function.</p>

<h3 id="fpabortprinter"><code>fpAbortPrinter</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/abortprinter">AbortPrinter</a> function.</p>

<h3 id="fpreadprinter"><code>fpReadPrinter</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/readprinter">ReadPrinter</a> function.</p>

<h3 id="fpenddocprinter"><code>fpEndDocPrinter</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/enddocprinter">EndDocPrinter</a> function.</p>

<h3 id="fpaddjob"><code>fpAddJob</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/addjob">AddJob</a> function.</p>

<h3 id="fpschedulejob"><code>fpScheduleJob</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/schedulejob">ScheduleJob</a> function.</p>

<h3 id="fpgetprinterdata"><code>fpGetPrinterData</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/getprinterdata">GetPrinterData</a> function.</p>

<h3 id="fpsetprinterdata"><code>fpSetPrinterData</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/setprinterdata">SetPrinterData</a> function.</p>

<h3 id="fpwaitforprinterchange"><code>fpWaitForPrinterChange</code></h3>

<p>Obsolete. Must be NULL.</p>

<h3 id="fpcloseprinter"><code>fpClosePrinter</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/closeprinter">ClosePrinter</a> function. If a printer change notification object has been created, then the router calls the provider's FindClosePrinterChangeNotification function before calling ClosePrinter.</p>

<h3 id="fpaddform"><code>fpAddForm</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/addform">AddForm</a> function.</p>

<h3 id="fpdeleteform"><code>fpDeleteForm</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/deleteform">DeleteForm</a> function.</p>

<h3 id="fpgetform"><code>fpGetForm</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/getform">GetForm</a> function.</p>

<h3 id="fpsetform"><code>fpSetForm</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/setform">SetForm</a> function.</p>

<h3 id="fpenumforms"><code>fpEnumForms</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/enumforms">EnumForms</a> function.</p>

<h3 id="fpenummonitors"><code>fpEnumMonitors</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/enummonitors">EnumMonitors</a> function, which is described in the Windows SDK documentation. However, at the provider level this function must supply one of the <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> return values listed in the following table.</p>

<table>
<thead>
<tr>
  <th>Return value</th>
  <th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
  <td>ROUTER_SUCCESS</td>
  <td>The provider has enumerated the monitors on the specified server.</td>
</tr>
<tr>
  <td>ROUTER_STOP_ROUTING</td>
  <td>The provider has enumerated the monitors on the specified server, and the router should not call other providers.</td>
</tr>
<tr>
  <td>ROUTER_UNKNOWN</td>
  <td>The provider does not support the specified server.</td>
</tr>
</tbody>
</table>

<h3 id="fpenumports"><code>fpEnumPorts</code></h3>

<table>
<thead>
<tr>
  <th>Return value</th>
  <th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
  <td>ROUTER_SUCCESS</td>
  <td>The provider has enumerated the ports on the specified server.</td>
</tr>
<tr>
  <td>ROUTER_STOP_ROUTING</td>
  <td>The provider has enumerated the ports on the specified server, and the router should not call other providers.</td>
</tr>
<tr>
  <td>ROUTER_UNKNOWN</td>
  <td>The provider does not support the specified server.</td>
</tr>
</tbody>
</table>

<h3 id="fpaddport"><code>fpAddPort</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/addport">AddPort</a> function. If the provider does not support the specified port, it must supply ERROR_NOT_SUPPORTED to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a> before returning <strong>FALSE</strong>.</p>

<h3 id="fpconfigureport"><code>fpConfigurePort</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/configureport">ConfigurePort</a> function. If the function supplies ERROR_NOT_SUPPORTED, ERROR_INVALID_NAME, or ERROR_UNKNOWN_PORT to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a>, the router will attempt to call another provider.</p>

<h3 id="fpdeleteport"><code>fpDeletePort</code></h3>

<p>(Required.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/deleteport">DeletePort</a> function. If the provider does not support the specified port, it must supply ERROR_NOT_SUPPORTED to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a> before returning <strong>FALSE</strong>.</p>

<h3 id="fpcreateprinteric"><code>fpCreatePrinterIC</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpplaygdiscriptonprinteric"><code>fpPlayGdiScriptOnPrinterIC</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpdeleteprinteric"><code>fpDeletePrinterIC</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpaddprinterconnection"><code>fpAddPrinterConnection</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/addprinterconnection">AddPrinterConnection</a> function.</p>

<h3 id="fpdeleteprinterconnection"><code>fpDeletePrinterConnection</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/deleteprinterconnection">DeletePrinterConnection</a> function.</p>

<h3 id="fpprintermessagebox"><code>fpPrinterMessageBox</code></h3>

<p>Not used. Must be NULL.</p>

<h3 id="fpaddmonitor"><code>fpAddMonitor</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/addmonitor">AddMonitor</a> function. If the provider does not support the specified monitor, it must supply ERROR_INVALID_NAME to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a> before returning <strong>FALSE</strong>.</p>

<h3 id="fpdeletemonitor"><code>fpDeleteMonitor</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/addmonitor">DeleteMonitor</a> function. If the provider does not support the specified monitor, it must supply ERROR_INVALID_NAME to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a> before returning <strong>FALSE</strong>.</p>

<h3 id="fpresetprinter"><code>fpResetPrinter</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/resetprinter">ResetPrinter</a> function.</p>

<h3 id="fpgetprinterdriverex"><code>fpGetPrinterDriverEx</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <strong>GetPrinterDriverEx</strong> function. If <strong>GetPrinterDriverEx</strong> is not supported, the router attempts to call <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/getprinterdriver">GetPrinterDriver</a>.</p>

<h3 id="fpfindfirstprinterchangenotification"><code>fpFindFirstPrinterChangeNotification</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/findfirstprinterchangenotification">FindFirstPrinterChangeNotification</a> function.</p>

<h3 id="fpfindcloseprinterchangenotification"><code>fpFindClosePrinterChangeNotification</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/findcloseprinterchangenotification">FindClosePrinterChangeNotification</a> function.</p>

<h3 id="fpaddportex"><code>fpAddPortEx</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <strong>AddPortEx</strong> function. If the provider does not support the specified port, it must supply ERROR_NOT_SUPPORTED to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a> before returning <strong>FALSE</strong>.</p>

<h3 id="fpshutdown"><code>fpShutDown</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fprefreshprinterchangenotification"><code>fpRefreshPrinterChangeNotification</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/ff561930(v=vs.85)">RefreshPrinterChangeNotification</a> function.</p>

<h3 id="fpopenprinterex"><code>fpOpenPrinterEx</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpaddprinterex"><code>fpAddPrinterEx</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpsetport"><code>fpSetPort</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/setport">SetPort</a> function. If the function supplies ERROR_NOT_SUPPORTED, ERROR_INVALID_NAME, or ERROR_UNKNOWN_PORT to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a>, the router will attempt to call another provider.</p>

<h3 id="fpenumprinterdata"><code>fpEnumPrinterData</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/enumprinterdata">EnumPrinterData</a> function.</p>

<h3 id="fpdeleteprinterdata"><code>fpDeletePrinterData</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/deleteprinterdata">DeletePrinterData</a> function.</p>

<h3 id="fpclustersplopen"><code>fpClusterSplOpen</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpclustersplclose"><code>fpClusterSplClose</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpclustersplisalive"><code>fpClusterSplIsAlive</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpsetprinterdataex"><code>fpSetPrinterDataEx</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/setprinterdataex">SetPrinterDataEx</a> function.</p>

<h3 id="fpgetprinterdataex"><code>fpGetPrinterDataEx</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/getprinterdataex">GetPrinterDataEx</a> function.</p>

<h3 id="fpenumprinterdataex"><code>fpEnumPrinterDataEx</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/enumprinterdataex">EnumPrinterDataEx</a> function.</p>

<h3 id="fpenumprinterkey"><code>fpEnumPrinterKey</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/enumprinterkey">EnumPrinterKey</a> function.</p>

<h3 id="fpdeleteprinterdataex"><code>fpDeletePrinterDataEx</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/deleteprinterdataex">DeletePrinterDataEx</a> function.</p>

<h3 id="fpdeleteprinterkey"><code>fpDeletePrinterKey</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/deleteprinterkey">DeletePrinterKey</a> function.</p>

<h3 id="fpseekprinter"><code>fpSeekPrinter</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpdeleteprinterdriverex"><code>fpDeletePrinterDriverEx</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/deleteprinterdriverex">DeletePrinterDriverEx</a> function. If the provider does not support the specified server, it should specify ERROR_INVALID_NAME to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a> before returning <strong>FALSE</strong>.</p>

<h3 id="fpaddpermachineconnection"><code>fpAddPerMachineConnection</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpdeletepermachineconnection"><code>fpDeletePerMachineConnection</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpenumpermachineconnections"><code>fpEnumPerMachineConnections</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpxcvdata"><code>fpXcvData</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/ff564255(v=vs.85)">XcvData</a> function.</p>

<h3 id="fpaddprinterdriverex"><code>fpAddPrinterDriverEx</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/printdocs/addprinterdriverex">AddPrinterDriverEx</a> function. If the provider does not support the specified server, it should specify ERROR_INVALID_NAME to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-setlasterror">SetLastError</a> before returning <strong>FALSE</strong>.</p>

<h3 id="fpsplreadprinter"><code>fpSplReadPrinter</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpdriverunloadcomplete"><code>fpDriverUnloadComplete</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpgetspoolfileinfo"><code>fpGetSpoolFileInfo</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpcommitspooldata"><code>fpCommitSpoolData</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpclosespoolfilehandle"><code>fpCloseSpoolFileHandle</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpflushprinter"><code>fpFlushPrinter</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpsendrecvbididata"><code>fpSendRecvBidiData</code></h3>

<p>(Optional. Can be NULL.) Pointer to the provider's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions//ff562068(v=vs.85)">SendRecvBidiData</a> function. If this parameter is NULL, it means that the provider does not support bidi communication.</p>

<h3 id="fpaddprinterconnection2"><code>fpAddPrinterConnection2</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpgetprintclassobject"><code>fpGetPrintClassObject</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpreportjobprocessingprogress"><code>fpReportJobProcessingProgress</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpenumandlogprovidorobjects"><code>fpEnumAndLogProvidorObjects</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpinternalgetprinterdriver"><code>fpInternalGetPrinterDriver</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpfindcompatibledriver"><code>fpFindCompatibleDriver</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpgetjobnamedpropertyvalue"><code>fpGetJobNamedPropertyValue</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpsetjobnamedproperty"><code>fpSetJobNamedProperty</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpdeletejobnamedproperty"><code>fpDeleteJobNamedProperty</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpenumjobnamedproperties"><code>fpEnumJobNamedProperties</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fppowerevent"><code>fpPowerEvent</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpgetuserpropertybag"><code>fpGetUserPropertyBag</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpcanshutdown"><code>fpCanShutdown</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fplogjobinfoforbranchoffice"><code>fpLogJobInfoForBranchOffice</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpregenerateprintdevicecapabilities"><code>fpRegeneratePrintDeviceCapabilities</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpinstallprinterdriverpackagefromconnection"><code>fpInstallPrinterDriverPackageFromConnection</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpprintsupportoperation"><code>fpPrintSupportOperation</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpippcreatejobonprinter"><code>fpIppCreateJobOnPrinter</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpippgetjobattributes"><code>fpIppGetJobAttributes</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpippsetjobattributes"><code>fpIppSetJobAttributes</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpippgetprinterattributes"><code>fpIppGetPrinterAttributes</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpippsetprinterattributes"><code>fpIppSetPrinterAttributes</code></h3>

<p>For internal use only. Must be NULL.</p>

<h3 id="fpippcreatejobonprinterwithattributes"><code>fpIppCreateJobOnPrinterWithAttributes</code></h3>

<p>For internal use only. Must be NULL.</p>

<h2 id="remarks">Remarks</h2>

<p>Function pointers are listed in the order they are specified within the PRINTPROVIDOR structure. To see function descriptions grouped by related capabilities, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/functions-defined-by-print-providers">Functions Defined by Print Providers</a>.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winspool/nf-winspool-findfirstprinterchangenotification">FindFirstPrinterChangeNotification</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winsplp/nf-winsplp-initializeprintprovidor">InitializePrintProvidor</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/ff561930(v=vs.85)">RefreshPrinterChangeNotification</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions//ff562068(v=vs.85)">SendRecvBidiData</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/ff564255(v=vs.85)">XcvData</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winsplp/ns-winsplp-_printprovidor">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/winsplp/ns-winsplp-_printprovidor.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
