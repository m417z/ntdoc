<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="SeSetSecurityDescriptorInfoEx - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>SeSetSecurityDescriptorInfoEx - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            SeSetSecurityDescriptorInfoEx - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntifs.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> SeSetSecurityDescriptorInfoEx(
  [in, optional] PVOID                 Object,
  [in]           PSECURITY_INFORMATION SecurityInformation,
                 PSECURITY_DESCRIPTOR  ModificationDescriptor,
  [in, out]      PSECURITY_DESCRIPTOR  *ObjectsSecurityDescriptor,
  [in]           <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                 AutoInheritFlags,
  [in]           <a href="pool_type" title="typedef enum _POOL_TYPE {&#10;    NonPagedPool,&#10;    NonPagedPoolExecute = NonPagedPool,&#10;    PagedPool,&#10;    NonPagedPoolMustSucceed = NonPagedPool + 2,&#10;    DontUseThisType,&#10;    NonPagedPoolCacheAligned = NonPagedPool + 4,&#10;    PagedPoolCacheAligned,&#10;    NonPagedPoolCacheAlignedMustS = NonPagedPool + 6,&#10;    MaxPoolType,&#10;    NonPagedPoolBase = 0,&#10;    NonPagedPoolBaseMustSucceed = NonPagedPoolBase + 2,&#10;    NonPagedPoolBaseCacheAligned = NonPagedPoolBase + 4,&#10;    NonPagedPoolBaseCacheAlignedMustS = NonPagedPoolBase + 6,&#10;    NonPagedPoolSession = 32,&#10;    PagedPoolSession = NonPagedPoolSession + 1,&#10;    NonPagedPoolMustSucceedSession = PagedPoolSession + 1,&#10;    DontUseThisTypeSession = NonPagedPoolMustSucceedSession + 1,&#10;    NonPagedPoolCacheAlignedSession = DontUseThisTypeSession + 1,&#10;    PagedPoolCacheAlignedSession = NonPagedPoolCacheAlignedSession + 1,&#10;...">POOL_TYPE</a>             PoolType,
  [in]           PGENERIC_MAPPING      GenericMapping
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-sesetsecuritydescriptorinfoex">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/sesetsecuritydescriptorinfoex.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ntifs-sesetsecuritydescriptorinfoex)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="sesetsecuritydescriptorinfoex-function">SeSetSecurityDescriptorInfoEx function</h1>

<h2 id="description">Description</h2>

<p>The <strong>SeSetSecurityDescriptorInfoEx</strong> routine modifies an object's security descriptor and specifies whether the object supports automatic inheritance of access control entries (ACE).</p>

<h2 id="parameters">Parameters</h2>

<h3 id="object-in-optional"><code>Object</code> [in, optional]</h3>

<p>Pointer to the object whose security descriptor is to be modified. This is used to update security quota information.</p>

<h3 id="securityinformation-in"><code>SecurityInformation</code> [in]</h3>

<p>Pointer to a value specifying which security information is to be set. Can be a combination of one or more of the following.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>DACL_SECURITY_INFORMATION</td>
  <td>Indicates the discretionary access control list (DACL) of the object is being set. Requires WRITE_DAC access.</td>
</tr>
<tr>
  <td>GROUP_SECURITY_INFORMATION</td>
  <td>Indicates the primary group identifier of the object is being set. Requires WRITE_OWNER access.</td>
</tr>
<tr>
  <td>OWNER_SECURITY_INFORMATION</td>
  <td>Indicates the owner identifier of the object is being set. Requires WRITE_OWNER access.</td>
</tr>
<tr>
  <td>SACL_SECURITY_INFORMATION</td>
  <td>Indicates the system <a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a> (SACL) of the object is being set. Requires ACCESS_SYSTEM_SECURITY access.</td>
</tr>
</tbody>
</table>

<h3 id="modificationdescriptor"><code>ModificationDescriptor</code></h3>

<p>The input security descriptor to be applied to the object. The caller of this routine is expected to probe and capture the passed security descriptor before calling, and to release it after calling.</p>

<h3 id="objectssecuritydescriptor-in-out"><code>ObjectsSecurityDescriptor</code> [in, out]</h3>

<p>Pointer to a pointer to the object's security descriptor. The security descriptor must be in self-relative format. This structure must be deallocated by the caller.</p>

<h3 id="autoinheritflags-in"><code>AutoInheritFlags</code> [in]</h3>

<p>Bitmask that controls automatic inheritance of ACEs. Set to the logical OR of one or more of the following bit flags:</p>

<table>
<thead>
<tr>
  <th>Security Information Flags</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>SEF_DACL_AUTO_INHERIT</td>
  <td>If this flag is set, the DACL is treated as an auto-inherit DACL and is processed as described in the following Remarks section. This bit is ignored if DACL_SECURITY_INFORMATION is not set in the <strong>SecurityInformation</strong> parameter.</td>
</tr>
<tr>
  <td>SEF_SACL_AUTO_INHERIT</td>
  <td>If this flag is set, the SACL is treated as an auto-inherit SACL and is processed as described in the following Remarks section. This bit is ignored if SACL_SECURITY_INFORMATION is not set in the <strong>SecurityInformation</strong> parameter.</td>
</tr>
</tbody>
</table>

<h3 id="pooltype-in"><code>PoolType</code> [in]</h3>

<p>Specifies the pool type to use when allocating a new security descriptor, which can be one of the following:</p>

<ul>
<li><strong>NonPagedPool</strong></li>
<li><strong>PagedPool</strong></li>
<li><strong>NonPagedPoolCacheAligned</strong></li>
<li><strong>PagedPoolCacheAligned</strong></li>
</ul>

<p>Usually, a caller specifies <strong>PagedPool</strong>, or else <strong>NonPagedPool</strong> if the buffer will be accessed at IRQL &gt;= DISPATCH_LEVEL or in an arbitrary thread context.</p>

<p>The <strong>NonPagedPoolMustSucceed</strong> and <strong>NonPagedPoolCacheAlignedMustS</strong> pool types are obsolete and should no longer be used.</p>

<h3 id="genericmapping-in"><code>GenericMapping</code> [in]</h3>

<p>Pointer to a <a href="generic_mapping" title="typedef struct _GENERIC_MAPPING {&#10;  ACCESS_MASK GenericRead;&#10;  ACCESS_MASK GenericWrite;&#10;  ACCESS_MASK GenericExecute;&#10;  ACCESS_MASK GenericAll;&#10;} GENERIC_MAPPING;">GENERIC_MAPPING</a> structure that specifies the mapping of generic to specific and standard access types for the object being accessed. This mapping structure is expected to be safe to access (that is, captured if necessary) prior to be passed to this routine.</p>

<h2 id="return-value">Return value</h2>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a></td>
  <td>The object's security descriptor was successfully modified.</td>
</tr>
<tr>
  <td>STATUS_BAD_DESCRIPTOR_FORMAT</td>
  <td>The provided object's security descriptor was not in self-relative format.</td>
</tr>
<tr>
  <td>STATUS_NO_SECURITY_ON_OBJECT</td>
  <td>The object does not have a security descriptor.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>If the <strong>AutoInheritFlags</strong> parameter is zero, the effect of calling <strong>SeSetSecurityDescriptorInfoEx</strong> is the same as that of calling <strong><a href="sesetsecuritydescriptorinfo" title="NTSTATUS SeSetSecurityDescriptorInfo(&#10;  [in, optional] PVOID                 Object,&#10;  [in]           PSECURITY_INFORMATION SecurityInformation,&#10;                 PSECURITY_DESCRIPTOR  ModificationDescriptor,&#10;  [in, out]      PSECURITY_DESCRIPTOR  *ObjectsSecurityDescriptor,&#10;  [in]           POOL_TYPE             PoolType,&#10;  [in]           PGENERIC_MAPPING      GenericMapping&#10;);">SeSetSecurityDescriptorInfo</a></strong>.</p>

<p>If <strong>AutoInheritFlags</strong> specifies the SEF_DACL_AUTO_INHERIT bit, <strong>SeSetSecurityDescriptorInfoEx</strong> applies the following rules to the DACL to create the new security descriptor from the current descriptor:</p>

<ul>
<li><p>If the SE_DACL_PROTECTED flag is not set in the control bits of the either the current security descriptor or the input <strong>SecurityDescriptor</strong>, <strong>SeSetSecurityDescriptorInfoEx</strong> constructs the output security descriptor from the inherited ACEs of the current security descriptor and noninherited ACEs of <strong>SecurityDescriptor</strong>. That is, it is impossible to change an inherited ACE by changing the <a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a> on an object. This behavior preserves the inherited ACEs as they were inherited from the parent container.</p></li>
<li><p>If SE_DACL_PROTECTED is set in the input <strong>SecurityDescriptor</strong>, the current security descriptor is ignored. The output security descriptor is built as a copy of the input <strong>SecurityDescriptor</strong> with any INHERITED_ACE bits turned off.</p></li>
</ul>

<p>Ideally an <a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a> editor should turn off the INHERITED_ACE bits indicating to its caller that the ACEs inherited from the object's parent are now being explicitly set on the object.</p>

<ul>
<li>If SE_DACL_PROTECTED is set in the current security descriptor and not in the <strong>SecurityDescriptor</strong>, the current security descriptor is ignored. The output security descriptor is built as a copy of the <strong>SecurityDescriptor</strong>. It is the caller's responsibility to ensure that the correct ACEs have the INHERITED_ACE bit turned on.</li>
</ul>

<p>If <strong>AutoInheritFlags</strong> specifies the SEF_SACL_AUTO_INHERIT bit, <strong>SeSetSecurityDescriptorInfoEx</strong> applies similar rules to the new SACL.</p>

<p>For more information about access control and ACE inheritance, see the Security section of the Microsoft Windows SDK documentation.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ifs/ace"><strong>ACE</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_acl"><strong>ACL</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_generic_mapping"><strong>GENERIC_MAPPING</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-rtlcreatesecuritydescriptor"><strong>RtlCreateSecurityDescriptor</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-rtlcreatesecuritydescriptorrelative"><strong>RtlCreateSecurityDescriptorRelative</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-rtllengthsecuritydescriptor"><strong>RtlLengthSecurityDescriptor</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-rtlsetdaclsecuritydescriptor"><strong>RtlSetDaclSecurityDescriptor</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-rtlsetownersecuritydescriptor"><strong>RtlSetOwnerSecurityDescriptor</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-rtlvalidsecuritydescriptor"><strong>RtlValidSecurityDescriptor</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/ns-ntifs-_security_descriptor"><strong>SECURITY_DESCRIPTOR</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ifs/security-information"><strong>SECURITY_INFORMATION</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-sequerysecuritydescriptorinfo"><strong>SeQuerySecurityDescriptorInfo</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-sesetsecuritydescriptorinfo"><strong>SeSetSecurityDescriptorInfo</strong></a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-sesetsecuritydescriptorinfoex">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntifs/nf-ntifs-sesetsecuritydescriptorinfoex.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
