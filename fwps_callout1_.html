<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FWPS_CALLOUT1_ - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FWPS_CALLOUT1_ - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FWPS_CALLOUT1_ - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// fwpsk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct FWPS_CALLOUT1_ {
  GUID                                calloutKey;
  <a href="uint32" title="typedef unsigned int UINT32;">UINT32</a>                              flags;
  FWPS_CALLOUT_CLASSIFY_FN1           classifyFn;
  FWPS_CALLOUT_NOTIFY_FN1             notifyFn;
  FWPS_CALLOUT_FLOW_DELETE_NOTIFY_FN0 flowDeleteFn;
} FWPS_CALLOUT1;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/ns-fwpsk-fwps_callout1_">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/fwps_callout1_.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-fwpsk-fwps_callout1_)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="fwps_callout1_-structure">FWPS_CALLOUT1_ structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>FWPS_CALLOUT1</strong> structure defines the data that is required for a callout driver to register a
callout with the filter engine.</p>

<p><strong>Note</strong> <strong>FWPS_CALLOUT1</strong> is the specific version of <strong>FWPS_CALLOUT</strong> used in Windows 7 and later. See <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/FWP/wfp-version-independent-names-and-targeting-specific-versions-of-windows">WFP Version-Independent Names and Targeting Specific Versions of Windows</a> for more information. For Windows 8, <a href="fwps_callout2_" title="typedef struct FWPS_CALLOUT2_ {&#10;  GUID                                calloutKey;&#10;  UINT32                              flags;&#10;  FWPS_CALLOUT_CLASSIFY_FN2           classifyFn;&#10;  FWPS_CALLOUT_NOTIFY_FN2             notifyFn;&#10;  FWPS_CALLOUT_FLOW_DELETE_NOTIFY_FN0 flowDeleteFn;&#10;} FWPS_CALLOUT2;">FWPS_CALLOUT2</a> is available. For Windows Vista, <a href="fwps_callout0_" title="typedef struct FWPS_CALLOUT0_ {&#10;  GUID                                calloutKey;&#10;  UINT32                              flags;&#10;  FWPS_CALLOUT_CLASSIFY_FN0           classifyFn;&#10;  FWPS_CALLOUT_NOTIFY_FN0             notifyFn;&#10;  FWPS_CALLOUT_FLOW_DELETE_NOTIFY_FN0 flowDeleteFn;&#10;} FWPS_CALLOUT0;">FWPS_CALLOUT0</a> is available.</p>

<h2 id="members">Members</h2>

<h3 id="calloutkey"><code>calloutKey</code></h3>

<p>A callout driver-defined <strong>GUID</strong> that uniquely identifies the callout.</p>

<h3 id="flags"><code>flags</code></h3>

<p>Flags that specify callout-specific parameters. Possible flags are:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>FWP_CALLOUT_FLAG_CONDITIONAL_ON_FLOW</strong><br><br>0x00000001</td>
  <td>A callout driver can specify this flag when registering a callout that will be added at a layer that supports data flows. If this flag is specified, the filter engine calls the callout driver's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nc-fwpsk-fwps_callout_classify_fn1">classifyFn1</a> callout function only if there is a context associated with the data flow. A callout driver associates a context with a data flow by calling the <a href="fwpsflowassociatecontext0" title="NTSTATUS FwpsFlowAssociateContext0(&#10;  [in] UINT64 flowId,&#10;  [in] UINT16 layerId,&#10;  [in] UINT32 calloutId,&#10;  [in] UINT64 flowContext&#10;);">FwpsFlowAssociateContext0</a> function.</td>
</tr>
<tr>
  <td><strong>FWP_CALLOUT_FLAG_ALLOW_OFFLOAD</strong><br><br>0x00000002</td>
  <td>A callout driver specifies this flag to indicate that the callout driver's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nc-fwpsk-fwps_callout_classify_fn1">classifyFn1</a> callout function is unaffected by offloading network data processing to offload-capable network interface cards (NICs). If this flag is not specified, then offloading of network data processing is disabled for all traffic that is processed by any filters that specify the callout for the filter's action.</td>
</tr>
<tr>
  <td><strong>FWP_CALLOUT_FLAG_ENABLE_COMMIT_ADD_NOTIFY</strong><br><br>0x00000004</td>
  <td>A callout driver specifies this flag to indicate that it can receive notifications about objects and filters that are added inside a transaction. The filter engine sends the notification after the transaction is committed.</td>
</tr>
<tr>
  <td><strong>FWP_CALLOUT_FLAG_ALLOW_MID_STREAM_INSPECTION</strong><br><br>0x00000008</td>
  <td>A callout driver specifies this flag to indicate that it can perform dynamic stream inspection of data flows at stream level. See <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/stream-inspection">Stream Inspection</a>.</td>
</tr>
<tr>
  <td><strong>FWP_CALLOUT_FLAG_ALLOW_RECLASSIFY</strong><br><br>0x00000010</td>
  <td>A callout driver specifies this flag to register itself to be called when an existing socket operation is reclassified.</td>
</tr>
</tbody>
</table>

<h3 id="classifyfn"><code>classifyFn</code></h3>

<p>A pointer to the callout driver's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nc-fwpsk-fwps_callout_classify_fn1">classifyFn1</a> callout function. The filter
engine calls this function whenever there is network data to be processed by the callout.</p>

<h3 id="notifyfn"><code>notifyFn</code></h3>

<p>A pointer to the callout driver's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nc-fwpsk-fwps_callout_notify_fn1">notifyFn1</a> function. The filter engine calls
this function to notify the callout driver about events that are associated with the callout.</p>

<h3 id="flowdeletefn"><code>flowDeleteFn</code></h3>

<p>A pointer to the callout driver's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nc-fwpsk-fwps_callout_flow_delete_notify_fn0">flowDeleteFn</a> callout function. The filter
engine calls this function whenever a data flow that is being processed by the callout is terminated.</p>

<p>If a callout driver does not associate a context with the data flows that the callout processes, then
this member should be set to <strong>NULL</strong>.</p>

<h2 id="remarks">Remarks</h2>

<p>A callout driver passes a pointer to an initialized <strong>FWPS_CALLOUT1</strong> structure to the
<a href="fwpscalloutregister1" title="NTSTATUS FwpsCalloutRegister1(&#10;  [in, out]       void                *deviceObject,&#10;  [in]            const FWPS_CALLOUT1 *callout,&#10;  [out, optional] UINT32              *calloutId&#10;);">FwpsCalloutRegister1</a> function when it
registers a callout with the filter engine.</p>

<p>A callout can set the <strong>FWP_CALLOUT_FLAG_CONDITIONAL_ON_FLOW</strong> flag only for connections on which
the driver is interested in performing stream inspections. This callout will be ignored on all other
connections. Performance will be improved and the driver will not have to maintain unnecessary state
data.</p>

<p>This structure is essentially identical to the previous version,
<a href="fwps_callout0_" title="typedef struct FWPS_CALLOUT0_ {&#10;  GUID                                calloutKey;&#10;  UINT32                              flags;&#10;  FWPS_CALLOUT_CLASSIFY_FN0           classifyFn;&#10;  FWPS_CALLOUT_NOTIFY_FN0             notifyFn;&#10;  FWPS_CALLOUT_FLOW_DELETE_NOTIFY_FN0 flowDeleteFn;&#10;} FWPS_CALLOUT0;">FWPS_CALLOUT0</a>. The only differences are that
the members of this version store the updated versions of the callout function pointers, and additional flags are available for callout drivers to set.</p>

<h2 id="see-also">See also</h2>

<p><a href="fwps_callout0_" title="typedef struct FWPS_CALLOUT0_ {&#10;  GUID                                calloutKey;&#10;  UINT32                              flags;&#10;  FWPS_CALLOUT_CLASSIFY_FN0           classifyFn;&#10;  FWPS_CALLOUT_NOTIFY_FN0             notifyFn;&#10;  FWPS_CALLOUT_FLOW_DELETE_NOTIFY_FN0 flowDeleteFn;&#10;} FWPS_CALLOUT0;">FWPS_CALLOUT0</a></p>

<p><a href="fwps_callout2_" title="typedef struct FWPS_CALLOUT2_ {&#10;  GUID                                calloutKey;&#10;  UINT32                              flags;&#10;  FWPS_CALLOUT_CLASSIFY_FN2           classifyFn;&#10;  FWPS_CALLOUT_NOTIFY_FN2             notifyFn;&#10;  FWPS_CALLOUT_FLOW_DELETE_NOTIFY_FN0 flowDeleteFn;&#10;} FWPS_CALLOUT2;">FWPS_CALLOUT2</a></p>

<p><a href="fwpscalloutregister1" title="NTSTATUS FwpsCalloutRegister1(&#10;  [in, out]       void                *deviceObject,&#10;  [in]            const FWPS_CALLOUT1 *callout,&#10;  [out, optional] UINT32              *calloutId&#10;);">FwpsCalloutRegister1</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nc-fwpsk-fwps_callout_classify_fn1">classifyFn1</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nc-fwpsk-fwps_callout_flow_delete_notify_fn0">flowDeleteFn</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nc-fwpsk-fwps_callout_notify_fn1">notifyFn1</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/ns-fwpsk-fwps_callout1_">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/fwpsk/ns-fwpsk-fwps_callout1_.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
