<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="KSAUDIO_POSITION - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>KSAUDIO_POSITION - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            KSAUDIO_POSITION - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ksmedia.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct {
#if ...
  <a href="ulonglong" title="typedef unsigned __int64 ULONGLONG;">ULONGLONG</a> PlayOffset;
#if ...
  <a href="ulonglong" title="typedef unsigned __int64 ULONGLONG;">ULONGLONG</a> WriteOffset;
#else
  <a href="dwordlong" title="typedef unsigned __int64 DWORDLONG;">DWORDLONG</a> PlayOffset;
#endif
#else
  <a href="dwordlong" title="typedef unsigned __int64 DWORDLONG;">DWORDLONG</a> WriteOffset;
#endif
} KSAUDIO_POSITION, *PKSAUDIO_POSITION;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ksmedia/ns-ksmedia-ksaudio_position">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ksaudio_position.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ksmedia-ksaudio_position)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="ksaudio_position-structure">KSAUDIO_POSITION structure</h1>

<h2 id="description">Description</h2>

<p>The KSAUDIO_POSITION structure specifies the current positions of the play and write cursors in the sound buffer for an audio stream.</p>

<h2 id="members">Members</h2>

<h3 id="playoffset"><code>PlayOffset</code></h3>

<p>Specifies the current play position as a byte offset.</p>

<h3 id="writeoffset"><code>WriteOffset</code></h3>

<p>Specifies the current write position as a byte offset.</p>

<h2 id="remarks">Remarks</h2>

<p>This structure is used to get and set the data value for the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/ksproperty-audio-position">KSPROPERTY_AUDIO_POSITION</a> property.</p>

<p>For a looped client buffer (with stream type <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ksinterface-standard-looped-streaming">KSINTERFACE_STANDARD_LOOPED_STREAMING</a>), <strong>PlayOffset</strong> and <strong>WriteOffset</strong> are byte offsets into the client buffer. When either offset reaches the end of the buffer, it wraps around to the start of the buffer. Hence, neither offset ever exceeds the buffer size.</p>

<p>For a nonlooped client buffer (with stream type <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ksinterface-standard-streaming">KSINTERFACE_STANDARD_STREAMING</a>), <strong>PlayOffset</strong> and <strong>WriteOffset</strong> are not offsets into any one physical buffer that either your driver has allocated or a client has allocated. Instead, these offsets are stream-relative and can be thought of as offsets into an idealized buffer that contains the entire stream and is contiguous from beginning to end. Any internal offsets that point into the actual physical buffers that contain the data need to be maintained separately.</p>

<p>During playback, the <strong>PlayOffset</strong> and <strong>WriteOffset</strong> values are interpreted as follows:</p>

<ul>
<li><strong>PlayOffset</strong> is the offset of the last byte in the buffer that has played. <strong>PlayOffset</strong> + 1 is the offset of the next byte that will play.</li>
<li><strong>WriteOffset</strong> is the offset of the last byte in the playback buffer.</li>
</ul>

<p>When a client submits another buffer to the device for playback, <strong>WriteOffset</strong> will increment upon receipt of that buffer to indicate the new <strong>WriteOffset</strong> value, but <strong>PlayOffset</strong> does not change until after that buffer has actually been played by the device.</p>

<p>During recording, the <strong>PlayOffset</strong> and <strong>WriteOffset</strong> values are interpreted as follows:</p>

<ul>
<li><strong>PlayOffset</strong> is the offset of the last byte in the buffer that has been captured. <strong>PlayOffset</strong> + 1 is the offset of the next byte that will be captured.</li>
<li><strong>WriteOffset</strong> is the offset of the last byte in the capture buffer.</li>
</ul>

<p>When an application submits another buffer to the device for capturing, the <strong>WriteOffset</strong> value will increment upon receipt of that buffer. The <strong>PlayOffset</strong> value will not change until data has actually been captured into the buffer.</p>

<p>The space between <strong>PlayOffset</strong> and <strong>WriteOffset</strong> is considered off-limits to the client because it represents the portion of the client buffer that has already been sent to the driver and might still be in use by the driver.</p>

<p>For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/audio-position-property">Audio Position Property</a>.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ksinterface-standard-looped-streaming">KSINTERFACE_STANDARD_LOOPED_STREAMING</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ksinterface-standard-streaming">KSINTERFACE_STANDARD_STREAMING</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/ksproperty-audio-position">KSPROPERTY_AUDIO_POSITION</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ksmedia/ns-ksmedia-ksaudio_position">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ksmedia/ns-ksmedia-ksaudio_position.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
