<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="RDF_TRANSMIT - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>RDF_TRANSMIT - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            RDF_TRANSMIT - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// smclib.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>  (*ReaderFunction[RDF_TRANSMIT])(
   <a href="smartcard_extension" title="typedef struct _SMARTCARD_EXTENSION {&#10;  ULONG                     Version;&#10;  VENDOR_ATTR               VendorAttr;&#10;  NTSTATUS(                 *ReaderFunction[16];&#10;  SCARD_CARD_CAPABILITIES   CardCapabilities;&#10;  ULONG                     LastError;&#10;  struct {&#10;    PULONG Information;&#10;    PUCHAR RequestBuffer;&#10;    ULONG  RequestBufferLength;&#10;    PUCHAR ReplyBuffer;&#10;    ULONG  ReplyBufferLength;&#10;  } IoRequest;&#10;  ULONG                     MajorIoControlCode;&#10;  ULONG                     MinorIoControlCode;&#10;  POS_DEP_DATA              OsData;&#10;  SCARD_READER_CAPABILITIES ReaderCapabilities;&#10;  PREADER_EXTENSION         ReaderExtension;&#10;  SMARTCARD_REPLY           SmartcardReply;&#10;  SMARTCARD_REQUEST         SmartcardRequest;&#10;...">PSMARTCARD_EXTENSION</a> SmartcardExtension
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/smartcard/smartcard-rdf-transmit-callback">View the official Windows hardware development documentation</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/rdf_transmit.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows hardware development documentation (smartcard-rdf-transmit-callback)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="rdf_transmit-callback-function">RDF_TRANSMIT callback function</h1>

<p>The RDF_TRANSMIT callback function performs data transmissions.</p>

<h2 id="parameters">Parameters</h2>

<ul>
<li><em>SmartcardExtension</em>
A pointer to the smart card extension, <strong><a href="smartcard_extension" title="typedef struct _SMARTCARD_EXTENSION {&#10;  ULONG                     Version;&#10;  VENDOR_ATTR               VendorAttr;&#10;  NTSTATUS(                 *ReaderFunction[16];&#10;  SCARD_CARD_CAPABILITIES   CardCapabilities;&#10;  ULONG                     LastError;&#10;  struct {&#10;    PULONG Information;&#10;    PUCHAR RequestBuffer;&#10;    ULONG  RequestBufferLength;&#10;    PUCHAR ReplyBuffer;&#10;    ULONG  ReplyBufferLength;&#10;  } IoRequest;&#10;  ULONG                     MajorIoControlCode;&#10;  ULONG                     MinorIoControlCode;&#10;  POS_DEP_DATA              OsData;&#10;  SCARD_READER_CAPABILITIES ReaderCapabilities;&#10;  PREADER_EXTENSION         ReaderExtension;&#10;  SMARTCARD_REPLY           SmartcardReply;&#10;  SMARTCARD_REQUEST         SmartcardRequest;&#10;...">SMARTCARD_EXTENSION</a></strong>, of the device.</li>
</ul>

<h2 id="return-value">Return value</h2>

<p>This function returns an <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> value. Possible values include the following:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong><a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a></strong></td>
  <td>Transmission successful.</td>
</tr>
<tr>
  <td><strong>STATUS_NO_MEDIA</strong></td>
  <td>No smart card is inserted in the reader.</td>
</tr>
<tr>
  <td><strong>STATUS_IO_TIMEOUT</strong></td>
  <td>The request timed out.</td>
</tr>
<tr>
  <td><strong>STATUS_INVALID_DEVICE_REQUEST</strong></td>
  <td>The protocol, defined by <strong>dwProtocol</strong>, is invalid.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>Smart card reader drivers must implement this callback function.</p>

<p>On input, the caller must pass the following values to the function:</p>

<ul>
<li><p><strong>SmartcardExtension-&gt;MajorIoControlCode</strong>
Contains <strong><a href="ioctl_smartcard_transmit" title="// CTL_CODE(0x0031, 0x005, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_SMARTCARD_TRANSMIT 0x00310014">IOCTL_SMARTCARD_TRANSMIT</a></strong>.</p></li>
<li><p><strong>SmartcardExtension-&gt;IoRequest.RequestBuffer</strong>
A pointer to an <a href="scard_io_request" title="typedef struct _SCARD_IO_REQUEST {&#10;  DWORD dwProtocol;&#10;  DWORD cbPciLength;&#10;} SCARD_IO_REQUEST, *PSCARD_IO_REQUEST, *LPSCARD_IO_REQUEST;">SCARD_IO_REQUEST</a> structure followed by data to transmit to the card.</p></li>
<li><p><strong>SmartcardExtension-&gt;IoRequest.RequestBufferLength</strong>
The number of bytes to transmit to the card.</p></li>
<li><p><strong>SmartcardExtension-&gt;IoRequest.ReplyBufferLength</strong>
The size, in bytes, of the reply buffer.</p></li>
</ul>

<p>The request returns the following values:</p>

<ul>
<li><p><strong>SmartcardExtension-&gt;IoRequest.ReplyBuffer</strong>
A pointer to the buffer that receives the <a href="scard_io_request" title="typedef struct _SCARD_IO_REQUEST {&#10;  DWORD dwProtocol;&#10;  DWORD cbPciLength;&#10;} SCARD_IO_REQUEST, *PSCARD_IO_REQUEST, *LPSCARD_IO_REQUEST;">SCARD_IO_REQUEST</a> structure, plus the result of the card.</p></li>
<li><p><strong>SmartcardExtension-&gt;IoRequest.Information</strong>
Receives the actual number of bytes returned by the smart card, plus the size of the <a href="scard_io_request" title="typedef struct _SCARD_IO_REQUEST {&#10;  DWORD dwProtocol;&#10;  DWORD cbPciLength;&#10;} SCARD_IO_REQUEST, *PSCARD_IO_REQUEST, *LPSCARD_IO_REQUEST;">SCARD_IO_REQUEST</a> structure. For a definition of the <a href="scard_io_request" title="typedef struct _SCARD_IO_REQUEST {&#10;  DWORD dwProtocol;&#10;  DWORD cbPciLength;&#10;} SCARD_IO_REQUEST, *PSCARD_IO_REQUEST, *LPSCARD_IO_REQUEST;">SCARD_IO_REQUEST</a> structure, see <a href="ioctl_smartcard_transmit" title="// CTL_CODE(0x0031, 0x005, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_SMARTCARD_TRANSMIT 0x00310014">IOCTL_SMARTCARD_TRANSMIT</a>.</p></li>
</ul>

<p>When this function is called, <strong>SmartcardExtension-&gt;IoRequest.RequestBuffer</strong> points to an <a href="scard_io_request" title="typedef struct _SCARD_IO_REQUEST {&#10;  DWORD dwProtocol;&#10;  DWORD cbPciLength;&#10;} SCARD_IO_REQUEST, *PSCARD_IO_REQUEST, *LPSCARD_IO_REQUEST;">SCARD_IO_REQUEST</a> structure followed by the data to transmit.</p>

<p><!-- CODE_MARKER --></p>

<div class="codehilite">
<pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">_SCARD_IO_REQUEST</span><span class="p">{</span>
<span class="w">  </span><span class="n"><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></span><span class="w">  </span><span class="n">dwProtocol</span><span class="p">;</span><span class="w">   </span><span class="c1">// Protocol identifier</span>
<span class="w">  </span><span class="n"><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></span><span class="w">  </span><span class="n">cbPciLength</span><span class="p">;</span><span class="w">  </span><span class="c1">// Protocol Control Information Length</span>
<span class="p">}</span><span class="w"> </span><span class="n"><a href="scard_io_request" title="typedef struct _SCARD_IO_REQUEST {&#10;  DWORD dwProtocol;&#10;  DWORD cbPciLength;&#10;} SCARD_IO_REQUEST, *PSCARD_IO_REQUEST, *LPSCARD_IO_REQUEST;">SCARD_IO_REQUEST</a></span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n"><a href="scard_io_request" title="typedef struct _SCARD_IO_REQUEST {&#10;  DWORD dwProtocol;&#10;  DWORD cbPciLength;&#10;} SCARD_IO_REQUEST, *PSCARD_IO_REQUEST, *LPSCARD_IO_REQUEST;">PSCARD_IO_REQUEST</a></span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">LPSCARD_IO_REQUEST</span><span class="p">;</span>
</code></pre>
</div>

<p>The <strong>dwProtocol</strong> member must contain the protocol identifier that is returned by a call to <a href="ioctl_smartcard_set_protocol" title="// CTL_CODE(0x0031, 0x00c, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_SMARTCARD_SET_PROTOCOL 0x00310030">IOCTL_SMARTCARD_SET_PROTOCOL</a>.</p>

<p>The <strong>cbPciLength</strong> member contains the size, in bytes, of the <a href="scard_io_request" title="typedef struct _SCARD_IO_REQUEST {&#10;  DWORD dwProtocol;&#10;  DWORD cbPciLength;&#10;} SCARD_IO_REQUEST, *PSCARD_IO_REQUEST, *LPSCARD_IO_REQUEST;">SCARD_IO_REQUEST</a> structure. The size of this structure is usually 8 bytes.</p>

<p>The <a href="scard_io_request" title="typedef struct _SCARD_IO_REQUEST {&#10;  DWORD dwProtocol;&#10;  DWORD cbPciLength;&#10;} SCARD_IO_REQUEST, *PSCARD_IO_REQUEST, *LPSCARD_IO_REQUEST;">SCARD_IO_REQUEST</a> structure is followed by (protocol) data to transmit to the card. Depending on the protocol to use for the transmission, the library offers several support functions. For more information about these support functions, see SmartcardT0Request (WDM) and SmartcardT1Request (WDM).</p>

<p><em>RequestBuffer</em> and <em>ReplyBuffer</em> point to the same system buffer. If you use the library function <em>SmartcardxxRequest</em> and <em>SmartcardxxReply</em>, you will not overwrite the input buffer. If you do not use these functions, make a copy of the <em>RequestBuffer</em> before you start transmissions.</p>

<p>You must copy the <a href="scard_io_request" title="typedef struct _SCARD_IO_REQUEST {&#10;  DWORD dwProtocol;&#10;  DWORD cbPciLength;&#10;} SCARD_IO_REQUEST, *PSCARD_IO_REQUEST, *LPSCARD_IO_REQUEST;">SCARD_IO_REQUEST</a> structure to the <em>ReplyBuffer</em> parameter, followed by the data received from the card. Again, if you use the <em>SmartcardxxRequest</em> and <em>SmartcardxxReply</em> functions, the library will copy the structure for you.</p>

<h2 id="requirements">Requirements</h2>

<table>
<thead>
<tr>
  <th></th>
  <th></th>
</tr>
</thead>
<tbody>
<tr>
  <td>Target platform</td>
  <td>Desktop</td>
</tr>
<tr>
  <td>Header</td>
  <td>Smclib.h (include Smclib.h)</td>
</tr>
</tbody>
</table>

<h2 id="see-also">See also</h2>

<p><strong><a href="ioctl_smartcard_set_protocol" title="// CTL_CODE(0x0031, 0x00c, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_SMARTCARD_SET_PROTOCOL 0x00310030">IOCTL_SMARTCARD_SET_PROTOCOL</a></strong></p>

<p><strong><a href="ioctl_smartcard_transmit" title="// CTL_CODE(0x0031, 0x005, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_SMARTCARD_TRANSMIT 0x00310014">IOCTL_SMARTCARD_TRANSMIT</a></strong></p>

<p><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff548965/(v=vs.85/)"><strong>SmartcardT0Request (WDM)</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff548969/(v=vs.85/)"><strong>SmartcardT1Request (WDM)</strong></a></p>

<p><strong><a href="smartcard_extension" title="typedef struct _SMARTCARD_EXTENSION {&#10;  ULONG                     Version;&#10;  VENDOR_ATTR               VendorAttr;&#10;  NTSTATUS(                 *ReaderFunction[16];&#10;  SCARD_CARD_CAPABILITIES   CardCapabilities;&#10;  ULONG                     LastError;&#10;  struct {&#10;    PULONG Information;&#10;    PUCHAR RequestBuffer;&#10;    ULONG  RequestBufferLength;&#10;    PUCHAR ReplyBuffer;&#10;    ULONG  ReplyBufferLength;&#10;  } IoRequest;&#10;  ULONG                     MajorIoControlCode;&#10;  ULONG                     MinorIoControlCode;&#10;  POS_DEP_DATA              OsData;&#10;  SCARD_READER_CAPABILITIES ReaderCapabilities;&#10;  PREADER_EXTENSION         ReaderExtension;&#10;  SMARTCARD_REPLY           SmartcardReply;&#10;  SMARTCARD_REQUEST         SmartcardRequest;&#10;...">SMARTCARD_EXTENSION</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/smartcard/smartcard-rdf-transmit-callback">View the official Windows hardware development documentation</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs/blob/staging/windows-driver-docs-pr/smartcard/smartcard-rdf-transmit-callback.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
