<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NtSetSecurityObject - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NtSetSecurityObject - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NtSetSecurityObject - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTOBAPI_H
//
// Objects, handles
//
#if (PHNT_MODE != PHNT_MODE_KERNEL)

</span><span class="ntdoc-code-intro">/**
 * The NtSetSecurityObject routine sets an object&#x27;s security state.
 *
 * @param Handle Handle for the object whose security state is to be set.
 * @param SecurityInformation A SECURITY_INFORMATION value specifying the information to be set.
 * @param SecurityDescriptor Pointer to the security descriptor to be set for the object.
 * @return <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> Successful or errant status.
 * @sa https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/nf-ntifs-zwsetsecurityobject
 */
</span><span class="ntdoc-code-body">NTSYSCALLAPI
<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>
NTAPI
NtSetSecurityObject(
    _In_ HANDLE Handle,
    _In_ SECURITY_INFORMATION SecurityInformation,
    _In_ PSECURITY_DESCRIPTOR SecurityDescriptor
    );
</span><span class="ntdoc-code-footer">
#endif
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/addd49805cb586a891f7c6f31d88a43545cc1c80/phnt/include/ntobapi.h#L370">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTZWAPI_H

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NTSYSCALLAPI
<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>
NTAPI
ZwSetSecurityObject(
    _In_ HANDLE Handle,
    _In_ SECURITY_INFORMATION SecurityInformation,
    _In_ PSECURITY_DESCRIPTOR SecurityDescriptor
    );
</span><span class="ntdoc-code-footer">
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/addd49805cb586a891f7c6f31d88a43545cc1c80/phnt/include/ntzwapi.h#L4440">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntifs.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">__kernel_entry NTSYSCALLAPI <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> NtSetSecurityObject(
  [in] HANDLE               Handle,
  [in] SECURITY_INFORMATION SecurityInformation,
  [in] PSECURITY_DESCRIPTOR SecurityDescriptor
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-ntsetsecurityobject">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntifs.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NTSYSAPI <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> ZwSetSecurityObject(
  [in] HANDLE               Handle,
  [in] SECURITY_INFORMATION SecurityInformation,
  [in] PSECURITY_DESCRIPTOR SecurityDescriptor
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-zwsetsecurityobject">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ntsetsecurityobject.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ntifs-ntsetsecurityobject)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="ntsetsecurityobject-function">NtSetSecurityObject function</h1>

<h2 id="description">Description</h2>

<p>The <strong>NtSetSecurityObject</strong> routine sets an object's security state.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="handle-in"><code>Handle</code> [in]</h3>

<p>Handle for the object whose security state is to be set. This handle must have the access specified in the Meaning column of the table shown in the description of the <strong>SecurityInformation</strong> parameter.</p>

<h3 id="securityinformation-in"><code>SecurityInformation</code> [in]</h3>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ifs/security-information"><strong>SECURITY_INFORMATION</strong></a> value specifying the information to be set as a combination of one or more of the following.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>OWNER_SECURITY_INFORMATION</td>
  <td>Indicates the owner identifier of the object is to be set. Requires WRITE_OWNER access.</td>
</tr>
<tr>
  <td>GROUP_SECURITY_INFORMATION</td>
  <td>Indicates the primary group identifier of the object is to be set. Requires WRITE_OWNER access.</td>
</tr>
<tr>
  <td>SACL_SECURITY_INFORMATION</td>
  <td>Indicates the system <a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a> (SACL) of the object is to be set. Requires ACCESS_SYSTEM_SECURITY access.</td>
</tr>
<tr>
  <td>DACL_SECURITY_INFORMATION</td>
  <td>Indicates the discretionary access control list (DACL) of the object is to be set. Requires WRITE_DAC access.</td>
</tr>
</tbody>
</table>

<h3 id="securitydescriptor-in"><code>SecurityDescriptor</code> [in]</h3>

<p>Pointer to the security descriptor to be set for the object.</p>

<h2 id="return-value">Return value</h2>

<p><strong>NtSetSecurityObject</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> or an appropriate error status. Possible error status codes include the following:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>STATUS_ACCESS_DENIED</td>
  <td>The caller did not have the required access.</td>
</tr>
<tr>
  <td>STATUS_ACCESS_VIOLATION</td>
  <td><strong>SecurityDescriptor</strong> was a <strong>NULL</strong> pointer.</td>
</tr>
<tr>
  <td>STATUS_INSUFFICIENT_RESOURCES</td>
  <td>The object's security descriptor could not be captured.</td>
</tr>
<tr>
  <td>STATUS_INVALID_ACL</td>
  <td>The object's security descriptor contained an invalid <a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a>.</td>
</tr>
<tr>
  <td>STATUS_INVALID_HANDLE</td>
  <td><strong>Handle</strong> is not a valid handle.</td>
</tr>
<tr>
  <td>STATUS_INVALID_SECURITY_DESCR</td>
  <td><strong>SecurityDescriptor</strong> did not point to a valid security descriptor.</td>
</tr>
<tr>
  <td>STATUS_INVALID_SID</td>
  <td>The object's security descriptor contained an invalid <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a>.</td>
</tr>
<tr>
  <td>STATUS_OBJECT_TYPE_MISMATCH</td>
  <td><strong>Handle</strong> is not a handle of the expected type.</td>
</tr>
<tr>
  <td>STATUS_UNKNOWN_REVISION</td>
  <td>The revision level of the object's security descriptor was unknown or not supported.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>A security descriptor can be in absolute or self-relative form. In self-relative form, all members of the structure are located contiguously in memory. In absolute form, the structure only contains pointers to the members. For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/secauthz/absolute-and-self-relative-security-descriptors">Absolute and Self-Relative Security Descriptors</a>.</p>

<p>For more information about security and access control, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/driversecurity/windows-security-model">Windows security model for driver developers</a> and the documentation on these topics in the Windows SDK.</p>

<p>Minifilters should use <strong><a href="fltsetsecurityobject" title="NTSTATUS FLTAPI FltSetSecurityObject(&#10;  [in] PFLT_INSTANCE        Instance,&#10;  [in] PFILE_OBJECT         FileObject,&#10;  [in] SECURITY_INFORMATION SecurityInformation,&#10;  [in] PSECURITY_DESCRIPTOR SecurityDescriptor&#10;);">FltSetSecurityObject</a></strong> instead of <strong>NtSetSecurityObject</strong>.</p>

<p>Callers of <strong>NtSetSecurityObject</strong> must be running at IRQL = PASSIVE_LEVEL and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/disabling-apcs">with special kernel APCs enabled</a>.</p>

<blockquote>
  <p>[!NOTE]
  If the call to the <strong>NtSetSecurityObject</strong> function occurs in user mode, you should use the name "<strong>NtSetSecurityObject</strong>" instead of "<strong>ZwSetSecurityObject</strong>".</p>
</blockquote>

<p>For calls from kernel-mode drivers, the <strong>Nt*Xxx</strong>* and <strong>Zw*Xxx</strong>* versions of a Windows Native System Services routine can behave differently in the way that they handle and interpret input parameters. For more information about the relationship between the <strong>Nt*Xxx</strong>* and <strong>Zw*Xxx</strong>* versions of a routine, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/using-nt-and-zw-versions-of-the-native-system-services-routines">Using Nt and Zw Versions of the Native System Services Routines</a>.</p>

<h2 id="see-also">See also</h2>

<p><strong><a href="fltsetsecurityobject" title="NTSTATUS FLTAPI FltSetSecurityObject(&#10;  [in] PFLT_INSTANCE        Instance,&#10;  [in] PFILE_OBJECT         FileObject,&#10;  [in] SECURITY_INFORMATION SecurityInformation,&#10;  [in] PSECURITY_DESCRIPTOR SecurityDescriptor&#10;);">FltSetSecurityObject</a></strong></p>

<p><strong><a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a></strong></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ifs/security-information"><strong>SECURITY_INFORMATION</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/using-nt-and-zw-versions-of-the-native-system-services-routines"><strong>Using Nt and Zw Versions of the Native System Services Routines</strong></a></p>

<p><strong><a href="ntquerysecurityobject" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQuerySecurityObject(&#10;    _In_ HANDLE Handle,&#10;    _In_ SECURITY_INFORMATION SecurityInformation,&#10;    _Out_writes_bytes_to_opt_(Length, *LengthNeeded) PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_ ULONG Length,&#10;    _Out_ PULONG LengthNeeded&#10;    );">NtQuerySecurityObject</a></strong></p>

<p><strong>ZwSetSecurityObject</strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-ntsetsecurityobject">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntifs/nf-ntifs-ntsetsecurityobject.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ntifs-zwsetsecurityobject)</h1>
</div>
<div class="ntdoc-description">
<h1>ZwSetSecurityObject function</h1>

<h2>Description</h2>

<p>The <strong>ZwSetSecurityObject</strong> routine sets an object's security state.</p>

<h2>Parameters</h2>

<h3><code>Handle</code> [in]</h3>

<p>Handle for the object whose security state is to be set. This handle must have the access specified in the Meaning column of the table shown in the description of the <strong>SecurityInformation</strong> parameter.</p>

<h3><code>SecurityInformation</code> [in]</h3>

<p>A <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ifs/security-information"><strong>SECURITY_INFORMATION</strong></a>value specifying the information to be set. Can be a combination of one or more of the following values.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>DACL_SECURITY_INFORMATION</td>
  <td>Indicates the discretionary access control list (DACL) of the object is to be set. Requires WRITE_DAC access.</td>
</tr>
<tr>
  <td>GROUP_SECURITY_INFORMATION</td>
  <td>Indicates the primary group identifier of the object is to be set. Requires WRITE_OWNER access.</td>
</tr>
<tr>
  <td>OWNER_SECURITY_INFORMATION</td>
  <td>Indicates the owner identifier of the object is to be set. Requires WRITE_OWNER access.</td>
</tr>
<tr>
  <td>SACL_SECURITY_INFORMATION</td>
  <td>Indicates the system <a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a> (SACL) of the object is to be set. Requires ACCESS_SYSTEM_SECURITY access.</td>
</tr>
</tbody>
</table>

<h3><code>SecurityDescriptor</code> [in]</h3>

<p>Pointer to the security descriptor to be set for the object.</p>

<h2>Return value</h2>

<p><strong>ZwSetSecurityObject</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> or an appropriate error status. Possible error status codes include the following:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>STATUS_ACCESS_DENIED</td>
  <td><strong>Handle</strong> does not have the required access rights.</td>
</tr>
<tr>
  <td>STATUS_ACCESS_VIOLATION</td>
  <td><strong>SecurityDescriptor</strong> is a <strong>NULL</strong> pointer.</td>
</tr>
<tr>
  <td>STATUS_INSUFFICIENT_RESOURCES</td>
  <td>The object's security descriptor could not be captured.</td>
</tr>
<tr>
  <td>STATUS_INVALID_ACL</td>
  <td>The object's security descriptor contains an invalid <a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a>.</td>
</tr>
<tr>
  <td>STATUS_INVALID_HANDLE</td>
  <td><strong>Handle</strong> is not a valid handle.</td>
</tr>
<tr>
  <td>STATUS_INVALID_SECURITY_DESCR</td>
  <td><strong>SecurityDescriptor</strong> does not point to a valid security descriptor.</td>
</tr>
<tr>
  <td>STATUS_INVALID_SID</td>
  <td>The object's security descriptor contains an invalid <strong><a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a></strong>.</td>
</tr>
<tr>
  <td>STATUS_OBJECT_TYPE_MISMATCH</td>
  <td><strong>Handle</strong> is not a handle of the expected type.</td>
</tr>
<tr>
  <td>STATUS_UNKNOWN_REVISION</td>
  <td>The revision level of the object's security descriptor is unknown or is not supported.</td>
</tr>
</tbody>
</table>

<h2>Remarks</h2>

<p>A security descriptor can be in absolute or self-relative form. In self-relative form, all members of the structure are located contiguously in memory. In absolute form, the structure only contains pointers to the members. For more information, see "Absolute and Self-Relative Security Descriptors" in the Security section of the Windows SDK documentation.</p>

<p>For more information about security and access control, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/driversecurity/windows-security-model">Windows security model for driver developers</a> and the documentation on these topics in the Windows SDK.</p>

<p>Minifilters should use <strong><a href="fltsetsecurityobject" title="NTSTATUS FLTAPI FltSetSecurityObject(&#10;  [in] PFLT_INSTANCE        Instance,&#10;  [in] PFILE_OBJECT         FileObject,&#10;  [in] SECURITY_INFORMATION SecurityInformation,&#10;  [in] PSECURITY_DESCRIPTOR SecurityDescriptor&#10;);">FltSetSecurityObject</a></strong> instead of <strong>ZwSetSecurityObject</strong>.</p>

<p>Callers of <strong>ZwSetSecurityObject</strong> must be running at IRQL = PASSIVE_LEVEL and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/disabling-apcs">with special kernel APCs enabled</a>.</p>

<blockquote>
  <p>[!NOTE]
  If the call to the <strong>ZwSetSecurityObject</strong> function occurs in user mode, you should use the name "<strong>NtSetSecurityObject</strong>" instead of "<strong>ZwSetSecurityObject</strong>".</p>
</blockquote>

<p>For calls from kernel-mode drivers, the <strong>Nt*Xxx</strong>* and <strong>Zw*Xxx</strong>* versions of a Windows Native System Services routine can behave differently in the way that they handle and interpret input parameters. For more information about the relationship between the <strong>Nt*Xxx</strong>* and <strong>Zw*Xxx</strong>* versions of a routine, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/using-nt-and-zw-versions-of-the-native-system-services-routines">Using Nt and Zw Versions of the Native System Services Routines</a>.</p>

<h2>See also</h2>

<p><strong><a href="fltsetsecurityobject" title="NTSTATUS FLTAPI FltSetSecurityObject(&#10;  [in] PFLT_INSTANCE        Instance,&#10;  [in] PFILE_OBJECT         FileObject,&#10;  [in] SECURITY_INFORMATION SecurityInformation,&#10;  [in] PSECURITY_DESCRIPTOR SecurityDescriptor&#10;);">FltSetSecurityObject</a></strong></p>

<p><strong><a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a></strong></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ifs/security-information"><strong>SECURITY_INFORMATION</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/using-nt-and-zw-versions-of-the-native-system-services-routines">Using Nt and Zw Versions of the Native System Services Routines</a></p>

<p><strong><a href="ntquerysecurityobject" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQuerySecurityObject(&#10;    _In_ HANDLE Handle,&#10;    _In_ SECURITY_INFORMATION SecurityInformation,&#10;    _Out_writes_bytes_to_opt_(Length, *LengthNeeded) PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_ ULONG Length,&#10;    _Out_ PULONG LengthNeeded&#10;    );">ZwQuerySecurityObject</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-zwsetsecurityobject">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntifs/nf-ntifs-zwsetsecurityobject.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>NTinternals.net (undocumented.ntinternals.net)</h1>
</div>
<div class="ntdoc-description">
<p>This function is documented in Windows Driver Kit <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/nf-ntifs-ntsetsecurityobject">here</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/nf-ntifs-zwsetsecurityobject">here</a>.</p>

<hr />

<p>Function <code>NtSetSecurityDescriptor</code> writes object's Security Descriptor.</p>

<h3>ObjectHandle</h3>

<p><code>HANDLE</code> to object of any type. Must be opened with <code>WRITE_DAC</code> or <code>WRITE_OWNER</code> access depending on <code>SecurityInformationClass</code> parameter.</p>

<h3>SecurityInformationClass</h3>

<p>See <code><a href="ntquerysecurityobject" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQuerySecurityObject(&#10;    _In_ HANDLE Handle,&#10;    _In_ SECURITY_INFORMATION SecurityInformation,&#10;    _Out_writes_bytes_to_opt_(Length, *LengthNeeded) PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_ ULONG Length,&#10;    _Out_ PULONG LengthNeeded&#10;    );">NtQuerySecurityObject</a></code> for possible values.</p>

<h3>DescriptorBuffer</h3>

<p>Pointer to user's allocated <code><a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a></code> to set.</p>

<h1>Documented by</h1>

<ul>
<li>Tomasz Nowak</li>
</ul>

<h1>See also</h1>

<ul>
<li><code><a href="ntquerysecurityobject" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQuerySecurityObject(&#10;    _In_ HANDLE Handle,&#10;    _In_ SECURITY_INFORMATION SecurityInformation,&#10;    _Out_writes_bytes_to_opt_(Length, *LengthNeeded) PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_ ULONG Length,&#10;    _Out_ PULONG LengthNeeded&#10;    );">NtQuerySecurityObject</a></code></li>
<li><code><a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a></code></li>
</ul>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/undocumented.ntinternals.net/ntsetsecurityobject.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
