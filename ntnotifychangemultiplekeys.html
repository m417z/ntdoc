<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NtNotifyChangeMultipleKeys - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NtNotifyChangeMultipleKeys - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NtNotifyChangeMultipleKeys - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTREGAPI_H

</span><span class="ntdoc-code-intro">/**
 * Requests notification when a registry key or any of its subkeys changes.
 *
 * @param MasterKeyHandle A handle to an open key. The handle must be opened with the KEY_NOTIFY access right.
 * @param Count The number of subkeys under the key specified by the MasterKeyHandle parameter.
 * @param SubordinateObjects Pointer to an array of <a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PVOID SecurityDescriptor; // PSECURITY_DESCRIPTOR;&#10;    PVOID SecurityQualityOfService; // PSECURITY_QUALITY_OF_SERVICE&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">OBJECT_ATTRIBUTES</a> structures, one for each subkey. This array can contain one <a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PVOID SecurityDescriptor; // PSECURITY_DESCRIPTOR;&#10;    PVOID SecurityQualityOfService; // PSECURITY_QUALITY_OF_SERVICE&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">OBJECT_ATTRIBUTES</a> structure.
 * @param Event A handle to an event created by the caller. If Event is not NULL, the caller waits until the operation succeeds, at which time the event is signaled.
 * @param ApcRoutine A pointer to an asynchronous procedure call (APC) function supplied by the caller. If ApcRoutine is not NULL, the specified APC function executes after the operation completes.
 * @param ApcContext A pointer to a context supplied by the caller for its APC function. This value is passed to the APC function when it is executed. The Asynchronous parameter must be TRUE. If ApcContext is specified, the Event parameter must be NULL.
 * @param IoStatusBlock A pointer to an <a href="io_status_block" title="typedef struct _IO_STATUS_BLOCK&#10;{&#10;    union&#10;    {&#10;        NTSTATUS Status;&#10;        PVOID Pointer;&#10;    };&#10;    ULONG_PTR Information;&#10;} IO_STATUS_BLOCK, *PIO_STATUS_BLOCK;">IO_STATUS_BLOCK</a> structure that contains the final status and information about the operation. For successful calls that return data, the number of bytes written to the Buffer parameter is supplied in the Information member of the <a href="io_status_block" title="typedef struct _IO_STATUS_BLOCK&#10;{&#10;    union&#10;    {&#10;        NTSTATUS Status;&#10;        PVOID Pointer;&#10;    };&#10;    ULONG_PTR Information;&#10;} IO_STATUS_BLOCK, *PIO_STATUS_BLOCK;">IO_STATUS_BLOCK</a> structure.
 * @param CompletionFilter A bitmap of operations that trigger notification. This parameter can be one or more of the following flags. REG_NOTIFY_CHANGE_NAME, REG_NOTIFY_CHANGE_ATTRIBUTES, REG_NOTIFY_CHANGE_LAST_SET, REG_NOTIFY_CHANGE_SECURITY.
 * @param WatchTree If this parameter is TRUE, the caller is notified about changes to all subkeys of the specified key. If this parameter is FALSE, the caller is notified only about changes to the specified key.
 * @param Buffer Reserved for system use. This parameter must be NULL.
 * @param BufferSize Reserved for system use. This parameter must be zero.
 * @param Asynchronous Whether the operation is asynchronous.
 * @return <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> Successful or errant status.
 */
</span><span class="ntdoc-code-body">NTSYSCALLAPI
<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>
NTAPI
NtNotifyChangeMultipleKeys(
    _In_ HANDLE MasterKeyHandle,
    _In_opt_ <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Count,
    _In_reads_opt_(Count) <a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PVOID SecurityDescriptor; // PSECURITY_DESCRIPTOR;&#10;    PVOID SecurityQualityOfService; // PSECURITY_QUALITY_OF_SERVICE&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">OBJECT_ATTRIBUTES</a> SubordinateObjects[],
    _In_opt_ HANDLE Event,
    _In_opt_ <a href="pio_apc_routine" title="typedef IO_APC_ROUTINE* PIO_APC_ROUTINE;">PIO_APC_ROUTINE</a> ApcRoutine,
    _In_opt_ PVOID ApcContext,
    _Out_ <a href="io_status_block" title="typedef struct _IO_STATUS_BLOCK&#10;{&#10;    union&#10;    {&#10;        NTSTATUS Status;&#10;        PVOID Pointer;&#10;    };&#10;    ULONG_PTR Information;&#10;} IO_STATUS_BLOCK, *PIO_STATUS_BLOCK;">PIO_STATUS_BLOCK</a> IoStatusBlock,
    _In_ <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> CompletionFilter,
    _In_ BOOLEAN WatchTree,
    _Out_writes_bytes_opt_(BufferSize) PVOID Buffer,
    _In_ <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> BufferSize,
    _In_ BOOLEAN Asynchronous
    );
</span><span class="ntdoc-code-footer">
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/b281a48adceb1d88b4db663cbaf84ab06cc7074d/phnt/include/ntregapi.h#L1320">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTZWAPI_H

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NTSYSCALLAPI
<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>
NTAPI
ZwNotifyChangeMultipleKeys(
    _In_ HANDLE MasterKeyHandle,
    _In_opt_ <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Count,
    _In_reads_opt_(Count) <a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PVOID SecurityDescriptor; // PSECURITY_DESCRIPTOR;&#10;    PVOID SecurityQualityOfService; // PSECURITY_QUALITY_OF_SERVICE&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">OBJECT_ATTRIBUTES</a> SubordinateObjects[],
    _In_opt_ HANDLE Event,
    _In_opt_ <a href="pio_apc_routine" title="typedef IO_APC_ROUTINE* PIO_APC_ROUTINE;">PIO_APC_ROUTINE</a> ApcRoutine,
    _In_opt_ PVOID ApcContext,
    _Out_ <a href="io_status_block" title="typedef struct _IO_STATUS_BLOCK&#10;{&#10;    union&#10;    {&#10;        NTSTATUS Status;&#10;        PVOID Pointer;&#10;    };&#10;    ULONG_PTR Information;&#10;} IO_STATUS_BLOCK, *PIO_STATUS_BLOCK;">PIO_STATUS_BLOCK</a> IoStatusBlock,
    _In_ <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> CompletionFilter,
    _In_ BOOLEAN WatchTree,
    _Out_writes_bytes_opt_(BufferSize) PVOID Buffer,
    _In_ <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> BufferSize,
    _In_ BOOLEAN Asynchronous
    );
</span><span class="ntdoc-code-footer">
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/b281a48adceb1d88b4db663cbaf84ab06cc7074d/phnt/include/ntzwapi.h#L2469">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// winternl.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">__kernel_entry <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> NtNotifyChangeMultipleKeys(
  [in]            HANDLE               MasterKeyHandle,
  [in, optional]  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                Count,
  [in, optional]  <a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PVOID SecurityDescriptor; // PSECURITY_DESCRIPTOR;&#10;    PVOID SecurityQualityOfService; // PSECURITY_QUALITY_OF_SERVICE&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">OBJECT_ATTRIBUTES</a> [] SubordinateObjects,
  [in, optional]  HANDLE               Event,
  [in, optional]  <a href="pio_apc_routine" title="typedef IO_APC_ROUTINE* PIO_APC_ROUTINE;">PIO_APC_ROUTINE</a>      ApcRoutine,
  [in, optional]  PVOID                ApcContext,
  [out]           <a href="io_status_block" title="typedef struct _IO_STATUS_BLOCK&#10;{&#10;    union&#10;    {&#10;        NTSTATUS Status;&#10;        PVOID Pointer;&#10;    };&#10;    ULONG_PTR Information;&#10;} IO_STATUS_BLOCK, *PIO_STATUS_BLOCK;">PIO_STATUS_BLOCK</a>     IoStatusBlock,
  [in]            <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                CompletionFilter,
  [in]            BOOLEAN              WatchTree,
  [out, optional] PVOID                Buffer,
  [in]            <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                BufferSize,
  [in]            BOOLEAN              Asynchronous
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows/win32/api/winternl/nf-winternl-ntnotifychangemultiplekeys">View the official Win32 API reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<p>This function is <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntnotifychangemultiplekeys">documented in Windows SDK</a>.</p>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ntnotifychangemultiplekeys.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Win32 API reference (nf-winternl-ntnotifychangemultiplekeys)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="ntnotifychangemultiplekeys-function">NtNotifyChangeMultipleKeys function</h1>

<h2 id="description">Description</h2>

<p>[This function may be changed or removed from Windows without further notice. ]</p>

<p>Requests notification when a registry key or any of its subkeys changes.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="masterkeyhandle-in"><code>MasterKeyHandle</code> [in]</h3>

<p>A handle to an open key. The handle must be opened with the <strong>KEY_NOTIFY</strong> access right.</p>

<h3 id="count-in-optional"><code>Count</code> [in, optional]</h3>

<p>The number of keys objects provided in the <em>SubordinateObjects</em> parameter. This parameter must be 1.</p>

<h3 id="subordinateobjects-in-optional"><code>SubordinateObjects</code> [in, optional]</h3>

<p>Pointer to an array of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/content/wudfwdm/ns-wudfwdm-_object_attributes">OBJECT_ATTRIBUTES</a> structures, one for each key. This array can contain one <strong><a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PVOID SecurityDescriptor; // PSECURITY_DESCRIPTOR;&#10;    PVOID SecurityQualityOfService; // PSECURITY_QUALITY_OF_SERVICE&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">OBJECT_ATTRIBUTES</a></strong> structure and must not be a key in the same hive as the <em>MasterKeyHandle</em> key.</p>

<h3 id="event-in-optional"><code>Event</code> [in, optional]</h3>

<p>A handle to an event created by the caller. If <em>Event</em> is not <strong>NULL</strong>, the caller waits until the operation succeeds, at which time the event is signaled.</p>

<h3 id="apcroutine-in-optional"><code>ApcRoutine</code> [in, optional]</h3>

<p>A pointer to an asynchronous procedure call (APC) function supplied by the caller. If <em>ApcRoutine</em> is not <strong>NULL</strong>, the specified APC function executes after the operation completes. A <a href="work_queue_item" title="typedef struct _WORK_QUEUE_ITEM {&#10;  LIST_ENTRY             List;&#10;  PWORKER_THREAD_ROUTINE WorkerRoutine;&#10;  __volatile PVOID       Parameter;&#10;} WORK_QUEUE_ITEM, *PWORK_QUEUE_ITEM;">WORK_QUEUE_ITEM</a> must be provided instead of ApcRoutine in the <em>ZwNotifyChangeMultipleKeys</em> variant.</p>

<h3 id="apccontext-in-optional"><code>ApcContext</code> [in, optional]</h3>

<p>A pointer to a context supplied by the caller for its APC function. This value is passed to the APC function when it is executed. The <em>Asynchronous</em> parameter must be <strong>TRUE</strong>. If <em>ApcContext</em> is specified, the <em>Event</em> parameter must be <strong>NULL</strong>. A <a href="work_queue_type" title="typedef enum _WORK_QUEUE_TYPE {&#10;  CriticalWorkQueue,&#10;  DelayedWorkQueue,&#10;  HyperCriticalWorkQueue,&#10;  NormalWorkQueue,&#10;  BackgroundWorkQueue,&#10;  RealTimeWorkQueue,&#10;  SuperCriticalWorkQueue,&#10;  MaximumWorkQueue,&#10;  CustomPriorityWorkQueue&#10;} WORK_QUEUE_TYPE;">WORK_QUEUE_TYPE</a> must be provided instead of ApcContext in the <em>ZwNotifyChangeMultipleKeys</em> variant.</p>

<h3 id="iostatusblock-out"><code>IoStatusBlock</code> [out]</h3>

<p>A pointer to an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/content/wdm/ns-wdm-_io_status_block">IO_STATUS_BLOCK</a> structure that contains the final status and information about the operation. For successful calls that return data, the number of bytes written to the <em>Buffer</em> parameter is supplied in the <strong>Information</strong> member of the <strong><a href="io_status_block" title="typedef struct _IO_STATUS_BLOCK&#10;{&#10;    union&#10;    {&#10;        NTSTATUS Status;&#10;        PVOID Pointer;&#10;    };&#10;    ULONG_PTR Information;&#10;} IO_STATUS_BLOCK, *PIO_STATUS_BLOCK;">IO_STATUS_BLOCK</a></strong> structure.</p>

<h3 id="completionfilter-in"><code>CompletionFilter</code> [in]</h3>

<p>A bitmap of operations that trigger notification. This parameter can be one or more of the following flags.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>REG_NOTIFY_CHANGE_NAME</strong></td>
  <td>Notify the caller if a subkey is added or deleted.</td>
</tr>
<tr>
  <td><strong>REG_NOTIFY_CHANGE_ATTRIBUTES</strong></td>
  <td>Notify the caller of changes to the attributes of the key, such as the security descriptor information.</td>
</tr>
<tr>
  <td><strong>REG_NOTIFY_CHANGE_LAST_SET</strong></td>
  <td>Notify the caller of changes to a value of the key. This can include adding or deleting a value, or changing an existing value.</td>
</tr>
<tr>
  <td><strong>REG_NOTIFY_CHANGE_SECURITY</strong></td>
  <td>Notify the caller of changes to the security descriptor of the key.</td>
</tr>
</tbody>
</table>

<h3 id="watchtree-in"><code>WatchTree</code> [in]</h3>

<p>If this parameter is <strong>TRUE</strong>, the caller is notified about changes to all subkeys of the specified key. If this parameter is <strong>FALSE</strong>, the caller is notified only about changes to the specified key.</p>

<h3 id="buffer-out-optional"><code>Buffer</code> [out, optional]</h3>

<p>Reserved for system use. This parameter must be <strong>NULL</strong>.</p>

<h3 id="buffersize-in"><code>BufferSize</code> [in]</h3>

<p>Reserved for system use. This parameter must be zero.</p>

<h3 id="asynchronous-in"><code>Asynchronous</code> [in]</h3>

<p>If this parameter is <strong>TRUE</strong>, the function returns immediately. If this parameter is <strong>FALSE</strong>, the function does not return until the specified event occurs.</p>

<h2 id="return-value">Return value</h2>

<p>Returns an <strong><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a></strong> or error code.</p>

<p>If the <em>Asynchronous</em> parameter is <strong>TRUE</strong> and the specified event has not yet occurred, the function returns <strong>STATUS_PENDING</strong>.</p>

<p>The forms and significance of <strong><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a></strong> error codes are listed in the Ntstatus.h header file available in the WDK, and are described in the WDK documentation.</p>

<h2 id="remarks">Remarks</h2>

<p>This function has no associated header file. You can also use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/DevNotes/-loadlibrary">LoadLibrary</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/DevNotes/-getprocaddress-">GetProcAddress</a> functions to dynamically link to Ntdll.dll.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/SysInfo/registry-key-security-and-access-rights">Registry Key Security and Access Rights</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows/win32/api/winternl/nf-winternl-ntnotifychangemultiplekeys">View the official Win32 API reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/sdk-api/blob/docs/sdk-api-src/content/winternl/nf-winternl-ntnotifychangemultiplekeys.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
