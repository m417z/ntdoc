<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="MODM_OPEN - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>MODM_OPEN - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            MODM_OPEN - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// mmddk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="dword" title="typedef unsigned long DWORD;">DWORD</a> <a href="modmessage" title="DWORD modMessage(&#10;   UINT      uDeviceID,&#10;   UINT      uMsg,&#10;   DWORD_PTR dwUser,&#10;   DWORD_PTR dwParam1,&#10;   DWORD_PTR dwParam2&#10;);">modMessage</a>(
   <a href="uint" title="typedef unsigned int UINT;">UINT</a>      uDeviceID,
   <a href="uint" title="typedef unsigned int UINT;">UINT</a>      uMsg,
   <a href="dword_ptr" title="typedef ULONG_PTR DWORD_PTR;">DWORD_PTR</a> dwUser,
   <a href="dword_ptr" title="typedef ULONG_PTR DWORD_PTR;">DWORD_PTR</a> dwParam1,
   <a href="dword_ptr" title="typedef ULONG_PTR DWORD_PTR;">DWORD_PTR</a> dwParam2
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/modm-open">View the official Windows hardware development documentation</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/modm_open.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows hardware development documentation (modm-open)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>MODM_OPEN function</h1>

<p>WINMM sends the <code>MODM_OPEN</code> message to the <strong><a href="modmessage" title="DWORD modMessage(&#10;   UINT      uDeviceID,&#10;   UINT      uMsg,&#10;   DWORD_PTR dwUser,&#10;   DWORD_PTR dwParam1,&#10;   DWORD_PTR dwParam2&#10;);">modMessage</a></strong> function of a MIDI output driver to allocate a specified device that a client application can use.</p>

<h2>Parameters</h2>

<ul>
<li><p><em>uDeviceID</em>
Specifies the ID of the target device. Device IDs are sequential and have an initial value of zero and a final value equal that is to one less than the number of devices that the driver supports.</p></li>
<li><p><em>uMsg</em>
WINMM sets this parameter to <strong>MODM_OPEN</strong> when it calls <strong><a href="modmessage" title="DWORD modMessage(&#10;   UINT      uDeviceID,&#10;   UINT      uMsg,&#10;   DWORD_PTR dwUser,&#10;   DWORD_PTR dwParam1,&#10;   DWORD_PTR dwParam2&#10;);">modMessage</a></strong> to process this message.</p></li>
<li><p><em>dwUser</em>
The MIDI output driver must fill this location with its instance data, but only in response to the <code>MODM_OPEN</code>.</p></li>
<li><p><em>dwParam1</em>
This parameter specifies a far pointer to a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/mmddk/ns-mmddk-midiopendesc"><strong>MIDIOPENDESC</strong></a> structure. This structure contains additional information for the driver such as instance data from the client and a callback function for the client.</p></li>
<li><p><em>dwParam2</em>
This parameter specifies option flags that determine how the device is opened. The flags can be any of the values in the following table.</p></li>
</ul>

<table>
<thead>
<tr>
  <th>Flag</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>CALLBACK_EVENT</td>
  <td>If this flag is specified, <strong>dwCallback</strong> in the <strong>MIDIOPENDESC</strong> structure is assumed to be an event handle.</td>
</tr>
<tr>
  <td>CALLBACK_FUNCTION</td>
  <td>If this flag is specified, <strong>dwCallback</strong> in the <strong>MIDIOPENDESC</strong> structure is assumed to be the address of a callback function.</td>
</tr>
<tr>
  <td>CALLBACK_THREAD</td>
  <td>If this flag is specified, <strong>dwCallback</strong> in the <strong>MIDIOPENDESC</strong> structure is assumed to be a handle to a thread.</td>
</tr>
<tr>
  <td>CALLBACK_WINDOW</td>
  <td>If this flag is specified, <strong>dwCallback</strong> in the <strong>MIDIOPENDESC</strong> structure is assumed to be a window handle.</td>
</tr>
<tr>
  <td>MIDI_IO_COOKED</td>
  <td>If this flag is specified, the device is opened in stream mode and the driver receives stream messages. The driver must be able to handle any contingencies that arise. For example, the driver must be able to play short messages and system-exclusive messages asynchronously to the stream.</td>
</tr>
</tbody>
</table>

<h2>Return value</h2>

<p>The <strong><a href="modmessage" title="DWORD modMessage(&#10;   UINT      uDeviceID,&#10;   UINT      uMsg,&#10;   DWORD_PTR dwUser,&#10;   DWORD_PTR dwParam1,&#10;   DWORD_PTR dwParam2&#10;);">modMessage</a></strong> function returns MMSYSERR_NOERROR if the operation is successful. Otherwise it returns one of the error messages in the following table.</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>MMSYSERR_NOTENABLED</strong></td>
  <td>The driver failed to load or initialize.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_ALLOCATED</strong></td>
  <td>The MIDI device is already allocated by the maximum number of clients that the driver supports or the device cannot be opened because of system resource limitations other than memory.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_NOMEM</strong></td>
  <td>The device cannot be opened because of a failure to allocate or lock memory.</td>
</tr>
</tbody>
</table>

<h2>Remarks</h2>

<p>The driver must be able to determine the number of clients it can allow to use a particular device. After a device is opened for the maximum number of clients that the driver supports, the driver returns MMSYSERR_ALLOCATED for any additional requests to open the device. If the open operation is successful, the driver uses the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/mmiscapi/nf-mmiscapi-drivercallback">DriverCallback</a> function to send the client a <strong><a href="mom_open" title="DWORD modMessage(&#10;   UINT      uDeviceID,&#10;   UINT      uMsg,&#10;   DWORD_PTR dwUser,&#10;   DWORD_PTR dwParam1,&#10;   DWORD_PTR dwParam2&#10;);">MOM_OPEN</a></strong> message.</p>

<h2>Requirements</h2>

<table>
<thead>
<tr>
  <th></th>
  <th></th>
</tr>
</thead>
<tbody>
<tr>
  <td>Target platform</td>
  <td>Desktop</td>
</tr>
<tr>
  <td>Version</td>
  <td>Available in Windows XP and later Windows operating systems.</td>
</tr>
<tr>
  <td>Header</td>
  <td>Mmddk.h (include Mmddk.h, Mmsystem.h, or Windows.h)</td>
</tr>
</tbody>
</table>

<h2>See also</h2>

<p><strong><a href="modmessage" title="DWORD modMessage(&#10;   UINT      uDeviceID,&#10;   UINT      uMsg,&#10;   DWORD_PTR dwUser,&#10;   DWORD_PTR dwParam1,&#10;   DWORD_PTR dwParam2&#10;);">modMessage</a></strong></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/mmddk/ns-mmddk-midiopendesc"><strong>MIDIOPENDESC</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/mmiscapi/nf-mmiscapi-drivercallback">DriverCallback</a></p>

<p><strong><a href="mom_open" title="DWORD modMessage(&#10;   UINT      uDeviceID,&#10;   UINT      uMsg,&#10;   DWORD_PTR dwUser,&#10;   DWORD_PTR dwParam1,&#10;   DWORD_PTR dwParam2&#10;);">MOM_OPEN</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/modm-open">View the official Windows hardware development documentation</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs/blob/staging/windows-driver-docs-pr/audio/modm-open.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
