<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PCAM_CONFIGURE_ROUTINE_EX - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PCAM_CONFIGURE_ROUTINE_EX - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PCAM_CONFIGURE_ROUTINE_EX - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// usbcamdi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PCAM_CONFIGURE_ROUTINE_EX PcamConfigureRoutineEx;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> PcamConfigureRoutineEx(
  <a href="device_object" title="typedef struct _DEVICE_OBJECT {&#10;  CSHORT                   Type;&#10;  USHORT                   Size;&#10;  LONG                     ReferenceCount;&#10;  struct _DRIVER_OBJECT    *DriverObject;&#10;  struct _DEVICE_OBJECT    *NextDevice;&#10;  struct _DEVICE_OBJECT    *AttachedDevice;&#10;  struct _IRP              *CurrentIrp;&#10;  PIO_TIMER                Timer;&#10;  ULONG                    Flags;&#10;  ULONG                    Characteristics;&#10;  __volatile PVPB          Vpb;&#10;  PVOID                    DeviceExtension;&#10;  DEVICE_TYPE              DeviceType;&#10;  CCHAR                    StackSize;&#10;  union {&#10;    LIST_ENTRY         ListEntry;&#10;    WAIT_CONTEXT_BLOCK Wcb;&#10;  } Queue;&#10;  ULONG                    AlignmentRequirement;&#10;...">PDEVICE_OBJECT</a> BusDeviceObject,
  PVOID DeviceContext,
  <a href="usbd_interface_information" title="typedef struct _USBD_INTERFACE_INFORMATION {&#10;  USHORT                Length;&#10;  UCHAR                 InterfaceNumber;&#10;  UCHAR                 AlternateSetting;&#10;  UCHAR                 Class;&#10;  UCHAR                 SubClass;&#10;  UCHAR                 Protocol;&#10;  UCHAR                 Reserved;&#10;  USBD_INTERFACE_HANDLE InterfaceHandle;&#10;  ULONG                 NumberOfPipes;&#10;  USBD_PIPE_INFORMATION Pipes[1];&#10;} USBD_INTERFACE_INFORMATION, *PUSBD_INTERFACE_INFORMATION;">PUSBD_INTERFACE_INFORMATION</a> Interface,
  <a href="usb_configuration_descriptor" title="typedef struct _USB_CONFIGURATION_DESCRIPTOR {&#10;  UCHAR  bLength;&#10;  UCHAR  bDescriptorType;&#10;  USHORT wTotalLength;&#10;  UCHAR  bNumInterfaces;&#10;  UCHAR  bConfigurationValue;&#10;  UCHAR  iConfiguration;&#10;  UCHAR  bmAttributes;&#10;  UCHAR  MaxPower;&#10;} USB_CONFIGURATION_DESCRIPTOR, *PUSB_CONFIGURATION_DESCRIPTOR;">PUSB_CONFIGURATION_DESCRIPTOR</a> ConfigurationDescriptor,
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> PipeConfigListSize,
  <a href="usbcamd_pipe_config_descriptor" title="typedef struct _pipe_config_descriptor {&#10;  CHAR  StreamAssociation;&#10;  UCHAR PipeConfigFlags;&#10;} USBCAMD_Pipe_Config_Descriptor, *PUSBCAMD_Pipe_Config_Descriptor;">PUSBCAMD_Pipe_Config_Descriptor</a> PipeConfig,
  <a href="usb_device_descriptor" title="typedef struct _USB_DEVICE_DESCRIPTOR {&#10;  UCHAR  bLength;&#10;  UCHAR  bDescriptorType;&#10;  USHORT bcdUSB;&#10;  UCHAR  bDeviceClass;&#10;  UCHAR  bDeviceSubClass;&#10;  UCHAR  bDeviceProtocol;&#10;  UCHAR  bMaxPacketSize0;&#10;  USHORT idVendor;&#10;  USHORT idProduct;&#10;  USHORT bcdDevice;&#10;  UCHAR  iManufacturer;&#10;  UCHAR  iProduct;&#10;  UCHAR  iSerialNumber;&#10;  UCHAR  bNumConfigurations;&#10;} USB_DEVICE_DESCRIPTOR, *PUSB_DEVICE_DESCRIPTOR;">PUSB_DEVICE_DESCRIPTOR</a> DeviceDescriptor
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/usbcamdi/nc-usbcamdi-pcam_configure_routine_ex">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pcam_configure_routine_ex.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-usbcamdi-pcam_configure_routine_ex)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pcam_configure_routine_ex-callback-function">PCAM_CONFIGURE_ROUTINE_EX callback function</h1>

<h2 id="description">Description</h2>

<p>A camera minidriver's <strong>CamConfigureEx</strong> callback function configures the isochronous streaming interface.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="busdeviceobject"><code>BusDeviceObject</code></h3>

<p>Pointer to the camera minidriver's device object created by the USB hub.</p>

<h3 id="devicecontext"><code>DeviceContext</code></h3>

<p>Pointer to the camera minidriver's device context.</p>

<h3 id="interface"><code>Interface</code></h3>

<p>Pointer to the <a href="usbd_interface_information" title="typedef struct _USBD_INTERFACE_INFORMATION {&#10;  USHORT                Length;&#10;  UCHAR                 InterfaceNumber;&#10;  UCHAR                 AlternateSetting;&#10;  UCHAR                 Class;&#10;  UCHAR                 SubClass;&#10;  UCHAR                 Protocol;&#10;  UCHAR                 Reserved;&#10;  USBD_INTERFACE_HANDLE InterfaceHandle;&#10;  ULONG                 NumberOfPipes;&#10;  USBD_PIPE_INFORMATION Pipes[1];&#10;} USBD_INTERFACE_INFORMATION, *PUSBD_INTERFACE_INFORMATION;">USBD_INTERFACE_INFORMATION</a> structure initialized with the proper values for a SELECT_INTERFACE <a href="urb" title="typedef struct _URB {&#10;  union {&#10;#if ...&#10;    _URB_HEADER                                     UrbHeader;&#10;#else&#10;    struct _URB_HEADER                              UrbHeader;&#10;#endif&#10;#if ...&#10;    _URB_SELECT_INTERFACE                           UrbSelectInterface;&#10;#else&#10;    struct _URB_SELECT_INTERFACE                    UrbSelectInterface;&#10;#endif&#10;#if ...&#10;    _URB_SELECT_CONFIGURATION                       UrbSelectConfiguration;&#10;#else&#10;    struct _URB_SELECT_CONFIGURATION                UrbSelectConfiguration;&#10;#endif&#10;#if ...&#10;    _URB_PIPE_REQUEST                               UrbPipeRequest;&#10;#else&#10;...">URB</a> request. This interface structure corresponds to a single isochronous interface on the device.</p>

<h3 id="configurationdescriptor"><code>ConfigurationDescriptor</code></h3>

<p>Pointer to the <a href="usb_configuration_descriptor" title="typedef struct _USB_CONFIGURATION_DESCRIPTOR {&#10;  UCHAR  bLength;&#10;  UCHAR  bDescriptorType;&#10;  USHORT wTotalLength;&#10;  UCHAR  bNumInterfaces;&#10;  UCHAR  bConfigurationValue;&#10;  UCHAR  iConfiguration;&#10;  UCHAR  bmAttributes;&#10;  UCHAR  MaxPower;&#10;} USB_CONFIGURATION_DESCRIPTOR, *PUSB_CONFIGURATION_DESCRIPTOR;">USB_CONFIGURATION_DESCRIPTOR</a> for this device.</p>

<h3 id="pipeconfiglistsize"><code>PipeConfigListSize</code></h3>

<p>Specifies the number of elements in the <em>PipeConfig</em> array.</p>

<h3 id="pipeconfig"><code>PipeConfig</code></h3>

<p>Pointer to a <a href="usbcamd_pipe_config_descriptor" title="typedef struct _pipe_config_descriptor {&#10;  CHAR  StreamAssociation;&#10;  UCHAR PipeConfigFlags;&#10;} USBCAMD_Pipe_Config_Descriptor, *PUSBCAMD_Pipe_Config_Descriptor;">USBCAMD_Pipe_Config_Descriptor</a> array describing the association between pipes and streams.</p>

<h3 id="devicedescriptor"><code>DeviceDescriptor</code></h3>

<p>Pointer to the <a href="usb_device_descriptor" title="typedef struct _USB_DEVICE_DESCRIPTOR {&#10;  UCHAR  bLength;&#10;  UCHAR  bDescriptorType;&#10;  USHORT bcdUSB;&#10;  UCHAR  bDeviceClass;&#10;  UCHAR  bDeviceSubClass;&#10;  UCHAR  bDeviceProtocol;&#10;  UCHAR  bMaxPacketSize0;&#10;  USHORT idVendor;&#10;  USHORT idProduct;&#10;  USHORT bcdDevice;&#10;  UCHAR  iManufacturer;&#10;  UCHAR  iProduct;&#10;  UCHAR  iSerialNumber;&#10;  UCHAR  bNumConfigurations;&#10;} USB_DEVICE_DESCRIPTOR, *PUSB_DEVICE_DESCRIPTOR;">USB_DEVICE_DESCRIPTOR</a> for this device.</p>

<h2 id="return-value">Return value</h2>

<p><strong>CamConfigureEx</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> or an appropriate error code.</p>

<h2 id="remarks">Remarks</h2>

<p>Camera minidrivers use <strong>CamConfigureEx</strong> to inform USBCAMD about the relationship between discovered pipes and streams.</p>

<p>USBCAMD calls the <strong>CamConfigureEx</strong> callback function to configure the isochronous streaming interface. After this function returns, USBCAMD can be notified of which interface and which alternate setting within the USB video streaming interface to use for the idle state.</p>

<p>USBCAMD requires that the camera must have a single USB configuration description, and all alternate settings within the USB video streaming interface must have the same number and type of pipes.</p>

<p>The original USBCAMD does not call <strong>CamConfigureEx</strong>.</p>

<p>This function is required.</p>

<h2 id="see-also">See also</h2>

<p><a href="usbcamd_device_data2" title="typedef struct _USBCAMD_DEVICE_DATA2 {&#10;  ULONG                             Sig;&#10;  PCAM_INITIALIZE_ROUTINE           CamInitialize;&#10;  PCAM_INITIALIZE_ROUTINE           CamUnInitialize;&#10;  PCAM_PROCESS_PACKET_ROUTINE_EX    CamProcessUSBPacketEx;&#10;  PCAM_NEW_FRAME_ROUTINE_EX         CamNewVideoFrameEx;&#10;  PCAM_PROCESS_RAW_FRAME_ROUTINE_EX CamProcessRawVideoFrameEx;&#10;  PCAM_START_CAPTURE_ROUTINE_EX     CamStartCaptureEx;&#10;  PCAM_STOP_CAPTURE_ROUTINE_EX      CamStopCaptureEx;&#10;  PCAM_CONFIGURE_ROUTINE_EX         CamConfigureEx;&#10;  PCAM_STATE_ROUTINE                CamSaveState;&#10;  PCAM_STATE_ROUTINE                CamRestoreState;&#10;  PCAM_ALLOCATE_BW_ROUTINE_EX       CamAllocateBandwidthEx;&#10;  PCAM_FREE_BW_ROUTINE_EX           CamFreeBandwidthEx;&#10;} USBCAMD_DEVICE_DATA2, *PUSBCAMD_DEVICE_DATA2;">USBCAMD_DEVICE_DATA2</a></p>

<p><a href="usbcamd_pipe_config_descriptor" title="typedef struct _pipe_config_descriptor {&#10;  CHAR  StreamAssociation;&#10;  UCHAR PipeConfigFlags;&#10;} USBCAMD_Pipe_Config_Descriptor, *PUSBCAMD_Pipe_Config_Descriptor;">USBCAMD_Pipe_Config_Descriptor</a></p>

<p><a href="usbd_interface_information" title="typedef struct _USBD_INTERFACE_INFORMATION {&#10;  USHORT                Length;&#10;  UCHAR                 InterfaceNumber;&#10;  UCHAR                 AlternateSetting;&#10;  UCHAR                 Class;&#10;  UCHAR                 SubClass;&#10;  UCHAR                 Protocol;&#10;  UCHAR                 Reserved;&#10;  USBD_INTERFACE_HANDLE InterfaceHandle;&#10;  ULONG                 NumberOfPipes;&#10;  USBD_PIPE_INFORMATION Pipes[1];&#10;} USBD_INTERFACE_INFORMATION, *PUSBD_INTERFACE_INFORMATION;">USBD_INTERFACE_INFORMATION</a></p>

<p><a href="usb_configuration_descriptor" title="typedef struct _USB_CONFIGURATION_DESCRIPTOR {&#10;  UCHAR  bLength;&#10;  UCHAR  bDescriptorType;&#10;  USHORT wTotalLength;&#10;  UCHAR  bNumInterfaces;&#10;  UCHAR  bConfigurationValue;&#10;  UCHAR  iConfiguration;&#10;  UCHAR  bmAttributes;&#10;  UCHAR  MaxPower;&#10;} USB_CONFIGURATION_DESCRIPTOR, *PUSB_CONFIGURATION_DESCRIPTOR;">USB_CONFIGURATION_DESCRIPTOR</a></p>

<p><a href="usb_device_descriptor" title="typedef struct _USB_DEVICE_DESCRIPTOR {&#10;  UCHAR  bLength;&#10;  UCHAR  bDescriptorType;&#10;  USHORT bcdUSB;&#10;  UCHAR  bDeviceClass;&#10;  UCHAR  bDeviceSubClass;&#10;  UCHAR  bDeviceProtocol;&#10;  UCHAR  bMaxPacketSize0;&#10;  USHORT idVendor;&#10;  USHORT idProduct;&#10;  USHORT bcdDevice;&#10;  UCHAR  iManufacturer;&#10;  UCHAR  iProduct;&#10;  UCHAR  iSerialNumber;&#10;  UCHAR  bNumConfigurations;&#10;} USB_DEVICE_DESCRIPTOR, *PUSB_DEVICE_DESCRIPTOR;">USB_DEVICE_DESCRIPTOR</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/usbcamdi/nc-usbcamdi-pcam_configure_routine_ex">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/usbcamdi/nc-usbcamdi-pcam_configure_routine_ex.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
