<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NtQueryInformationProcess - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NtQueryInformationProcess - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NtQueryInformationProcess - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTPSAPI_H
//
// Processes
//
#if (PHNT_MODE != PHNT_MODE_KERNEL)

</span><span class="ntdoc-code-intro">//#define NtCurrentLogonId() (<a href="ntcurrentpeb" title="#define NtCurrentPeb() (NtCurrentTeb()-&gt;ProcessEnvironmentBlock)">NtCurrentPeb</a>()-&gt;LogonId)

/**
 * Retrieves information about the specified process.
 *
 * \param ProcessHandle A handle to the process.
 * \param ProcessInformationClass The type of process information to be retrieved.
 * \param ProcessInformation A pointer to a buffer that receives the process information.
 * \param ProcessInformationLength The size of the buffer pointed to by the ProcessInformation parameter.
 * \param ReturnLength An optional pointer to a variable that receives the size of the data returned.
 * \return <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> Successful or errant status.
 */
</span><span class="ntdoc-code-body">NTSYSCALLAPI
<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>
NTAPI
NtQueryInformationProcess(
    _In_ HANDLE ProcessHandle,
    _In_ <a href="processinfoclass" title="typedef enum _PROCESSINFOCLASS&#10;{&#10;    ProcessBasicInformation,                        // q: PROCESS_BASIC_INFORMATION, PROCESS_EXTENDED_BASIC_INFORMATION&#10;    ProcessQuotaLimits,                             // qs: QUOTA_LIMITS, QUOTA_LIMITS_EX&#10;    ProcessIoCounters,                              // q: IO_COUNTERS&#10;    ProcessVmCounters,                              // q: VM_COUNTERS, VM_COUNTERS_EX, VM_COUNTERS_EX2&#10;    ProcessTimes,                                   // q: KERNEL_USER_TIMES&#10;    ProcessBasePriority,                            // s: KPRIORITY&#10;    ProcessRaisePriority,                           // s: ULONG&#10;    ProcessDebugPort,                               // q: HANDLE&#10;    ProcessExceptionPort,                           // s: PROCESS_EXCEPTION_PORT (requires SeTcbPrivilege)&#10;    ProcessAccessToken,                             // s: PROCESS_ACCESS_TOKEN&#10;    ProcessLdtInformation,                          // qs: PROCESS_LDT_INFORMATION // 10&#10;    ProcessLdtSize,                                 // s: PROCESS_LDT_SIZE&#10;    ProcessDefaultHardErrorMode,                    // qs: ULONG&#10;    ProcessIoPortHandlers,                          // s: PROCESS_IO_PORT_HANDLER_INFORMATION // (kernel-mode only)&#10;    ProcessPooledUsageAndLimits,                    // q: POOLED_USAGE_AND_LIMITS&#10;    ProcessWorkingSetWatch,                         // q: PROCESS_WS_WATCH_INFORMATION[]; s: void&#10;    ProcessUserModeIOPL,                            // qs: ULONG (requires SeTcbPrivilege)&#10;    ProcessEnableAlignmentFaultFixup,               // s: BOOLEAN&#10;...">PROCESSINFOCLASS</a> ProcessInformationClass,
    _Out_writes_bytes_(ProcessInformationLength) PVOID ProcessInformation,
    _In_ <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> ProcessInformationLength,
    _Out_opt_ PULONG ReturnLength
    );
</span><span class="ntdoc-code-footer">
#endif
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/3d935379c6ac1f147cc4e3b25bed778f0d140c69/phnt/include/ntpsapi.h#L2109">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTZWAPI_H

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NTSYSCALLAPI
<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>
NTAPI
ZwQueryInformationProcess(
    _In_ HANDLE ProcessHandle,
    _In_ <a href="processinfoclass" title="typedef enum _PROCESSINFOCLASS&#10;{&#10;    ProcessBasicInformation,                        // q: PROCESS_BASIC_INFORMATION, PROCESS_EXTENDED_BASIC_INFORMATION&#10;    ProcessQuotaLimits,                             // qs: QUOTA_LIMITS, QUOTA_LIMITS_EX&#10;    ProcessIoCounters,                              // q: IO_COUNTERS&#10;    ProcessVmCounters,                              // q: VM_COUNTERS, VM_COUNTERS_EX, VM_COUNTERS_EX2&#10;    ProcessTimes,                                   // q: KERNEL_USER_TIMES&#10;    ProcessBasePriority,                            // s: KPRIORITY&#10;    ProcessRaisePriority,                           // s: ULONG&#10;    ProcessDebugPort,                               // q: HANDLE&#10;    ProcessExceptionPort,                           // s: PROCESS_EXCEPTION_PORT (requires SeTcbPrivilege)&#10;    ProcessAccessToken,                             // s: PROCESS_ACCESS_TOKEN&#10;    ProcessLdtInformation,                          // qs: PROCESS_LDT_INFORMATION // 10&#10;    ProcessLdtSize,                                 // s: PROCESS_LDT_SIZE&#10;    ProcessDefaultHardErrorMode,                    // qs: ULONG&#10;    ProcessIoPortHandlers,                          // s: PROCESS_IO_PORT_HANDLER_INFORMATION // (kernel-mode only)&#10;    ProcessPooledUsageAndLimits,                    // q: POOLED_USAGE_AND_LIMITS&#10;    ProcessWorkingSetWatch,                         // q: PROCESS_WS_WATCH_INFORMATION[]; s: void&#10;    ProcessUserModeIOPL,                            // qs: ULONG (requires SeTcbPrivilege)&#10;    ProcessEnableAlignmentFaultFixup,               // s: BOOLEAN&#10;...">PROCESSINFOCLASS</a> ProcessInformationClass,
    _Out_writes_bytes_(ProcessInformationLength) PVOID ProcessInformation,
    _In_ <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> ProcessInformationLength,
    _Out_opt_ PULONG ReturnLength
    );
</span><span class="ntdoc-code-footer">
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/3d935379c6ac1f147cc4e3b25bed778f0d140c69/phnt/include/ntzwapi.h#L3173">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// winternl.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">__kernel_entry <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> NtQueryInformationProcess(
  [in]            HANDLE           ProcessHandle,
  [in]            <a href="processinfoclass" title="typedef enum _PROCESSINFOCLASS&#10;{&#10;    ProcessBasicInformation,                        // q: PROCESS_BASIC_INFORMATION, PROCESS_EXTENDED_BASIC_INFORMATION&#10;    ProcessQuotaLimits,                             // qs: QUOTA_LIMITS, QUOTA_LIMITS_EX&#10;    ProcessIoCounters,                              // q: IO_COUNTERS&#10;    ProcessVmCounters,                              // q: VM_COUNTERS, VM_COUNTERS_EX, VM_COUNTERS_EX2&#10;    ProcessTimes,                                   // q: KERNEL_USER_TIMES&#10;    ProcessBasePriority,                            // s: KPRIORITY&#10;    ProcessRaisePriority,                           // s: ULONG&#10;    ProcessDebugPort,                               // q: HANDLE&#10;    ProcessExceptionPort,                           // s: PROCESS_EXCEPTION_PORT (requires SeTcbPrivilege)&#10;    ProcessAccessToken,                             // s: PROCESS_ACCESS_TOKEN&#10;    ProcessLdtInformation,                          // qs: PROCESS_LDT_INFORMATION // 10&#10;    ProcessLdtSize,                                 // s: PROCESS_LDT_SIZE&#10;    ProcessDefaultHardErrorMode,                    // qs: ULONG&#10;    ProcessIoPortHandlers,                          // s: PROCESS_IO_PORT_HANDLER_INFORMATION // (kernel-mode only)&#10;    ProcessPooledUsageAndLimits,                    // q: POOLED_USAGE_AND_LIMITS&#10;    ProcessWorkingSetWatch,                         // q: PROCESS_WS_WATCH_INFORMATION[]; s: void&#10;    ProcessUserModeIOPL,                            // qs: ULONG (requires SeTcbPrivilege)&#10;    ProcessEnableAlignmentFaultFixup,               // s: BOOLEAN&#10;...">PROCESSINFOCLASS</a> ProcessInformationClass,
  [out]           PVOID            ProcessInformation,
  [in]            <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>            ProcessInformationLength,
  [out, optional] PULONG           ReturnLength
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows/win32/api/winternl/nf-winternl-ntqueryinformationprocess">View the official Win32 API reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<p>Queries various information about the specified process. This function is partially <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntqueryinformationprocess">documented in Windows SDK</a>.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>ProcessHandle</code> - a handle to the process or the <code><a href="ntcurrentprocess" title="#define NtCurrentProcess() ((HANDLE)(LONG_PTR)-1)">NtCurrentProcess</a></code> pseudo-handle. For most information classes, the handle must grant either <code><a href="process_query_information" title="#define PROCESS_QUERY_INFORMATION 0x0400">PROCESS_QUERY_INFORMATION</a></code> or <code><a href="process_query_limited_information" title="#define PROCESS_QUERY_LIMITED_INFORMATION 0x1000">PROCESS_QUERY_LIMITED_INFORMATION</a></code> access.</li>
<li><code>ProcessInformationClass</code> - the type of information to retrieve.</li>
<li><code>ProcessInformation</code> - a pointer to a user-allocated buffer that receives the requested information.</li>
<li><code>ProcessInformationLength</code> - the size of the provided buffer in bytes.</li>
<li><code>ReturnLength</code> - an optional pointer to a variable that receives the number of bytes written when the function succeeds or the number of bytes requires when the buffer is too small.</li>
</ul>

<h1 id="information-classes">Information classes</h1>

<p>For the list of supported info classes and required process access, see <code><a href="processinfoclass" title="typedef enum _PROCESSINFOCLASS&#10;{&#10;    ProcessBasicInformation,                        // q: PROCESS_BASIC_INFORMATION, PROCESS_EXTENDED_BASIC_INFORMATION&#10;    ProcessQuotaLimits,                             // qs: QUOTA_LIMITS, QUOTA_LIMITS_EX&#10;    ProcessIoCounters,                              // q: IO_COUNTERS&#10;    ProcessVmCounters,                              // q: VM_COUNTERS, VM_COUNTERS_EX, VM_COUNTERS_EX2&#10;    ProcessTimes,                                   // q: KERNEL_USER_TIMES&#10;    ProcessBasePriority,                            // s: KPRIORITY&#10;    ProcessRaisePriority,                           // s: ULONG&#10;    ProcessDebugPort,                               // q: HANDLE&#10;    ProcessExceptionPort,                           // s: PROCESS_EXCEPTION_PORT (requires SeTcbPrivilege)&#10;    ProcessAccessToken,                             // s: PROCESS_ACCESS_TOKEN&#10;    ProcessLdtInformation,                          // qs: PROCESS_LDT_INFORMATION // 10&#10;    ProcessLdtSize,                                 // s: PROCESS_LDT_SIZE&#10;    ProcessDefaultHardErrorMode,                    // qs: ULONG&#10;    ProcessIoPortHandlers,                          // s: PROCESS_IO_PORT_HANDLER_INFORMATION // (kernel-mode only)&#10;    ProcessPooledUsageAndLimits,                    // q: POOLED_USAGE_AND_LIMITS&#10;    ProcessWorkingSetWatch,                         // q: PROCESS_WS_WATCH_INFORMATION[]; s: void&#10;    ProcessUserModeIOPL,                            // qs: ULONG (requires SeTcbPrivilege)&#10;    ProcessEnableAlignmentFaultFixup,               // s: BOOLEAN&#10;...">PROCESSINFOCLASS</a></code>.</p>

<h1 id="notable-return-values">Notable return values</h1>

<ul>
<li><code>STATUS_BUFFER_TOO_SMALL</code> and <code>STATUS_INFO_LENGTH_MISMATCH</code> indicate that the requested information does not fit into the provided buffer.</li>
</ul>

<h1 id="related-win32-api">Related Win32 API</h1>

<ul>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getexitcodeprocess">&lt;code>GetExitCodeProcess&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getprocessid">&lt;code>GetProcessId&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getprocessinformation">&lt;code>GetProcessInformation&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getprocessmitigationpolicy">&lt;code>GetProcessMitigationPolicy&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/wow64apiset/nf-wow64apiset-iswow64process">&lt;code>IsWow64Process&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-isprocesscritical">&lt;code>IsProcessCritical&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-processidtosessionid">&lt;code>ProcessIdToSessionId&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/realtimeapiset/nf-realtimeapiset-queryprocesscycletime">&lt;code>QueryProcessCycleTime&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-queryprocessaffinityupdatemode">&lt;code>QueryProcessAffinityUpdateMode&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-getprocessworkingsetsizeex">&lt;code>GetProcessWorkingSetSizeEx&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getprocesstimes">&lt;code>GetProcessTimes&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/errhandlingapi/nf-errhandlingapi-geterrormode">&lt;code>GetErrorMode&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getprocesshandlecount">&lt;code>GetProcessHandleCount&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getprocesspriorityboost">&lt;code>GetProcessPriorityBoost&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getprocessversion">&lt;code>GetProcessVersion&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processtopologyapi/nf-processtopologyapi-getprocessgroupaffinity">&lt;code>GetProcessGroupAffinity&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getpriorityclass">&lt;code>GetPriorityClass&lt;/code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-getlogicaldrives">&lt;code>GetLogicalDrives&lt;/code></a></li>
</ul>

<h1 id="see-also">See also</h1>

<ul>
<li><code><a href="ntsetinformationprocess" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationProcess(&#10;    _In_ HANDLE ProcessHandle,&#10;    _In_ PROCESSINFOCLASS ProcessInformationClass,&#10;    _In_reads_bytes_(ProcessInformationLength) PVOID ProcessInformation,&#10;    _In_ ULONG ProcessInformationLength&#10;    );">NtSetInformationProcess</a></code></li>
<li><code><a href="ntopenprocess" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtOpenProcess(&#10;    _Out_ PHANDLE ProcessHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ PCOBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_opt_ PCLIENT_ID ClientId&#10;    );">NtOpenProcess</a></code></li>
<li><code><a href="ntopenprocesstoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtOpenProcessToken(&#10;    _In_ HANDLE ProcessHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _Out_ PHANDLE TokenHandle&#10;    );">NtOpenProcessToken</a></code></li>
</ul>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ntqueryinformationprocess.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Win32 API reference (nf-winternl-ntqueryinformationprocess)</h1>
</div>
<div class="ntdoc-description">
<h1>NtQueryInformationProcess function</h1>

<h2>Description</h2>

<p>[<strong>NtQueryInformationProcess</strong> may be altered or unavailable in future versions of Windows. Applications should use the alternate functions listed in this topic.]</p>

<p>Retrieves information about the specified process.</p>

<h2>Parameters</h2>

<h3><code>ProcessHandle</code> [in]</h3>

<p>A handle to the process for which information is to be retrieved.</p>

<h3><code>ProcessInformationClass</code> [in]</h3>

<p>The type of process information to be retrieved. This parameter can be one of the following values from the <strong><a href="processinfoclass" title="typedef enum _PROCESSINFOCLASS&#10;{&#10;    ProcessBasicInformation,                        // q: PROCESS_BASIC_INFORMATION, PROCESS_EXTENDED_BASIC_INFORMATION&#10;    ProcessQuotaLimits,                             // qs: QUOTA_LIMITS, QUOTA_LIMITS_EX&#10;    ProcessIoCounters,                              // q: IO_COUNTERS&#10;    ProcessVmCounters,                              // q: VM_COUNTERS, VM_COUNTERS_EX, VM_COUNTERS_EX2&#10;    ProcessTimes,                                   // q: KERNEL_USER_TIMES&#10;    ProcessBasePriority,                            // s: KPRIORITY&#10;    ProcessRaisePriority,                           // s: ULONG&#10;    ProcessDebugPort,                               // q: HANDLE&#10;    ProcessExceptionPort,                           // s: PROCESS_EXCEPTION_PORT (requires SeTcbPrivilege)&#10;    ProcessAccessToken,                             // s: PROCESS_ACCESS_TOKEN&#10;    ProcessLdtInformation,                          // qs: PROCESS_LDT_INFORMATION // 10&#10;    ProcessLdtSize,                                 // s: PROCESS_LDT_SIZE&#10;    ProcessDefaultHardErrorMode,                    // qs: ULONG&#10;    ProcessIoPortHandlers,                          // s: PROCESS_IO_PORT_HANDLER_INFORMATION // (kernel-mode only)&#10;    ProcessPooledUsageAndLimits,                    // q: POOLED_USAGE_AND_LIMITS&#10;    ProcessWorkingSetWatch,                         // q: PROCESS_WS_WATCH_INFORMATION[]; s: void&#10;    ProcessUserModeIOPL,                            // qs: ULONG (requires SeTcbPrivilege)&#10;    ProcessEnableAlignmentFaultFixup,               // s: BOOLEAN&#10;...">PROCESSINFOCLASS</a></strong> enumeration.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>ProcessBasicInformation</strong><br><br>0</td>
  <td>Retrieves a pointer to a <a href="peb" title="typedef struct _PEB&#10;{&#10;    //&#10;    // The process was cloned with an inherited address space.&#10;    //&#10;    BOOLEAN InheritedAddressSpace;&#10;&#10;    //&#10;    // The process has image file execution options (IFEO).&#10;    //&#10;    BOOLEAN ReadImageFileExecOptions;&#10;&#10;    //&#10;    // The process has a debugger attached.&#10;    //&#10;    BOOLEAN BeingDebugged;&#10;&#10;    union&#10;    {&#10;        BOOLEAN BitField;&#10;...">PEB</a> structure that can be used to determine whether the specified process is being debugged, and a unique value used by the system to identify the specified process. <br><br>Use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/debugapi/nf-debugapi-checkremotedebuggerpresent">CheckRemoteDebuggerPresent</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/processthreadsapi/nf-processthreadsapi-getprocessid">GetProcessId</a> functions to obtain this information.</td>
</tr>
<tr>
  <td><strong>ProcessDebugPort</strong><br><br>7</td>
  <td>Retrieves a <strong><a href="dword_ptr" title="typedef ULONG_PTR DWORD_PTR;">DWORD_PTR</a></strong> value that is the port number of the debugger for the process. A nonzero value indicates that the process is being run under the control of a ring 3 debugger.<br><br>Use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/debugapi/nf-debugapi-checkremotedebuggerpresent">CheckRemoteDebuggerPresent</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/debugapi/nf-debugapi-isdebuggerpresent">IsDebuggerPresent</a> function.</td>
</tr>
<tr>
  <td><strong>ProcessWow64Information</strong><br><br>26</td>
  <td>Determines whether the process is running in the WOW64 environment (WOW64 is the x86 emulator that allows Win32-based applications to run on 64-bit Windows).<br><br>Use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/wow64apiset/nf-wow64apiset-iswow64process2">IsWow64Process2</a> function to obtain this information.</td>
</tr>
<tr>
  <td><strong>ProcessImageFileName</strong><br><br>27</td>
  <td>Retrieves a <strong><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></strong> value containing the name of the image file for the process.<br><br>Use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/winbase/nf-winbase-queryfullprocessimagenamea">QueryFullProcessImageName</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/psapi/nf-psapi-getprocessimagefilenamea">GetProcessImageFileName</a> function to obtain this information.</td>
</tr>
<tr>
  <td><strong>ProcessBreakOnTermination</strong><br><br>29</td>
  <td>Retrieves a <strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></strong> value indicating whether the process is considered critical.<br><br><strong>Note</strong> This value can be used starting in Windows XP with SP3. Starting in Windows 8.1, <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/processthreadsapi/nf-processthreadsapi-isprocesscritical">IsProcessCritical</a> should be used instead.</td>
</tr>
<tr>
  <td><strong>ProcessTelemetryIdInformation</strong><br><br>64</td>
  <td>Retrieves a <strong><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/devnotes/process_telemetry_id_information_type">PROCESS_TELEMETRY_ID_INFORMATION_TYPE</a></strong> value that contains metadata about a process.</td>
</tr>
<tr>
  <td><strong>ProcessSubsystemInformation</strong><br><br>75</td>
  <td>Retrieves a <strong><a href="subsystem_information_type" title="typedef enum _SUBSYSTEM_INFORMATION_TYPE&#10;{&#10;    SubsystemInformationTypeWin32,&#10;    SubsystemInformationTypeWSL,&#10;    MaxSubsystemInformationType&#10;} SUBSYSTEM_INFORMATION_TYPE;">SUBSYSTEM_INFORMATION_TYPE</a></strong> value indicating the subsystem type of the process. The buffer pointed to by the <em>ProcessInformation</em> parameter should be large enough to hold a single <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/content/ntddk/ne-ntddk-_subsystem_information_type">SUBSYSTEM_INFORMATION_TYPE</a> enumeration.</td>
</tr>
</tbody>
</table>

<h3><code>ProcessInformation</code> [out]</h3>

<p>A pointer to a buffer supplied by the calling application into which the function writes the requested information. The size of the information written varies depending on the data type of the <em>ProcessInformationClass</em> parameter:</p>

<h4><a href="process_basic_information" title="typedef struct _PROCESS_BASIC_INFORMATION&#10;{&#10;    NTSTATUS ExitStatus;                    // The exit status of the process. (GetExitCodeProcess)&#10;    PPEB PebBaseAddress;                    // A pointer to the process environment block (PEB) of the process.&#10;    KAFFINITY AffinityMask;                 // The affinity mask of the process. (GetProcessAffinityMask) (deprecated)&#10;    KPRIORITY BasePriority;                 // The base priority of the process. (GetPriorityClass)&#10;    HANDLE UniqueProcessId;                 // The unique identifier of the process. (GetProcessId)&#10;    HANDLE InheritedFromUniqueProcessId;    // The unique identifier of the parent process.&#10;} PROCESS_BASIC_INFORMATION, *PPROCESS_BASIC_INFORMATION;">PROCESS_BASIC_INFORMATION</a></h4>

<p>When the <em>ProcessInformationClass</em> parameter is <strong>ProcessBasicInformation</strong>, the buffer pointed to by the <em>ProcessInformation</em> parameter should be large enough to hold a single <strong><a href="process_basic_information" title="typedef struct _PROCESS_BASIC_INFORMATION&#10;{&#10;    NTSTATUS ExitStatus;                    // The exit status of the process. (GetExitCodeProcess)&#10;    PPEB PebBaseAddress;                    // A pointer to the process environment block (PEB) of the process.&#10;    KAFFINITY AffinityMask;                 // The affinity mask of the process. (GetProcessAffinityMask) (deprecated)&#10;    KPRIORITY BasePriority;                 // The base priority of the process. (GetPriorityClass)&#10;    HANDLE UniqueProcessId;                 // The unique identifier of the process. (GetProcessId)&#10;    HANDLE InheritedFromUniqueProcessId;    // The unique identifier of the parent process.&#10;} PROCESS_BASIC_INFORMATION, *PPROCESS_BASIC_INFORMATION;">PROCESS_BASIC_INFORMATION</a></strong> structure having the following layout:</p>

<pre><code>typedef <a href="process_basic_information" title="typedef struct _PROCESS_BASIC_INFORMATION&#10;{&#10;    NTSTATUS ExitStatus;                    // The exit status of the process. (GetExitCodeProcess)&#10;    PPEB PebBaseAddress;                    // A pointer to the process environment block (PEB) of the process.&#10;    KAFFINITY AffinityMask;                 // The affinity mask of the process. (GetProcessAffinityMask) (deprecated)&#10;    KPRIORITY BasePriority;                 // The base priority of the process. (GetPriorityClass)&#10;    HANDLE UniqueProcessId;                 // The unique identifier of the process. (GetProcessId)&#10;    HANDLE InheritedFromUniqueProcessId;    // The unique identifier of the parent process.&#10;} PROCESS_BASIC_INFORMATION, *PPROCESS_BASIC_INFORMATION;">struct _PROCESS_BASIC_INFORMATION</a> {
    <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> ExitStatus;
    <a href="peb" title="typedef struct _PEB&#10;{&#10;    //&#10;    // The process was cloned with an inherited address space.&#10;    //&#10;    BOOLEAN InheritedAddressSpace;&#10;&#10;    //&#10;    // The process has image file execution options (IFEO).&#10;    //&#10;    BOOLEAN ReadImageFileExecOptions;&#10;&#10;    //&#10;    // The process has a debugger attached.&#10;    //&#10;    BOOLEAN BeingDebugged;&#10;&#10;    union&#10;    {&#10;        BOOLEAN BitField;&#10;...">PPEB</a> PebBaseAddress;
    <a href="ulong_ptr" title="typedef [public] unsigned __int3264 ULONG_PTR;">ULONG_PTR</a> AffinityMask;
    <a href="kpriority" title="typedef LONG KPRIORITY, *PKPRIORITY;">KPRIORITY</a> BasePriority;
    <a href="ulong_ptr" title="typedef [public] unsigned __int3264 ULONG_PTR;">ULONG_PTR</a> UniqueProcessId;
    <a href="ulong_ptr" title="typedef [public] unsigned __int3264 ULONG_PTR;">ULONG_PTR</a> InheritedFromUniqueProcessId;
} <a href="process_basic_information" title="typedef struct _PROCESS_BASIC_INFORMATION&#10;{&#10;    NTSTATUS ExitStatus;                    // The exit status of the process. (GetExitCodeProcess)&#10;    PPEB PebBaseAddress;                    // A pointer to the process environment block (PEB) of the process.&#10;    KAFFINITY AffinityMask;                 // The affinity mask of the process. (GetProcessAffinityMask) (deprecated)&#10;    KPRIORITY BasePriority;                 // The base priority of the process. (GetPriorityClass)&#10;    HANDLE UniqueProcessId;                 // The unique identifier of the process. (GetProcessId)&#10;    HANDLE InheritedFromUniqueProcessId;    // The unique identifier of the parent process.&#10;} PROCESS_BASIC_INFORMATION, *PPROCESS_BASIC_INFORMATION;">PROCESS_BASIC_INFORMATION</a>;
</code></pre>

<table>
<thead>
<tr>
  <th>Field</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>ExitStatus</strong></td>
  <td>Contains the same value that <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/processthreadsapi/nf-processthreadsapi-getexitcodeprocess"><strong>GetExitCodeProcess</strong></a> returns. However the use of <strong>GetExitCodeProcess</strong> is preferable for clarity and safety.</td>
</tr>
<tr>
  <td><strong>PebBaseAddress</strong></td>
  <td>Points to a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/Winternl/ns-winternl-peb"><strong>PEB</strong></a> structure.</td>
</tr>
<tr>
  <td><strong>AffinityMask</strong></td>
  <td>Can be cast to a <strong><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></strong> and contains the same value that <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winbase/nf-winbase-getprocessaffinitymask"><strong>GetProcessAffinityMask</strong></a> returns for the <code>lpProcessAffinityMask</code> parameter.</td>
</tr>
<tr>
  <td><strong>BasePriority</strong></td>
  <td>Contains the process priority as described in <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/procthread/scheduling-priorities#base-priority">Scheduling Priorities</a>.</td>
</tr>
<tr>
  <td><strong>UniqueProcessId</strong></td>
  <td>Can be cast to a <strong><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></strong> and contains a unique identifier for this process. We recommend using the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/processthreadsapi/nf-processthreadsapi-getprocessid"><strong>GetProcessId</strong></a> function to retrieve this information.</td>
</tr>
<tr>
  <td><strong>InheritedFromUniqueProcessId</strong></td>
  <td>Can be cast to a <strong><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></strong> and contains a unique identifier for the parent process.</td>
</tr>
</tbody>
</table>

<h4><a href="ulong_ptr" title="typedef [public] unsigned __int3264 ULONG_PTR;">ULONG_PTR</a></h4>

<p>When the <em>ProcessInformationClass</em> parameter is <strong>ProcessWow64Information</strong>, the buffer pointed to by the <em>ProcessInformation</em> parameter should be large enough to hold a <strong><a href="ulong_ptr" title="typedef [public] unsigned __int3264 ULONG_PTR;">ULONG_PTR</a></strong>. If this value is nonzero, the process is running in a WOW64 environment. Otherwise, the process is not running in a WOW64 environment.</p>

<p>Use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/wow64apiset/nf-wow64apiset-iswow64process2">IsWow64Process2</a> function to determine whether a process is running in the WOW64 environment.</p>

<h4><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></h4>

<p>When the <em>ProcessInformationClass</em> parameter is <strong>ProcessImageFileName</strong>, the buffer pointed to by the <em>ProcessInformation</em> parameter should be large enough to hold a <strong><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></strong> structure as well as the string itself. The string stored in the <strong>Buffer</strong> member is the name of the image file.</p>

<p>If the buffer is too small, the function fails with the STATUS_INFO_LENGTH_MISMATCH error code and the <em>ReturnLength</em> parameter is set to the required buffer size.</p>

<h3><code>ProcessInformationLength</code> [in]</h3>

<p>The size of the buffer pointed to by the <em>ProcessInformation</em> parameter, in bytes.</p>

<h3><code>ReturnLength</code> [out, optional]</h3>

<p>A pointer to a variable in which the function returns the size of the requested information. If the function was successful, this is the size of the information written to the buffer pointed to by the <em>ProcessInformation</em> parameter (if the buffer was too small, this is the minimum size of buffer needed to receive the information successfully).</p>

<h2>Return value</h2>

<p>The function returns an <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> success or error code.</p>

<p>The forms and significance of <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> error codes are listed in the Ntstatus.h header file available in the DDK. See <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/logging-errors">Logging Errors</a> for more details.</p>

<h2>Remarks</h2>

<p>The <strong>NtQueryInformationProcess</strong> function and the structures that it returns are internal to the operating system and subject to change from one release of Windows to another. To maintain the compatibility of your application, it is better to use public functions mentioned in the description of the <em>ProcessInformationClass</em> parameter instead.</p>

<p>If you do use <strong>NtQueryInformationProcess</strong>, access the function through <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/Dlls/using-run-time-dynamic-linking">run-time dynamic linking</a>. This gives your code an opportunity to respond gracefully if the function has been changed or removed from the operating system. Signature changes, however, may not be detectable.</p>

<p>This function has no associated import library. You must use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya">LoadLibrary</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress">GetProcAddress</a> functions to dynamically link to Ntdll.dll.</p>

<h2>See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/debugapi/nf-debugapi-checkremotedebuggerpresent">CheckRemoteDebuggerPresent</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/processthreadsapi/nf-processthreadsapi-getprocessid">GetProcessId</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/debugapi/nf-debugapi-isdebuggerpresent">IsDebuggerPresent</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/wow64apiset/nf-wow64apiset-iswow64process">IsWow64Process</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/wow64apiset/nf-wow64apiset-iswow64process2">IsWow64Process2</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows/win32/api/winternl/nf-winternl-ntqueryinformationprocess">View the official Win32 API reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/sdk-api/blob/docs/sdk-api-src/content/winternl/nf-winternl-ntqueryinformationprocess.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>NTinternals.net (undocumented.ntinternals.net)</h1>
</div>
<div class="ntdoc-description">
<p>This function is <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntqueryinformationprocess">documented in Windows SDK</a>.</p>

<hr />

<h3>ProcessHandle</h3>

<p>Handle to process opened with <code><a href="process_query_information" title="#define PROCESS_QUERY_INFORMATION 0x0400">PROCESS_QUERY_INFORMATION</a></code> access.</p>

<h3>ProcessInformationClass</h3>

<p>See <code>PROCESS_INFORMATION_CLASS</code>.</p>

<h3>ProcessInformation</h3>

<p>Buffer for results.</p>

<h3>ProcessInformationLength</h3>

<p>Length of buffer. See <code>PROCESS_INFORMATION_CLASS</code> for additional information.</p>

<h3>ReturnLength</h3>

<p>Number of bytes needed, if <code>ProcessInformationLength</code> was too small.</p>

<h1>Documented by</h1>

<ul>
<li>ReactOS</li>
<li>Sven B. Schreiber</li>
<li>Tomasz Nowak</li>
</ul>

<h1>See also</h1>

<ul>
<li><code><a href="ntcreateprocess" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateProcess(&#10;    _Out_ PHANDLE ProcessHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ PCOBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ HANDLE ParentProcess,&#10;    _In_ BOOLEAN InheritObjectTable,&#10;    _In_opt_ HANDLE SectionHandle,&#10;    _In_opt_ HANDLE DebugPort,&#10;    _In_opt_ HANDLE TokenHandle&#10;    );">NtCreateProcess</a></code></li>
<li><code><a href="ntopenprocess" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtOpenProcess(&#10;    _Out_ PHANDLE ProcessHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ PCOBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_opt_ PCLIENT_ID ClientId&#10;    );">NtOpenProcess</a></code></li>
<li><code><a href="ntsetinformationprocess" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationProcess(&#10;    _In_ HANDLE ProcessHandle,&#10;    _In_ PROCESSINFOCLASS ProcessInformationClass,&#10;    _In_reads_bytes_(ProcessInformationLength) PVOID ProcessInformation,&#10;    _In_ ULONG ProcessInformationLength&#10;    );">NtSetInformationProcess</a></code></li>
<li><code>PROCESS_INFORMATION_CLASS</code></li>
</ul>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/undocumented.ntinternals.net/ntqueryinformationprocess.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
