<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="DXGKDDI_QUERYDEPENDENTENGINEGROUP - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>DXGKDDI_QUERYDEPENDENTENGINEGROUP - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            DXGKDDI_QUERYDEPENDENTENGINEGROUP - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dkmddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">DXGKDDI_QUERYDEPENDENTENGINEGROUP DxgkddiQuerydependentenginegroup;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> DxgkddiQuerydependentenginegroup(
  IN_CONST_HANDLE hAdapter,
  INOUT_DXGKARG_QUERYDEPENDENTENGINEGROUP pQueryDependentEngineGroup
)
{...}</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_querydependentenginegroup">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/dxgkddi_querydependentenginegroup.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-d3dkmddi-dxgkddi_querydependentenginegroup)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="dxgkddi_querydependentenginegroup-callback-function">DXGKDDI_QUERYDEPENDENTENGINEGROUP callback function</h1>

<h2 id="description">Description</h2>

<p><em>Dxgkrnl</em>'s GPU scheduler calls <strong>DxgkddiQuerydependentenginegroup</strong> to query dependencies of nodes in a physical display adapter.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="hadapter"><code>hAdapter</code></h3>

<p>[in] A handle to a context block that is associated with a display adapter. The display miniport driver previously provided this handle to the DirectX graphics kernel subsystem in the <strong>MiniportDeviceContext</strong> output parameter of the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dispmprt/nc-dispmprt-dxgkddi_add_device"><strong>DxgkDdiAddDevice</strong></a> function.</p>

<h3 id="pquerydependentenginegroup"><code>pQueryDependentEngineGroup</code></h3>

<p>[in/out] A <strong><a href="dxgkarg_querydependentenginegroup" title="typedef struct _DXGKARG_QUERYDEPENDENTENGINEGROUP {&#10;  [in]  UINT      NodeOrdinal;&#10;  [in]  UINT      EngineOrdinal;&#10;  [out] ULONGLONG DependentNodeOrdinalMask;&#10;} DXGKARG_QUERYDEPENDENTENGINEGROUP;">DXGKARG_QUERYDEPENDENTENGINEGROUP</a></strong> structure in which KMD specifies all nodes affected by the reset operation.</p>

<h2 id="return-value">Return value</h2>

<p><strong>DxgkddiQuerydependentenginegroup</strong> must return <strong><a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a></strong>.</p>

<h2 id="remarks">Remarks</h2>

<p><em>Dxgkrnl</em>'s GPU scheduler calls this function to get a description of all physical adapters (engines) that will be affected by an engine reset request. It helps improve user experience on hardware architectures that have dependencies among multiple engines that can affect the reset process. Note that all affected nodes must have the same engine affinity value. (See the engine affinity discussion in <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/display/tdr-changes-in-windows-8">TDR changes in Windows 8</a>.)</p>

<p>The GPU scheduler calls <strong>DxgkDdiQueryDependentEngineGroup</strong> every time it calls <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_resetengine"><strong>DxgkDdiResetEngine</strong></a>. The GPU scheduler waits 500 milliseconds for the display miniport driver to complete preemption of all dependent engines. For any engines that the driver can't complete a preemption, the GPU scheduler calls the <strong>DxgkDdiResetEngine</strong> function sequentially based upon the engine ordinal value.</p>

<p>Here is an example of how to compute the bitmask in the <strong><a href="dxgkarg_querydependentenginegroup" title="typedef struct _DXGKARG_QUERYDEPENDENTENGINEGROUP {&#10;  [in]  UINT      NodeOrdinal;&#10;  [in]  UINT      EngineOrdinal;&#10;  [out] ULONGLONG DependentNodeOrdinalMask;&#10;} DXGKARG_QUERYDEPENDENTENGINEGROUP;">DXGKARG_QUERYDEPENDENTENGINEGROUP</a></strong>.<strong>DependentNodeOrdinalMask</strong> member. If the original values of the <strong><a href="dxgkarg_querydependentenginegroup" title="typedef struct _DXGKARG_QUERYDEPENDENTENGINEGROUP {&#10;  [in]  UINT      NodeOrdinal;&#10;  [in]  UINT      EngineOrdinal;&#10;  [out] ULONGLONG DependentNodeOrdinalMask;&#10;} DXGKARG_QUERYDEPENDENTENGINEGROUP;">DXGKARG_QUERYDEPENDENTENGINEGROUP</a></strong> structure's <strong>NodeOrdinal</strong> and <strong>EngineOrdinal</strong> members are 1 and 0, respectively, and additional nodes with identifiers 2 and 4 will also be reset when node 1 is reset, the driver should set <strong>DependentNodeOrdinalMask</strong> to 10110, or 0x16 in hexadecimal notation. The index value <strong>EngineOrdinal</strong> is assumed to be identical for all dependent nodes. The node being reset is included in the <strong>DependentNodeOrdinalMask</strong> bit mask.</p>

<p>This function should be made pageable, and it should always succeed.</p>

<p>The operating system guarantees that this function follows the first level synchronization mode as defined in <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/display/threading-and-synchronization-first-level">Threading and Synchronization First Level</a>.</p>

<p>For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/display/tdr-changes-in-windows-8">TDR changes in Windows 8</a>.</p>

<h2 id="see-also">See also</h2>

<p><strong><a href="dxgkarg_createcontext" title="typedef struct _DXGKARG_CREATECONTEXT {&#10;  [out] HANDLE                  hContext;&#10;  [in]  UINT                    NodeOrdinal;&#10;  [in]  UINT                    EngineAffinity;&#10;  [in]  DXGK_CREATECONTEXTFLAGS Flags;&#10;  [in]  VOID                    *pPrivateDriverData;&#10;  [in]  UINT                    PrivateDriverDataSize;&#10;  [out] DXGK_CONTEXTINFO        ContextInfo;&#10;} DXGKARG_CREATECONTEXT;">DXGKARG_CREATECONTEXT</a></strong></p>

<p><strong><a href="dxgkarg_querydependentenginegroup" title="typedef struct _DXGKARG_QUERYDEPENDENTENGINEGROUP {&#10;  [in]  UINT      NodeOrdinal;&#10;  [in]  UINT      EngineOrdinal;&#10;  [out] ULONGLONG DependentNodeOrdinalMask;&#10;} DXGKARG_QUERYDEPENDENTENGINEGROUP;">DXGKARG_QUERYDEPENDENTENGINEGROUP</a></strong></p>

<p><strong><a href="dxgk_drivercaps" title="typedef struct _DXGK_DRIVERCAPS {&#10;  [out] PHYSICAL_ADDRESS                   HighestAcceptableAddress;&#10;  [out] UINT                               MaxAllocationListSlotId;&#10;  [out] SIZE_T                             ApertureSegmentCommitLimit;&#10;  [out] UINT                               MaxPointerWidth;&#10;  [out] UINT                               MaxPointerHeight;&#10;  [out] DXGK_POINTERFLAGS                  PointerCaps;&#10;  [out] UINT                               InterruptMessageNumber;&#10;  [out] UINT                               NumberOfSwizzlingRanges;&#10;  [out] UINT                               MaxOverlays;&#10;  union {&#10;    [out] DXGK_GAMMARAMPCAPS      GammaRampCaps;&#10;    [out] DXGK_COLORTRANSFORMCAPS ColorTransformCaps;&#10;  };&#10;  [out] DXGK_PRESENTATIONCAPS              PresentationCaps;&#10;  [out] UINT                               MaxQueuedFlipOnVSync;&#10;  [out] DXGK_FLIPCAPS                      FlipCaps;&#10;  [out] DXGK_VIDSCHCAPS                    SchedulingCaps;&#10;  [out] DXGK_VIDMMCAPS                     MemoryManagementCaps;&#10;  [out] DXGK_GPUENGINETOPOLOGY             GpuEngineTopology;&#10;...">DXGK_DRIVERCAPS</a></strong></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dispmprt/nc-dispmprt-dxgkddi_add_device"><strong>DxgkDdiAddDevice</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_resetengine"><strong>DxgkDdiResetEngine</strong></a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_querydependentenginegroup">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dkmddi/nc-d3dkmddi-dxgkddi_querydependentenginegroup.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
