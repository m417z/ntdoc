<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NdisMIndicateStatus - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NdisMIndicateStatus - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NdisMIndicateStatus - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">VOID NdisMIndicateStatus(
  [in] NDIS_HANDLE MiniportHandle,
  [in] NDIS_STATUS GeneralStatus,
  [in] PVOID       StatusBuffer,
  [in] <a href="uint" title="typedef unsigned int UINT;">UINT</a>        StatusBufferSize
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndismindicatestatus">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndismindicatestatus.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ndis-ndismindicatestatus)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="ndismindicatestatus-function">NdisMIndicateStatus function</h1>

<h2 id="description">Description</h2>

<p><strong>Note</strong> NDIS 5. <em>x</em> has been deprecated and is superseded by NDIS 6. <em>x</em>. For new NDIS driver development, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_netvista/">Network Drivers Starting with Windows Vista</a>. For information about porting NDIS 5. <em>x</em> drivers to NDIS 6. <em>x</em>, see <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/Ff570059">Porting NDIS 5.x Drivers to NDIS 6.0</a>.</p>

<p><strong>NdisMIndicateStatus</strong> indicates changes in the status of a NIC to higher-level NDIS drivers.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="miniporthandle-in"><code>MiniportHandle</code> [in]</h3>

<p>Specifies the handle originally input to <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff550472/(v=vs.85/)"><strong>MiniportInitialize</strong></a>.</p>

<h3 id="generalstatus-in"><code>GeneralStatus</code> [in]</h3>

<p>Specifies the NDIS_STATUS_ <em>XXX</em> value that indicates the general change in status for the NIC.</p>

<h3 id="statusbuffer-in"><code>StatusBuffer</code> [in]</h3>

<p>Pointer to a caller-allocated buffer containing data that is medium-specific and dependent on the value of <em>GeneralStatus</em>. It indicates detailed information about the change in status.</p>

<h3 id="statusbuffersize-in"><code>StatusBufferSize</code> [in]</h3>

<p>Specifies the size in bytes of the buffer at <em>StatusBuffer</em>.</p>

<h2 id="remarks">Remarks</h2>

<p>When a miniport driver calls <strong>NdisMIndicateStatus</strong>, NDIS calls each bound protocol's <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff563257/(v=vs.85/)"><strong>ProtocolStatus</strong></a> function. This allows a bound protocol driver or, possibly, the configuration manager to log the change in status of an underlying NIC or to take corrective action. For example, a protocol might call <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff554691/(v=vs.85/)"><strong>NdisReset</strong></a>, depending on the NDIS_STATUS_ <em>XXX</em> indicated.</p>

<p>When a miniport driver calls <strong>NdisMIndicateStatus</strong> to report a change in NIC status, NDIS can call the <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff550502/(v=vs.85/)"><em>MiniportReset</em></a> function to try restoring the NIC to a working condition. In these circumstances, NDIS can call bound protocols only with NDIS_STATUS_RESET_START and later with NDIS_STATUS_RESET_END, rather than with the <em>GeneralStatus</em> indicated by the miniport driver.</p>

<p><strong>NdisMIndicateStatus</strong> provides two pieces of information:</p>

<ul>
<li>An overall status value indicating the general change in status.</li>
<li>A specific reason for the general change, which can be network-specific. For example, ring-insertion failures are particular to Token Ring (802.5) networks, but are irrelevant to Ethernet (802.3) NICs and their drivers.</li>
</ul>

<p>A miniport driver also can call <strong>NdisMIndicateStatus</strong> to indicate problems such as cables that have been accidentally removed and then reinserted or a ring that has temporarily failed. For example, suppose both the following conditions occur:</p>

<ul>
<li>The miniport driver calls <strong>NdisMIndicateStatus</strong> with NDIS_STATUS_RING_STATUS.</li>
<li><p>The <em>StatusBuffer</em> contains one of the following status values:</p>

<ul>
<li>NDIS_RING_LOBE_WIRE_FAULT</li>
<li>NDIS_RING_HARD_ERROR
NDIS_RING_SIGNAL_LOSS</li>
</ul></li>
</ul>

<p>After such a change in status has been signaled with an indication, any associated thresholds or statistics counters remain unchanged.</p>

<p>A miniport driver cannot call <strong>NdisMIndicateStatus</strong> in the context of its <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff550478/(v=vs.85/)"><strong>MiniportISR</strong></a>, <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff549451/(v=vs.85/)"><strong>MiniportHalt</strong></a>, or <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff550533/(v=vs.85/)"><strong>MiniportShutdown</strong></a> function. Only a deserialized miniport driver can call <strong>NdisMIndicateStatus</strong> in the context of its <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff550472/(v=vs.85/)"><strong>MiniportInitialize</strong></a> function.</p>

<p>A miniport driver must release any spin lock that it is holding before calling <strong>NdisMIndicateStatus</strong>.</p>

<p>Serialized callers of <strong>NdisMIndicateStatus</strong> must run at IRQL = DISPATCH_LEVEL. Deserialized callers of <strong>NdisMIndicateStatus</strong> must run at IRQL &lt;= DISPATCH_LEVEL.</p>

<p><strong>Indicating the Loss and Restoration of a Network Connection</strong></p>

<p>When a miniport driver senses that the network connection has been lost, it should call <strong>NdisMIndicateStatus</strong> with NDIS_STATUS_MEDIA_DISCONNECT. When the connection is restored, the miniport driver should call <strong>NdisMIndicateStatus</strong> with NDIS_STATUS_MEDIA_CONNECT.</p>

<p><strong>Note</strong> 802.11 miniport drivers must follow the media status guidelines for wireless LANs when generating network connection indications. For more information about these guidelines, see <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff549301/(v=vs.85/)">Media Status Indications for 802.11 Networks</a>.</p>

<p><strong>802.11 Wireless LAN Miniport Driver Calls to NdisMIndicateStatus</strong></p>

<p>802.11 wireless LAN (WLAN) miniport drivers can make various indications specific to the WLAN media. For example, the miniport driver can make a WLAN-specific indication when the following occur:</p>

<ul>
<li>The driver detects that the received signal strength of its current BSS association has changed.</li>
<li>The driver detects a TKIP MIC failure on a received packet.</li>
</ul>

<p>The following types of WLAN-specific indications can be made by 802.11 miniport drivers with <strong>NdisMIndicateStatus</strong>:</p>

<ul>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff564096/(v=vs.85/)">RSSI Indications</a></li>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff544134/(v=vs.85/)">Authentication Indications</a></li>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff562383/(v=vs.85/)">PMKID Candidate List Indications</a></li>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff549317/(v=vs.85/)">Media Streaming Indications</a></li>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff563284/(v=vs.85/)">Radio State Indications</a></li>
</ul>

<p>For more information about these media specific indications, see <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff543911/(v=vs.85/)">802.11 Media-Specific Status Indications</a>.</p>

<p><strong>WAN Miniport Driver Calls to NdisMIndicateStatus</strong></p>

<p>Most WAN NIC drivers indicate status with some special status codes and buffer contents. These status indications are generated by WAN NIC drivers, and NDIS protocol drivers bound to such a miniport driver can ignore these indications. However, processing these indications correctly usually results in improved performance for protocols and for WAN NIC drivers.</p>

<p>The following four types of WAN-specific indications can be sent to bound protocol drivers with <strong>NdisMIndicateStatus</strong>:</p>

<ul>
<li>Line up</li>
<li>Line down</li>
<li>Fragment</li>
<li>TAPI line event</li>
</ul>

<p><strong>NDIS_STATUS_WAN_LINE_UP</strong></p>

<p>A WAN miniport driver makes a line-up indication whenever a new link becomes active. Until this occurs, the NIC will accept frames and let them succeed or fail, but it is unlikely that they will actually be received by any remote node. Until this occurs, protocols should reduce their timers and retry counts to quickly fail any outgoing connection attempts.</p>

<p>The WAN miniport driver makes this indication with <strong>NdisMIndicateStatus</strong> before it returns from the <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff561166/(v=vs.85/)">OID_TAPI_GET_ID</a> request.</p>

<p>The status code for the line-up indication is NDIS_STATUS_WAN_LINE_UP. The buffer at <em>StatusBuffer</em> is formatted as an <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff557058/(v=vs.85/)"><strong>NDIS_MAC_LINE_UP</strong></a> structure.</p>

<p><strong>NDIS_STATUS_WAN_LINE_DOWN</strong></p>

<p>A WAN miniport driver makes a line-down indication whenever a link goes down. When this occurs, bound protocols should reduce their timers and retry counts until the next line-up indication.</p>

<p>The status code for the line-down indication is NDIS_STATUS_WAN_LINE_DOWN. The buffer at <em>StatusBuffer</em> is formatted as an <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff557057/(v=vs.85/)"><strong>NDIS_MAC_LINE_DOWN</strong></a> structure.</p>

<p><strong>NDIS_STATUS_WAN_FRAGMENT</strong></p>

<p>A WAN miniport driver makes a fragment indication whenever it receives a partial packet from the remote node. When this occurs, a bound protocol should send frames to the remote node that will notify it of this situation, rather than waiting for a time-out to occur.</p>

<p>The status code for the fragment indication is NDIS_STATUS_WAN_FRAGMENT. The buffer at <em>StatusBuffer</em> is formatted as an <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff557055/(v=vs.85/)"><strong>NDIS_MAC_FRAGMENT</strong></a> structure.</p>

<p>NDISWAN monitors dropped packets by counting the number of fragment indications on each link.</p>

<p><strong>NDIS_TAPI_EVENT</strong></p>

<p>A WAN miniport driver must use a <em>GeneralStatus</em> value of NDIS_STATUS_TAPI_INDICATION for TAPI status indications <em>.</em> The buffer at <em>StatusBuffer</em> is formatted as an NDIS_TAPI_EVENT structure.</p>

<ul>
<li>Target platform: <a rel="noopener" target="_blank" href="https://go.microsoft.com/fwlink/p/?linkid=531356">Universal</a></li>
<li>Version: Not supported for NDIS 6.0 drivers in Windows Vista. Use <a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/Ff563600"><strong>NdisMIndicateStatusEx</strong></a>instead. Supported for NDIS 5.1 drivers in Windows Vista and Windows XP.</li>
</ul>

<h2 id="see-also">See also</h2>

<ul>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff550472/(v=vs.85/)"><strong>MiniportInitialize</strong></a></li>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff550502/(v=vs.85/)"><em>MiniportReset</em></a></li>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff557055/(v=vs.85/)"><strong>NDIS_MAC_FRAGMENT</strong></a></li>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff557057/(v=vs.85/)"><strong>NDIS_MAC_LINE_DOWN</strong></a></li>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff557058/(v=vs.85/)"><strong>NDIS_MAC_LINE_UP</strong></a></li>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff553540/(v=vs.85/)"><strong>NdisMIndicateStatusComplete</strong></a></li>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff558986/(v=vs.85/)"><strong>NDIS_TAPI_EVENT</strong></a></li>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff563257/(v=vs.85/)"><strong>ProtocolStatus</strong></a></li>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff549301/(v=vs.85/)">Media Status Indications for 802.11 Networks</a></li>
<li><a rel="noopener" target="_blank" href="https://msdn.microsoft.com/library/ff543911/(v=vs.85/)">802.11 Media-Specific Status Indications</a></li>
</ul>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndismindicatestatus">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ndis/nf-ndis-ndismindicatestatus.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
