<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="TCP_OFFLOAD_STATS - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>TCP_OFFLOAD_STATS - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            TCP_OFFLOAD_STATS - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ndischimney.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _TCP_OFFLOAD_STATS {
  <a href="ulong64" title="typedef unsigned __int64 ULONG64;">ULONG64</a> InSegments;
  <a href="ulong64" title="typedef unsigned __int64 ULONG64;">ULONG64</a> OutSegments;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>   CurrentlyEstablished;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>   ResetEstablished;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>   RetransmittedSegments;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>   InErrors;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>   OutResets;
} TCP_OFFLOAD_STATS, *PTCP_OFFLOAD_STATS;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndischimney/ns-ndischimney-_tcp_offload_stats">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/tcp_offload_stats.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ndischimney-_tcp_offload_stats)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_tcp_offload_stats-structure">_TCP_OFFLOAD_STATS structure</h1>

<h2 id="description">Description</h2>

<p>[The TCP chimney offload feature is deprecated and should not be used.]</p>

<p>The TCP_OFFLOAD_STATS structure contains statistics that an offload target supplies in response to a
query of
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp4-offload-stats">OID_TCP4_OFFLOAD_STATS</a> or
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp6-offload-stats">OID_TCP6_OFFLOAD_STATS</a>.</p>

<h2 id="members">Members</h2>

<h3 id="insegments"><code>InSegments</code></h3>

<p>The total number of segments received on offloaded TCP connections, including those received in
error (
<strong>InErrors</strong> ). This count includes segments received on currently established connections. See
<em>tcpInSegs</em> in RFC 1156.</p>

<h3 id="outsegments"><code>OutSegments</code></h3>

<p>The total number of segments sent on offloaded TCP connections, including those on current
connections but excluding those containing only retransmitted octets. See
<em>tcpOutSegs</em> in RFC 1156.</p>

<h3 id="currentlyestablished"><code>CurrentlyEstablished</code></h3>

<p>The number of TCP connections for which the current state is either ESTABLISHED or CLOSE-WAIT. See
<em>tcpCurrEstab</em> in RFC 1156.</p>

<h3 id="resetestablished"><code>ResetEstablished</code></h3>

<p>The number of times that offloaded TCP connections have made a direct transition to the CLOSED
state from either the ESTABLISHED state or the CLOSE-WAIT state.</p>

<h3 id="retransmittedsegments"><code>RetransmittedSegments</code></h3>

<p>The total number of segments retransmitted on offloaded TCP connections--that is, the number of
TCP segments transmitted that contain one or more previously transmitted octets. See
<em>tcpRetransSegs</em> in RFC 1156.</p>

<h3 id="inerrors"><code>InErrors</code></h3>

<p>The number of packets received on offloaded TCP connections that contained one or more
TCP-specific errors that prevented the offload target from delivering the packets. See
<em>ifInErrors</em> in RFC 1156.</p>

<h3 id="outresets"><code>OutResets</code></h3>

<p>The number of segments transmitted on offloaded TCP connections with the RST bit set in the TCP
header.</p>

<h2 id="remarks">Remarks</h2>

<p>The statistics in the TCP_OFFLOAD_STATS structure pertain only to offloaded TCP connections. The
offload target must not include counts for TCP segments on connections that haven't been offloaded. The
statistics in the TCP_OFFLOAD_STATS structure pertain to a single network interface.</p>

<p>If an offload target has more than one network interface, it must maintain a separate set of TCP
statistics counters for each network interface. If the offload target supports both IPv4 and IPv6
connections on a network interface, it must, for that interface, maintain a separate set of TCP
statistics counters for TCP/IPv4 traffic and a separate set of TCP statistics counters for TCP/IPv6
traffic.</p>

<p>If an offload target's TCP chimney capabilities are enabled (see
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/hardware/network/ff558995(v=vs.85)">NDIS_TASK_OFFLOAD</a>) and if at least one
offloaded path state object has been offloaded to the offload target, the offload target can process a
received packet that has a corrupted TCP header (but a valid IP header) in one of two ways:</p>

<ul>
<li>The offload target can indicate the packet through the non-offload interface by calling the
<a rel="noopener" target="_blank" href="ndismindicatereceivenetbufferlists">NdisMIndicateReceiveNetBufferLists</a> function. In this case, the offload target must not increment
the
<strong>InErrors</strong> counter. This is the recommended approach.</li>
<li>Alternatively, the offload target can drop the corrupted packet and increment the
<strong>InErrors</strong> counter.</li>
</ul>

<p>If the offload target's TCP chimney capabilities are not enabled or if there is not at least one
offloaded path state object, the offload target must indicate the corrupted packet and must not increment
the
<strong>InErrors</strong> counter.</p>

<p>The host stack integrates the statistics returned by an offload target with the statistics that the
host stack maintains for non-offloaded TCP connections.</p>

<p>Note that the host stack supplies a TCP_OFFLOAD_STATS structure when setting OID_TCP4_OFFLOAD_STATS or
OID_TCP6_OFFLOAD_STATS. In this case, however, the offload target does not have to examine the values in
the TCP_OFFLOAD_STATS structure. Instead, when OID_TCP4_OFFLOAD_STATS is set, the offload target should
reset to zero its TCP statistics counters for offloaded TCP connections that convey IPv4 datagrams. When
OID_TCP6_OFFLOAD_STATS is set, the offload target should reset to zero its TCP statistics counters for
offloaded TCP connections that convey IPv6 datagrams.</p>

<p>All of the counters that supply the values for the TCP_OFFLOAD_STATS structure wrap (restart from
zero) when incremented beyond their maximum counts.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp4-offload-stats">OID_TCP4_OFFLOAD_STATS</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp6-offload-stats">OID_TCP6_OFFLOAD_STATS</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndischimney/ns-ndischimney-_tcp_offload_stats">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ndischimney/ns-ndischimney-_tcp_offload_stats.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
