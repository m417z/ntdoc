<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FILE_DISPOSITION_INFORMATION_EX - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FILE_DISPOSITION_INFORMATION_EX - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FILE_DISPOSITION_INFORMATION_EX - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _FILE_DISPOSITION_INFORMATION_EX {
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Flags;
} FILE_DISPOSITION_INFORMATION_EX, *PFILE_DISPOSITION_INFORMATION_EX;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddk/ns-ntddk-_file_disposition_information_ex">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/file_disposition_information_ex.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddk-_file_disposition_information_ex)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_file_disposition_information_ex-structure">_FILE_DISPOSITION_INFORMATION_EX structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>FILE_DISPOSITION_INFORMATION_EX</strong> structure is used as an argument to the <a rel="noopener" target="_blank" href="ntsetinformationfile">ZwSetInformationFile</a> routine and indicates how the operating system should delete a file.</p>

<h2 id="members">Members</h2>

<h3 id="flags"><code>Flags</code></h3>

<p>Specifies what actions the system should take with a specific file while deleting.</p>

<table>
<thead>
<tr>
  <th>Flag Name</th>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>FILE_DISPOSITION_DO_NOT_DELETE</td>
  <td>0x00000000</td>
  <td>Specifies the system should not delete a file.</td>
</tr>
<tr>
  <td>FILE_DISPOSITION_DELETE</td>
  <td>0x00000001</td>
  <td>Specifies the system should delete a file.</td>
</tr>
<tr>
  <td>FILE_DISPOSITION_POSIX_SEMANTICS</td>
  <td>0x00000002</td>
  <td>Specifies the system should perform a POSIX-style delete. See more info in Remarks.</td>
</tr>
<tr>
  <td>FILE_DISPOSITION_FORCE_IMAGE_SECTION_CHECK</td>
  <td>0x00000004</td>
  <td>Specifies the system should force an image section check.</td>
</tr>
<tr>
  <td>FILE_DISPOSITION_ON_CLOSE</td>
  <td>0x00000008</td>
  <td>Specifies if the system sets or clears the on-close state.</td>
</tr>
<tr>
  <td>FILE_DISPOSITION_IGNORE_READONLY_ATTRIBUTE</td>
  <td>0x00000010</td>
  <td>Allows read-only files to be deleted.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>The caller must have DELETE access to a given file to call <a href="ntsetinformationfile" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationFile(&#10;    _In_ HANDLE FileHandle,&#10;    _Out_ PIO_STATUS_BLOCK IoStatusBlock,&#10;    _In_reads_bytes_(Length) PVOID FileInformation,&#10;    _In_ ULONG Length,&#10;    _In_ FILE_INFORMATION_CLASS FileInformationClass&#10;    );">ZwSetInformationFile</a> with <strong>FILE_DISPOSITION_DELETE</strong>.</p>

<p>When <strong>FILE_DISPOSITION_POSIX_SEMANTICS</strong> is not set, a file marked for deletion is not actually deleted until all open handles for the file have been closed and the link count for the file is zero. When <strong>FILE_DISPOSITION_POSIX_SEMANTICS</strong> is set, the link is removed from the visible namespace as soon as the POSIX delete handle has been closed, but the file's data streams remain accessible by other existing handles until the last handle has been closed. That is, applications that already had the file open can still use their handle to read/write even though the name they used to open it is gone and the file's link count may have reached zero.</p>

<p>If the file is being deleted at user request, using POSIX semantics allows the system to delete the file as requested, but also allows any process with an open handle to continue to access the file's data as long as the handle is open.</p>

<p>A return value of STATUS_CANNOT_DELETE indicates that either the file is read-only, or there is an existing mapped view to the file.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="ntclose">ZwClose</a></p>

<p><a rel="noopener" target="_blank" href="ntsetinformationfile">ZwSetInformationFile</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddk/ns-ntddk-_file_disposition_information_ex">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddk/ns-ntddk-_file_disposition_information_ex.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
