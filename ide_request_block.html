<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="IDE_REQUEST_BLOCK - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>IDE_REQUEST_BLOCK - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            IDE_REQUEST_BLOCK - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// irb.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _IDE_REQUEST_BLOCK {
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a> Function;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>  IrbStatus;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>  AtaStatus;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>  AtaError;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>  Channel;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>  TargetId;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>  Lun;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>  CdbLength;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>  SenseInfoBufferLength;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>  SenseInfoBufferType;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>  QueueTag;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  ReservedAsUlong;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  IrbFlags;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  TimeOutValue;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  DataTransferLength;
  PVOID  IrbExtension;
  PVOID  DataBuffer;
  PVOID  SenseInfoBuffer;
  PVOID  NextIrb;
  PVOID  Reserved;
  union {
    <a href="ide_task_file" title="typedef struct _IDE_TASK_FILE {&#10;  IDEREGISTERS Current;&#10;  IDEREGISTERS Previous;&#10;} IDE_TASK_FILE, *PIDE_TASK_FILE;">IDE_TASK_FILE</a>  IdeTaskFile;
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>          Cdb[16];
    <a href="ide_power_info" title="typedef struct _IDE_POWER_INFO {&#10;  IDE_POWER_STATE CurrentPowerState;&#10;  IDE_POWER_STATE DesiredPowerState;&#10;} IDE_POWER_INFO, *PIDE_POWER_INFO;">IDE_POWER_INFO</a> PowerChange;
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>          AsUChar[16];
  };
} IDE_REQUEST_BLOCK, *PIDE_REQUEST_BLOCK;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/irb/ns-irb-_ide_request_block">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ide_request_block.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-irb-_ide_request_block)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>_IDE_REQUEST_BLOCK structure</h1>

<h2>Description</h2>

<p>The IDE_REQUEST_BLOCK structure defines an IDE request block.</p>

<p><strong>Note</strong> The ATA port driver and ATA miniport driver models may be altered or unavailable in the future. Instead, we recommend using the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/storage/storport-driver">Storport driver</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/storage/storport-miniport-drivers">Storport miniport</a> driver models.</p>

<h2>Members</h2>

<h3><code>Function</code></h3>

<p>Specifies the category that the request belongs to. The table below describes the classification of the I/O requests.</p>

<table>
<thead>
<tr>
  <th></th>
  <th></th>
  <th></th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>Function</strong></td>
  <td><strong>Sub-commands</strong></td>
  <td><strong>Description</strong></td>
</tr>
<tr>
  <td>IRB_FUNCTION_ATA_COMMAND</td>
  <td>IRB_FUNCTION_ATA_IDENTIFY<br><br>IRB_FUNCTION_ATA_READ<br><br>IRB_FUNCTION_ATA_WRITE<br><br>IRB_FUNCTION_ATA_FLUSH<br><br>IRB_FUNCTION_ATA_SMART</td>
  <td>Indicates that the <a href="irb" title="typedef struct _IRB {&#10;  ULONG     FunctionNumber;&#10;  ULONG     Flags;&#10;  ULONG_PTR BusReserved[IRB_BUS_RESERVED_SZ];&#10;  ULONG_PTR PortReserved[IRB_PORT_RESERVED_SZ];&#10;  union {&#10;    IRB_REQ_ASYNC_READ                          AsyncRead;&#10;    IRB_REQ_ASYNC_WRITE                         AsyncWrite;&#10;    IRB_REQ_ASYNC_LOCK                          AsyncLock;&#10;    IRB_REQ_ISOCH_ALLOCATE_BANDWIDTH            IsochAllocateBandwidth;&#10;    IRB_REQ_ISOCH_ALLOCATE_CHANNEL              IsochAllocateChannel;&#10;    IRB_REQ_ISOCH_ALLOCATE_RESOURCES            IsochAllocateResources;&#10;    IRB_REQ_ISOCH_ATTACH_BUFFERS                IsochAttachBuffers;&#10;    IRB_REQ_ISOCH_DETACH_BUFFERS                IsochDetachBuffers;&#10;    IRB_REQ_ISOCH_FREE_BANDWIDTH                IsochFreeBandwidth;&#10;    IRB_REQ_ISOCH_FREE_CHANNEL                  IsochFreeChannel;&#10;    IRB_REQ_ISOCH_FREE_RESOURCES                IsochFreeResources;&#10;    IRB_REQ_ISOCH_LISTEN                        IsochListen;&#10;    IRB_REQ_ISOCH_QUERY_CURRENT_CYCLE_TIME      IsochQueryCurrentCycleTime;&#10;    IRB_REQ_ISOCH_QUERY_RESOURCES               IsochQueryResources;&#10;...">IRB</a> contains an IdeTaskFile that describes the ATA command. The sub-commands indicate finer grouping of request for faster lookup.</td>
</tr>
<tr>
  <td>IRB_FUNCTION_ATAPI_COMMAND</td>
  <td>IRB_FUNCTION_REQUEST_SENSE</td>
  <td>Indicates that the <a href="irb" title="typedef struct _IRB {&#10;  ULONG     FunctionNumber;&#10;  ULONG     Flags;&#10;  ULONG_PTR BusReserved[IRB_BUS_RESERVED_SZ];&#10;  ULONG_PTR PortReserved[IRB_PORT_RESERVED_SZ];&#10;  union {&#10;    IRB_REQ_ASYNC_READ                          AsyncRead;&#10;    IRB_REQ_ASYNC_WRITE                         AsyncWrite;&#10;    IRB_REQ_ASYNC_LOCK                          AsyncLock;&#10;    IRB_REQ_ISOCH_ALLOCATE_BANDWIDTH            IsochAllocateBandwidth;&#10;    IRB_REQ_ISOCH_ALLOCATE_CHANNEL              IsochAllocateChannel;&#10;    IRB_REQ_ISOCH_ALLOCATE_RESOURCES            IsochAllocateResources;&#10;    IRB_REQ_ISOCH_ATTACH_BUFFERS                IsochAttachBuffers;&#10;    IRB_REQ_ISOCH_DETACH_BUFFERS                IsochDetachBuffers;&#10;    IRB_REQ_ISOCH_FREE_BANDWIDTH                IsochFreeBandwidth;&#10;    IRB_REQ_ISOCH_FREE_CHANNEL                  IsochFreeChannel;&#10;    IRB_REQ_ISOCH_FREE_RESOURCES                IsochFreeResources;&#10;    IRB_REQ_ISOCH_LISTEN                        IsochListen;&#10;    IRB_REQ_ISOCH_QUERY_CURRENT_CYCLE_TIME      IsochQueryCurrentCycleTime;&#10;    IRB_REQ_ISOCH_QUERY_RESOURCES               IsochQueryResources;&#10;...">IRB</a> contains a CDB that describes the ATAPI command.</td>
</tr>
<tr>
  <td>IRB_FUNCTION_MINIPORT_COMMAND</td>
  <td>IRB_FUNCTION_ADAPTER_FLUSH<br><br>IRB_FUNCTION_SHUTDOWN<br><br>IRB_FUNCTION_POWER_CHANGE<br><br>IRB_FUNCTION_POWER_REBOOT<br><br>IRB_FUNCTION_LUN_RESET<br><br>IRB_FUNCTION_MINIPORT_IOCTL</td>
  <td>Indicates that the <a href="irb" title="typedef struct _IRB {&#10;  ULONG     FunctionNumber;&#10;  ULONG     Flags;&#10;  ULONG_PTR BusReserved[IRB_BUS_RESERVED_SZ];&#10;  ULONG_PTR PortReserved[IRB_PORT_RESERVED_SZ];&#10;  union {&#10;    IRB_REQ_ASYNC_READ                          AsyncRead;&#10;    IRB_REQ_ASYNC_WRITE                         AsyncWrite;&#10;    IRB_REQ_ASYNC_LOCK                          AsyncLock;&#10;    IRB_REQ_ISOCH_ALLOCATE_BANDWIDTH            IsochAllocateBandwidth;&#10;    IRB_REQ_ISOCH_ALLOCATE_CHANNEL              IsochAllocateChannel;&#10;    IRB_REQ_ISOCH_ALLOCATE_RESOURCES            IsochAllocateResources;&#10;    IRB_REQ_ISOCH_ATTACH_BUFFERS                IsochAttachBuffers;&#10;    IRB_REQ_ISOCH_DETACH_BUFFERS                IsochDetachBuffers;&#10;    IRB_REQ_ISOCH_FREE_BANDWIDTH                IsochFreeBandwidth;&#10;    IRB_REQ_ISOCH_FREE_CHANNEL                  IsochFreeChannel;&#10;    IRB_REQ_ISOCH_FREE_RESOURCES                IsochFreeResources;&#10;    IRB_REQ_ISOCH_LISTEN                        IsochListen;&#10;    IRB_REQ_ISOCH_QUERY_CURRENT_CYCLE_TIME      IsochQueryCurrentCycleTime;&#10;    IRB_REQ_ISOCH_QUERY_RESOURCES               IsochQueryResources;&#10;...">IRB</a> is for the miniport. It is the responsibility of the miniport to interpret the command appropriately.</td>
</tr>
</tbody>
</table>

<h3><code>IrbStatus</code></h3>

<p>The miniport must set this member to indicates the status of the specified operation. The table below describes the various <strong>IrbStatus</strong> values and their meaning.</p>

<table>
<thead>
<tr>
  <th></th>
  <th></th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>Value</strong></td>
  <td><strong>Meaning</strong></td>
</tr>
<tr>
  <td>IRB_STATUS_PENDING</td>
  <td>Indicates that the request is in progress. The port driver initializes <strong>IrbStatus</strong> to this value. A miniport driver should never set the <strong>IrbStatus</strong> member to this value.</td>
</tr>
<tr>
  <td>IRB_STATUS_SUCCESS</td>
  <td>Indicates that the request was completed successfully.</td>
</tr>
<tr>
  <td>IRB_STATUS_DATALENGTH_MISMATCH</td>
  <td>Indicates that a data underrun or overrun error occurred. The miniport must update the DataTransferLength field in the <a href="irb" title="typedef struct _IRB {&#10;  ULONG     FunctionNumber;&#10;  ULONG     Flags;&#10;  ULONG_PTR BusReserved[IRB_BUS_RESERVED_SZ];&#10;  ULONG_PTR PortReserved[IRB_PORT_RESERVED_SZ];&#10;  union {&#10;    IRB_REQ_ASYNC_READ                          AsyncRead;&#10;    IRB_REQ_ASYNC_WRITE                         AsyncWrite;&#10;    IRB_REQ_ASYNC_LOCK                          AsyncLock;&#10;    IRB_REQ_ISOCH_ALLOCATE_BANDWIDTH            IsochAllocateBandwidth;&#10;    IRB_REQ_ISOCH_ALLOCATE_CHANNEL              IsochAllocateChannel;&#10;    IRB_REQ_ISOCH_ALLOCATE_RESOURCES            IsochAllocateResources;&#10;    IRB_REQ_ISOCH_ATTACH_BUFFERS                IsochAttachBuffers;&#10;    IRB_REQ_ISOCH_DETACH_BUFFERS                IsochDetachBuffers;&#10;    IRB_REQ_ISOCH_FREE_BANDWIDTH                IsochFreeBandwidth;&#10;    IRB_REQ_ISOCH_FREE_CHANNEL                  IsochFreeChannel;&#10;    IRB_REQ_ISOCH_FREE_RESOURCES                IsochFreeResources;&#10;    IRB_REQ_ISOCH_LISTEN                        IsochListen;&#10;    IRB_REQ_ISOCH_QUERY_CURRENT_CYCLE_TIME      IsochQueryCurrentCycleTime;&#10;    IRB_REQ_ISOCH_QUERY_RESOURCES               IsochQueryResources;&#10;...">IRB</a> to indicate the actual amount of data that was transferred in the case of an underrun.</td>
</tr>
<tr>
  <td>IRB_STATUS_DEVICE_ERROR</td>
  <td>Indicates that the device returned an error. The miniport driver must update the <em>AtaStatus</em> and <em>AtaError</em> fields in the Irb to the contents of the device ATA status and error register at the completion of the command.</td>
</tr>
<tr>
  <td>IRB_STATUS_INVALID_REQUEST</td>
  <td>Indicates that the miniport does not support the given request.</td>
</tr>
<tr>
  <td>IRB_STATUS_BUS_RESET</td>
  <td>Indicates that a bus reset occurred while processing the given request.</td>
</tr>
<tr>
  <td>IRB_STATUS_SELECTION_TIMEOUT</td>
  <td>Indicates that the destination device could not be selected.</td>
</tr>
<tr>
  <td>IRB_STATUS_BUSY</td>
  <td>Indicates that the device is busy. The port driver retries any request completed with this status. A request completed with busy status is retried only once. It is the responsibility of the miniport driver to pause the request queue using <strong><a href="ataportdevicebusy" title="VOID AtaPortDeviceBusy(&#10;  [in] PVOID ChannelExtension,&#10;  [in] UCHAR TargetId,&#10;  [in] UCHAR Lun,&#10;  [in] ULONG BusyTimeout&#10;);">AtaPortDeviceBusy</a></strong> if the device cannot handle request for a certain period of time.</td>
</tr>
<tr>
  <td>IRB_STATUS_AUTOSENSE_VALID</td>
  <td>IRB_STATUS_AUTOSENSE_VALID is a bitmask that indicates valid sense data in the <em>SenseInfoBuffer</em> member of the <a href="irb" title="typedef struct _IRB {&#10;  ULONG     FunctionNumber;&#10;  ULONG     Flags;&#10;  ULONG_PTR BusReserved[IRB_BUS_RESERVED_SZ];&#10;  ULONG_PTR PortReserved[IRB_PORT_RESERVED_SZ];&#10;  union {&#10;    IRB_REQ_ASYNC_READ                          AsyncRead;&#10;    IRB_REQ_ASYNC_WRITE                         AsyncWrite;&#10;    IRB_REQ_ASYNC_LOCK                          AsyncLock;&#10;    IRB_REQ_ISOCH_ALLOCATE_BANDWIDTH            IsochAllocateBandwidth;&#10;    IRB_REQ_ISOCH_ALLOCATE_CHANNEL              IsochAllocateChannel;&#10;    IRB_REQ_ISOCH_ALLOCATE_RESOURCES            IsochAllocateResources;&#10;    IRB_REQ_ISOCH_ATTACH_BUFFERS                IsochAttachBuffers;&#10;    IRB_REQ_ISOCH_DETACH_BUFFERS                IsochDetachBuffers;&#10;    IRB_REQ_ISOCH_FREE_BANDWIDTH                IsochFreeBandwidth;&#10;    IRB_REQ_ISOCH_FREE_CHANNEL                  IsochFreeChannel;&#10;    IRB_REQ_ISOCH_FREE_RESOURCES                IsochFreeResources;&#10;    IRB_REQ_ISOCH_LISTEN                        IsochListen;&#10;    IRB_REQ_ISOCH_QUERY_CURRENT_CYCLE_TIME      IsochQueryCurrentCycleTime;&#10;    IRB_REQ_ISOCH_QUERY_RESOURCES               IsochQueryResources;&#10;...">IRB</a>.</td>
</tr>
<tr>
  <td>IRB_STATUS_RETURN_TASKFILE_VALID</td>
  <td>IRB_STATUS_RETURN_TASKFILE_VALID is a bitmask that indicates a valid return task file in the <em>SenseInfoBuffer</em> member of the <a href="irb" title="typedef struct _IRB {&#10;  ULONG     FunctionNumber;&#10;  ULONG     Flags;&#10;  ULONG_PTR BusReserved[IRB_BUS_RESERVED_SZ];&#10;  ULONG_PTR PortReserved[IRB_PORT_RESERVED_SZ];&#10;  union {&#10;    IRB_REQ_ASYNC_READ                          AsyncRead;&#10;    IRB_REQ_ASYNC_WRITE                         AsyncWrite;&#10;    IRB_REQ_ASYNC_LOCK                          AsyncLock;&#10;    IRB_REQ_ISOCH_ALLOCATE_BANDWIDTH            IsochAllocateBandwidth;&#10;    IRB_REQ_ISOCH_ALLOCATE_CHANNEL              IsochAllocateChannel;&#10;    IRB_REQ_ISOCH_ALLOCATE_RESOURCES            IsochAllocateResources;&#10;    IRB_REQ_ISOCH_ATTACH_BUFFERS                IsochAttachBuffers;&#10;    IRB_REQ_ISOCH_DETACH_BUFFERS                IsochDetachBuffers;&#10;    IRB_REQ_ISOCH_FREE_BANDWIDTH                IsochFreeBandwidth;&#10;    IRB_REQ_ISOCH_FREE_CHANNEL                  IsochFreeChannel;&#10;    IRB_REQ_ISOCH_FREE_RESOURCES                IsochFreeResources;&#10;    IRB_REQ_ISOCH_LISTEN                        IsochListen;&#10;    IRB_REQ_ISOCH_QUERY_CURRENT_CYCLE_TIME      IsochQueryCurrentCycleTime;&#10;    IRB_REQ_ISOCH_QUERY_RESOURCES               IsochQueryResources;&#10;...">IRB</a>.</td>
</tr>
</tbody>
</table>

<h3><code>AtaStatus</code></h3>

<p>Indicates the status returned by the device in its status register. The miniport driver should update this field when completing an <a href="irb" title="typedef struct _IRB {&#10;  ULONG     FunctionNumber;&#10;  ULONG     Flags;&#10;  ULONG_PTR BusReserved[IRB_BUS_RESERVED_SZ];&#10;  ULONG_PTR PortReserved[IRB_PORT_RESERVED_SZ];&#10;  union {&#10;    IRB_REQ_ASYNC_READ                          AsyncRead;&#10;    IRB_REQ_ASYNC_WRITE                         AsyncWrite;&#10;    IRB_REQ_ASYNC_LOCK                          AsyncLock;&#10;    IRB_REQ_ISOCH_ALLOCATE_BANDWIDTH            IsochAllocateBandwidth;&#10;    IRB_REQ_ISOCH_ALLOCATE_CHANNEL              IsochAllocateChannel;&#10;    IRB_REQ_ISOCH_ALLOCATE_RESOURCES            IsochAllocateResources;&#10;    IRB_REQ_ISOCH_ATTACH_BUFFERS                IsochAttachBuffers;&#10;    IRB_REQ_ISOCH_DETACH_BUFFERS                IsochDetachBuffers;&#10;    IRB_REQ_ISOCH_FREE_BANDWIDTH                IsochFreeBandwidth;&#10;    IRB_REQ_ISOCH_FREE_CHANNEL                  IsochFreeChannel;&#10;    IRB_REQ_ISOCH_FREE_RESOURCES                IsochFreeResources;&#10;    IRB_REQ_ISOCH_LISTEN                        IsochListen;&#10;    IRB_REQ_ISOCH_QUERY_CURRENT_CYCLE_TIME      IsochQueryCurrentCycleTime;&#10;    IRB_REQ_ISOCH_QUERY_RESOURCES               IsochQueryResources;&#10;...">IRB</a> with <em>IRB_STATUS_DEVICE_ERROR</em>.</p>

<h3><code>AtaError</code></h3>

<p>Indicates the error value returned by the device in its error register. The miniport driver should update this field when completing an <a href="irb" title="typedef struct _IRB {&#10;  ULONG     FunctionNumber;&#10;  ULONG     Flags;&#10;  ULONG_PTR BusReserved[IRB_BUS_RESERVED_SZ];&#10;  ULONG_PTR PortReserved[IRB_PORT_RESERVED_SZ];&#10;  union {&#10;    IRB_REQ_ASYNC_READ                          AsyncRead;&#10;    IRB_REQ_ASYNC_WRITE                         AsyncWrite;&#10;    IRB_REQ_ASYNC_LOCK                          AsyncLock;&#10;    IRB_REQ_ISOCH_ALLOCATE_BANDWIDTH            IsochAllocateBandwidth;&#10;    IRB_REQ_ISOCH_ALLOCATE_CHANNEL              IsochAllocateChannel;&#10;    IRB_REQ_ISOCH_ALLOCATE_RESOURCES            IsochAllocateResources;&#10;    IRB_REQ_ISOCH_ATTACH_BUFFERS                IsochAttachBuffers;&#10;    IRB_REQ_ISOCH_DETACH_BUFFERS                IsochDetachBuffers;&#10;    IRB_REQ_ISOCH_FREE_BANDWIDTH                IsochFreeBandwidth;&#10;    IRB_REQ_ISOCH_FREE_CHANNEL                  IsochFreeChannel;&#10;    IRB_REQ_ISOCH_FREE_RESOURCES                IsochFreeResources;&#10;    IRB_REQ_ISOCH_LISTEN                        IsochListen;&#10;    IRB_REQ_ISOCH_QUERY_CURRENT_CYCLE_TIME      IsochQueryCurrentCycleTime;&#10;    IRB_REQ_ISOCH_QUERY_RESOURCES               IsochQueryResources;&#10;...">IRB</a> with <em>IRB_STATUS_DEVICE_ERROR</em>.</p>

<h3><code>Channel</code></h3>

<p>Specifies the channel number.</p>

<h3><code>TargetId</code></h3>

<p>Specifies the target ID of the device.</p>

<h3><code>Lun</code></h3>

<p>Specifies the logical unit number of the device.</p>

<h3><code>CdbLength</code></h3>

<p>Specifies the length in bytes of the buffer pointed to by <strong>Cdb</strong>.</p>

<h3><code>SenseInfoBufferLength</code></h3>

<p>Specifies the length in bytes of the buffer pointed to by <strong>SenseInfoBuffer</strong>.</p>

<h3><code>SenseInfoBufferType</code></h3>

<p>Specifies the type of data structure returned in <strong>SenseInfoBuffer</strong>. Because ATA commands don't have a need for the request sense command, ATA_PASS_THROUGH commands use <strong>SenseInfoBuffer</strong> to return task file information. For ATA_PASS_THROUGH commands, as identified in the <strong>IrbFlags</strong> member, the appropriate return <strong>TaskFile</strong> size should be reported as either SENSE_INFO_BUFFER_RETURN_TYPE_28BIT_TASKFILE or</p>

<p>SENSE_INFO_BUFFER_RETURN_TYPE_48BIT_TASKFILE.</p>

<h3><code>QueueTag</code></h3>

<p>The queue tag for this <a href="irb" title="typedef struct _IRB {&#10;  ULONG     FunctionNumber;&#10;  ULONG     Flags;&#10;  ULONG_PTR BusReserved[IRB_BUS_RESERVED_SZ];&#10;  ULONG_PTR PortReserved[IRB_PORT_RESERVED_SZ];&#10;  union {&#10;    IRB_REQ_ASYNC_READ                          AsyncRead;&#10;    IRB_REQ_ASYNC_WRITE                         AsyncWrite;&#10;    IRB_REQ_ASYNC_LOCK                          AsyncLock;&#10;    IRB_REQ_ISOCH_ALLOCATE_BANDWIDTH            IsochAllocateBandwidth;&#10;    IRB_REQ_ISOCH_ALLOCATE_CHANNEL              IsochAllocateChannel;&#10;    IRB_REQ_ISOCH_ALLOCATE_RESOURCES            IsochAllocateResources;&#10;    IRB_REQ_ISOCH_ATTACH_BUFFERS                IsochAttachBuffers;&#10;    IRB_REQ_ISOCH_DETACH_BUFFERS                IsochDetachBuffers;&#10;    IRB_REQ_ISOCH_FREE_BANDWIDTH                IsochFreeBandwidth;&#10;    IRB_REQ_ISOCH_FREE_CHANNEL                  IsochFreeChannel;&#10;    IRB_REQ_ISOCH_FREE_RESOURCES                IsochFreeResources;&#10;    IRB_REQ_ISOCH_LISTEN                        IsochListen;&#10;    IRB_REQ_ISOCH_QUERY_CURRENT_CYCLE_TIME      IsochQueryCurrentCycleTime;&#10;    IRB_REQ_ISOCH_QUERY_RESOURCES               IsochQueryResources;&#10;...">IRB</a>. The port driver sets this field to 0.</p>

<h3><code>ReservedAsUlong</code></h3>

<p>Reserved for future use.</p>

<h3><code>IrbFlags</code></h3>

<p>Qualifies the request with certain actions that need to be performed. The table below describes them in detail.</p>

<table>
<thead>
<tr>
  <th></th>
  <th></th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>Flag</strong></td>
  <td><strong>Description</strong></td>
</tr>
<tr>
  <td>IRB_FLAGS_DRDY_REQUIRED</td>
  <td>Indicates that the miniport driver must wait for the device to set the DRDY bit in the ATA status register before issuing this command.</td>
</tr>
<tr>
  <td>IRB_FLAGS_USE_DMA</td>
  <td>Indicates that the request has an associated scatter/gather list and the miniport driver could use DMA to transfer data for this request.</td>
</tr>
<tr>
  <td>IRB_FLAGS_MAP_BUFFERS</td>
  <td>Indicates that the <strong>DataBuffer</strong> field in the <a href="irb" title="typedef struct _IRB {&#10;  ULONG     FunctionNumber;&#10;  ULONG     Flags;&#10;  ULONG_PTR BusReserved[IRB_BUS_RESERVED_SZ];&#10;  ULONG_PTR PortReserved[IRB_PORT_RESERVED_SZ];&#10;  union {&#10;    IRB_REQ_ASYNC_READ                          AsyncRead;&#10;    IRB_REQ_ASYNC_WRITE                         AsyncWrite;&#10;    IRB_REQ_ASYNC_LOCK                          AsyncLock;&#10;    IRB_REQ_ISOCH_ALLOCATE_BANDWIDTH            IsochAllocateBandwidth;&#10;    IRB_REQ_ISOCH_ALLOCATE_CHANNEL              IsochAllocateChannel;&#10;    IRB_REQ_ISOCH_ALLOCATE_RESOURCES            IsochAllocateResources;&#10;    IRB_REQ_ISOCH_ATTACH_BUFFERS                IsochAttachBuffers;&#10;    IRB_REQ_ISOCH_DETACH_BUFFERS                IsochDetachBuffers;&#10;    IRB_REQ_ISOCH_FREE_BANDWIDTH                IsochFreeBandwidth;&#10;    IRB_REQ_ISOCH_FREE_CHANNEL                  IsochFreeChannel;&#10;    IRB_REQ_ISOCH_FREE_RESOURCES                IsochFreeResources;&#10;    IRB_REQ_ISOCH_LISTEN                        IsochListen;&#10;    IRB_REQ_ISOCH_QUERY_CURRENT_CYCLE_TIME      IsochQueryCurrentCycleTime;&#10;    IRB_REQ_ISOCH_QUERY_RESOURCES               IsochQueryResources;&#10;...">IRB</a> is mapped. The miniport can safely access <strong>DataBuffer</strong> when this flag is set. The miniport driver must not access <strong>DataBuffer</strong> if the flag is not set. The miniport driver could request the port driver to map the data buffer by setting this flag in the <a href="irb" title="typedef struct _IRB {&#10;  ULONG     FunctionNumber;&#10;  ULONG     Flags;&#10;  ULONG_PTR BusReserved[IRB_BUS_RESERVED_SZ];&#10;  ULONG_PTR PortReserved[IRB_PORT_RESERVED_SZ];&#10;  union {&#10;    IRB_REQ_ASYNC_READ                          AsyncRead;&#10;    IRB_REQ_ASYNC_WRITE                         AsyncWrite;&#10;    IRB_REQ_ASYNC_LOCK                          AsyncLock;&#10;    IRB_REQ_ISOCH_ALLOCATE_BANDWIDTH            IsochAllocateBandwidth;&#10;    IRB_REQ_ISOCH_ALLOCATE_CHANNEL              IsochAllocateChannel;&#10;    IRB_REQ_ISOCH_ALLOCATE_RESOURCES            IsochAllocateResources;&#10;    IRB_REQ_ISOCH_ATTACH_BUFFERS                IsochAttachBuffers;&#10;    IRB_REQ_ISOCH_DETACH_BUFFERS                IsochDetachBuffers;&#10;    IRB_REQ_ISOCH_FREE_BANDWIDTH                IsochFreeBandwidth;&#10;    IRB_REQ_ISOCH_FREE_CHANNEL                  IsochFreeChannel;&#10;    IRB_REQ_ISOCH_FREE_RESOURCES                IsochFreeResources;&#10;    IRB_REQ_ISOCH_LISTEN                        IsochListen;&#10;    IRB_REQ_ISOCH_QUERY_CURRENT_CYCLE_TIME      IsochQueryCurrentCycleTime;&#10;    IRB_REQ_ISOCH_QUERY_RESOURCES               IsochQueryResources;&#10;...">IRB</a> in its <strong>IdeHwBuildIo</strong> routine.</td>
</tr>
<tr>
  <td>IRB_FLAGS_48BIT</td>
  <td>Indicates that the ATA command in the <a href="irb" title="typedef struct _IRB {&#10;  ULONG     FunctionNumber;&#10;  ULONG     Flags;&#10;  ULONG_PTR BusReserved[IRB_BUS_RESERVED_SZ];&#10;  ULONG_PTR PortReserved[IRB_PORT_RESERVED_SZ];&#10;  union {&#10;    IRB_REQ_ASYNC_READ                          AsyncRead;&#10;    IRB_REQ_ASYNC_WRITE                         AsyncWrite;&#10;    IRB_REQ_ASYNC_LOCK                          AsyncLock;&#10;    IRB_REQ_ISOCH_ALLOCATE_BANDWIDTH            IsochAllocateBandwidth;&#10;    IRB_REQ_ISOCH_ALLOCATE_CHANNEL              IsochAllocateChannel;&#10;    IRB_REQ_ISOCH_ALLOCATE_RESOURCES            IsochAllocateResources;&#10;    IRB_REQ_ISOCH_ATTACH_BUFFERS                IsochAttachBuffers;&#10;    IRB_REQ_ISOCH_DETACH_BUFFERS                IsochDetachBuffers;&#10;    IRB_REQ_ISOCH_FREE_BANDWIDTH                IsochFreeBandwidth;&#10;    IRB_REQ_ISOCH_FREE_CHANNEL                  IsochFreeChannel;&#10;    IRB_REQ_ISOCH_FREE_RESOURCES                IsochFreeResources;&#10;    IRB_REQ_ISOCH_LISTEN                        IsochListen;&#10;    IRB_REQ_ISOCH_QUERY_CURRENT_CYCLE_TIME      IsochQueryCurrentCycleTime;&#10;    IRB_REQ_ISOCH_QUERY_RESOURCES               IsochQueryResources;&#10;...">IRB</a> belongs to the 48 bit LBA feature set. The <strong>Previous</strong> field in the <em>_IDE_TASK_FILE</em> structure is valid when this flag is set.</td>
</tr>
<tr>
  <td>IRB_FLAGS_PIO_MULTIPLE</td>
  <td>Indicates that the ATA command is to be transferred using the ATA PIO Multiple method.</td>
</tr>
<tr>
  <td>IRB_FLAGS_RETURN_RESULTS</td>
  <td>Indicates that the ATA return task file is to be copied to <strong>SenseInfoBuffer</strong>.</td>
</tr>
<tr>
  <td>IRB_FLAGS_DATA_IN</td>
  <td>Indicates that the data is to be transferred from the device to the host system (a read operation).</td>
</tr>
<tr>
  <td>IRB_FLAGS_DATA_OUT</td>
  <td>Indicates that the data is to be transferred to the device from the host system ( a write operation).</td>
</tr>
<tr>
  <td>IRB_FLAGS_DISCARDABLE</td>
  <td>Indicates that the command shall be done in a best effort manner. (note: this is not currently employed by ATAport).</td>
</tr>
<tr>
  <td>IRB_FLAGS_HIGH_PRIORITY</td>
  <td>Indicates that this <a href="irb" title="typedef struct _IRB {&#10;  ULONG     FunctionNumber;&#10;  ULONG     Flags;&#10;  ULONG_PTR BusReserved[IRB_BUS_RESERVED_SZ];&#10;  ULONG_PTR PortReserved[IRB_PORT_RESERVED_SZ];&#10;  union {&#10;    IRB_REQ_ASYNC_READ                          AsyncRead;&#10;    IRB_REQ_ASYNC_WRITE                         AsyncWrite;&#10;    IRB_REQ_ASYNC_LOCK                          AsyncLock;&#10;    IRB_REQ_ISOCH_ALLOCATE_BANDWIDTH            IsochAllocateBandwidth;&#10;    IRB_REQ_ISOCH_ALLOCATE_CHANNEL              IsochAllocateChannel;&#10;    IRB_REQ_ISOCH_ALLOCATE_RESOURCES            IsochAllocateResources;&#10;    IRB_REQ_ISOCH_ATTACH_BUFFERS                IsochAttachBuffers;&#10;    IRB_REQ_ISOCH_DETACH_BUFFERS                IsochDetachBuffers;&#10;    IRB_REQ_ISOCH_FREE_BANDWIDTH                IsochFreeBandwidth;&#10;    IRB_REQ_ISOCH_FREE_CHANNEL                  IsochFreeChannel;&#10;    IRB_REQ_ISOCH_FREE_RESOURCES                IsochFreeResources;&#10;    IRB_REQ_ISOCH_LISTEN                        IsochListen;&#10;    IRB_REQ_ISOCH_QUERY_CURRENT_CYCLE_TIME      IsochQueryCurrentCycleTime;&#10;    IRB_REQ_ISOCH_QUERY_RESOURCES               IsochQueryResources;&#10;...">IRB</a> is to be processed as soon as possible, before non-high-priority IRBs currently in the ATA miniport.</td>
</tr>
</tbody>
</table>

<h3><code>TimeOutValue</code></h3>

<p>Indicates the time in seconds after which the request will time out.</p>

<h3><code>DataTransferLength</code></h3>

<p>Contains the length in bytes of the data buffer that contains data to be transferred.</p>

<h3><code>IrbExtension</code></h3>

<p>Pointer to the per-request extension allocated by the port driver.</p>

<h3><code>DataBuffer</code></h3>

<p>Pointer to the buffer where the data resides.</p>

<h3><code>SenseInfoBuffer</code></h3>

<p>Pointer to the buffer which holds the sense data.</p>

<h3><code>NextIrb</code></h3>

<p>Pointer to the next <a href="irb" title="typedef struct _IRB {&#10;  ULONG     FunctionNumber;&#10;  ULONG     Flags;&#10;  ULONG_PTR BusReserved[IRB_BUS_RESERVED_SZ];&#10;  ULONG_PTR PortReserved[IRB_PORT_RESERVED_SZ];&#10;  union {&#10;    IRB_REQ_ASYNC_READ                          AsyncRead;&#10;    IRB_REQ_ASYNC_WRITE                         AsyncWrite;&#10;    IRB_REQ_ASYNC_LOCK                          AsyncLock;&#10;    IRB_REQ_ISOCH_ALLOCATE_BANDWIDTH            IsochAllocateBandwidth;&#10;    IRB_REQ_ISOCH_ALLOCATE_CHANNEL              IsochAllocateChannel;&#10;    IRB_REQ_ISOCH_ALLOCATE_RESOURCES            IsochAllocateResources;&#10;    IRB_REQ_ISOCH_ATTACH_BUFFERS                IsochAttachBuffers;&#10;    IRB_REQ_ISOCH_DETACH_BUFFERS                IsochDetachBuffers;&#10;    IRB_REQ_ISOCH_FREE_BANDWIDTH                IsochFreeBandwidth;&#10;    IRB_REQ_ISOCH_FREE_CHANNEL                  IsochFreeChannel;&#10;    IRB_REQ_ISOCH_FREE_RESOURCES                IsochFreeResources;&#10;    IRB_REQ_ISOCH_LISTEN                        IsochListen;&#10;    IRB_REQ_ISOCH_QUERY_CURRENT_CYCLE_TIME      IsochQueryCurrentCycleTime;&#10;    IRB_REQ_ISOCH_QUERY_RESOURCES               IsochQueryResources;&#10;...">IRB</a> to be processed. The port driver sets this to <strong>NULL</strong>. The miniport driver can use this field to link IRBs together.</p>

<h3><code>Reserved</code></h3>

<p>Reserved for future use.</p>

<h3><code>IdeTaskFile</code></h3>

<p>Contains a structure of type <a href="ide_task_file" title="typedef struct _IDE_TASK_FILE {&#10;  IDEREGISTERS Current;&#10;  IDEREGISTERS Previous;&#10;} IDE_TASK_FILE, *PIDE_TASK_FILE;">IDE_TASK_FILE</a> that holds the IDE task file for the indicated controller. This member is defined whenever the result of a bitwise AND between the <strong>Function</strong> member and IRB_FUNCTION_ATA_COMMAND is nonzero.</p>

<h3><code>Cdb</code></h3>

<p>Contains a command descriptor block (CDB). This member is defined whenever the result of a bitwise AND between the <strong>Function</strong> member and IRB_FUNCTION_ATAPI_COMMAND is nonzero.</p>

<h3><code>PowerChange</code></h3>

<p>Indicates an enumeration value of type <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/irb/ns-irb-_ide_power_info">POWER_CHANGE_INFO</a> that defines a power state transition. This member is defined whenever <strong>Function</strong> is equal to IRB_FUNCTION_POWER_CHANGE.</p>

<h3><code>AsUChar</code></h3>

<p>Provides a means of accessing members <strong>IdeTaskFile</strong>, <strong>PowerChange</strong>, and <strong>Cdb</strong> as unsigned character data.</p>

<h2>Remarks</h2>

<p>The IDE_REQUEST_BLOCK structure provides a functionality similar to the <a href="scsi_request_block" title="typedef struct _SCSI_REQUEST_BLOCK {&#10;  USHORT                     Length;&#10;  UCHAR                      Function;&#10;  UCHAR                      SrbStatus;&#10;  UCHAR                      ScsiStatus;&#10;  UCHAR                      PathId;&#10;  UCHAR                      TargetId;&#10;  UCHAR                      Lun;&#10;  UCHAR                      QueueTag;&#10;  UCHAR                      QueueAction;&#10;  UCHAR                      CdbLength;&#10;  UCHAR                      SenseInfoBufferLength;&#10;  ULONG                      SrbFlags;&#10;  ULONG                      DataTransferLength;&#10;  ULONG                      TimeOutValue;&#10;  PVOID                      DataBuffer;&#10;  PVOID                      SenseInfoBuffer;&#10;  struct _SCSI_REQUEST_BLOCK *NextSrb;&#10;  PVOID                      OriginalRequest;&#10;  PVOID                      SrbExtension;&#10;...">SCSI_REQUEST_BLOCK</a> but with characteristics more suitable for managing devices on an IDE bus.</p>

<h2>See also</h2>

<p><a href="ataportdevicebusy" title="VOID AtaPortDeviceBusy(&#10;  [in] PVOID ChannelExtension,&#10;  [in] UCHAR TargetId,&#10;  [in] UCHAR Lun,&#10;  [in] ULONG BusyTimeout&#10;);">AtaPortDeviceBusy</a></p>

<p><a href="ide_task_file" title="typedef struct _IDE_TASK_FILE {&#10;  IDEREGISTERS Current;&#10;  IDEREGISTERS Previous;&#10;} IDE_TASK_FILE, *PIDE_TASK_FILE;">IDE_TASK_FILE</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/irb/ns-irb-_ide_power_info">POWER_CHANGE_INFO</a></p>

<p><a href="scsi_request_block" title="typedef struct _SCSI_REQUEST_BLOCK {&#10;  USHORT                     Length;&#10;  UCHAR                      Function;&#10;  UCHAR                      SrbStatus;&#10;  UCHAR                      ScsiStatus;&#10;  UCHAR                      PathId;&#10;  UCHAR                      TargetId;&#10;  UCHAR                      Lun;&#10;  UCHAR                      QueueTag;&#10;  UCHAR                      QueueAction;&#10;  UCHAR                      CdbLength;&#10;  UCHAR                      SenseInfoBufferLength;&#10;  ULONG                      SrbFlags;&#10;  ULONG                      DataTransferLength;&#10;  ULONG                      TimeOutValue;&#10;  PVOID                      DataBuffer;&#10;  PVOID                      SenseInfoBuffer;&#10;  struct _SCSI_REQUEST_BLOCK *NextSrb;&#10;  PVOID                      OriginalRequest;&#10;  PVOID                      SrbExtension;&#10;...">SCSI_REQUEST_BLOCK</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/irb/ns-irb-_ide_request_block">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/irb/ns-irb-_ide_request_block.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
