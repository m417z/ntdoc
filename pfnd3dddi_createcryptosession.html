<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PFND3DDDI_CREATECRYPTOSESSION - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PFND3DDDI_CREATECRYPTOSESSION - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PFND3DDDI_CREATECRYPTOSESSION - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dumddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PFND3DDDI_CREATECRYPTOSESSION Pfnd3dddiCreatecryptosession;

HRESULT Pfnd3dddiCreatecryptosession(
  HANDLE hDevice,
  <a href="d3dddiarg_createcryptosession" title="typedef struct _D3DDDIARG_CREATECRYPTOSESSION {&#10;  [in]     GUID   CryptoType;&#10;           GUID   DecodeProfile;&#10;  [in/out] HANDLE hCryptoSession;&#10;} D3DDDIARG_CREATECRYPTOSESSION;">D3DDDIARG_CREATECRYPTOSESSION</a> *unnamedParam2
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_createcryptosession">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pfnd3dddi_createcryptosession.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-d3dumddi-pfnd3dddi_createcryptosession)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pfnd3dddi_createcryptosession-callback-function">PFND3DDDI_CREATECRYPTOSESSION callback function</h1>

<h2 id="description">Description</h2>

<p>The <strong>CreateCryptoSession</strong> function creates a crypto session that the Direct3D runtime uses to manage a session key and to perform crypto operations into and out of protected memory.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="hdevice"><code>hDevice</code></h3>

<p>A handle to the display device (graphics context).</p>

<h3 id="unnamedparam2"><code>unnamedParam2</code></h3>

<p>pData [in, out]</p>

<p>A pointer to a <a href="d3dddiarg_createcryptosession" title="typedef struct _D3DDDIARG_CREATECRYPTOSESSION {&#10;  [in]     GUID   CryptoType;&#10;           GUID   DecodeProfile;&#10;  [in/out] HANDLE hCryptoSession;&#10;} D3DDDIARG_CREATECRYPTOSESSION;">D3DDDIARG_CREATECRYPTOSESSION</a> structure. On input, this structure contains information that the driver can use. On output, the driver specifies information in the structure that the Microsoft Direct3D runtime can use.</p>

<h2 id="return-value">Return value</h2>

<p><strong>CreateCryptoSession</strong> returns one of the following values:</p>

<table>
<thead>
<tr>
  <th style="text-align:left;"><strong>Return code</strong></th>
  <th style="text-align:left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:left;"><strong>S_OK</strong></td>
  <td style="text-align:left;">The crypto session is successfully created.</td>
</tr>
<tr>
  <td style="text-align:left;"><strong>E_OUTOFMEMORY</strong></td>
  <td style="text-align:left;"><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d10umddi/nc-d3d10umddi-pfnd3d11_1ddi_createcryptosession">CreateCryptoSession</a> could not allocate the required memory for it to complete.</td>
</tr>
<tr>
  <td style="text-align:left;"><strong>D3DDDIERR_NOTAVAILABLE</strong></td>
  <td style="text-align:left;">The driver does not support the GUID that is specified in the CryptoTypemember of the <a href="d3dddiarg_createcryptosession" title="typedef struct _D3DDDIARG_CREATECRYPTOSESSION {&#10;  [in]     GUID   CryptoType;&#10;           GUID   DecodeProfile;&#10;  [in/out] HANDLE hCryptoSession;&#10;} D3DDDIARG_CREATECRYPTOSESSION;">D3DDDIARG_CREATECRYPTOSESSION</a> structure or the NULL_GUID (all zeros) is specified in the CryptoTypemember.</td>
</tr>
<tr>
  <td style="text-align:left;"><strong>D3DDDIERR_UNSUPPORTEDCRYPTO</strong></td>
  <td style="text-align:left;">The driver does not support the crypto type for the specified decode type.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>If the <strong>DecodeProfile</strong> member of the <a href="d3dddiarg_createcryptosession" title="typedef struct _D3DDDIARG_CREATECRYPTOSESSION {&#10;  [in]     GUID   CryptoType;&#10;           GUID   DecodeProfile;&#10;  [in/out] HANDLE hCryptoSession;&#10;} D3DDDIARG_CREATECRYPTOSESSION;">D3DDDIARG_CREATECRYPTOSESSION</a> structure is NULL_GUID, the crypto session will not be used for DirectX Video Acceleration (DirectX VA) decoding. If <strong>DecodeProfile</strong> is not <strong>NULL</strong> GUID, the driver should fail with D3DDDIERR_UNSUPPORTEDCRYPTO if the crypto type in the <strong>CryptoType</strong> member is not supported by the decode profile.</p>

<p>The driver returns a handle for the crypto session in the <strong>hCryptoSession</strong> member of <a href="d3dddiarg_createcryptosession" title="typedef struct _D3DDDIARG_CREATECRYPTOSESSION {&#10;  [in]     GUID   CryptoType;&#10;           GUID   DecodeProfile;&#10;  [in/out] HANDLE hCryptoSession;&#10;} D3DDDIARG_CREATECRYPTOSESSION;">D3DDDIARG_CREATECRYPTOSESSION</a> that the runtime passes in all subsequent crypto session calls (for example, <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_cryptosessionkeyexchange">CryptoSessionKeyExchange</a>).</p>

<p>The driver must keep track of the display device (<strong>hDevice</strong>) that was used to create the crypto session. The driver should fail all subsequent calls that use this created crypto session if the display device that is specified in those calls is different from the display device that was used to create the crypto session.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_cryptosessionkeyexchange">CryptoSessionKeyExchange</a></p>

<p><a href="d3dddiarg_createcryptosession" title="typedef struct _D3DDDIARG_CREATECRYPTOSESSION {&#10;  [in]     GUID   CryptoType;&#10;           GUID   DecodeProfile;&#10;  [in/out] HANDLE hCryptoSession;&#10;} D3DDDIARG_CREATECRYPTOSESSION;">D3DDDIARG_CREATECRYPTOSESSION</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_createcryptosession">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dumddi/nc-d3dumddi-pfnd3dddi_createcryptosession.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
