<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="KBUGCHECK_REASON_CALLBACK_ROUTINE - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>KBUGCHECK_REASON_CALLBACK_ROUTINE - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            KBUGCHECK_REASON_CALLBACK_ROUTINE - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">KBUGCHECK_REASON_CALLBACK_ROUTINE KbugcheckReasonCallbackRoutine;

VOID KbugcheckReasonCallbackRoutine(
  [in]      <a href="kbugcheck_callback_reason" title="typedef enum _KBUGCHECK_CALLBACK_REASON {&#10;  KbCallbackInvalid,&#10;  KbCallbackReserved1,&#10;  KbCallbackSecondaryDumpData,&#10;  KbCallbackDumpIo,&#10;  KbCallbackAddPages,&#10;  KbCallbackSecondaryMultiPartDumpData,&#10;  KbCallbackRemovePages,&#10;  KbCallbackTriageDumpData,&#10;  KbCallbackReserved2,&#10;  KbCallbackReserved3&#10;} KBUGCHECK_CALLBACK_REASON;">KBUGCHECK_CALLBACK_REASON</a> Reason,
  [in]      _KBUGCHECK_REASON_CALLBACK_RECORD *Record,
  [in, out] PVOID ReasonSpecificData,
  [in]      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> ReasonSpecificDataLength
)
{...}</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-kbugcheck_reason_callback_routine">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/kbugcheck_reason_callback_routine.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-wdm-kbugcheck_reason_callback_routine)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2 id="description">Description</h2>

<p>Driver-implemented callback functions that the system executes when it issues a bug check.</p>

<p>See <strong><a href="kbugcheck_callback_reason" title="typedef enum _KBUGCHECK_CALLBACK_REASON {&#10;  KbCallbackInvalid,&#10;  KbCallbackReserved1,&#10;  KbCallbackSecondaryDumpData,&#10;  KbCallbackDumpIo,&#10;  KbCallbackAddPages,&#10;  KbCallbackSecondaryMultiPartDumpData,&#10;  KbCallbackRemovePages,&#10;  KbCallbackTriageDumpData,&#10;  KbCallbackReserved2,&#10;  KbCallbackReserved3&#10;} KBUGCHECK_CALLBACK_REASON;">KBUGCHECK_CALLBACK_REASON</a></strong> for information on available callback types.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="reason-in"><code>Reason</code> [in]</h3>

<p>An enumeration of type <strong><a href="kbugcheck_callback_reason" title="typedef enum _KBUGCHECK_CALLBACK_REASON {&#10;  KbCallbackInvalid,&#10;  KbCallbackReserved1,&#10;  KbCallbackSecondaryDumpData,&#10;  KbCallbackDumpIo,&#10;  KbCallbackAddPages,&#10;  KbCallbackSecondaryMultiPartDumpData,&#10;  KbCallbackRemovePages,&#10;  KbCallbackTriageDumpData,&#10;  KbCallbackReserved2,&#10;  KbCallbackReserved3&#10;} KBUGCHECK_CALLBACK_REASON;">KBUGCHECK_CALLBACK_REASON</a></strong> that specifies the reason for the call to the callback routine.</p>

<h3 id="record-in"><code>Record</code> [in]</h3>

<p>A pointer to the <strong><a href="kbugcheck_reason_callback_record" title="typedef struct _KBUGCHECK_REASON_CALLBACK_RECORD {&#10;  LIST_ENTRY                         Entry;&#10;  PKBUGCHECK_REASON_CALLBACK_ROUTINE CallbackRoutine;&#10;  PUCHAR                             Component;&#10;  ULONG_PTR                          Checksum;&#10;  KBUGCHECK_CALLBACK_REASON          Reason;&#10;  UCHAR                              State;&#10;} KBUGCHECK_REASON_CALLBACK_RECORD, *PKBUGCHECK_REASON_CALLBACK_RECORD;">KBUGCHECK_REASON_CALLBACK_RECORD</a></strong> structure that the driver supplied when it registered this callback. For more information, see the description of the <em>CallbackRecord</em> parameter in <strong><a href="keregisterbugcheckreasoncallback" title="BOOLEAN KeRegisterBugCheckReasonCallback(&#10;  [out] PKBUGCHECK_REASON_CALLBACK_RECORD  CallbackRecord,&#10;  [in]  PKBUGCHECK_REASON_CALLBACK_ROUTINE CallbackRoutine,&#10;  [in]  KBUGCHECK_CALLBACK_REASON          Reason,&#10;  [in]  PUCHAR                             Component&#10;);">KeRegisterBugCheckReasonCallback</a></strong>.</p>

<h3 id="reasonspecificdata-in-out"><code>ReasonSpecificData</code> [in, out]</h3>

<p>Pointer to a buffer that contains a structure of type determined by the table below. Certain members of this structure are filled in by the operating system before it calls the callback routine, and other members must be filled in by the callback routine. For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/writing-a-bug-check-callback-routine">Writing a Bug Check Callback Routine</a>.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Data structure</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>KbCallbackSecondaryDumpData</strong></td>
  <td><strong><a href="kbugcheck_secondary_dump_data" title="typedef struct _KBUGCHECK_SECONDARY_DUMP_DATA {&#10;  IN PVOID  InBuffer;&#10;  IN ULONG  InBufferLength;&#10;  IN ULONG  MaximumAllowed;&#10;  OUT GUID  Guid;&#10;  OUT PVOID OutBuffer;&#10;  OUT ULONG OutBufferLength;&#10;} KBUGCHECK_SECONDARY_DUMP_DATA, *PKBUGCHECK_SECONDARY_DUMP_DATA;">KBUGCHECK_SECONDARY_DUMP_DATA</a></strong></td>
</tr>
<tr>
  <td><strong>KbCallbackDumpIo</strong></td>
  <td><strong><a href="kbugcheck_dump_io" title="typedef struct _KBUGCHECK_DUMP_IO {&#10;  IN ULONG64                Offset;&#10;  IN PVOID                  Buffer;&#10;  IN ULONG                  BufferLength;&#10;  IN KBUGCHECK_DUMP_IO_TYPE Type;&#10;} KBUGCHECK_DUMP_IO, *PKBUGCHECK_DUMP_IO;">KBUGCHECK_DUMP_IO</a></strong></td>
</tr>
<tr>
  <td><strong>KbCallbackAddPages</strong></td>
  <td><strong><a href="kbugcheck_add_pages" title="typedef struct _KBUGCHECK_ADD_PAGES {&#10;  PVOID     Context;&#10;  ULONG     Flags;&#10;  ULONG     BugCheckCode;&#10;  ULONG_PTR Address;&#10;  ULONG_PTR Count;&#10;} KBUGCHECK_ADD_PAGES, *PKBUGCHECK_ADD_PAGES;">KBUGCHECK_ADD_PAGES</a></strong></td>
</tr>
<tr>
  <td><strong>KbCallbackSecondaryMultiPartDumpData</strong></td>
  <td><strong><a href="kbugcheck_secondary_dump_data_ex" title="typedef struct _KBUGCHECK_SECONDARY_DUMP_DATA_EX {&#10;  PVOID     InBuffer;&#10;  ULONG     InBufferLength;&#10;  ULONG     MaximumAllowed;&#10;  GUID      Guid;&#10;  PVOID     OutBuffer;&#10;  ULONG     OutBufferLength;&#10;  PVOID     Context;&#10;  ULONG     Flags;&#10;  ULONG     DumpType;&#10;  ULONG     BugCheckCode;&#10;  ULONG_PTR BugCheckParameter1;&#10;  ULONG_PTR BugCheckParameter2;&#10;  ULONG_PTR BugCheckParameter3;&#10;  ULONG_PTR BugCheckParameter4;&#10;} KBUGCHECK_SECONDARY_DUMP_DATA_EX, *PKBUGCHECK_SECONDARY_DUMP_DATA_EX;">KBUGCHECK_SECONDARY_DUMP_DATA_EX</a></strong></td>
</tr>
<tr>
  <td><strong>KbCallbackRemovePages</strong></td>
  <td><strong><a href="kbugcheck_remove_pages" title="typedef struct _KBUGCHECK_REMOVE_PAGES {&#10;  PVOID     Context;&#10;  ULONG     Flags;&#10;  ULONG     BugCheckCode;&#10;  ULONG_PTR Address;&#10;  ULONG_PTR Count;&#10;} KBUGCHECK_REMOVE_PAGES, *PKBUGCHECK_REMOVE_PAGES;">KBUGCHECK_REMOVE_PAGES</a></strong></td>
</tr>
<tr>
  <td><strong>KbCallbackTriageDumpData</strong></td>
  <td><strong><a href="kbugcheck_triage_dump_data" title="typedef struct _KBUGCHECK_TRIAGE_DUMP_DATA {&#10;  PKTRIAGE_DUMP_DATA_ARRAY DataArray;&#10;  ULONG                    Flags;&#10;  ULONG                    MaxVirtMemSize;&#10;  ULONG                    BugCheckCode;&#10;  ULONG_PTR                BugCheckParameter1;&#10;  ULONG_PTR                BugCheckParameter2;&#10;  ULONG_PTR                BugCheckParameter3;&#10;  ULONG_PTR                BugCheckParameter4;&#10;} KBUGCHECK_TRIAGE_DUMP_DATA, *PKBUGCHECK_TRIAGE_DUMP_DATA;">KBUGCHECK_TRIAGE_DUMP_DATA</a></strong></td>
</tr>
</tbody>
</table>

<h3 id="reasonspecificdatalength-in"><code>ReasonSpecificDataLength</code> [in]</h3>

<p>Specifies the size, in bytes, of the buffer that the <em>ReasonSpecificData</em> parameter points to.</p>

<h2 id="remarks">Remarks</h2>

<p>For information about how to implement this callback routine, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/writing-a-bug-check-callback-routine">Writing a Bug Check Callback Routine</a>.</p>

<p>For sample code that shows how to write data to the crash dump file, see <a rel="noopener" target="_blank" href="https://github.com/Microsoft/DMF/blob/master/Dmf/Modules.Library/Dmf_CrashDump.md">DMF_CrashDump</a>.</p>

<h2 id="see-also">See also</h2>

<p><strong><a href="kbugcheck_add_pages" title="typedef struct _KBUGCHECK_ADD_PAGES {&#10;  PVOID     Context;&#10;  ULONG     Flags;&#10;  ULONG     BugCheckCode;&#10;  ULONG_PTR Address;&#10;  ULONG_PTR Count;&#10;} KBUGCHECK_ADD_PAGES, *PKBUGCHECK_ADD_PAGES;">KBUGCHECK_ADD_PAGES</a></strong></p>

<p><a href="kbugcheck_callback_reason" title="typedef enum _KBUGCHECK_CALLBACK_REASON {&#10;  KbCallbackInvalid,&#10;  KbCallbackReserved1,&#10;  KbCallbackSecondaryDumpData,&#10;  KbCallbackDumpIo,&#10;  KbCallbackAddPages,&#10;  KbCallbackSecondaryMultiPartDumpData,&#10;  KbCallbackRemovePages,&#10;  KbCallbackTriageDumpData,&#10;  KbCallbackReserved2,&#10;  KbCallbackReserved3&#10;} KBUGCHECK_CALLBACK_REASON;">KBUGCHECK_CALLBACK_REASON</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/eprocess">KBUGCHECK_REASON_CALLBACK_RECORD</a></p>

<p><a href="keregisterbugcheckreasoncallback" title="BOOLEAN KeRegisterBugCheckReasonCallback(&#10;  [out] PKBUGCHECK_REASON_CALLBACK_RECORD  CallbackRecord,&#10;  [in]  PKBUGCHECK_REASON_CALLBACK_ROUTINE CallbackRoutine,&#10;  [in]  KBUGCHECK_CALLBACK_REASON          Reason,&#10;  [in]  PUCHAR                             Component&#10;);">KeRegisterBugCheckReasonCallback</a></p>

<p><a href="kederegisterbugcheckreasoncallback" title="BOOLEAN KeDeregisterBugCheckReasonCallback(&#10;  [in, out] PKBUGCHECK_REASON_CALLBACK_RECORD CallbackRecord&#10;);">KeDeregisterBugCheckReasonCallback</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/writing-a-bug-check-callback-routine">Writing a Bug Check Callback Routine</a>.</p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-kbugcheck_reason_callback_routine">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/nc-wdm-kbugcheck_reason_callback_routine.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
