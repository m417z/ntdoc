<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FILE_RENAME_INFORMATION - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FILE_RENAME_INFORMATION - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FILE_RENAME_INFORMATION - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTIOAPI_H

</span><span class="ntdoc-code-intro">/**
 * The FILE_RENAME_INFORMATION structure is used to rename a file.
 * \sa https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/ns-ntifs-_file_rename_information
 */
</span><span class="ntdoc-code-body">typedef struct _FILE_RENAME_INFORMATION
{
    BOOLEAN ReplaceIfExists;
    HANDLE RootDirectory;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> FileNameLength;
    _Field_size_bytes_(FileNameLength) WCHAR FileName[1];
} FILE_RENAME_INFORMATION, *PFILE_RENAME_INFORMATION;
</span><span class="ntdoc-code-footer">
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/b281a48adceb1d88b4db663cbaf84ab06cc7074d/phnt/include/ntioapi.h#L611">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntifs.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _FILE_RENAME_INFORMATION {
#if (_WIN32_WINNT &gt;= _WIN32_WINNT_WIN10_RS1)
    union {
        BOOLEAN ReplaceIfExists;  // FileRenameInformation
        <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Flags;              // FileRenameInformationEx
    } DUMMYUNIONNAME;
#else
    BOOLEAN ReplaceIfExists;
#endif
    HANDLE RootDirectory;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> FileNameLength;
    WCHAR FileName[1];
} FILE_RENAME_INFORMATION, *PFILE_RENAME_INFORMATION;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/ns-ntifs-_file_rename_information">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/file_rename_information.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntifs-_file_rename_information)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="file_rename_information-structure">FILE_RENAME_INFORMATION structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>FILE_RENAME_INFORMATION</strong> structure is used to rename a file.</p>

<h2 id="members">Members</h2>

<h3 id="dummyunionname"><code>DUMMYUNIONNAME</code></h3>

<h3 id="dummyunionnamereplaceifexists"><code>DUMMYUNIONNAME.ReplaceIfExists</code></h3>

<p>Set to TRUE to specify that if a file with the given name already exists, it should be replaced with the given file. Set to FALSE if the rename operation should fail if a file with the given name already exists.</p>

<h3 id="dummyunionnameflags"><code>DUMMYUNIONNAME.Flags</code></h3>

<p>Flags for the rename operation. This field is only applicable when used with the <strong>FileRenameInformationEx</strong> information class.</p>

<p>Here are the possible values:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong><a href="file_rename_replace_if_exists" title="#define FILE_RENAME_REPLACE_IF_EXISTS 0x00000001 // since REDSTONE">FILE_RENAME_REPLACE_IF_EXISTS</a></strong> (0x00000001)</td>
  <td>If a file with the given name already exists, it should be replaced with the given file. Equivalent to the ReplaceIfExists field used with the FileRenameInformation information class.</td>
</tr>
<tr>
  <td><strong><a href="file_rename_posix_semantics" title="#define FILE_RENAME_POSIX_SEMANTICS 0x00000002">FILE_RENAME_POSIX_SEMANTICS</a></strong> (0x00000002)</td>
  <td>If <a href="file_rename_replace_if_exists" title="#define FILE_RENAME_REPLACE_IF_EXISTS 0x00000001 // since REDSTONE">FILE_RENAME_REPLACE_IF_EXISTS</a> is also specified, allow replacing a file even if there are existing handles to it. Existing handles to the replaced file continue to be valid for operations such as read and write. Any subsequent opens of the target name will open the renamed file, not the replaced file.</td>
</tr>
<tr>
  <td><strong><a href="file_rename_suppress_pin_state_inheritance" title="#define FILE_RENAME_SUPPRESS_PIN_STATE_INHERITANCE 0x00000004 // since REDSTONE3">FILE_RENAME_SUPPRESS_PIN_STATE_INHERITANCE</a></strong> (0x00000004)</td>
  <td>When renaming a file to a new directory, suppress any inheritance rules related to the FILE_ATTRIBUTE_PINNED and FILE_ATTRIBUTE_UNPINNED attributes of the file.</td>
</tr>
<tr>
  <td><strong><a href="file_rename_suppress_storage_reserve_inheritance" title="#define FILE_RENAME_SUPPRESS_STORAGE_RESERVE_INHERITANCE 0x00000008 // since REDSTONE5">FILE_RENAME_SUPPRESS_STORAGE_RESERVE_INHERITANCE</a></strong> (0x00000008)</td>
  <td>When renaming a file to a new directory, suppress any inheritance rules related to the storage reserve ID property of the file.</td>
</tr>
<tr>
  <td><strong><a href="file_rename_no_increase_available_space" title="#define FILE_RENAME_NO_INCREASE_AVAILABLE_SPACE 0x00000010">FILE_RENAME_NO_INCREASE_AVAILABLE_SPACE</a></strong> (0x00000010)</td>
  <td>If <a href="file_rename_suppress_storage_reserve_inheritance" title="#define FILE_RENAME_SUPPRESS_STORAGE_RESERVE_INHERITANCE 0x00000008 // since REDSTONE5">FILE_RENAME_SUPPRESS_STORAGE_RESERVE_INHERITANCE</a> is not also specified, when renaming a file to a new directory, automatically resize affected storage reserve areas as needed to prevent the user visible free space on the volume from increasing. Requires manage volume access.</td>
</tr>
<tr>
  <td><strong><a href="file_rename_no_decrease_available_space" title="#define FILE_RENAME_NO_DECREASE_AVAILABLE_SPACE 0x00000020">FILE_RENAME_NO_DECREASE_AVAILABLE_SPACE</a></strong> (0x00000020)</td>
  <td>If <a href="file_rename_suppress_storage_reserve_inheritance" title="#define FILE_RENAME_SUPPRESS_STORAGE_RESERVE_INHERITANCE 0x00000008 // since REDSTONE5">FILE_RENAME_SUPPRESS_STORAGE_RESERVE_INHERITANCE</a> is not also specified, when renaming a file to a new directory, automatically resize affected storage reserve areas as needed to prevent the user visible free space on the volume from decreasing. Requires manage volume access.</td>
</tr>
<tr>
  <td><strong><a href="file_rename_preserve_available_space" title="#define FILE_RENAME_PRESERVE_AVAILABLE_SPACE 0x00000030">FILE_RENAME_PRESERVE_AVAILABLE_SPACE</a></strong> (0x00000030)</td>
  <td>Equivalent to specifying both <a href="file_rename_no_increase_available_space" title="#define FILE_RENAME_NO_INCREASE_AVAILABLE_SPACE 0x00000010">FILE_RENAME_NO_INCREASE_AVAILABLE_SPACE</a> and <a href="file_rename_no_decrease_available_space" title="#define FILE_RENAME_NO_DECREASE_AVAILABLE_SPACE 0x00000020">FILE_RENAME_NO_DECREASE_AVAILABLE_SPACE</a>.</td>
</tr>
<tr>
  <td><strong><a href="file_rename_ignore_readonly_attribute" title="#define FILE_RENAME_IGNORE_READONLY_ATTRIBUTE 0x00000040">FILE_RENAME_IGNORE_READONLY_ATTRIBUTE</a></strong> (0x00000040)</td>
  <td>If <a href="file_rename_replace_if_exists" title="#define FILE_RENAME_REPLACE_IF_EXISTS 0x00000001 // since REDSTONE">FILE_RENAME_REPLACE_IF_EXISTS</a> is also specified, allow replacing a file even if it is read-only. Requires WRITE_ATTRIBUTES access to the replaced file.</td>
</tr>
<tr>
  <td><strong><a href="file_rename_force_resize_target_sr" title="#define FILE_RENAME_FORCE_RESIZE_TARGET_SR 0x00000080 // since 19H1">FILE_RENAME_FORCE_RESIZE_TARGET_SR</a></strong> (0x00000080)</td>
  <td>If <a href="file_rename_suppress_storage_reserve_inheritance" title="#define FILE_RENAME_SUPPRESS_STORAGE_RESERVE_INHERITANCE 0x00000008 // since REDSTONE5">FILE_RENAME_SUPPRESS_STORAGE_RESERVE_INHERITANCE</a> is not also specified, when renaming a file to a new directory that is part of a different storage reserve area, always grow the target directory's storage reserve area by the full size of the file being renamed. Requires manage volume access.</td>
</tr>
<tr>
  <td><strong><a href="file_rename_force_resize_source_sr" title="#define FILE_RENAME_FORCE_RESIZE_SOURCE_SR 0x00000100">FILE_RENAME_FORCE_RESIZE_SOURCE_SR</a></strong> (0x00000100)</td>
  <td>If <a href="file_rename_suppress_storage_reserve_inheritance" title="#define FILE_RENAME_SUPPRESS_STORAGE_RESERVE_INHERITANCE 0x00000008 // since REDSTONE5">FILE_RENAME_SUPPRESS_STORAGE_RESERVE_INHERITANCE</a> is not also specified, when renaming a file to a new directory that is part of a different storage reserve area, always shrink the source directory's storage reserve area by the full size of the file being renamed. Requires manage volume access.</td>
</tr>
<tr>
  <td><strong><a href="file_rename_force_resize_sr" title="#define FILE_RENAME_FORCE_RESIZE_SR 0x00000180">FILE_RENAME_FORCE_RESIZE_SR</a></strong> (0x00000180)</td>
  <td>Equivalent to specifying both <a href="file_rename_force_resize_target_sr" title="#define FILE_RENAME_FORCE_RESIZE_TARGET_SR 0x00000080 // since 19H1">FILE_RENAME_FORCE_RESIZE_TARGET_SR</a> and <a href="file_rename_force_resize_source_sr" title="#define FILE_RENAME_FORCE_RESIZE_SOURCE_SR 0x00000100">FILE_RENAME_FORCE_RESIZE_SOURCE_SR</a>.</td>
</tr>
</tbody>
</table>

<h3 id="replaceifexists"><code>ReplaceIfExists</code></h3>

<p>Set to TRUE to specify that if a file with the given name already exists, it should be replaced with the given file. Set to FALSE if the rename operation should fail if a file with the given name already exists.</p>

<h3 id="rootdirectory"><code>RootDirectory</code></h3>

<p>A handle that <strong>IopOpenLinkOrRenameTarget</strong> uses to open the target directory.</p>

<p>If the file is not being moved to a different directory, or if the <strong>FileName</strong> member contains the full pathname, this member is NULL. Otherwise, it is a handle for the root directory under which the file will reside after it is renamed.</p>

<p>To perform two open operations that won't cause a sharing conflict, you can open <strong>RootDirectory</strong> by requesting traverse | read-attribute. <strong>IopOpenLinkOrRenameTarget</strong> can then perform a relative open by requesting FILE_WRITE_DATA | SYNCHRONIZE. These two opens would not cause sharing conflict.</p>

<h3 id="filenamelength"><code>FileNameLength</code></h3>

<p>Length, in bytes, of the new name for the file.</p>

<h3 id="filename"><code>FileName</code></h3>

<p>The first character of a wide-character string containing the new name for the file. This is followed in memory by the remainder of the string. If the <strong>RootDirectory</strong> member is NULL, and the file is being moved to a different directory, this member specifies the full pathname to be assigned to the file. Otherwise, it specifies only the file name or a relative pathname.</p>

<h2 id="syntax">Syntax</h2>

<p><!-- CODE_MARKER --></p>

<div class="codehilite">
<pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">_FILE_RENAME_INFORMATION</span><span class="w"> </span><span class="p">{</span>
<span class="cp">#if (_WIN32_WINNT &gt;= _WIN32_WINNT_WIN10_RS1)</span>
<span class="w">    </span><span class="k">union</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">BOOLEAN</span><span class="w"> </span><span class="n">ReplaceIfExists</span><span class="p">;</span><span class="w">  </span><span class="c1">// FileRenameInformation</span>
<span class="w">        </span><span class="n"><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></span><span class="w"> </span><span class="n">Flags</span><span class="p">;</span><span class="w">              </span><span class="c1">// FileRenameInformationEx</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">DUMMYUNIONNAME</span><span class="p">;</span>
<span class="cp">#else</span>
<span class="w">    </span><span class="n">BOOLEAN</span><span class="w"> </span><span class="n">ReplaceIfExists</span><span class="p">;</span>
<span class="cp">#endif</span>
<span class="w">    </span><span class="n">HANDLE</span><span class="w"> </span><span class="n">RootDirectory</span><span class="p">;</span>
<span class="w">    </span><span class="n"><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></span><span class="w"> </span><span class="n">FileNameLength</span><span class="p">;</span>
<span class="w">    </span><span class="n">WCHAR</span><span class="w"> </span><span class="n">FileName</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span><span class="w"> </span><span class="n">FILE_RENAME_INFORMATION</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">PFILE_RENAME_INFORMATION</span><span class="p">;</span>
</code></pre>
</div>

<h2 id="remarks">Remarks</h2>

<p>The <strong>FILE_RENAME_INFORMATION</strong> structure is used to rename a file. This operation can be performed in either of the following ways:</p>

<ul>
<li><p>Call <strong><a href="fltsetinformationfile" title="NTSTATUS FLTAPI FltSetInformationFile(&#10;  [in] PFLT_INSTANCE          Instance,&#10;  [in] PFILE_OBJECT           FileObject,&#10;  [in] PVOID                  FileInformation,&#10;  [in] ULONG                  Length,&#10;  [in] FILE_INFORMATION_CLASS FileInformationClass&#10;);">FltSetInformationFile</a></strong> or <strong><a href="ntsetinformationfile" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationFile(&#10;    _In_ HANDLE FileHandle,&#10;    _Out_ PIO_STATUS_BLOCK IoStatusBlock,&#10;    _In_reads_bytes_(Length) PVOID FileInformation,&#10;    _In_ ULONG Length,&#10;    _In_ FILE_INFORMATION_CLASS FileInformationClass&#10;    );">ZwSetInformationFile</a></strong>, passing <strong>FileRenameInformation</strong> as the value of <strong>FileInformationClass</strong> and passing a caller-allocated buffer formatted as a <strong>FILE_RENAME_INFORMATION</strong> structure for the value of <strong>FileInformation</strong>. The <strong>FileHandle</strong> parameter specifies the file to be renamed.</p></li>
<li><p>Create an <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a> with major function code <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ifs/irp-mj-set-information"><strong>IRP_MJ_SET_INFORMATION</strong></a>.</p></li>
</ul>

<p>File system minifilters must use <strong><a href="fltsetinformationfile" title="NTSTATUS FLTAPI FltSetInformationFile(&#10;  [in] PFLT_INSTANCE          Instance,&#10;  [in] PFILE_OBJECT           FileObject,&#10;  [in] PVOID                  FileInformation,&#10;  [in] ULONG                  Length,&#10;  [in] FILE_INFORMATION_CLASS FileInformationClass&#10;);">FltSetInformationFile</a></strong>, not <strong><a href="ntsetinformationfile" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationFile(&#10;    _In_ HANDLE FileHandle,&#10;    _Out_ PIO_STATUS_BLOCK IoStatusBlock,&#10;    _In_reads_bytes_(Length) PVOID FileInformation,&#10;    _In_ ULONG Length,&#10;    _In_ FILE_INFORMATION_CLASS FileInformationClass&#10;    );">ZwSetInformationFile</a></strong>, to rename a file.</p>

<p>Renaming a file requires DELETE access to the file so that the directory entry can be removed from the current parent directory, as well as the appropriate access to create the new entry in the new parent directory file.</p>

<p>The file name string in the <strong>FileName</strong> member must be specified in one of the following forms.</p>

<ul>
<li><p>A simple file name. (The <strong>RootDirectory</strong> member is NULL.) In this case, the file is simply renamed within the same directory. That is, the rename operation changes the name of the file but not its location.</p></li>
<li><p>A fully qualified file name. (The <strong>RootDirectory</strong> member is NULL.) In this case, the rename operation changes the name and location of the file.</p></li>
<li><p>A relative file name. In this case, the <strong>RootDirectory</strong> member contains a handle to the target directory for the rename operation. The file name itself must be a simple file name.</p></li>
</ul>

<p>General rules for rename operations:</p>

<ul>
<li><p>A file or directory can only be renamed within a volume. In other words, a rename operation cannot cause a file or directory to be moved to a different volume.</p></li>
<li><p>A volume's root directory cannot be renamed.</p></li>
<li><p>If <strong>ReplaceIfExists</strong> is set to FALSE, and the target exists, the rename operation will fail.</p></li>
<li><p>Even if <strong>ReplaceIfExists</strong> is set to TRUE, the rename operation will still fail if a file with the same name already exists and is a directory, a read-only file, or a currently executing file.</p></li>
<li><p>A volume's files and directories cannot be renamed if the volume is a read-only volume, such as a CDFS volume or a read-only NTFS volume.</p></li>
</ul>

<p>Special rules for renaming open files:</p>

<ul>
<li><p>A file cannot be renamed if it has any open handles, unless it is only open because of a batch opportunistic lock (oplock) and the batch oplock can be broken immediately.</p></li>
<li><p>A file cannot be renamed if a file with the same name exists and has open handles (except in the batch-oplock case described earlier).</p></li>
<li><p>A directory cannot be renamed if it or any of its subdirectories contains a file that has open handles (except in the batch-oplock case described earlier).</p></li>
</ul>

<p>Special rules for renaming NTFS data streams:</p>

<ul>
<li><p>The default directory stream cannot be renamed.</p></li>
<li><p>The new name for the stream must begin with a colon (:).</p></li>
<li><p>A data stream can only be renamed <em>within</em> the same file. In other words, a rename operation cannot cause a data stream to be moved to a different file.</p></li>
<li><p>A data stream on a directory cannot be renamed to the default data stream.</p></li>
<li><p>If <strong>ReplaceIfExists</strong> is set to TRUE, the rename operation will succeed only if a stream with the same name does not exist or is a zero-length data stream.</p></li>
<li><p>"Renaming" the default data stream is allowed, but this is not a true rename, because it leaves behind a zero-length default data stream.</p></li>
</ul>

<p>The size of the <strong>FileInformation</strong> buffer passed to <strong><a href="ntsetinformationfile" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationFile(&#10;    _In_ HANDLE FileHandle,&#10;    _Out_ PIO_STATUS_BLOCK IoStatusBlock,&#10;    _In_reads_bytes_(Length) PVOID FileInformation,&#10;    _In_ ULONG Length,&#10;    _In_ FILE_INFORMATION_CLASS FileInformationClass&#10;    );">ZwSetInformationFile</a></strong> or <strong><a href="fltsetinformationfile" title="NTSTATUS FLTAPI FltSetInformationFile(&#10;  [in] PFLT_INSTANCE          Instance,&#10;  [in] PFILE_OBJECT           FileObject,&#10;  [in] PVOID                  FileInformation,&#10;  [in] ULONG                  Length,&#10;  [in] FILE_INFORMATION_CLASS FileInformationClass&#10;);">FltSetInformationFile</a></strong> must be &gt;= <strong>sizeof</strong>(FILE_RENAME_INFORMATION) plus the size in bytes of the <strong>FileName</strong> string.</p>

<h2 id="see-also">See also</h2>

<p><strong><a href="fltsetinformationfile" title="NTSTATUS FLTAPI FltSetInformationFile(&#10;  [in] PFLT_INSTANCE          Instance,&#10;  [in] PFILE_OBJECT           FileObject,&#10;  [in] PVOID                  FileInformation,&#10;  [in] ULONG                  Length,&#10;  [in] FILE_INFORMATION_CLASS FileInformationClass&#10;);">FltSetInformationFile</a></strong></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ifs/irp-mj-set-information"><strong>IRP_MJ_SET_INFORMATION</strong></a></p>

<p><strong><a href="ntsetinformationfile" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationFile(&#10;    _In_ HANDLE FileHandle,&#10;    _Out_ PIO_STATUS_BLOCK IoStatusBlock,&#10;    _In_reads_bytes_(Length) PVOID FileInformation,&#10;    _In_ ULONG Length,&#10;    _In_ FILE_INFORMATION_CLASS FileInformationClass&#10;    );">ZwSetInformationFile</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/ns-ntifs-_file_rename_information">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntifs/ns-ntifs-_file_rename_information.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>NTinternals.net (undocumented.ntinternals.net)</h1>
</div>
<div class="ntdoc-description">
<p>This structure is <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/ns-ntifs-_file_rename_information">documented in Windows Driver Kit</a>.</p>

<hr />

<p>Structure <code>FILE_RENAME_INFORMATION</code> is used as input buffer for function <code><a href="ntsetinformationfile" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationFile(&#10;    _In_ HANDLE FileHandle,&#10;    _Out_ PIO_STATUS_BLOCK IoStatusBlock,&#10;    _In_reads_bytes_(Length) PVOID FileInformation,&#10;    _In_ ULONG Length,&#10;    _In_ FILE_INFORMATION_CLASS FileInformationClass&#10;    );">NtSetInformationFile</a></code>, called with <code>FileRenameInformation</code> information class. Using this structure caller can rename file, or move it into other directory.</p>

<h3>ReplaceIfExists</h3>

<p>If set, and file with the same name as destination exist, it will be replaced. If no, <code>STATUS_OBJECT_NAME_COLLISION</code> is returned.</p>

<h3>RootDirectory</h3>

<p>Optional <code>HANDLE</code> to parent directory for destination file.</p>

<h3>FileNameLength</h3>

<p>Length of <code>FileName</code> array, in bytes.</p>

<h3>FileName[1]</h3>

<p>UNICODE string specifying destination file name. If <code>RootDirectory</code> is <em>NULL</em>, it must contains full system path, or only destination file name for in-place rename operation.</p>

<h1>Documented by</h1>

<ul>
<li>Tomasz Nowak</li>
<li>Bo Branten</li>
</ul>

<h1>See also</h1>

<ul>
<li><code><a href="file_information_class" title="typedef enum _FILE_INFORMATION_CLASS&#10;{&#10;    FileDirectoryInformation = 1,                   // q: FILE_DIRECTORY_INFORMATION (requires FILE_LIST_DIRECTORY) (NtQueryDirectoryFile[Ex])&#10;    FileFullDirectoryInformation,                   // q: FILE_FULL_DIR_INFORMATION (requires FILE_LIST_DIRECTORY) (NtQueryDirectoryFile[Ex])&#10;    FileBothDirectoryInformation,                   // q: FILE_BOTH_DIR_INFORMATION (requires FILE_LIST_DIRECTORY) (NtQueryDirectoryFile[Ex])&#10;    FileBasicInformation,                           // qs: FILE_BASIC_INFORMATION (q: requires FILE_READ_ATTRIBUTES; s: requires FILE_WRITE_ATTRIBUTES)&#10;    FileStandardInformation,                        // q: FILE_STANDARD_INFORMATION, FILE_STANDARD_INFORMATION_EX&#10;    FileInternalInformation,                        // q: FILE_INTERNAL_INFORMATION&#10;    FileEaInformation,                              // q: FILE_EA_INFORMATION (requires FILE_READ_EA)&#10;    FileAccessInformation,                          // q: FILE_ACCESS_INFORMATION&#10;    FileNameInformation,                            // q: FILE_NAME_INFORMATION&#10;    FileRenameInformation,                          // s: FILE_RENAME_INFORMATION (requires DELETE) // 10&#10;    FileLinkInformation,                            // s: FILE_LINK_INFORMATION&#10;    FileNamesInformation,                           // q: FILE_NAMES_INFORMATION (requires FILE_LIST_DIRECTORY) (NtQueryDirectoryFile[Ex])&#10;    FileDispositionInformation,                     // s: FILE_DISPOSITION_INFORMATION (requires DELETE)&#10;    FilePositionInformation,                        // qs: FILE_POSITION_INFORMATION (q: requires FILE_READ_ATTRIBUTES; s: requires FILE_WRITE_ATTRIBUTES)&#10;    FileFullEaInformation,                          // q: FILE_FULL_EA_INFORMATION (requires FILE_READ_EA)&#10;    FileModeInformation,                            // qs: FILE_MODE_INFORMATION (q: requires FILE_READ_ATTRIBUTES; s: requires FILE_WRITE_ATTRIBUTES)&#10;    FileAlignmentInformation,                       // q: FILE_ALIGNMENT_INFORMATION&#10;    FileAllInformation,                             // q: FILE_ALL_INFORMATION&#10;...">FILE_INFORMATION_CLASS</a></code></li>
<li><code><a href="ntcreatefile" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateFile(&#10;    _Out_ PHANDLE FileHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ PCOBJECT_ATTRIBUTES ObjectAttributes,&#10;    _Out_ PIO_STATUS_BLOCK IoStatusBlock,&#10;    _In_opt_ PLARGE_INTEGER AllocationSize,&#10;    _In_ ULONG FileAttributes,&#10;    _In_ ULONG ShareAccess,&#10;    _In_ ULONG CreateDisposition,&#10;    _In_ ULONG CreateOptions,&#10;    _In_reads_bytes_opt_(EaLength) PVOID EaBuffer,&#10;    _In_ ULONG EaLength&#10;    );">NtCreateFile</a></code></li>
<li><code><a href="ntnotifychangedirectoryfile" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtNotifyChangeDirectoryFile(&#10;    _In_ HANDLE FileHandle,&#10;    _In_opt_ HANDLE Event,&#10;    _In_opt_ PIO_APC_ROUTINE ApcRoutine,&#10;    _In_opt_ PVOID ApcContext,&#10;    _Out_ PIO_STATUS_BLOCK IoStatusBlock,&#10;    _Out_writes_bytes_(Length) PVOID Buffer, // FILE_NOTIFY_INFORMATION&#10;    _In_ ULONG Length,&#10;    _In_ ULONG CompletionFilter,&#10;    _In_ BOOLEAN WatchTree&#10;    );">NtNotifyChangeDirectoryFile</a></code></li>
<li><code><a href="ntopenfile" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtOpenFile(&#10;    _Out_ PHANDLE FileHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ PCOBJECT_ATTRIBUTES ObjectAttributes,&#10;    _Out_ PIO_STATUS_BLOCK IoStatusBlock,&#10;    _In_ ULONG ShareAccess,&#10;    _In_ ULONG OpenOptions&#10;    );">NtOpenFile</a></code></li>
<li><code><a href="ntsetinformationfile" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationFile(&#10;    _In_ HANDLE FileHandle,&#10;    _Out_ PIO_STATUS_BLOCK IoStatusBlock,&#10;    _In_reads_bytes_(Length) PVOID FileInformation,&#10;    _In_ ULONG Length,&#10;    _In_ FILE_INFORMATION_CLASS FileInformationClass&#10;    );">NtSetInformationFile</a></code></li>
</ul>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/undocumented.ntinternals.net/file_rename_information.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
