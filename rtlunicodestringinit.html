<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="RtlUnicodeStringInit - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>RtlUnicodeStringInit - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github.ntdoc.min.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github-dark-dimmed.ntdoc.min.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            RtlUnicodeStringInit - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header language-cpp">#ifndef _NTSTRSAFE_H_INCLUDED_
#ifndef NTSTRSAFE_LIB_IMPL
#ifndef NTSTRSAFE_NO_UNICODE_STRING_FUNCTIONS

</span><span class="ntdoc-code-intro language-cpp">/*++

  <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>
  RtlUnicodeStringInit(
  _Out_ <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">PUNICODE_STRING</a> DestinationString,
  _In_opt_ <a href="ntstrsafe_pcwstr" title="typedef _Null_terminated_ const wchar_t* NTSTRSAFE_PCWSTR;">NTSTRSAFE_PCWSTR</a> pszSrc              OPTIONAL
  );

  Routine Description:

  The RtlUnicodeStringInit function initializes a counted unicode string from
  pszSrc.

  This function returns an <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> value.  It returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the
  counted unicode string was successfully initialized from pszSrc. In failure
  cases the unicode string buffer will be set to NULL, and the Length and
  MaximumLength members will be set to zero.

Arguments:

DestinationString - pointer to the counted unicode string to be initialized

pszSrc            - source string which must be null or null terminated

Notes:
DestinationString should not be NULL. See <a href="rtlunicodestringinitex" title="_At_(DestinationString-&gt;Buffer, _Post_equal_to_(pszSrc))&#10;_At_(DestinationString-&gt;Length, _Post_equal_to_(_String_length_(pszSrc) * sizeof(WCHAR)))&#10;_At_(DestinationString-&gt;MaximumLength, _Post_equal_to_((_String_length_(pszSrc)+1) * sizeof(WCHAR)))&#10;NTSTRSAFEDDI&#10;RtlUnicodeStringInitEx(&#10;        _Out_ PUNICODE_STRING DestinationString,&#10;        _In_opt_ NTSTRSAFE_PCWSTR pszSrc,&#10;        _In_ DWORD dwFlags)&#10;{&#10;    NTSTATUS status;&#10;&#10;    if (dwFlags &amp; (~STRSAFE_UNICODE_STRING_VALID_FLAGS))&#10;    {&#10;        status = STATUS_INVALID_PARAMETER;&#10;    }&#10;    else&#10;    {&#10;        status = RtlUnicodeStringInitWorker(DestinationString,&#10;                pszSrc,&#10;                NTSTRSAFE_UNICODE_STRING_MAX_CCH,&#10;...">RtlUnicodeStringInitEx</a> if you require
the handling of NULL values.

Return Value:

<a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> -

failure        -   the operation did not succeed

STATUS_INVALID_PARAMETER
-   this return value is an indication that the source string
was too large and DestinationString could not be initialized

It is strongly recommended to use the <a href="nt_success" title="#define NT_SUCCESS(Status) (((NTSTATUS)(Status)) &gt;= 0)">NT_SUCCESS</a>() macro to test the
return value of this function.

--*/

</span><span class="ntdoc-code-body language-cpp">_At_(DestinationString-&gt;Buffer, _Post_equal_to_(pszSrc))
_At_(DestinationString-&gt;Length, _Post_equal_to_(_String_length_(pszSrc) * sizeof(WCHAR)))
_At_(DestinationString-&gt;MaximumLength, _Post_equal_to_((_String_length_(pszSrc)+1) * sizeof(WCHAR)))
<a href="ntstrsafeddi" title="#define NTSTRSAFEDDI __inline NTSTATUS __clrcall">NTSTRSAFEDDI</a>
RtlUnicodeStringInit(
        _Out_ <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">PUNICODE_STRING</a> DestinationString,
        _In_opt_ <a href="ntstrsafe_pcwstr" title="typedef _Null_terminated_ const wchar_t* NTSTRSAFE_PCWSTR;">NTSTRSAFE_PCWSTR</a> pszSrc)
{
    return <a href="rtlunicodestringinitworker" title="_At_(DestinationString-&gt;Buffer, _Post_equal_to_(pszSrc))&#10;_At_(DestinationString-&gt;Length, _Post_equal_to_(_String_length_(pszSrc) * sizeof(WCHAR)))&#10;_At_(DestinationString-&gt;MaximumLength, _Post_equal_to_((_String_length_(pszSrc)+1) * sizeof(WCHAR)))&#10;NTSTRSAFEWORKERDDI&#10;RtlUnicodeStringInitWorker(&#10;        _Out_ PUNICODE_STRING DestinationString,&#10;        _In_opt_ NTSTRSAFE_PCWSTR pszSrc,&#10;        _In_ const size_t cchMax,&#10;        _In_ DWORD dwFlags);">RtlUnicodeStringInitWorker</a>(DestinationString,
            pszSrc,
            <a href="ntstrsafe_unicode_string_max_cch" title="#define NTSTRSAFE_UNICODE_STRING_MAX_CCH (0xffff / sizeof(wchar_t)) // max buffer size, in characters, for a UNICODE_STRING">NTSTRSAFE_UNICODE_STRING_MAX_CCH</a>,
            0);
}
</span><span class="ntdoc-code-footer language-cpp">
#endif
#endif
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/d9393a49b3707fc786047a2ca5ae4afefd760b30/phnt/include/ntstrsafe.h#L6762">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header language-cpp">// ntstrsafe.h

</span><span class="ntdoc-code-intro language-cpp"></span><span class="ntdoc-code-body language-cpp"><a href="ntstrsafeddi" title="#define NTSTRSAFEDDI __inline NTSTATUS __clrcall">NTSTRSAFEDDI</a> RtlUnicodeStringInit(
  [out]          <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">PUNICODE_STRING</a>  DestinationString,
  [in, optional] <a href="ntstrsafe_pcwstr" title="typedef _Null_terminated_ const wchar_t* NTSTRSAFE_PCWSTR;">NTSTRSAFE_PCWSTR</a> pszSrc
);</span><span class="ntdoc-code-footer language-cpp"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntstrsafe/nf-ntstrsafe-rtlunicodestringinit">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/rtlunicodestringinit.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ntstrsafe-rtlunicodestringinit)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>RtlUnicodeStringInit function</h1>
<h2>Description</h2>
<p>The <strong>RtlUnicodeStringInit</strong> function initializes a <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a> structure.</p>
<h2>Parameters</h2>
<h3><code>DestinationString</code> [out]</h3>
<p>A pointer to a <strong><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></strong> structure to be initialized. The <strong>pszSrc</strong> pointer is copied into the <strong>DestinationString</strong> parameter's <strong><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></strong> structure. The maximum number of characters in the string that <strong>pszSrc</strong> points to is <a href="ntstrsafe_unicode_string_max_cch" title="#define NTSTRSAFE_UNICODE_STRING_MAX_CCH (0xffff / sizeof(wchar_t)) // max buffer size, in characters, for a UNICODE_STRING">NTSTRSAFE_UNICODE_STRING_MAX_CCH</a>.</p>
<h3><code>pszSrc</code> [in, optional]</h3>
<p>Optional. A pointer to a null-terminated string constant. This string pointer will be copied to the <strong>Buffer</strong> member of the <strong><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></strong> structure pointed to by the <strong>DestinationString</strong> parameter. This string pointer can be <strong>NULL</strong>.</p>
<h2>Return value</h2>
<p><strong>RtlUnicodeStringInit</strong> returns one of the following <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> values.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a></strong></td>
<td>This <strong>success</strong> status means that source data was present, the string was copied without truncation, and the resultant destination buffer is null-terminated.</td>
</tr>
<tr>
<td><strong>STATUS_INVALID_PARAMETER</strong></td>
<td>This <strong>error</strong> status means that the function received an invalid input parameter. For more information, see the following list.</td>
</tr>
</tbody>
</table>
<p><strong>RtlUnicodeStringInit</strong> returns the STATUS_INVALID_PARAMETER value when one of the following occurs:</p>
<ul>
<li>The length of the string that the <strong>pszSrc</strong> parameter points to is greater than <a href="ntstrsafe_unicode_string_max_cch" title="#define NTSTRSAFE_UNICODE_STRING_MAX_CCH (0xffff / sizeof(wchar_t)) // max buffer size, in characters, for a UNICODE_STRING">NTSTRSAFE_UNICODE_STRING_MAX_CCH</a> characters.</li>
<li>The <strong>DestinationString</strong> pointer is <strong>NULL</strong>, but the <strong>pszSrc</strong> pointer is not <strong>NULL</strong>.</li>
</ul>
<p>For information about how to test <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> values, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/using-ntstatus-values">Using NTSTATUS Values</a>.</p>
<h2>Remarks</h2>
<p>The <strong>RtlUnicodeStringInit</strong> function does the following:</p>
<ul>
<li>Sets the <strong>Length</strong> member of the <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a> structure that is pointed to by the <strong>pszSrc</strong> parameter to the length, in bytes, of the string that the <strong>pszSrc</strong> parameter points to.</li>
<li>Sets the <strong>MaximumLength</strong> member of the <strong><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></strong> structure to the length, in bytes, of the string that the <strong>pszSrc</strong> parameter points to plus 2 bytes.</li>
<li>Sets the <strong>Buffer</strong> member of the <strong><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></strong> structure to the address that the <strong>pszSrc</strong> parameter specifies.</li>
</ul>
<p>The <strong>DestinationString</strong> pointer should not be <strong>NULL</strong>. If you need to specify <strong>NULL</strong> <strong>DestinationString</strong> pointer values, use the <a href="rtlunicodestringinitex" title="_At_(DestinationString-&gt;Buffer, _Post_equal_to_(pszSrc))&#10;_At_(DestinationString-&gt;Length, _Post_equal_to_(_String_length_(pszSrc) * sizeof(WCHAR)))&#10;_At_(DestinationString-&gt;MaximumLength, _Post_equal_to_((_String_length_(pszSrc)+1) * sizeof(WCHAR)))&#10;NTSTRSAFEDDI&#10;RtlUnicodeStringInitEx(&#10;        _Out_ PUNICODE_STRING DestinationString,&#10;        _In_opt_ NTSTRSAFE_PCWSTR pszSrc,&#10;        _In_ DWORD dwFlags)&#10;{&#10;    NTSTATUS status;&#10;&#10;    if (dwFlags &amp; (~STRSAFE_UNICODE_STRING_VALID_FLAGS))&#10;    {&#10;        status = STATUS_INVALID_PARAMETER;&#10;    }&#10;    else&#10;    {&#10;        status = RtlUnicodeStringInitWorker(DestinationString,&#10;                pszSrc,&#10;                NTSTRSAFE_UNICODE_STRING_MAX_CCH,&#10;...">RtlUnicodeStringInitEx</a> function.</p>
<p>For more information about the safe string functions, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/using-safe-string-functions">Using Safe String Functions</a>.</p>
<h2>See also</h2>
<p><a href="rtlunicodestringinitex" title="_At_(DestinationString-&gt;Buffer, _Post_equal_to_(pszSrc))&#10;_At_(DestinationString-&gt;Length, _Post_equal_to_(_String_length_(pszSrc) * sizeof(WCHAR)))&#10;_At_(DestinationString-&gt;MaximumLength, _Post_equal_to_((_String_length_(pszSrc)+1) * sizeof(WCHAR)))&#10;NTSTRSAFEDDI&#10;RtlUnicodeStringInitEx(&#10;        _Out_ PUNICODE_STRING DestinationString,&#10;        _In_opt_ NTSTRSAFE_PCWSTR pszSrc,&#10;        _In_ DWORD dwFlags)&#10;{&#10;    NTSTATUS status;&#10;&#10;    if (dwFlags &amp; (~STRSAFE_UNICODE_STRING_VALID_FLAGS))&#10;    {&#10;        status = STATUS_INVALID_PARAMETER;&#10;    }&#10;    else&#10;    {&#10;        status = RtlUnicodeStringInitWorker(DestinationString,&#10;                pszSrc,&#10;                NTSTRSAFE_UNICODE_STRING_MAX_CCH,&#10;...">RtlUnicodeStringInitEx</a></p>
<p><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntstrsafe/nf-ntstrsafe-rtlunicodestringinit">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntstrsafe/nf-ntstrsafe-rtlunicodestringinit.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script src="modules/highlight.js/highlight.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
