<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="CreateIpForwardEntry2 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>CreateIpForwardEntry2 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            CreateIpForwardEntry2 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// netioapi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NETIOAPI_API CreateIpForwardEntry2(
  _In_ const <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> *Row
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/createipforwardentry2">View the official Windows hardware development documentation</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/createipforwardentry2.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows hardware development documentation (createipforwardentry2)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="createipforwardentry2-function">CreateIpForwardEntry2 function</h1>

<p>The <strong>CreateIpForwardEntry2</strong> function creates a new IP route entry on a local computer.</p>

<h2 id="parameters">Parameters</h2>

<ul>
<li><em>Row</em> [in]
A pointer to a <strong><a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a></strong> structure entry for an IP route entry.</li>
</ul>

<h2 id="return-value">Return value</h2>

<p><strong>CreateIpForwardEntry2</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the function succeeds.</p>

<p>If the function fails, <strong>CreateIpForwardEntry2</strong> returns one of the following error codes:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>STATUS_INVALID_PARAMETER</strong></td>
  <td>An invalid parameter was passed to the function. This error is returned if one of the following situations occurs:<br><br>* A <strong>NULL</strong> pointer is passed in the <em>Row</em> parameter.<br>* The <strong>DestinationPrefix</strong> member of the <strong><a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a></strong> structure that the <em>Row</em> parameter points to was not specified.<br>* The <strong>NextHop</strong> member of the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure was not specified.<br>* Both <strong>InterfaceLuid</strong> and <strong>InterfaceIndex</strong> members of the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure were unspecified.<br>* The <strong>PreferredLifetime</strong> member of the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure is greater than the <strong>ValidLifetime</strong> member.<br>* The <strong>SitePrefixLength</strong> member of the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure is greater than the prefix length that is specified by the <strong>DestinationPrefix</strong> member.<br><br>This error is returned if a <strong>NULL</strong> pointer is passed in the <em>Row</em> parameter, the <strong>DestinationPrefix</strong> member of the <strong><a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a></strong> structure that is pointed to by the <em>Row</em> parameter was not specified, the <strong>NextHop</strong> member of the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure was not specified, or both <strong>InterfaceLuid</strong> and <strong>InterfaceIndex</strong> members of the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure were unspecified. This error is also returned if the <strong>PreferredLifetime</strong> member that is specified in the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure is greater than the <strong>ValidLifetime</strong> member, or if the <strong>SitePrefixLength</strong> in the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure is greater than the prefix length that is specified in the <strong>DestinationPrefix</strong> member.</td>
</tr>
<tr>
  <td><strong>STATUS_NOT_FOUND</strong></td>
  <td>The specified interface could not be found. This error is returned if the function cannot find the network interface that is specified by the <strong>InterfaceLuid</strong> or <strong>InterfaceIndex</strong> member of the <a href="mib_ipnet_row2" title="typedef struct _MIB_IPNET_ROW2 {&#10;  SOCKADDR_INET     Address;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  NET_LUID          InterfaceLuid;&#10;  UCHAR             PhysicalAddress[IF_MAX_PHYS_ADDRESS_LENGTH];&#10;  ULONG             PhysicalAddressLength;&#10;  NL_NEIGHBOR_STATE State;&#10;  union {&#10;    struct {&#10;      BOOLEAN IsRouter  :1;&#10;      BOOLEAN IsUnreachable  :1;&#10;    };&#10;    UCHAR  Flags;&#10;  };&#10;  union {&#10;    ULONG LastReachable;&#10;    ULONG LastUnreachable;&#10;  } ReachabilityTime;&#10;} MIB_IPNET_ROW2, *PMIB_IPNET_ROW2;">MIB_IPNET_ROW2</a> structure that the <em>Row</em> parameter points to.</td>
</tr>
<tr>
  <td><strong>STATUS_NOT_SUPPORTED</strong></td>
  <td>The request is not supported. This error is returned if the interface that is specified does not support routes. This error is returned if no IPv4 stack is located on the local computer and AF_INET was specified in the address family in the <strong>DestinationPrefix</strong> member of the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure that the <em>Row</em> parameter points to, or if no IPv6 stack is located on the local computer and AF_INET6 was specified for the address family in the <strong>DestinationPrefix</strong> member.</td>
</tr>
<tr>
  <td><strong>ERROR_OBJECT_ALREADY_EXISTS</strong></td>
  <td>The object already exists. This error is returned if the <strong>DestinationPrefix</strong> member of the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure that the <em>Row</em> parameter points to is a duplicate of an existing IP route entry on the interface that is specified by the <strong>InterfaceLuid</strong> or <strong>InterfaceIndex</strong> member of the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure.</td>
</tr>
<tr>
  <td><strong>Other</strong></td>
  <td>Use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winbase/nf-winbase-formatmessage">FormatMessage</a> function to obtain the message string for the returned error.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>The <strong>CreateIpForwardEntry2</strong> function is used to add a new neighbor IP address entry on a local computer. Use the <strong><a href="initializeipforwardentry" title="VOID NETIOAPI_API_ InitializeIpForwardEntry(&#10;  _Out_ PMIB_IPFORWARD_ROW2 Row&#10;);">InitializeIpForwardEntry</a></strong> function to initialize the members of a <strong><a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a></strong> structure entry with default values. A driver can then change the members in the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> entry that it wants to modify and then call <strong>CreateIpForwardEntry2</strong>.</p>

<p>Your driver must initialize the following members of the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure that the <em>Row</em> parameter points to:</p>

<ul>
<li><p>Set <strong>DestinationPrefix</strong> to a valid IPv4 or IPv6 address prefix.</p></li>
<li><p>Set <strong>NextHop</strong> to a valid IPv4 or IPv6 address and family.</p></li>
<li><p>Set <strong>InterfaceLuid</strong> or <strong>InterfaceIndex</strong> to the <a href="luid" title="typedef struct _LUID {&#10;  DWORD LowPart;&#10;  LONG  HighPart;&#10;} LUID, *PLUID;">LUID</a> or index value of the interface.</p></li>
</ul>

<p>The <strong>InterfaceLuid</strong> and <strong>InterfaceIndex</strong> members are used in the order that is listed earlier. So if the <strong>InterfaceLuid</strong> is specified, this member is used to determine the interface to add the IP route entry on. If no value was set for the <strong>InterfaceLuid</strong> member (the value of this member was set to zero), the <strong>InterfaceIndex</strong> member is next used to determine the interface.</p>

<p>The route metric offset that is specified in the <strong>Metric</strong> member of the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure that the <em>Row</em> parameter points to represents only part of the complete route metric. The complete metric is a combination of this route metric offset added to the interface metric that is specified in the <strong>Metric</strong> member of the <strong><a href="mib_ipinterface_row" title="typedef struct _MIB_IPINTERFACE_ROW {&#10;  ADDRESS_FAMILY                 Family;&#10;  NET_LUID                       InterfaceLuid;&#10;  NET_IFINDEX                    InterfaceIndex;&#10;  ULONG                          MaxReassemblySize;&#10;  ULONG64                        InterfaceIdentifier;&#10;  ULONG                          MinRouterAdvertisementInterval;&#10;  ULONG                          MaxRouterAdvertisementInterval;&#10;  BOOLEAN                        AdvertisingEnabled;&#10;  BOOLEAN                        ForwardingEnabled;&#10;  BOOLEAN                        WeakHostSend;&#10;  BOOLEAN                        WeakHostReceive;&#10;  BOOLEAN                        UseAutomaticMetric;&#10;  BOOLEAN                        UseNeighborUnreachabilityDetection;&#10;  BOOLEAN                        ManagedAddressConfigurationSupported;&#10;  BOOLEAN                        OtherStatefulConfigurationSupported;&#10;  BOOLEAN                        AdvertiseDefaultRoute;&#10;  NL_ROUTER_DISCOVERY_BEHAVIOR   RouterDiscoveryBehavior;&#10;  ULONG                          DadTransmits;&#10;  ULONG                          BaseReachableTime;&#10;...">MIB_IPINTERFACE_ROW</a></strong> structure of the associated interface. A driver can retrieve the interface metric by calling the <strong><a href="getipinterfaceentry" title="NETIOAPI_API GetIpInterfaceEntry(&#10;  _Inout_ PMIB_IPINTERFACE_ROW Row&#10;);">GetIpInterfaceEntry</a></strong> function.</p>

<p>The <strong>Age</strong> and <strong>Origin</strong> members of the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure that the <em>Row</em> parameter points to are ignored when the <strong>CreateIpForwardEntry2</strong> function is called. These members are set by the network stack and cannot be set by using the <strong>CreateIpForwardEntry2</strong> function.</p>

<p>The <strong>CreateIpForwardEntry2</strong> function fails if the <strong>DestinationPrefix</strong> and <strong>NextHop</strong> members of the <a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a> structure that the <em>Row</em> parameter points to are a duplicate of an existing IP route entry on the interface that is specified in the <strong>InterfaceLuid</strong> or <strong>InterfaceIndex</strong> members.</p>

<h2 id="requirements">Requirements</h2>

<table>
<thead>
<tr>
  <th></th>
  <th></th>
</tr>
</thead>
<tbody>
<tr>
  <td>Target platform</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/develop/target-platforms">Universal</a></td>
</tr>
<tr>
  <td>Version</td>
  <td>Available in Windows Vista and later versions of the Windows operating systems.</td>
</tr>
<tr>
  <td>Header</td>
  <td>Netioapi.h (include Netioapi.h)</td>
</tr>
<tr>
  <td>Library</td>
  <td>Netio.lib</td>
</tr>
<tr>
  <td>IRQL</td>
  <td>&lt; DISPATCH_LEVEL</td>
</tr>
</tbody>
</table>

<h2 id="see-also">See also</h2>

<p><strong><a href="deleteipforwardentry2" title="NETIOAPI_API DeleteIpForwardEntry2(&#10;  _In_ const MIB_IPFORWARD_ROW2 *Row&#10;);">DeleteIpForwardEntry2</a></strong></p>

<p><strong><a href="getbestroute2" title="NETIOAPI_API GetBestRoute2(&#10;  _In_opt_       NET_LUID            *InterfaceLuid,&#10;  _In_           NET_IFINDEX         InterfaceIndex,&#10;  _In_opt_ const SOCKADDR_INET       *SourceAddress,&#10;  _In_     const SOCKADDR_INET       *DestinationAddress,&#10;  _In_           ULONG               AddressSortOptions,&#10;  _Out_          PMIB_IPFORWARD_ROW2 BestRoute,&#10;  _Out_          SOCKADDR_INET       *BestSourceAddress&#10;);">GetBestRoute2</a></strong></p>

<p><strong><a href="getipforwardentry2" title="NETIOAPI_API GetIpForwardEntry2(&#10;  _Inout_ PMIB_IPFORWARD_ROW2 Row&#10;);">GetIpForwardEntry2</a></strong></p>

<p><strong><a href="getipforwardtable2" title="NETIOAPI_API GetIpForwardTable2(&#10;  _In_  ADDRESS_FAMILY        Family,&#10;  _Out_ PMIB_IPFORWARD_TABLE2 *Table&#10;);">GetIpForwardTable2</a></strong></p>

<p><strong><a href="getipinterfaceentry" title="NETIOAPI_API GetIpInterfaceEntry(&#10;  _Inout_ PMIB_IPINTERFACE_ROW Row&#10;);">GetIpInterfaceEntry</a></strong></p>

<p><strong><a href="initializeipforwardentry" title="VOID NETIOAPI_API_ InitializeIpForwardEntry(&#10;  _Out_ PMIB_IPFORWARD_ROW2 Row&#10;);">InitializeIpForwardEntry</a></strong></p>

<p><strong><a href="mib_ipforward_row2" title="typedef struct _MIB_IPFORWARD_ROW2 {&#10;  NET_LUID          InterfaceLuid;&#10;  NET_IFINDEX       InterfaceIndex;&#10;  IP_ADDRESS_PREFIX DestinationPrefix;&#10;  SOCKADDR_INET     NextHop;&#10;  UCHAR             SitePrefixLength;&#10;  ULONG             ValidLifetime;&#10;  ULONG             PreferredLifetime;&#10;  ULONG             Metric;&#10;  NL_ROUTE_PROTOCOL Protocol;&#10;  BOOLEAN           Loopback;&#10;  BOOLEAN           AutoconfigureAddress;&#10;  BOOLEAN           Publish;&#10;  BOOLEAN           Immortal;&#10;  ULONG             Age;&#10;  NL_ROUTE_ORIGIN   Origin;&#10;} MIB_IPFORWARD_ROW2, *PMIB_IPFORWARD_ROW2;">MIB_IPFORWARD_ROW2</a></strong></p>

<p><strong><a href="mib_ipforward_table2" title="typedef struct _MIB_IPFORWARD_TABLE2 {&#10;  ULONG              NumEntries;&#10;  MIB_IPFORWARD_ROW2 Table[ANY_SIZE];&#10;} MIB_IPFORWARD_TABLE2, *PMIB_IPFORWARD_TABLE2;">MIB_IPFORWARD_TABLE2</a></strong></p>

<p><strong><a href="mib_ipinterface_row" title="typedef struct _MIB_IPINTERFACE_ROW {&#10;  ADDRESS_FAMILY                 Family;&#10;  NET_LUID                       InterfaceLuid;&#10;  NET_IFINDEX                    InterfaceIndex;&#10;  ULONG                          MaxReassemblySize;&#10;  ULONG64                        InterfaceIdentifier;&#10;  ULONG                          MinRouterAdvertisementInterval;&#10;  ULONG                          MaxRouterAdvertisementInterval;&#10;  BOOLEAN                        AdvertisingEnabled;&#10;  BOOLEAN                        ForwardingEnabled;&#10;  BOOLEAN                        WeakHostSend;&#10;  BOOLEAN                        WeakHostReceive;&#10;  BOOLEAN                        UseAutomaticMetric;&#10;  BOOLEAN                        UseNeighborUnreachabilityDetection;&#10;  BOOLEAN                        ManagedAddressConfigurationSupported;&#10;  BOOLEAN                        OtherStatefulConfigurationSupported;&#10;  BOOLEAN                        AdvertiseDefaultRoute;&#10;  NL_ROUTER_DISCOVERY_BEHAVIOR   RouterDiscoveryBehavior;&#10;  ULONG                          DadTransmits;&#10;  ULONG                          BaseReachableTime;&#10;...">MIB_IPINTERFACE_ROW</a></strong></p>

<p><strong><a href="notifyroutechange2" title="NETIOAPI_API NotifyRouteChange2(&#10;  _In_    ADDRESS_FAMILY             Family,&#10;  _In_    PIPFORWARD_CHANGE_CALLBACK Callback,&#10;  _In_    PVOID                      CallerContext,&#10;  _In_    BOOLEAN                    InitialNotification,&#10;  _Inout_ HANDLE                     *NotificationHandle&#10;);">NotifyRouteChange2</a></strong></p>

<p><strong><a href="setipforwardentry2" title="NETIOAPI_API SetIpForwardEntry2(&#10;  _In_ const MIB_IPFORWARD_ROW2 *Route&#10;);">SetIpForwardEntry2</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/createipforwardentry2">View the official Windows hardware development documentation</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs/blob/staging/windows-driver-docs-pr/network/createipforwardentry2.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
