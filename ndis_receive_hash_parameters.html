<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NDIS_RECEIVE_HASH_PARAMETERS - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NDIS_RECEIVE_HASH_PARAMETERS - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NDIS_RECEIVE_HASH_PARAMETERS - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _NDIS_RECEIVE_HASH_PARAMETERS {
  <a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a> Header;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              Flags;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              HashInformation;
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>             HashSecretKeySize;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              HashSecretKeyOffset;
} NDIS_RECEIVE_HASH_PARAMETERS, *PNDIS_RECEIVE_HASH_PARAMETERS;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_receive_hash_parameters">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndis_receive_hash_parameters.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddndis-_ndis_receive_hash_parameters)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_ndis_receive_hash_parameters-structure">_NDIS_RECEIVE_HASH_PARAMETERS structure</h1>

<h2 id="description">Description</h2>

<p>The NDIS_RECEIVE_HASH_PARAMETERS structure specifies the receive hash parameters for a miniport
adapter that supports receive hash calculations.</p>

<h2 id="members">Members</h2>

<h3 id="header"><code>Header</code></h3>

<p>The
<a rel="noopener" target="_blank" href="ndis_object_header">NDIS_OBJECT_HEADER</a> structure for the
NDIS_RECEIVE_HASH_PARAMETERS structure. Set the
**Type** member of the structure that
**Header** specifies to NDIS_OBJECT_TYPE_DEFAULT, the
<strong>Revision</strong> member to NDIS_RECEIVE_HASH_PARAMETERS_REVISION_1, and the
**Size** member to NDIS_SIZEOF_RECEIVE_HASH_PARAMETERS_REVISION_1.</p>

<h3 id="flags"><code>Flags</code></h3>

<p>A <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a> value that indicates what the miniport driver should do with the hash parameters. The
miniport driver can use these flags to quickly determine which parameters have changed and update the
hash settings accordingly.</p>

<p>In a set request, the flags are defined as follows:</p>

<h4 id="ndis_receive_hash_flag_enable_hash">NDIS_RECEIVE_HASH_FLAG_ENABLE_HASH</h4>

<p>If this flag is set, enable calculating hash values on received frames and place the calculated
hash value in the <strong>NetBufferListHashValue</strong> OOB information in the <a href="net_buffer_list" title="typedef struct _NET_BUFFER_LIST {&#10;  union {&#10;    struct {&#10;      NET_BUFFER_LIST *Next;&#10;      NET_BUFFER      *FirstNetBuffer;&#10;    };&#10;    SLIST_HEADER           Link;&#10;    NET_BUFFER_LIST_HEADER NetBufferListHeader;&#10;  };&#10;  NET_BUFFER_LIST_CONTEXT *Context;&#10;  NET_BUFFER_LIST         *ParentNetBufferList;&#10;  NDIS_HANDLE             NdisPoolHandle;&#10;  PVOID                   NdisReserved[2];&#10;  PVOID                   ProtocolReserved[4];&#10;  PVOID                   MiniportReserved[2];&#10;  PVOID                   Scratch;&#10;  NDIS_HANDLE             SourceHandle;&#10;  ULONG                   NblFlags;&#10;  LONG                    ChildRefCount;&#10;  ULONG                   Flags;&#10;...">NET_BUFFER_LIST</a> structure.</p>

<p>If this flag is clear, disable the calculation of hash values on received frames.</p>

<p>If receive hash calculation is enabled, the miniport driver should set this flag; otherwise, this
flag should be clear.</p>

<h4 id="ndis_receive_hash_flag_hash_info_unchanged">NDIS_RECEIVE_HASH_FLAG_HASH_INFO_UNCHANGED</h4>

<p>The HashInformation member has not changed. The hash information includes the hash types and hash
function.</p>

<p>If this flag is set, the HashInformation member of the NDIS_RECEIVE_HASH_PARAMETERS structure
should be ignored.</p>

<p>If this flag is cleared, the HashInformation member contains a new value that the miniport driver
must use to calculate hash values on received frames.</p>

<h4 id="ndis_receive_hash_flag_hash_key_unchanged">NDIS_RECEIVE_HASH_FLAG_HASH_KEY_UNCHANGED</h4>

<p>The secret key and associated data members have not changed.</p>

<p>If this flag is set, the secret key and associated data members should be ignored.</p>

<p>If this flag is cleared, the secret key or associated data members have changed and miniport
driver must use the new information.</p>

<p>In a query request, the flags are defined as follows:</p>

<h3 id="hashinformation"><code>HashInformation</code></h3>

<p>In a set request, the hash type and hash function that the NIC should use to compute the hash
values for the incoming packets.</p>

<p>In a query request, the hash type and hash function that the NIC is using.</p>

<p>Overlying drivers and NDIS can use the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-rss-hash-info-from-type-and-func">NDIS_RSS_HASH_INFO_FROM_TYPE_AND_FUNC</a> macro to combine the hash type and hash function into hash
information and set the
<strong>HashInformation</strong> member.</p>

<p>Miniport drivers can use the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-rss-hash-info-from-type-and-func">NDIS_RSS_HASH_TYPE_FROM_HASH_INFO</a> macro to get the hash type from
<strong>HashInformation</strong> and the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-rss-hash-info-from-type-and-func">NDIS_RSS_HASH_FUNC_FROM_HASH_INFO</a> macro to get the hash function.</p>

<h3 id="hashsecretkeysize"><code>HashSecretKeySize</code></h3>

<p>The size of the secret key array of the hash function, in bytes. The size of the array is 40 bytes for NdisHashFunctionToeplitz.</p>

<h3 id="hashsecretkeyoffset"><code>HashSecretKeyOffset</code></h3>

<p>The offset of the secret key array of the hash function from the beginning of the
NDIS_RECEIVE_HASH_PARAMETERS structure. Use this offset to get the 320-bit (40 bytes) secret key.</p>

<p>In a set request, the secret key can contain any data that the overlying driver chooses.</p>

<p>In a query request, the secret key contains the data that the NIC is using.</p>

<h2 id="remarks">Remarks</h2>

<p>The NDIS_RECEIVE_HASH_PARAMETERS structure defines the hash parameters for the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-gen-receive-hash">OID_GEN_RECEIVE_HASH</a> OID.</p>

<p><strong>Note</strong> Protocol drivers must disable receive hash calculations before they enable RSS. If
RSS is enabled, a protocol driver disables RSS before it enables receive hash calculations. A miniport
driver should fail a request to enable receive hash calculations or RSS if the other service is currently
enabled.</p>

<p><strong>Note</strong> The secret key is appended after the NDIS_RECEIVE_HASH_PARAMETERS structure
members.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="ndis_object_header">NDIS_OBJECT_HEADER</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-rss-hash-info-from-type-and-func">NDIS_RSS_HASH_FUNC_FROM_HASH_INFO</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-rss-hash-info-from-type-and-func">NDIS_RSS_HASH_INFO_FROM_TYPE_AND_FUNC</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-rss-hash-info-from-type-and-func">NDIS_RSS_HASH_TYPE_FROM_HASH_INFO</a></p>

<p><a rel="noopener" target="_blank" href="net_buffer_list">NET_BUFFER_LIST</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-gen-receive-hash">OID_GEN_RECEIVE_HASH</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_receive_hash_parameters">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddndis/ns-ntddndis-_ndis_receive_hash_parameters.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
