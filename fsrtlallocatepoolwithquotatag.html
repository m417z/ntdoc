<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FsRtlAllocatePoolWithQuotaTag - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FsRtlAllocatePoolWithQuotaTag - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FsRtlAllocatePoolWithQuotaTag - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntifs.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">void FsRtlAllocatePoolWithQuotaTag(
  [in] PoolType,
  [in] NumberOfBytes,
  [in] Tag
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-fsrtlallocatepoolwithquotatag">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/fsrtlallocatepoolwithquotatag.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ntifs-fsrtlallocatepoolwithquotatag)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="fsrtlallocatepoolwithquotatag-macro">FsRtlAllocatePoolWithQuotaTag macro</h1>

<h2 id="description">Description</h2>

<p>The <strong>FsRtlAllocatePoolWithQuotaTag</strong> routine allocates pool memory, charging quota against the current process.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="pooltype-in"><code>PoolType</code> [in]</h3>

<p>Type of pool to allocate. One of the following:</p>

<ul>
<li><strong>NonPagedPool</strong></li>
<li><strong>PagedPool</strong></li>
<li><strong>NonPagedPoolCacheAligned</strong></li>
<li><strong>PagedPoolCacheAligned</strong></li>
</ul>

<p>The <strong>NonPagedPoolMustSucceed</strong> and <strong>NonPagedPoolCacheAlignedMustS</strong> pool types are obsolete and should no longer be used.</p>

<h3 id="numberofbytes-in"><code>NumberOfBytes</code> [in]</h3>

<p>Number of bytes to allocate.</p>

<h3 id="tag-in"><code>Tag</code> [in]</h3>

<p>Specifies the pool tag for the allocated memory. Drivers normally specify the pool tag as a string of one to four 7-bit ASCII characters, delimited by single quotation marks (for example, 'abcd'). This parameter is required and cannot be zero.</p>

<h2 id="remarks">Remarks</h2>

<p>If a pool allocation failure occurs, <strong>FsRtlAllocatePoolWithQuotaTag</strong> raises a STATUS_INSUFFICIENT_RESOURCES exception. To gain control if this pool allocation failure occurs, the driver should wrap the call to <strong>FsRtlAllocatePoolWithQuotaTag</strong> in a <em>try-except</em> or <em>try-finally</em> statement.</p>

<p>The system associates the pool tag specified by the <strong>Tag</strong> parameter with the allocated buffer. Programming tools, such as the Windows Debugger (WinDbg), can display the pool tag associated with each allocated buffer. The value of the pool tag is normally displayed in reversed order. For example, if a caller passes 'Fred' as the value of the <strong>Tag</strong> parameter, this value would appear as 'derF' if pool is dumped or when tracking pool usage in the debugger.</p>

<p>For more information about memory management, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/managing-memory-for-drivers">Memory Management</a>.</p>

<p>Memory that <strong>FsRtlAllocatePoolWithQuotaTag</strong> allocates is uninitialized. A kernel-mode driver must first zero this memory if it is going to make it visible to user-mode software (to avoid leaking potentially privileged contents).</p>

<p>Callers of <strong>FsRtlAllocatePoolWithQuotaTag</strong> must be running at IRQL &lt;= DISPATCH_LEVEL. A caller at DISPATCH_LEVEL must specify a <strong>NonPaged</strong><strong>XxxPoolType</strong>. Otherwise, the caller must be running at IRQL &lt; DISPATCH_LEVEL.</p>

<h2 id="see-also">See also</h2>

<p><strong><a href="exallocatepoolwithquotatag" title="PVOID ExAllocatePoolWithQuotaTag(&#10;  [in] __drv_strictTypeMatch(__drv_typeExpr)POOL_TYPE PoolType,&#10;  [in] SIZE_T                                         NumberOfBytes,&#10;  [in] ULONG                                          Tag&#10;);">ExAllocatePoolWithQuotaTag</a></strong></p>

<p><strong><a href="exfreepool" title="void ExFreePool(&#10;  a&#10;);">ExFreePool</a></strong></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ifs/fsrtlallocatepoolwithquota"><strong>FsRtlAllocatePoolWithQuota</strong></a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-fsrtlallocatepoolwithquotatag">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntifs/nf-ntifs-fsrtlallocatepoolwithquotatag.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
