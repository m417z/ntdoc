<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FsRtlMupGetProviderInfoFromFileObject - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FsRtlMupGetProviderInfoFromFileObject - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FsRtlMupGetProviderInfoFromFileObject - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntifs.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> FsRtlMupGetProviderInfoFromFileObject(
  [in]      <a href="file_object" title="typedef struct _FILE_OBJECT {&#10;  CSHORT                                Type;&#10;  CSHORT                                Size;&#10;  PDEVICE_OBJECT                        DeviceObject;&#10;  PVPB                                  Vpb;&#10;  PVOID                                 FsContext;&#10;  PVOID                                 FsContext2;&#10;  PSECTION_OBJECT_POINTERS              SectionObjectPointer;&#10;  PVOID                                 PrivateCacheMap;&#10;  NTSTATUS                              FinalStatus;&#10;  struct _FILE_OBJECT                   *RelatedFileObject;&#10;  BOOLEAN                               LockOperation;&#10;  BOOLEAN                               DeletePending;&#10;  BOOLEAN                               ReadAccess;&#10;  BOOLEAN                               WriteAccess;&#10;  BOOLEAN                               DeleteAccess;&#10;  BOOLEAN                               SharedRead;&#10;  BOOLEAN                               SharedWrite;&#10;  BOOLEAN                               SharedDelete;&#10;  ULONG                                 Flags;&#10;...">PFILE_OBJECT</a> pFileObject,
  [in]      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>        Level,
  [out]     PVOID        pBuffer,
  [in, out] PULONG       pBufferSize
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-fsrtlmupgetproviderinfofromfileobject">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/fsrtlmupgetproviderinfofromfileobject.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ntifs-fsrtlmupgetproviderinfofromfileobject)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="fsrtlmupgetproviderinfofromfileobject-function">FsRtlMupGetProviderInfoFromFileObject function</h1>

<h2 id="description">Description</h2>

<p>The <strong>FsRtlMupGetProviderInfoFromFileObject</strong> routine gets information about a network redirector that is registered with the multiple UNC provider (MUP) from a file object for a file that is located on a remote file system.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="pfileobject-in"><code>pFileObject</code> [in]</h3>

<p>A pointer to a file object of a file that is located on a remote file system.</p>

<h3 id="level-in"><code>Level</code> [in]</h3>

<p>The level of information that is returned by the <strong>FsRtlMupGetProviderInfoFromFileObject</strong> routine. For more information about the possible values for this parameter, see the Remarks section.</p>

<h3 id="pbuffer-out"><code>pBuffer</code> [out]</h3>

<p>A pointer to a buffer that receives the information that is returned by the <strong>FsRtlMupGetProviderInfoFromFileObject</strong> routine. For more information about the format of the data that is returned in this buffer, see the Remarks section.</p>

<h3 id="pbuffersize-in-out"><code>pBufferSize</code> [in, out]</h3>

<p>A pointer to a <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>-typed variable that contains the size, in bytes, of the buffer that is pointed to by the <em>pBuffer</em> parameter. If the routine succeeds, this variable receives the size, in bytes, of data that is returned in the buffer.</p>

<h2 id="return-value">Return value</h2>

<p>The <strong>FsRtlMupGetProviderInfoFromFileObject</strong> routine returns one of the following <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> values.</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong><a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a></strong></td>
  <td>The information about the network redirector was successfully returned in the buffer that is pointed to by the <em>pBuffer</em> parameter.</td>
</tr>
<tr>
  <td><strong>STATUS_INVALID_PARAMETER</strong></td>
  <td>One of the parameters was <strong>NULL</strong> or contained an invalid value.</td>
</tr>
<tr>
  <td><strong>STATUS_OBJECT_NAME_NOT_FOUND</strong></td>
  <td>The file object that is pointed to by the <em>pFileObject</em> parameter does not correspond to a completely opened remote file system file object.</td>
</tr>
<tr>
  <td><strong>STATUS_BUFFER_TOO_SMALL</strong></td>
  <td>The size of the buffer that is pointed to by the <em>pBuffer</em> parameter is too small to return any data. In this situation, the variable that is pointed to by the <em>pBufferSize</em> parameter receives the required size, in bytes, of the buffer.</td>
</tr>
<tr>
  <td><strong>STATUS_BUFFER_OVERFLOW</strong></td>
  <td>The size of the buffer that is pointed to by the <em>pBuffer</em> parameter is too small to return all of the data. Only the data that would fit in the buffer was returned. In this situation, the variable that is pointed to by the <em>pBufferSize</em> parameter receives the required size, in bytes, of the buffer.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>A file system filter driver can call the <strong>FsRtlMupGetProviderInfoFromFileObject</strong> routine to get information about a network redirector from a file object for a file that is located on a remote file system. The amount of information that is returned by the <strong>FsRtlMupGetProviderInfoFromFileObject</strong> routine depends on the value of the <em>Level</em> parameter. If the <em>Level</em> parameter is set to 1, the <strong>FsRtlMupGetProviderInfoFromFileObject</strong> routine returns a FSRTL_MUP_PROVIDER_INFO_LEVEL_1 structure in the buffer that is pointed to by the *pBuffer* parameter. The FSRTL_MUP_PROVIDER_INFO_LEVEL_1 structure is defined as follows:</p>

<pre><code>typedef struct _FSRTL_MUP_PROVIDER_INFO_LEVEL_1 {
  ULONG32  ProviderId;
} FSRTL_MUP_PROVIDER_INFO_LEVEL_1, *PFSRTL_MUP_PROVIDER_INFO_LEVEL_1;
</code></pre>

<p>If the <em>Level</em> parameter is set to 2, the <strong>FsRtlMupGetProviderInfoFromFileObject</strong> routine returns a FSRTL_MUP_PROVIDER_INFO_LEVEL_2 structure in the buffer that is pointed to by the *pBuffer* parameter. The FSRTL_MUP_PROVIDER_INFO_LEVEL_2 structure is defined as follows:</p>

<pre><code>typedef struct _FSRTL_MUP_PROVIDER_INFO_LEVEL_2 {
  ULONG32  ProviderId;
  <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a>  ProviderName;
} FSRTL_MUP_PROVIDER_INFO_LEVEL_2, *PFSRTL_MUP_PROVIDER_INFO_LEVEL_2;
</code></pre>

<p>A file system filter driver can quickly compare the value of the provider identifier to the value of other provider identifiers without needing to do a string comparison.</p>

<p>The value of the UNC provider identifier for a particular network redirector remains the same if the network redirector is unloaded from the system and then reloaded back into the system.</p>

<p>To get the UNC provider identifier of a network redirector from the device name of the network redirector, a file system filter driver can call the <a rel="noopener" target="_blank" href="fsrtlmupgetprovideridfromname">FsRtlMupGetProviderIdFromName</a> routine.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="fsrtlmupgetprovideridfromname">FsRtlMupGetProviderIdFromName</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-fsrtlmupgetproviderinfofromfileobject">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntifs/nf-ntifs-fsrtlmupgetproviderinfofromfileobject.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
