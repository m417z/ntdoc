<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_CODEC_DATA_0095 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_CODEC_DATA_0095 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_CODEC_DATA_0095 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3d12umddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_CODEC_DATA_0095 {
  <a href="d3d12ddi_video_encoder_av1_picture_control_0095_flags" title="typedef enum D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAGS {&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_NONE = 0x0,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ENABLE_ERROR_RESILIENT_MODE = 0x1,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_DISABLE_CDF_UPDATE = 0x2,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ENABLE_PALETTE_ENCODING = 0x4,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ENABLE_SKIP_MODE = 0x8,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_FRAME_REFERENCE_MOTION_VECTORS = 0x10,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_FORCE_INTEGER_MOTION_VECTORS = 0x20,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ALLOW_INTRA_BLOCK_COPY = 0x40,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_USE_SUPER_RESOLUTION = 0x80,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_DISABLE_FRAME_END_UPDATE_CDF = 0x100,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ENABLE_FRAME_SEGMENTATION_AUTO = 0x200,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ENABLE_FRAME_SEGMENTATION_CUSTOM = 0x400,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ENABLE_WARPED_MOTION = 0x800,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_REDUCED_TX_SET = 0x1000,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_MOTION_MODE_SWITCHABLE = 0x2000,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ALLOW_HIGH_PRECISION_MV = 0x4000&#10;} ;">D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAGS</a>           Flags;
  <a href="d3d12ddi_video_encoder_av1_frame_type_0095" title="typedef enum D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095 {&#10;  D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095_KEY_FRAME = 0,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095_INTER_FRAME = 1,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095_INTRA_ONLY_FRAME = 2,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095_SWITCH_FRAME = 3&#10;} ;">D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095</a>                      FrameType;
  <a href="d3d12ddi_video_encoder_av1_comp_prediction_type_0095" title="typedef enum D3D12DDI_VIDEO_ENCODER_AV1_COMP_PREDICTION_TYPE_0095 {&#10;  D3D12DDI_VIDEO_ENCODER_AV1_COMP_PREDICTION_TYPE_0095_SINGLE_REFERENCE = 0,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_COMP_PREDICTION_TYPE_0095_COMPOUND_REFERENCE = 1&#10;} ;">D3D12DDI_VIDEO_ENCODER_AV1_COMP_PREDICTION_TYPE_0095</a>            CompoundPredictionType;
  <a href="d3d12ddi_video_encoder_av1_interpolation_filters_0095" title="typedef enum D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095 {&#10;  D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095_EIGHTTAP = 0,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095_EIGHTTAP_SMOOTH = 1,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095_EIGHTTAP_SHARP = 2,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095_BILINEAR = 3,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095_SWITCHABLE = 4&#10;} ;">D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095</a>           InterpolationFilter;
  <a href="d3d12ddi_video_encoder_av1_restoration_config_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_AV1_RESTORATION_CONFIG_0095 {&#10;  D3D12DDI_VIDEO_ENCODER_AV1_RESTORATION_TYPE_0095     FrameRestorationType[3];&#10;  D3D12DDI_VIDEO_ENCODER_AV1_RESTORATION_TILESIZE_0095 LoopRestorationPixelSize[3];&#10;} D3D12DDI_VIDEO_ENCODER_AV1_RESTORATION_CONFIG_0095;">D3D12DDI_VIDEO_ENCODER_AV1_RESTORATION_CONFIG_0095</a>              FrameRestorationConfig;
  <a href="d3d12ddi_video_encoder_av1_tx_mode_0095" title="typedef enum D3D12DDI_VIDEO_ENCODER_AV1_TX_MODE_0095 {&#10;  D3D12DDI_VIDEO_ENCODER_AV1_TX_MODE_0095_ONLY4x4 = 0,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_TX_MODE_0095_LARGEST = 1,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_TX_MODE_0095_SELECT = 2&#10;} ;">D3D12DDI_VIDEO_ENCODER_AV1_TX_MODE_0095</a>                         TxMode;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                                                            SuperResDenominator;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                                                            OrderHint;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                                                            PictureIndex;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                                                            TemporalLayerIndexPlus1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                                                            SpatialLayerIndexPlus1;
  <a href="d3d12ddi_video_encoder_av1_reference_picture_descriptor_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_AV1_REFERENCE_PICTURE_DESCRIPTOR_0095 {&#10;  UINT                                                                 ReconstructedPictureResourceIndex;&#10;  UINT                                                                 TemporalLayerIndexPlus1;&#10;  UINT                                                                 SpatialLayerIndexPlus1;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095                           FrameType;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_REFERENCE_PICTURE_WARPED_MOTION_INFO_0095 WarpedMotionInfo;&#10;  UINT                                                                 OrderHint;&#10;  UINT                                                                 PictureIndex;&#10;} D3D12DDI_VIDEO_ENCODER_AV1_REFERENCE_PICTURE_DESCRIPTOR_0095;">D3D12DDI_VIDEO_ENCODER_AV1_REFERENCE_PICTURE_DESCRIPTOR_0095</a>    ReferenceFramesReconPictureDescriptors[8];
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                                                            ReferenceIndices[7];
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                                                            PrimaryRefFrame;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                                                            RefreshFrameFlags;
  <a href="d3d12ddi_video_encoder_codec_av1_loop_filter_config_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_CODEC_AV1_LOOP_FILTER_CONFIG_0095 {&#10;  UINT64 LoopFilterLevel[2];&#10;  UINT64 LoopFilterLevelU;&#10;  UINT64 LoopFilterLevelV;&#10;  UINT64 LoopFilterSharpnessLevel;&#10;  UINT64 LoopFilterDeltaEnabled;&#10;  UINT64 UpdateRefDelta;&#10;  INT64  RefDeltas[8];&#10;  UINT64 UpdateModeDelta;&#10;  INT64  ModeDeltas[2];&#10;} D3D12DDI_VIDEO_ENCODER_CODEC_AV1_LOOP_FILTER_CONFIG_0095;">D3D12DDI_VIDEO_ENCODER_CODEC_AV1_LOOP_FILTER_CONFIG_0095</a>        LoopFilter;
  <a href="d3d12ddi_video_encoder_codec_av1_loop_filter_delta_config_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_CODEC_AV1_LOOP_FILTER_DELTA_CONFIG_0095 {&#10;  UINT64 DeltaLFPresent;&#10;  UINT64 DeltaLFMulti;&#10;  UINT64 DeltaLFRes;&#10;} D3D12DDI_VIDEO_ENCODER_CODEC_AV1_LOOP_FILTER_DELTA_CONFIG_0095;">D3D12DDI_VIDEO_ENCODER_CODEC_AV1_LOOP_FILTER_DELTA_CONFIG_0095</a>  LoopFilterDelta;
  <a href="d3d12ddi_video_encoder_codec_av1_quantization_config_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_CODEC_AV1_QUANTIZATION_CONFIG_0095 {&#10;  UINT64 BaseQIndex;&#10;  INT64  YDCDeltaQ;&#10;  INT64  UDCDeltaQ;&#10;  INT64  UACDeltaQ;&#10;  INT64  VDCDeltaQ;&#10;  INT64  VACDeltaQ;&#10;  UINT64 UsingQMatrix;&#10;  UINT64 QMY;&#10;  UINT64 QMU;&#10;  UINT64 QMV;&#10;} D3D12DDI_VIDEO_ENCODER_CODEC_AV1_QUANTIZATION_CONFIG_0095;">D3D12DDI_VIDEO_ENCODER_CODEC_AV1_QUANTIZATION_CONFIG_0095</a>       Quantization;
  <a href="d3d12ddi_video_encoder_codec_av1_quantization_delta_config_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_CODEC_AV1_QUANTIZATION_DELTA_CONFIG_0095 {&#10;  UINT64 DeltaQPresent;&#10;  UINT64 DeltaQRes;&#10;} D3D12DDI_VIDEO_ENCODER_CODEC_AV1_QUANTIZATION_DELTA_CONFIG_0095;">D3D12DDI_VIDEO_ENCODER_CODEC_AV1_QUANTIZATION_DELTA_CONFIG_0095</a> QuantizationDelta;
  <a href="d3d12ddi_video_encoder_av1_cdef_config_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_AV1_CDEF_CONFIG_0095 {&#10;  UINT64 CdefBits;&#10;  UINT64 CdefDampingMinus3;&#10;  UINT64 CdefYPriStrength[8];&#10;  UINT64 CdefUVPriStrength[8];&#10;  UINT64 CdefYSecStrength[8];&#10;  UINT64 CdefUVSecStrength[8];&#10;} D3D12DDI_VIDEO_ENCODER_AV1_CDEF_CONFIG_0095;">D3D12DDI_VIDEO_ENCODER_AV1_CDEF_CONFIG_0095</a>                     CDEF;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                                                            QPMapValuesCount;
  <a href="int16" title="typedef signed short INT16;">INT16</a>                                                           *pRateControlQPMap;
  <a href="d3d12ddi_video_encoder_av1_segmentation_config_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_CONFIG_0095 {&#10;  UINT64                                       UpdateMap;&#10;  UINT64                                       TemporalUpdate;&#10;  UINT64                                       UpdateData;&#10;  UINT64                                       NumSegments;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_SEGMENT_DATA_0095 SegmentsData[8];&#10;} D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_CONFIG_0095;">D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_CONFIG_0095</a>             CustomSegmentation;
  <a href="d3d12ddi_video_encoder_av1_segmentation_map_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_MAP_0095 {&#10;  UINT  SegmentsMapByteSize;&#10;  UINT8 *pSegmentsMap;&#10;} D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_MAP_0095;">D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_MAP_0095</a>                CustomSegmentsMap;
} D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_CODEC_DATA_0095;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d12umddi/ns-d3d12umddi-d3d12ddi_video_encoder_av1_picture_control_codec_data_0095">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/d3d12ddi_video_encoder_av1_picture_control_codec_data_0095.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-d3d12umddi-d3d12ddi_video_encoder_av1_picture_control_codec_data_0095)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2 id="description">Description</h2>

<p>The <strong>D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_CODEC_DATA_0095</strong> structure is a comprehensive configuration structure that contains all the necessary parameters for controlling the encoding of an AV1 picture (frame).</p>

<h2 id="members">Members</h2>

<h3 id="flags"><code>Flags</code></h3>

<p>A <strong><a href="d3d12ddi_video_encoder_av1_picture_control_0095_flags" title="typedef enum D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAGS {&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_NONE = 0x0,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ENABLE_ERROR_RESILIENT_MODE = 0x1,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_DISABLE_CDF_UPDATE = 0x2,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ENABLE_PALETTE_ENCODING = 0x4,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ENABLE_SKIP_MODE = 0x8,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_FRAME_REFERENCE_MOTION_VECTORS = 0x10,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_FORCE_INTEGER_MOTION_VECTORS = 0x20,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ALLOW_INTRA_BLOCK_COPY = 0x40,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_USE_SUPER_RESOLUTION = 0x80,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_DISABLE_FRAME_END_UPDATE_CDF = 0x100,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ENABLE_FRAME_SEGMENTATION_AUTO = 0x200,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ENABLE_FRAME_SEGMENTATION_CUSTOM = 0x400,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ENABLE_WARPED_MOTION = 0x800,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_REDUCED_TX_SET = 0x1000,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_MOTION_MODE_SWITCHABLE = 0x2000,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ALLOW_HIGH_PRECISION_MV = 0x4000&#10;} ;">D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAGS</a></strong> enumeration that specifies the flags for the frame to be encoded.</p>

<h3 id="frametype"><code>FrameType</code></h3>

<p>A <strong><a href="d3d12ddi_video_encoder_av1_frame_type_0095" title="typedef enum D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095 {&#10;  D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095_KEY_FRAME = 0,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095_INTER_FRAME = 1,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095_INTRA_ONLY_FRAME = 2,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095_SWITCH_FRAME = 3&#10;} ;">D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095</a></strong> enumeration that specifies the frame type being encoded.</p>

<h3 id="compoundpredictiontype"><code>CompoundPredictionType</code></h3>

<p>A <strong><a href="d3d12ddi_video_encoder_av1_comp_prediction_type_0095" title="typedef enum D3D12DDI_VIDEO_ENCODER_AV1_COMP_PREDICTION_TYPE_0095 {&#10;  D3D12DDI_VIDEO_ENCODER_AV1_COMP_PREDICTION_TYPE_0095_SINGLE_REFERENCE = 0,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_COMP_PREDICTION_TYPE_0095_COMPOUND_REFERENCE = 1&#10;} ;">D3D12DDI_VIDEO_ENCODER_AV1_COMP_PREDICTION_TYPE_0095</a></strong> enumeration that specifies the compound prediction type to be used. Related to AV1 syntax reference_select.</p>

<h3 id="interpolationfilter"><code>InterpolationFilter</code></h3>

<p>A <strong><a href="d3d12ddi_video_encoder_av1_interpolation_filters_0095" title="typedef enum D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095 {&#10;  D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095_EIGHTTAP = 0,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095_EIGHTTAP_SMOOTH = 1,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095_EIGHTTAP_SHARP = 2,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095_BILINEAR = 3,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095_SWITCHABLE = 4&#10;} ;">D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095</a></strong> enumeration that specifies the interpolation filter to be used for inter prediction on the current frame. Related to syntax interpolation_filter.</p>

<h3 id="framerestorationconfig"><code>FrameRestorationConfig</code></h3>

<p>A <strong><a href="d3d12ddi_video_encoder_av1_restoration_config_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_AV1_RESTORATION_CONFIG_0095 {&#10;  D3D12DDI_VIDEO_ENCODER_AV1_RESTORATION_TYPE_0095     FrameRestorationType[3];&#10;  D3D12DDI_VIDEO_ENCODER_AV1_RESTORATION_TILESIZE_0095 LoopRestorationPixelSize[3];&#10;} D3D12DDI_VIDEO_ENCODER_AV1_RESTORATION_CONFIG_0095;">D3D12DDI_VIDEO_ENCODER_AV1_RESTORATION_CONFIG_0095</a></strong> structure that specifies the frame restoration configuration to be used.</p>

<h3 id="txmode"><code>TxMode</code></h3>

<p>A <strong><a href="d3d12ddi_video_encoder_av1_tx_mode_0095" title="typedef enum D3D12DDI_VIDEO_ENCODER_AV1_TX_MODE_0095 {&#10;  D3D12DDI_VIDEO_ENCODER_AV1_TX_MODE_0095_ONLY4x4 = 0,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_TX_MODE_0095_LARGEST = 1,&#10;  D3D12DDI_VIDEO_ENCODER_AV1_TX_MODE_0095_SELECT = 2&#10;} ;">D3D12DDI_VIDEO_ENCODER_AV1_TX_MODE_0095</a></strong> enumeration that specifies the transform mode to be used.</p>

<h3 id="superresdenominator"><code>SuperResDenominator</code></h3>

<p>Indicates the configuration for super resolution. Has to be greater than or equal to <strong>D3D12_VIDEO_ENCODER_AV1_SUPERRES_DENOM_MIN</strong> (as defined by the AV1 codec standard) when super resolution is enabled.</p>

<h3 id="orderhint"><code>OrderHint</code></h3>

<p>Current frame order_hint AV1 syntax. <strong>OrderHint</strong> must be always passed even when not coding the order hint in the AV1 bitstream, and it must reflect the display order of the frame.</p>

<h3 id="pictureindex"><code>PictureIndex</code></h3>

<p>The unique picture index for this frame that will be used to uniquely identify it as a reference for future frames. This parameter is not related in any way to the AV1 standard syntax, but merely used for D3D API client implementation tracking instead.</p>

<p>The API Client should initialize this value at 0 for the first <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d12umddi/ne-d3d12umddi-d3d12ddi_video_encoder_av1_frame_type_0095"><strong>D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095_KEY_FRAME</strong></a> and increment it by one on each subsequent frame until the next <strong>D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095_KEY_FRAME</strong>, when it should be reset to zero and follow the same process.</p>

<p><strong>OrderHint</strong> can't be used for this purpose as it has a max range of <code>[0..2^(OrderHintBitsMinus1+1)]</code>, which can wrap around and not work as a unique identifier of the frames and their references.</p>

<h3 id="temporallayerindexplus1"><code>TemporalLayerIndexPlus1</code></h3>

<p>Picture temporal layer index plus one. A value of zero indicates temporal scalability not used. This value must be within the range [0..<a href="d3d12ddi_video_encoder_av1_codec_configuration_support_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_AV1_CODEC_CONFIGURATION_SUPPORT_0095 {&#10;  D3D12DDI_VIDEO_ENCODER_AV1_FEATURE_0095_FLAGS               SupportedFeatureFlags;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_FEATURE_0095_FLAGS               RequiredFeatureFlags;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095_FLAGS SupportedInterpolationFilters;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_RESTORATION_SUPPORT_0095_FLAGS   SupportedRestorationParams[3][3];&#10;  D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_MODE_0095_FLAGS     SupportedSegmentationModes;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_TX_MODE_0095_FLAGS               SupportedTxModes[4];&#10;  D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_BLOCK_SIZE_0095     SegmentationBlockSize;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_POST_ENCODE_VALUES_0095_FLAGS    PostEncodeValuesFlags;&#10;  UINT                                                        MaxTemporalLayers;&#10;  UINT                                                        MaxSpatialLayers;&#10;} D3D12DDI_VIDEO_ENCODER_AV1_CODEC_CONFIGURATION_SUPPORT_0095;">D3D12DDI_VIDEO_ENCODER_AV1_CODEC_CONFIGURATION_SUPPORT_0095</a>.MaxTemporalLayers].</p>

<h3 id="spatiallayerindexplus1"><code>SpatialLayerIndexPlus1</code></h3>

<p>Picture spatial layer index plus one. A value of zero indicates spatial scalability isn't used. This value must be within the range [0..<a href="d3d12ddi_video_encoder_av1_codec_configuration_support_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_AV1_CODEC_CONFIGURATION_SUPPORT_0095 {&#10;  D3D12DDI_VIDEO_ENCODER_AV1_FEATURE_0095_FLAGS               SupportedFeatureFlags;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_FEATURE_0095_FLAGS               RequiredFeatureFlags;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_INTERPOLATION_FILTERS_0095_FLAGS SupportedInterpolationFilters;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_RESTORATION_SUPPORT_0095_FLAGS   SupportedRestorationParams[3][3];&#10;  D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_MODE_0095_FLAGS     SupportedSegmentationModes;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_TX_MODE_0095_FLAGS               SupportedTxModes[4];&#10;  D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_BLOCK_SIZE_0095     SegmentationBlockSize;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_POST_ENCODE_VALUES_0095_FLAGS    PostEncodeValuesFlags;&#10;  UINT                                                        MaxTemporalLayers;&#10;  UINT                                                        MaxSpatialLayers;&#10;} D3D12DDI_VIDEO_ENCODER_AV1_CODEC_CONFIGURATION_SUPPORT_0095;">D3D12DDI_VIDEO_ENCODER_AV1_CODEC_CONFIGURATION_SUPPORT_0095</a>.MaxSpatialLayers].</p>

<h3 id="referenceframesreconpicturedescriptors8"><code>ReferenceFramesReconPictureDescriptors[8]</code></h3>

<p>An array of <strong><a href="d3d12ddi_video_encoder_av1_reference_picture_descriptor_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_AV1_REFERENCE_PICTURE_DESCRIPTOR_0095 {&#10;  UINT                                                                 ReconstructedPictureResourceIndex;&#10;  UINT                                                                 TemporalLayerIndexPlus1;&#10;  UINT                                                                 SpatialLayerIndexPlus1;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095                           FrameType;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_REFERENCE_PICTURE_WARPED_MOTION_INFO_0095 WarpedMotionInfo;&#10;  UINT                                                                 OrderHint;&#10;  UINT                                                                 PictureIndex;&#10;} D3D12DDI_VIDEO_ENCODER_AV1_REFERENCE_PICTURE_DESCRIPTOR_0095;">D3D12DDI_VIDEO_ENCODER_AV1_REFERENCE_PICTURE_DESCRIPTOR_0095</a></strong> structures that describes the current state snapshot of the complete (ie. including frames that are not used by current frame but used by future frames, etc) DPB buffer kept in <a href="d3d12ddi_video_encoder_picture_control_desc_0082_0" title="typedef struct D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_DESC_0082_0 {&#10;  UINT                                                     IntraRefreshFrameIndex;&#10;  D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_FLAGS_0080        Flags;&#10;  D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_CODEC_DATA_0082_0 PictureControlCodecData;&#10;  D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0080              ReferenceFrames;&#10;} D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_DESC_0082_0;">D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_DESC_0082_0</a>.ReferenceFrames. The reference indices (ie. last, altref, etc) map from past/future references into this descriptors array. The AV1 codec allows up to 8 references in the DPB.</p>

<p>This array of descriptors, in turn, maps a reference picture for this frame into a resource index in the reconstructed pictures array <a href="d3d12ddi_video_encoder_picture_control_desc_0082_0" title="typedef struct D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_DESC_0082_0 {&#10;  UINT                                                     IntraRefreshFrameIndex;&#10;  D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_FLAGS_0080        Flags;&#10;  D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_CODEC_DATA_0082_0 PictureControlCodecData;&#10;  D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0080              ReferenceFrames;&#10;} D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_DESC_0082_0;">D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_DESC_0082_0</a>.ReferenceFrames.</p>

<p>The size of this array always matches D3D12_VIDEO_ENCODER_PICTURE_CONTROL_DESC.ReferenceFrames.NumTextures for the associated <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d12umddi/nc-d3d12umddi-pfnd3d12ddi_video_encode_frame_0082_0">*EncodeFrame*</a> command.</p>

<h3 id="referenceindices7"><code>ReferenceIndices[7]</code></h3>

<p>Corresponds to the ref_frame_idx[i] AV1 syntax. For a reference type i, <strong>ReferenceIndices</strong>[i] indicates an index between [0..7] into <strong>ReferenceFramesReconPictureDescriptors</strong> where the current frame i-th reference type is stored in the DPB. In other words <strong>ReferenceFramesReconPictureDescriptors</strong>[<strong>ReferenceIndices</strong>[i]] contains the DPB descriptor for the i-th reference type.</p>

<p>The i-th entry of <strong>ReferenceIndices</strong>[] corresponds to each reference type as follows.</p>

<table>
<thead>
<tr>
  <th>Index i</th>
  <th>Reference type</th>
  <th>ReferenceFramesReconPictureDescriptors[ReferenceIndices[i]]</th>
</tr>
</thead>
<tbody>
<tr>
  <td>0</td>
  <td>Last</td>
  <td>DPB Descriptor for Last</td>
</tr>
<tr>
  <td>1</td>
  <td>Last2</td>
  <td>DPB Descriptor for Last2</td>
</tr>
<tr>
  <td>2</td>
  <td>Last3</td>
  <td>DPB Descriptor for Last3</td>
</tr>
<tr>
  <td>3</td>
  <td>Golden</td>
  <td>DPB Descriptor for Golden</td>
</tr>
<tr>
  <td>4</td>
  <td>Bwdref</td>
  <td>DPB Descriptor for Bwdref</td>
</tr>
<tr>
  <td>5</td>
  <td>Altref</td>
  <td>DPB Descriptor for Altref</td>
</tr>
<tr>
  <td>6</td>
  <td>Altref2</td>
  <td>DPB Descriptor for Altref2</td>
</tr>
</tbody>
</table>

<h3 id="primaryrefframe"><code>PrimaryRefFrame</code></h3>

<p>Corresponds to the AV1 element syntax primary_ref_frame in uncompressed_header(). Specifies which reference frame contains the CDF values and other state that must be loaded at the start of the frame. The allowed range is [0..7] and the values corresponds as follows:</p>

<table>
<thead>
<tr>
  <th>PrimaryRefFrame value</th>
  <th>AV1 syntax value (primary_ref_frame)</th>
  <th>Reference frame selected</th>
</tr>
</thead>
<tbody>
<tr>
  <td>0</td>
  <td>0</td>
  <td>Last</td>
</tr>
<tr>
  <td>1</td>
  <td>1</td>
  <td>Last2</td>
</tr>
<tr>
  <td>2</td>
  <td>2</td>
  <td>Last3</td>
</tr>
<tr>
  <td>3</td>
  <td>3</td>
  <td>Golden</td>
</tr>
<tr>
  <td>4</td>
  <td>4</td>
  <td>Bwdref</td>
</tr>
<tr>
  <td>5</td>
  <td>5</td>
  <td>Altref</td>
</tr>
<tr>
  <td>6</td>
  <td>6</td>
  <td>Altref2</td>
</tr>
<tr>
  <td>7</td>
  <td>7 (PRIMARY_REF_NONE)</td>
  <td>None</td>
</tr>
</tbody>
</table>

<h3 id="refreshframeflags"><code>RefreshFrameFlags</code></h3>

<p>Corresponds to the refresh_frame_flags AV1 syntax element.</p>

<h3 id="loopfilter"><code>LoopFilter</code></h3>

<p>A <strong><a href="d3d12ddi_video_encoder_codec_av1_loop_filter_config_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_CODEC_AV1_LOOP_FILTER_CONFIG_0095 {&#10;  UINT64 LoopFilterLevel[2];&#10;  UINT64 LoopFilterLevelU;&#10;  UINT64 LoopFilterLevelV;&#10;  UINT64 LoopFilterSharpnessLevel;&#10;  UINT64 LoopFilterDeltaEnabled;&#10;  UINT64 UpdateRefDelta;&#10;  INT64  RefDeltas[8];&#10;  UINT64 UpdateModeDelta;&#10;  INT64  ModeDeltas[2];&#10;} D3D12DDI_VIDEO_ENCODER_CODEC_AV1_LOOP_FILTER_CONFIG_0095;">D3D12DDI_VIDEO_ENCODER_CODEC_AV1_LOOP_FILTER_CONFIG_0095</a></strong> structure that specifies the loop filter parameters to be used.</p>

<h3 id="loopfilterdelta"><code>LoopFilterDelta</code></h3>

<p>A <strong><a href="d3d12ddi_video_encoder_codec_av1_loop_filter_delta_config_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_CODEC_AV1_LOOP_FILTER_DELTA_CONFIG_0095 {&#10;  UINT64 DeltaLFPresent;&#10;  UINT64 DeltaLFMulti;&#10;  UINT64 DeltaLFRes;&#10;} D3D12DDI_VIDEO_ENCODER_CODEC_AV1_LOOP_FILTER_DELTA_CONFIG_0095;">D3D12DDI_VIDEO_ENCODER_CODEC_AV1_LOOP_FILTER_DELTA_CONFIG_0095</a></strong> structure that specifies the loop filter delta parameters to be used.</p>

<h3 id="quantization"><code>Quantization</code></h3>

<p>A <strong><a href="d3d12ddi_video_encoder_codec_av1_quantization_config_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_CODEC_AV1_QUANTIZATION_CONFIG_0095 {&#10;  UINT64 BaseQIndex;&#10;  INT64  YDCDeltaQ;&#10;  INT64  UDCDeltaQ;&#10;  INT64  UACDeltaQ;&#10;  INT64  VDCDeltaQ;&#10;  INT64  VACDeltaQ;&#10;  UINT64 UsingQMatrix;&#10;  UINT64 QMY;&#10;  UINT64 QMU;&#10;  UINT64 QMV;&#10;} D3D12DDI_VIDEO_ENCODER_CODEC_AV1_QUANTIZATION_CONFIG_0095;">D3D12DDI_VIDEO_ENCODER_CODEC_AV1_QUANTIZATION_CONFIG_0095</a></strong> structure that specifies the quantization parameters to be used.</p>

<h3 id="quantizationdelta"><code>QuantizationDelta</code></h3>

<p>A <strong><a href="d3d12ddi_video_encoder_codec_av1_quantization_delta_config_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_CODEC_AV1_QUANTIZATION_DELTA_CONFIG_0095 {&#10;  UINT64 DeltaQPresent;&#10;  UINT64 DeltaQRes;&#10;} D3D12DDI_VIDEO_ENCODER_CODEC_AV1_QUANTIZATION_DELTA_CONFIG_0095;">D3D12DDI_VIDEO_ENCODER_CODEC_AV1_QUANTIZATION_DELTA_CONFIG_0095</a></strong> structure that specifies the quantization delta parameters to be used.</p>

<h3 id="cdef"><code>CDEF</code></h3>

<p>A <strong><a href="d3d12ddi_video_encoder_av1_cdef_config_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_AV1_CDEF_CONFIG_0095 {&#10;  UINT64 CdefBits;&#10;  UINT64 CdefDampingMinus3;&#10;  UINT64 CdefYPriStrength[8];&#10;  UINT64 CdefUVPriStrength[8];&#10;  UINT64 CdefYSecStrength[8];&#10;  UINT64 CdefUVSecStrength[8];&#10;} D3D12DDI_VIDEO_ENCODER_AV1_CDEF_CONFIG_0095;">D3D12DDI_VIDEO_ENCODER_AV1_CDEF_CONFIG_0095</a></strong> structure that specifies the constrained directional enhancement filtering (CDEF) parameters to be used.</p>

<h3 id="qpmapvaluescount"><code>QPMapValuesCount</code></h3>

<p>Contains the number of elements present in <strong>pRateControlQPMap</strong>. This value must match the number of coding blocks in the frame, rounding up the frame resolution to the closest aligned values.</p>

<h3 id="pratecontrolqpmap"><code>pRateControlQPMap</code></h3>

<p>Array containing, in row/column scan order, the QP map values to use on each squared region for this frame. The QP map dimensions can be calculated using the current resolution and <a href="d3d12ddi_video_encoder_resolution_support_limits_0080_2" title="typedef struct D3D12DDI_VIDEO_ENCODER_RESOLUTION_SUPPORT_LIMITS_0080_2 {&#10;  UINT MaxSubregionsNumber;&#10;  UINT MaxIntraRefreshFrameDuration;&#10;  UINT SubregionBlockPixelsSize;&#10;  UINT QPMapRegionPixelsSize;&#10;} D3D12DDI_VIDEO_ENCODER_RESOLUTION_SUPPORT_LIMITS_0080_2;">D3D12DDI_VIDEO_ENCODER_RESOLUTION_SUPPORT_LIMITS_0080_2</a>.QPMapRegionPixelsSize conveying the squared region sizes. The range for Delta QP values is [-255;255].</p>

<h3 id="customsegmentation"><code>CustomSegmentation</code></h3>

<p>A <strong><a href="d3d12ddi_video_encoder_av1_segmentation_config_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_CONFIG_0095 {&#10;  UINT64                                       UpdateMap;&#10;  UINT64                                       TemporalUpdate;&#10;  UINT64                                       UpdateData;&#10;  UINT64                                       NumSegments;&#10;  D3D12DDI_VIDEO_ENCODER_AV1_SEGMENT_DATA_0095 SegmentsData[8];&#10;} D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_CONFIG_0095;">D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_CONFIG_0095</a></strong> structure that specifies the custom segmentation parameters to be used. Only used when <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d12umddi/ne-d3d12umddi-d3d12ddi_video_encoder_av1_picture_control_0095_flags"><strong>D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ENABLE_FRAME_SEGMENTATION_CUSTOM</strong></a> is set for the current frame.</p>

<h3 id="customsegmentsmap"><code>CustomSegmentsMap</code></h3>

<p>Only used when <strong>D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_0095_FLAG_ENABLE_FRAME_SEGMENTATION_CUSTOM</strong> is set for the current frame. A <strong><a href="d3d12ddi_video_encoder_av1_segmentation_map_0095" title="typedef struct D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_MAP_0095 {&#10;  UINT  SegmentsMapByteSize;&#10;  UINT8 *pSegmentsMap;&#10;} D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_MAP_0095;">D3D12DDI_VIDEO_ENCODER_AV1_SEGMENTATION_MAP_0095</a></strong> structure that specifies the custom segmentation map to be used if <strong>CustomSegmentation.UpdateMap</strong> is set. Otherwise, the segment map is inherited from the reference frame.</p>

<h2 id="remarks">Remarks</h2>

<h3 id="dpb-management-expectations">DPB Management expectations</h3>

<p>The following is the contract the API client and the driver must conform to when using this API:</p>

<ol>
<li><p>When encoding <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d12umddi/ne-d3d12umddi-d3d12ddi_video_encoder_av1_frame_type_0095"><strong>D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095_KEY_FRAME</strong></a>:</p>

<ul>
<li><strong>PrimaryRefFrame</strong> must be 7 (PRIMARY_REF_NONE)</li>
<li><strong>RefreshFrameFlags</strong> must be 0xFF (conforming to the AV1 codec standard bitstream syntax)</li>
<li>For all array entries in <strong>ReferenceFramesReconPictureDescriptors</strong>, <strong>ReconstructedPictureResourceIndex</strong> must be set to D3D12_VIDEO_ENCODER_AV1_INVALID_DPB_RESOURCE_INDEX</li>
<li>The values in <strong>ReferenceIndices</strong>[7] are indistinct as any value [0..7] will point to an unused DPB slot in <strong>ReferenceFramesReconPictureDescriptors</strong> as per the point above.</li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d12umddi/ns-d3d12umddi-d3d12ddi_video_encode_reference_frames_0080"><strong>D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0082_0</strong></a> will be filled as:
<ul>
<li><strong>NumTexture2Ds</strong> = 0</li>
<li><strong>ppTexture2Ds</strong> = NULL</li>
<li><strong>pSubresources</strong> = NULL</li>
</ul></li>
</ul></li>
<li><p>When encoding a frame type with references (ie. SWITCH/INTER):</p>

<ul>
<li><strong>PrimaryRefFrame</strong> specifies which reference frame contains the CDF values and other state that must be loaded at the start of the frame.</li>
<li><strong>RefreshFrameFlags</strong> must be set accordingly to indicate on which <strong>ReferenceFramesReconPictureDescriptors</strong> DPB slots the current encoded frame reconstructed picture will be placed after encoding execution. This value must match exactly what the API client will code for refresh_frame_flags AV1 syntax element in the associated picture header for the current frame.</li>
<li><p>The array entries in <strong>ReferenceFramesReconPictureDescriptors</strong> for the current frame will follow exactly what <strong>RefreshFrameFlags</strong> indicated for the previous frame.</p>

<ul>
<li><p>For example: if <strong>RefreshFrameFlags</strong> indicates the current frame N will be placed in slots 2, 3 and 6, then in the next <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d12umddi/nc-d3d12umddi-pfnd3d12ddi_video_encode_frame_0082_0">*EncodeFrame*</a> call for frame N+1, the <strong>ReconstructedPictureResourceIndex</strong> parameter in the entries <strong>ReferenceFramesReconPictureDescriptors</strong>[1], <strong>ReferenceFramesReconPictureDescriptors</strong>[2], <strong>ReferenceFramesReconPictureDescriptors</strong>[5] parameter must point to frame N reconstructed picture in <strong><a href="d3d12ddi_video_encode_reference_frames_0080" title="typedef struct D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0080 {&#10;  UINT               NumTexture2Ds;&#10;  D3D12DDI_HRESOURCE *hDrvTexture2Ds;&#10;  UINT               *pSubresources;&#10;} D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0080;">D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0080</a></strong>.</p></li>
<li><p>Note this includes considering <strong>RefreshFrameFlags</strong>=0xFF for <strong>D3D12DDI_VIDEO_ENCODER_AV1_FRAME_TYPE_0095_KEY_FRAME</strong> as well, by marking all <strong>ReferenceFramesReconPictureDescriptors</strong> entries pointing to the KEY frame reconstructed picture.</p></li>
<li>If a (non key frame) picture won't be marked with <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d12umddi/ne-d3d12umddi-d3d12ddi_video_encoder_picture_control_flags_0080"><strong>D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_FLAG_0080_USED_AS_REFERENCE_PICTURE</strong></a>, their <strong>RefreshFrameFlags</strong> must be zero to indicate this.</li>
</ul></li>
<li>The values in <strong>ReferenceIndices</strong>[7] are within [0..7] and point to DPB slots in <strong>ReferenceFramesReconPictureDescriptors</strong>.</li>
<li>The values of <strong>ReferenceIndices</strong>[7] must match exactly what the API client codes in the picture header for ref_frame_idx.</li>
<li>As per AV1 syntax definition of ref_frame_idx there is no requirement that the array entry values must be unique.</li>
<li>If <strong>ReferenceFramesReconPictureDescriptors</strong>[<strong>ReferenceIndices</strong>[i]]. <strong>ReconstructedPictureResourceIndex</strong> == D3D12_VIDEO_ENCODER_AV1_INVALID_DPB_RESOURCE_INDEX
<ul>
<li>This indicates the reference picture i-th won't be used for the current frame and must be ignored.</li>
</ul></li>
<li>Otherwise (Valid <strong>ReferenceFramesReconPictureDescriptors</strong>[<strong>ReferenceIndices</strong>[i]]. <strong>ReconstructedPictureResourceIndex</strong>)
<ul>
<li>This indicates the reference i-th will point to the DPB slot <strong>ReferenceIndices</strong>[i] and the reconstructed picture to be used is <strong><a href="d3d12ddi_video_encode_reference_frames_0080" title="typedef struct D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0080 {&#10;  UINT               NumTexture2Ds;&#10;  D3D12DDI_HRESOURCE *hDrvTexture2Ds;&#10;  UINT               *pSubresources;&#10;} D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0080;">D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0080</a></strong>.<strong>ppTexture2Ds</strong>[<strong>ReferenceFramesReconPictureDescriptors</strong>[<strong>ReferenceIndices</strong>[i]].<strong>ReconstructedPictureResourceIndex</strong>]</li>
</ul></li>
<li><p><strong><a href="d3d12ddi_video_encode_reference_frames_0080" title="typedef struct D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0080 {&#10;  UINT               NumTexture2Ds;&#10;  D3D12DDI_HRESOURCE *hDrvTexture2Ds;&#10;  UINT               *pSubresources;&#10;} D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0080;">D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0080</a></strong> will be filled as:</p>

<ul>
<li><strong>NumTexture2Ds</strong> = {number of unique values of <strong>ReferenceFramesReconPictureDescriptors</strong>.<strong>ReconstructedPictureResourceIndex</strong>[j] != D3D12_VIDEO_ENCODER_AV1_INVALID_DPB_RESOURCE_INDEX for j in {0..7} }</li>
<li><strong>ppTexture2Ds</strong> = { compact array (no null entries) containing the reconstructed picture from the previously encoded frames that will be used as references }</li>
<li>[Texture Array mode only] <strong>pSubresources</strong> = { compact array (no null entries) containing the subresource index of the texture array from the previously encoded frames that will be used as references }</li>
</ul></li>
</ul></li>
<li><p>When encoding a frame type without references but without clearing the DPB (ie. INTRA_ONLY)</p>

<ul>
<li><strong>PrimaryRefFrame</strong> must be 7 (PRIMARY_REF_NONE)</li>
<li><strong>RefreshFrameFlags</strong> must be set accordingly to indicate on which <strong>ReferenceFramesReconPictureDescriptors</strong> DPB slots the current encoded frame reconstructed picture will be placed after encoding execution. This value must match exactly what the API client will code for refresh_frame_flags AV1 syntax element in the associated picture header for the current frame.</li>
<li>The array entries in <strong>ReferenceFramesReconPictureDescriptors</strong> for the current frame will follow exactly what RefreshFrameFlags indicated for the previous frame.</li>
<li>The values in <strong>ReferenceIndices</strong>[7] are ignored as the intra-only frame doesn't use any references.</li>
<li><p><strong><a href="d3d12ddi_video_encode_reference_frames_0080" title="typedef struct D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0080 {&#10;  UINT               NumTexture2Ds;&#10;  D3D12DDI_HRESOURCE *hDrvTexture2Ds;&#10;  UINT               *pSubresources;&#10;} D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0080;">D3D12DDI_VIDEO_ENCODE_REFERENCE_FRAMES_0080</a></strong> contains the DPB snapshot and will be filled as:</p>

<ul>
<li><strong>NumTexture2Ds</strong> = {number of <em>unique</em> values of <strong>ReferenceFramesReconPictureDescriptors</strong>.<strong>ReconstructedPictureResourceIndex</strong>[j] != D3D12_VIDEO_ENCODER_AV1_INVALID_DPB_RESOURCE_INDEX for j in {0..7} }</li>
<li><strong>ppTexture2Ds</strong> = { compact array (no null entries) containing the reconstructed picture from the previously encoded frames referred to by <strong>ReferenceFramesReconPictureDescriptors</strong>.<strong>ReconstructedPictureResourceIndex</strong>[j] for j in {0..7} }</li>
<li>[Texture Array mode only] <strong>pSubresources</strong> = { compact array (no null entries) containing the subresource index of the texture array from the previously encoded frames referred to by <strong>ReferenceFramesReconPictureDescriptors</strong>.<strong>ReconstructedPictureResourceIndex</strong>[j] for j in {0..7} }</li>
</ul></li>
</ul></li>
</ol>

<p>See <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/display/video-encoding-d3d12-av1">D3D12 AV1 video encoding</a> for more information.</p>

<h2 id="see-also">See also</h2>

<p><strong><a href="d3d12ddi_video_encoder_picture_control_codec_data_0082_0" title="typedef struct D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_CODEC_DATA_0082_0 {&#10;  UINT  DataSize;&#10;  union {&#10;    D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_CODEC_DATA_H264_0082_0 *pH264PicData;&#10;    D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_CODEC_DATA_HEVC_0082_0 *pHEVCPicData;&#10;    D3D12DDI_VIDEO_ENCODER_AV1_PICTURE_CONTROL_CODEC_DATA_0095    *pAV1PicData;&#10;  };&#10;} D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_CODEC_DATA_0082_0;">D3D12DDI_VIDEO_ENCODER_PICTURE_CONTROL_CODEC_DATA_0082_0</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d12umddi/ns-d3d12umddi-d3d12ddi_video_encoder_av1_picture_control_codec_data_0095">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3d12umddi/ns-d3d12umddi-d3d12ddi_video_encoder_av1_picture_control_codec_data_0095.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
