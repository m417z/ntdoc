<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PFND3D11_1DDI_QUERYAUTHENTICATEDCHANNEL - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PFND3D11_1DDI_QUERYAUTHENTICATEDCHANNEL - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PFND3D11_1DDI_QUERYAUTHENTICATEDCHANNEL - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3d10umddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PFND3D11_1DDI_QUERYAUTHENTICATEDCHANNEL Pfnd3d111DdiQueryauthenticatedchannel;

HRESULT Pfnd3d111DdiQueryauthenticatedchannel(
  D3D10DDI_HDEVICE hDevice,
  D3D11_1DDI_HAUTHCHANNEL hCAuthChannel,
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> InputDataSize,
  const VOID *pInputData,
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> OutputDataSize,
  VOID *pOutputData
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d10umddi/nc-d3d10umddi-pfnd3d11_1ddi_queryauthenticatedchannel">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pfnd3d11_1ddi_queryauthenticatedchannel.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-d3d10umddi-pfnd3d11_1ddi_queryauthenticatedchannel)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pfnd3d11_1ddi_queryauthenticatedchannel-callback-function">PFND3D11_1DDI_QUERYAUTHENTICATEDCHANNEL callback function</h1>

<h2 id="description">Description</h2>

<p>Queries an authenticated channel for capability and state information. Implemented by a Windows Display Driver Model (WDDM) 1.2 or later user-mode display driver.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="hdevice"><code>hDevice</code></h3>

<p>A handle to the display device (graphics context).</p>

<h3 id="hcauthchannel"><code>hCAuthChannel</code></h3>

<p>A handle to an authenticated channel object that was created through a call to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d10umddi/nc-d3d10umddi-pfnd3d11_1ddi_createauthenticatedchannel">CreateAuthenticatedChannel(D3D11_1)</a> function.</p>

<h3 id="inputdatasize"><code>InputDataSize</code></h3>

<p>The size, in bytes, of the data in the <em>pInputData</em> array.</p>

<h3 id="pinputdata"><code>pInputData</code></h3>

<p>A pointer to a buffer that describes the information to query. The data in this buffer is formatted as a <a href="d3d11_1ddi_authenticated_query_input" title="typedef struct D3D11_1DDI_AUTHENTICATED_QUERY_INPUT {&#10;  GUID   QueryType;&#10;  HANDLE hChannel;&#10;  UINT   SequenceNumber;&#10;} D3D11_1DDI_AUTHENTICATED_QUERY_INPUT;">D3D11_1DDI_AUTHENTICATED_QUERY_INPUT</a> structure.</p>

<h3 id="outputdatasize"><code>OutputDataSize</code></h3>

<p>The size, in bytes, of the data in the <em>pOutputData</em> array.</p>

<h3 id="poutputdata"><code>pOutputData</code></h3>

<p>A pointer to a buffer that contains the queried information. For more information, see the Remarks section.</p>

<h2 id="return-value">Return value</h2>

<p>Returns one of the following values:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>S_OK</td>
  <td>The authenticated channel was queried successfully.</td>
</tr>
<tr>
  <td>E_FAIL</td>
  <td>The display miniport driver does not support the specified command</td>
</tr>
<tr>
  <td>E_INVALIDARG</td>
  <td>Parameters were validated and determined to be incorrect.</td>
</tr>
<tr>
  <td>E_OUTOFMEMORY</td>
  <td>Memory was not available to complete the operation.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>The <em>pInputData</em> parameter references a buffer that contains a <a href="d3d11_1ddi_authenticated_query_input" title="typedef struct D3D11_1DDI_AUTHENTICATED_QUERY_INPUT {&#10;  GUID   QueryType;&#10;  HANDLE hChannel;&#10;  UINT   SequenceNumber;&#10;} D3D11_1DDI_AUTHENTICATED_QUERY_INPUT;">D3D11_1DDI_AUTHENTICATED_QUERY_INPUT</a> structure. This structure contains the driver's handle to the authenticated channel, a sequence number, and a GUID that indicates the type of query to perform. The driver must return <strong>E_INVALIDARG</strong> if the sequence number was not previously initialized by using the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d10umddi/nc-d3d10umddi-pfnd3d11_1ddi_configureauthenticatedchannel">ConfigureAuthenticatedChannel(D3D11_1)</a> function. The driver must also return <strong>E_INVALIDARG</strong> if the sequence number is not greater than the sequence number of the previous query call.</p>

<p>The byte array that is referenced by the <em>pOutputData</em> parameter is in a format that is specified by the <strong>QueryType</strong> member of the <a href="d3d11_1ddi_authenticated_query_input" title="typedef struct D3D11_1DDI_AUTHENTICATED_QUERY_INPUT {&#10;  GUID   QueryType;&#10;  HANDLE hChannel;&#10;  UINT   SequenceNumber;&#10;} D3D11_1DDI_AUTHENTICATED_QUERY_INPUT;">D3D11_1DDI_AUTHENTICATED_QUERY_INPUT</a> structure. The following list describes the format of this data based on the <strong>QueryType</strong> member.</p>

<p>The driver prepares the output buffer that is referenced by the <em>pOutputData</em> parameter by following these steps:</p>

<ol>
<li>Each structure that is returned based on the <strong>QueryType</strong> member starts with a <a href="d3d11_1ddi_authenticated_query_output" title="typedef struct D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT {&#10;  D3D11_1DDI_OMAC omac;&#10;  GUID            QueryType;&#10;  HANDLE          hChannel;&#10;  UINT            SequenceNumber;&#10;  HRESULT         ReturnCode;&#10;} D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT;">D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT</a> structure. The driver must copy the members of the <a href="d3d11_1ddi_authenticated_query_input" title="typedef struct D3D11_1DDI_AUTHENTICATED_QUERY_INPUT {&#10;  GUID   QueryType;&#10;  HANDLE hChannel;&#10;  UINT   SequenceNumber;&#10;} D3D11_1DDI_AUTHENTICATED_QUERY_INPUT;">D3D11_1DDI_AUTHENTICATED_QUERY_INPUT</a> to the <strong><a href="d3d11_1ddi_authenticated_query_output" title="typedef struct D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT {&#10;  D3D11_1DDI_OMAC omac;&#10;  GUID            QueryType;&#10;  HANDLE          hChannel;&#10;  UINT            SequenceNumber;&#10;  HRESULT         ReturnCode;&#10;} D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT;">D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT</a></strong> structure.</li>
<li>The driver must set the <strong>ReturnCode</strong> member to the same return code that it will return for the <em>QueryAuthenticatedChannel(D3D11_1)</em> call. This provides the application with a secure mechanism of accessing the return code.</li>
<li>Based on the value of the <strong>QueryType</strong> member, the driver must initialize the corresponding structure that follows the <a href="d3d11_1ddi_authenticated_query_output" title="typedef struct D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT {&#10;  D3D11_1DDI_OMAC omac;&#10;  GUID            QueryType;&#10;  HANDLE          hChannel;&#10;  UINT            SequenceNumber;&#10;  HRESULT         ReturnCode;&#10;} D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT;">D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT</a> structure in the <em>pOutputData</em> buffer.</li>
<li><p>The driver must sign the <em>pOutputData</em> buffer in a way that is identical to the way it handles Output Protection Manager (OPM) queries.</p>

<p>The <a href="d3d11_1ddi_authenticated_query_output" title="typedef struct D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT {&#10;  D3D11_1DDI_OMAC omac;&#10;  GUID            QueryType;&#10;  HANDLE          hChannel;&#10;  UINT            SequenceNumber;&#10;  HRESULT         ReturnCode;&#10;} D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT;">D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT</a> structure contains an AES-based one-key CBC message authentication code (OMAC) of the data. The display miniport driver must calculate an OMAC over the data in the output buffer to authenticate the data. The driver does this by first setting the <strong>omac</strong> member to zero and then calculating an OMAC for the data in the buffer. The driver then sets the <strong>omac</strong> member to the OMAC that it calculated.</p></li>
</ol>

<p>The display miniport driver must return <strong>E_INVALIDARG</strong> for the <em>QueryAuthenticatedChannel(D3D11_1)</em> call under the following conditions:</p>

<ul>
<li>The sequence number is not greater than a sequence number that was specified in a previous configuration call.</li>
<li>The sequence number has not yet been initialized by a call to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d10umddi/nc-d3d10umddi-pfnd3d11_1ddi_configureauthenticatedchannel">ConfigureAuthenticatedChannel(D3D11_1)</a> function.</li>
<li>The <em>OutputDataSize</em> parameter is less than size of the structure specified by the <strong><a href="d3d11_1ddi_authenticated_configure_input" title="typedef struct D3D11_1DDI_AUTHENTICATED_CONFIGURE_INPUT {&#10;  D3D11_1DDI_OMAC omac;&#10;  GUID            ConfigureType;&#10;  HANDLE          hChannel;&#10;  UINT            SequenceNumber;&#10;} D3D11_1DDI_AUTHENTICATED_CONFIGURE_INPUT;">D3D11_1DDI_AUTHENTICATED_CONFIGURE_INPUT</a>.QueryType</strong> member.</li>
</ul>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d10umddi/nc-d3d10umddi-pfnd3d11_1ddi_configureauthenticatedchannel">ConfigureAuthenticatedChannel(D3D11_1)</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d10umddi/nc-d3d10umddi-pfnd3d11_1ddi_createauthenticatedchannel">CreateAuthenticatedChannel(D3D11_1)</a></p>

<p><a href="d3d11_1ddi_authenticated_query_input" title="typedef struct D3D11_1DDI_AUTHENTICATED_QUERY_INPUT {&#10;  GUID   QueryType;&#10;  HANDLE hChannel;&#10;  UINT   SequenceNumber;&#10;} D3D11_1DDI_AUTHENTICATED_QUERY_INPUT;">D3D11_1DDI_AUTHENTICATED_QUERY_INPUT</a></p>

<p><a href="d3d11_1ddi_authenticated_query_output" title="typedef struct D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT {&#10;  D3D11_1DDI_OMAC omac;&#10;  GUID            QueryType;&#10;  HANDLE          hChannel;&#10;  UINT            SequenceNumber;&#10;  HRESULT         ReturnCode;&#10;} D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT;">D3D11_1DDI_AUTHENTICATED_QUERY_OUTPUT</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3d10umddi/nc-d3d10umddi-pfnd3d11_1ddi_queryauthenticatedchannel">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3d10umddi/nc-d3d10umddi-pfnd3d11_1ddi_queryauthenticatedchannel.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
