<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="ExAllocateFromPagedLookasideList - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ExAllocateFromPagedLookasideList - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            ExAllocateFromPagedLookasideList - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PVOID ExAllocateFromPagedLookasideList(
  [in, out] PPAGED_LOOKASIDE_LIST Lookaside
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-exallocatefrompagedlookasidelist">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/exallocatefrompagedlookasidelist.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-wdm-exallocatefrompagedlookasidelist)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="exallocatefrompagedlookasidelist-function">ExAllocateFromPagedLookasideList function</h1>

<h2 id="description">Description</h2>

<p>The <strong>ExAllocateFromPagedLookasideList</strong> routine returns a pointer to a paged entry from the given lookaside list, or it returns a pointer to a newly allocated paged entry.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="lookaside-in-out"><code>Lookaside</code> [in, out]</h3>

<p>A pointer to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/eprocess">PAGED_LOOKASIDE_LIST</a> structure for the lookaside list, which the caller already initialized with <a href="exinitializepagedlookasidelist" title="VOID ExInitializePagedLookasideList(&#10;  [out]          PPAGED_LOOKASIDE_LIST Lookaside,&#10;  [in, optional] PALLOCATE_FUNCTION    Allocate,&#10;  [in, optional] PFREE_FUNCTION        Free,&#10;  [in]           ULONG                 Flags,&#10;  [in]           SIZE_T                Size,&#10;  [in]           ULONG                 Tag,&#10;  [in]           USHORT                Depth&#10;);">ExInitializePagedLookasideList</a>.</p>

<h2 id="return-value">Return value</h2>

<p><strong>ExAllocateFromPagedLookasideList</strong> returns a pointer to an entry if one can be allocated. Otherwise, it returns <strong>NULL</strong>.</p>

<h2 id="remarks">Remarks</h2>

<blockquote>
  <p>[!CAUTION]
  Starting in Windows 11, version 22H2, this function changed from inline to exported. As a result, if you build your driver targeting the latest version of Windows, it will fail to load in older OS versions. To change the target OS version in Visual Studio, select Configuration Properties->Driver Settings->General.</p>
</blockquote>

<p>If the given lookaside list is not empty, <strong>ExAllocateFromPagedLookasideList</strong> removes the first entry from the list and returns a pointer to this entry. Otherwise, <strong>ExAllocateFromPagedLookasideList</strong> either calls the <em>Allocate</em> routine specified at list initialization or <a href="exallocatepoolwithtag" title="PVOID ExAllocatePoolWithTag(&#10;  [in] __drv_strictTypeMatch(__drv_typeExpr)POOL_TYPE PoolType,&#10;  [in] SIZE_T                                         NumberOfBytes,&#10;  [in] ULONG                                          Tag&#10;);">ExAllocatePoolWithTag</a> to return an entry pointer.</p>

<p>The caller can then set up the returned entry with any caller-determined data. The caller should release each entry with <a href="exfreetopagedlookasidelist" title="VOID ExFreeToPagedLookasideList(&#10;  [in, out] PPAGED_LOOKASIDE_LIST Lookaside,&#10;  [in]      PVOID                 Entry&#10;);">ExFreeToPagedLookasideList</a> when it is no longer in use.</p>

<p>Because the entries in a paged lookaside list are allocated from pageable memory, they must not be accessed at an IRQL &gt;= DISPATCH_LEVEL. You can use <a href="exallocatefromnpagedlookasidelist" title="PVOID ExAllocateFromNPagedLookasideList(&#10;  [in, out] PNPAGED_LOOKASIDE_LIST Lookaside&#10;);">ExAllocateFromNPagedLookasideList</a> to create a lookaside list with non-pageable entries.</p>

<p>On Windows 2000, drivers must use the <strong>-D_WIN2K_COMPAT_SLIST_USAGE</strong> switch to successfully link code that uses <strong>ExAllocateFromPagedLookasideList</strong>.</p>

<p>For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/using-lookaside-lists">Using Lookaside Lists</a>.</p>

<h2 id="see-also">See also</h2>

<p><a href="exallocatefromnpagedlookasidelist" title="PVOID ExAllocateFromNPagedLookasideList(&#10;  [in, out] PNPAGED_LOOKASIDE_LIST Lookaside&#10;);">ExAllocateFromNPagedLookasideList</a></p>

<p><a href="exfreetopagedlookasidelist" title="VOID ExFreeToPagedLookasideList(&#10;  [in, out] PPAGED_LOOKASIDE_LIST Lookaside,&#10;  [in]      PVOID                 Entry&#10;);">ExFreeToPagedLookasideList</a></p>

<p><a href="exinitializepagedlookasidelist" title="VOID ExInitializePagedLookasideList(&#10;  [out]          PPAGED_LOOKASIDE_LIST Lookaside,&#10;  [in, optional] PALLOCATE_FUNCTION    Allocate,&#10;  [in, optional] PFREE_FUNCTION        Free,&#10;  [in]           ULONG                 Flags,&#10;  [in]           SIZE_T                Size,&#10;  [in]           ULONG                 Tag,&#10;  [in]           USHORT                Depth&#10;);">ExInitializePagedLookasideList</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/eprocess">PAGED_LOOKASIDE_LIST</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-exallocatefrompagedlookasidelist">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/nf-wdm-exallocatefrompagedlookasidelist.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
