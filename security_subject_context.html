<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="SECURITY_SUBJECT_CONTEXT - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>SECURITY_SUBJECT_CONTEXT - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            SECURITY_SUBJECT_CONTEXT - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _SECURITY_SUBJECT_CONTEXT {
  PACCESS_TOKEN                ClientToken;
  <a href="security_impersonation_level" title="typedef enum _SECURITY_IMPERSONATION_LEVEL {&#10;  SecurityAnonymous,&#10;  SecurityIdentification,&#10;  SecurityImpersonation,&#10;  SecurityDelegation&#10;} SECURITY_IMPERSONATION_LEVEL, *PSECURITY_IMPERSONATION_LEVEL;">SECURITY_IMPERSONATION_LEVEL</a> ImpersonationLevel;
  PACCESS_TOKEN                PrimaryToken;
  PVOID                        ProcessAuditId;
} SECURITY_SUBJECT_CONTEXT, *PSECURITY_SUBJECT_CONTEXT;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_security_subject_context">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/security_subject_context.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-wdm-_security_subject_context)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="security_subject_context-structure">SECURITY_SUBJECT_CONTEXT structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>SECURITY_SUBJECT_CONTEXT</strong> structure is used to capture subject security context for access validation and auditing.</p>

<p><em>Drivers must not modify or try to directly access any members of this structure to make security decisions. To create and manipulate this structure, use the support routines listed in the <strong>See Also</strong> section.</em></p>

<h2 id="members">Members</h2>

<h3 id="clienttoken"><code>ClientToken</code></h3>

<p>Reserved for system use.</p>

<h3 id="impersonationlevel"><code>ImpersonationLevel</code></h3>

<p>Reserved for system use.</p>

<h3 id="primarytoken"><code>PrimaryToken</code></h3>

<p>Reserved for system use.</p>

<h3 id="processauditid"><code>ProcessAuditId</code></h3>

<p>Reserved for system use.</p>

<h2 id="remarks">Remarks</h2>

<p>For more information about security and access control, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/driversecurity/windows-security-model">Windows security model for driver developers</a> and the documentation on these topics in the Microsoft Windows SDK.</p>

<h2 id="see-also">See also</h2>

<p><strong><a href="access_state" title="typedef struct _ACCESS_STATE {&#10;  LUID                     OperationID;&#10;  BOOLEAN                  SecurityEvaluated;&#10;  BOOLEAN                  GenerateAudit;&#10;  BOOLEAN                  GenerateOnClose;&#10;  BOOLEAN                  PrivilegesAllocated;&#10;  ULONG                    Flags;&#10;  ACCESS_MASK              RemainingDesiredAccess;&#10;  ACCESS_MASK              PreviouslyGrantedAccess;&#10;  ACCESS_MASK              OriginalDesiredAccess;&#10;  SECURITY_SUBJECT_CONTEXT SubjectSecurityContext;&#10;  PSECURITY_DESCRIPTOR     SecurityDescriptor;&#10;  PVOID                    AuxData;&#10;  union {&#10;    INITIAL_PRIVILEGE_SET InitialPrivilegeSet;&#10;    PRIVILEGE_SET         PrivilegeSet;&#10;  } Privileges;&#10;  BOOLEAN                  AuditPrivileges;&#10;  UNICODE_STRING           ObjectName;&#10;  UNICODE_STRING           ObjectTypeName;&#10;...">ACCESS_STATE</a></strong></p>

<p><strong><a href="fsrtlnotifyfullchangedirectory" title="VOID FsRtlNotifyFullChangeDirectory(&#10;  [in]           PNOTIFY_SYNC               NotifySync,&#10;  [in]           PLIST_ENTRY                NotifyList,&#10;  [in]           PVOID                      FsContext,&#10;  [in]           PSTRING                    FullDirectoryName,&#10;  [in]           BOOLEAN                    WatchTree,&#10;  [in]           BOOLEAN                    IgnoreBuffer,&#10;  [in]           ULONG                      CompletionFilter,&#10;  [in, optional] PIRP                       NotifyIrp,&#10;  [in, optional] PCHECK_FOR_TRAVERSE_ACCESS TraverseCallback,&#10;  [in, optional] PSECURITY_SUBJECT_CONTEXT  SubjectContext&#10;);">FsRtlNotifyFullChangeDirectory</a></strong></p>

<p><strong><a href="security_impersonation_level" title="typedef enum _SECURITY_IMPERSONATION_LEVEL {&#10;  SecurityAnonymous,&#10;  SecurityIdentification,&#10;  SecurityImpersonation,&#10;  SecurityDelegation&#10;} SECURITY_IMPERSONATION_LEVEL, *PSECURITY_IMPERSONATION_LEVEL;">SECURITY_IMPERSONATION_LEVEL</a></strong></p>

<p><strong><a href="seaccesscheck" title="BOOLEAN SeAccessCheck(&#10;  [in]  PSECURITY_DESCRIPTOR      SecurityDescriptor,&#10;  [in]  PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,&#10;  [in]  BOOLEAN                   SubjectContextLocked,&#10;  [in]  ACCESS_MASK               DesiredAccess,&#10;  [in]  ACCESS_MASK               PreviouslyGrantedAccess,&#10;  [out] PPRIVILEGE_SET            *Privileges,&#10;  [in]  PGENERIC_MAPPING          GenericMapping,&#10;  [in]  KPROCESSOR_MODE           AccessMode,&#10;  [out] PACCESS_MASK              GrantedAccess,&#10;  [out] PNTSTATUS                 AccessStatus&#10;);">SeAccessCheck</a></strong></p>

<p><strong><a href="seassignsecurity" title="NTSTATUS SeAssignSecurity(&#10;  [in, optional] PSECURITY_DESCRIPTOR      ParentDescriptor,&#10;  [in, optional] PSECURITY_DESCRIPTOR      ExplicitDescriptor,&#10;  [out]          PSECURITY_DESCRIPTOR      *NewDescriptor,&#10;  [in]           BOOLEAN                   IsDirectoryObject,&#10;  [in]           PSECURITY_SUBJECT_CONTEXT SubjectContext,&#10;  [in]           PGENERIC_MAPPING          GenericMapping,&#10;  [in]           POOL_TYPE                 PoolType&#10;);">SeAssignSecurity</a></strong></p>

<p><strong><a href="seassignsecurityex" title="NTSTATUS SeAssignSecurityEx(&#10;  [in, optional] PSECURITY_DESCRIPTOR      ParentDescriptor,&#10;  [in, optional] PSECURITY_DESCRIPTOR      ExplicitDescriptor,&#10;  [out]          PSECURITY_DESCRIPTOR      *NewDescriptor,&#10;  [in, optional] GUID                      *ObjectType,&#10;  [in]           BOOLEAN                   IsDirectoryObject,&#10;  [in]           ULONG                     AutoInheritFlags,&#10;  [in]           PSECURITY_SUBJECT_CONTEXT SubjectContext,&#10;  [in]           PGENERIC_MAPPING          GenericMapping,&#10;  [in]           POOL_TYPE                 PoolType&#10;);">SeAssignSecurityEx</a></strong></p>

<p><strong><a href="seauditingfileorglobalevents" title="BOOLEAN SeAuditingFileOrGlobalEvents(&#10;  [in] BOOLEAN                   AccessGranted,&#10;  [in] PSECURITY_DESCRIPTOR      SecurityDescriptor,&#10;  [in] PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext&#10;);">SeAuditingFileOrGlobalEvents</a></strong></p>

<p><strong><a href="secapturesubjectcontext" title="VOID SeCaptureSubjectContext(&#10;  [out] PSECURITY_SUBJECT_CONTEXT SubjectContext&#10;);">SeCaptureSubjectContext</a></strong></p>

<p><strong><a href="secreateclientsecurityfromsubjectcontext" title="NTSTATUS SeCreateClientSecurityFromSubjectContext(&#10;  [in]  PSECURITY_SUBJECT_CONTEXT    SubjectContext,&#10;  [in]  PSECURITY_QUALITY_OF_SERVICE ClientSecurityQos,&#10;  [in]  BOOLEAN                      ServerIsRemote,&#10;  [out] PSECURITY_CLIENT_CONTEXT     ClientContext&#10;);">SeCreateClientSecurityFromSubjectContext</a></strong></p>

<p><strong><a href="sefiltertoken" title="NTSTATUS SeFilterToken(&#10;  [in]           PACCESS_TOKEN     ExistingToken,&#10;  [in]           ULONG             Flags,&#10;  [in, optional] PTOKEN_GROUPS     SidsToDisable,&#10;  [in, optional] PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;  [in, optional] PTOKEN_GROUPS     RestrictedSids,&#10;                 PACCESS_TOKEN     *FilteredToken&#10;);">SeFilterToken</a></strong></p>

<p><strong><a href="selocksubjectcontext" title="VOID SeLockSubjectContext(&#10;  [in] PSECURITY_SUBJECT_CONTEXT SubjectContext&#10;);">SeLockSubjectContext</a></strong></p>

<p><strong><a href="seprivilegecheck" title="BOOLEAN SePrivilegeCheck(&#10;  [in, out] PPRIVILEGE_SET            RequiredPrivileges,&#10;  [in]      PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,&#10;  [in]      KPROCESSOR_MODE           AccessMode&#10;);">SePrivilegeCheck</a></strong></p>

<p><strong><a href="sequerysubjectcontexttoken" title="PACESS_TOKEN&#10;SeQuerySubjectContextToken(SubjectContext);">SeQuerySubjectContextToken</a></strong></p>

<p><strong><a href="sereleasesubjectcontext" title="VOID SeReleaseSubjectContext(&#10;  [in, out] PSECURITY_SUBJECT_CONTEXT SubjectContext&#10;);">SeReleaseSubjectContext</a></strong></p>

<p><strong><a href="seunlocksubjectcontext" title="VOID SeUnlockSubjectContext(&#10;  [in] PSECURITY_SUBJECT_CONTEXT SubjectContext&#10;);">SeUnlockSubjectContext</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_security_subject_context">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/ns-wdm-_security_subject_context.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
