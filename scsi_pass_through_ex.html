<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="SCSI_PASS_THROUGH_EX - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>SCSI_PASS_THROUGH_EX - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            SCSI_PASS_THROUGH_EX - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddscsi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _SCSI_PASS_THROUGH_EX {
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>     Version;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>     Length;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>     CdbLength;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>     StorAddressLength;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>     ScsiStatus;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>     SenseInfoLength;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>     DataDirection;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>     Reserved;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>     TimeOutValue;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>     StorAddressOffset;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>     SenseInfoOffset;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>     DataOutTransferLength;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>     DataInTransferLength;
  <a href="ulong_ptr" title="typedef [public] unsigned __int3264 ULONG_PTR;">ULONG_PTR</a> DataOutBufferOffset;
  <a href="ulong_ptr" title="typedef [public] unsigned __int3264 ULONG_PTR;">ULONG_PTR</a> DataInBufferOffset;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>     Cdb[ANYSIZE_ARRAY];
} SCSI_PASS_THROUGH_EX, *PSCSI_PASS_THROUGH_EX;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddscsi/ns-ntddscsi-_scsi_pass_through_ex">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/scsi_pass_through_ex.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddscsi-_scsi_pass_through_ex)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>SCSI_PASS_THROUGH_EX structure</h1>
<h2>Description</h2>
<p>The <strong>SCSI_PASS_THROUGH_EX</strong> structure is used in conjunction with an <strong><a href="ioctl_scsi_pass_through_ex" title="// CTL_CODE(0x0004, 0x411, METHOD_BUFFERED, FILE_READ_ACCESS | FILE_WRITE_ACCESS)&#10;#define IOCTL_SCSI_PASS_THROUGH_EX 0x0004D044">IOCTL_SCSI_PASS_THROUGH_EX</a></strong> request to instruct the port driver to send an embedded SCSI command to the target device. <strong>SCSI_PASS_THROUGH_EX</strong> can contain a bi-directional data transfers and a variable length command data block.</p>
<blockquote>
<p>[!NOTE]
The SCSI port driver and SCSI miniport driver models may be altered or unavailable in the future. Instead, use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/storage/storport-driver-overview">Storport driver</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/storage/storport-miniport-drivers">Storport miniport</a> driver models.</p>
</blockquote>
<h2>Members</h2>
<h3><code>Version</code></h3>
<p>The version of this structure. Set to 0.</p>
<h3><code>Length</code></h3>
<p>The size of this structure, in bytes. Set to <code>sizeof(SCSI_PASS_THROUGH_EX)</code>.</p>
<h3><code>CdbLength</code></h3>
<p>The size of the SCSI command descriptor block in <strong>Cdb</strong>, in bytes.</p>
<h3><code>StorAddressLength</code></h3>
<p>The length, in bytes, of the storage device address structure at the offset of <strong>StorAddressOffset</strong> after this structure.</p>
<h3><code>ScsiStatus</code></h3>
<p>Reports the SCSI status that was returned by the HBA or the target device.</p>
<h3><code>SenseInfoLength</code></h3>
<p>The size in bytes of the request-sense buffer. This member is optional and can be set to 0.</p>
<h3><code>DataDirection</code></h3>
<p>Indicates whether the SCSI command will read or write data. This field must be one of the following values:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>SCSI_IOCTL_DATA_OUT</td>
<td>Write data to the device.</td>
</tr>
<tr>
<td>SCSI_IOCTL_DATA_IN</td>
<td>Read data from the device.</td>
</tr>
<tr>
<td>SCSI_IOCTL_DATA_UNSPECIFIED</td>
<td>No data is being transferred.</td>
</tr>
<tr>
<td>SCSI_IOCTL_DATA_BIDIRECTIONAL</td>
<td>Data is valid for both input and output.</td>
</tr>
</tbody>
</table>
<h3><code>Reserved</code></h3>
<p>Reserved. Set to 0.</p>
<h3><code>TimeOutValue</code></h3>
<p>Indicates the interval in seconds that the request can execute before the port driver considers it timed out. Do not set this value to 0. Default values often range from:</p>
<ul>
<li>Typical operations: 30 to 60 seconds</li>
<li>Short operations: 10 to 30 seconds</li>
<li>Medium operations: 30 to 120 seconds</li>
<li>Long operations (like format, extended self-test): 300 to 3600 seconds or more</li>
</ul>
<h3><code>StorAddressOffset</code></h3>
<p>The location of the target storage device address structure, in bytes, from the beginning of this structure.</p>
<h3><code>SenseInfoOffset</code></h3>
<p>Offset from the beginning of this structure to the request-sense buffer. Set to 0 if no request-sense buffer is present.</p>
<h3><code>DataOutTransferLength</code></h3>
<p>Indicates the size in bytes of the output data buffer. Many devices transfer chunks of data of predefined length. The value in <strong>DataOutTransferLength</strong> must be an integral multiple of this predefined, minimum length that is specified by the device. If an underrun occurs, the miniport driver must update this member to the number of bytes actually transferred. If no output data buffer is present, this member is set to 0.</p>
<h3><code>DataInTransferLength</code></h3>
<p>Indicates the size in bytes of the input data buffer. Many devices transfer chunks of data of predefined length. The value in <strong>DataInTransferLength</strong> must be an integral multiple of this predefined, minimum length that is specified by the device. If an underrun occurs, the miniport driver must update this member to the number of bytes actually transferred. If no input data buffer is present, this member is set to 0.</p>
<h3><code>DataOutBufferOffset</code></h3>
<p>Contains an offset from the beginning of this structure to the output data buffer. The offset must respect the data alignment requirements of the device.</p>
<h3><code>DataInBufferOffset</code></h3>
<p>Contains an offset from the beginning of this structure to the input data buffer. The offset must respect the data alignment requirements of the device.</p>
<h3><code>Cdb</code></h3>
<p>Specifies the SCSI command descriptor block to be sent to the target device.</p>
<h2>Remarks</h2>
<p>The <strong>SCSI_PASS_THROUGH_EX</strong> structure is used with the <strong><a href="ioctl_scsi_pass_through_ex" title="// CTL_CODE(0x0004, 0x411, METHOD_BUFFERED, FILE_READ_ACCESS | FILE_WRITE_ACCESS)&#10;#define IOCTL_SCSI_PASS_THROUGH_EX 0x0004D044">IOCTL_SCSI_PASS_THROUGH_EX</a></strong> control code, which is a buffered device control request. To bypass buffering in system memory, callers should use <strong><a href="ioctl_scsi_pass_through_direct_ex" title="// CTL_CODE(0x0004, 0x412, METHOD_BUFFERED, FILE_READ_ACCESS | FILE_WRITE_ACCESS)&#10;#define IOCTL_SCSI_PASS_THROUGH_DIRECT_EX 0x0004D048">IOCTL_SCSI_PASS_THROUGH_DIRECT_EX</a></strong>. When handling an <strong><a href="ioctl_scsi_pass_through_direct_ex" title="// CTL_CODE(0x0004, 0x412, METHOD_BUFFERED, FILE_READ_ACCESS | FILE_WRITE_ACCESS)&#10;#define IOCTL_SCSI_PASS_THROUGH_DIRECT_EX 0x0004D048">IOCTL_SCSI_PASS_THROUGH_DIRECT_EX</a></strong> request, the system locks down the buffer in user memory and the device accesses this memory directly.</p>
<blockquote>
<p>[!NOTE]
Drivers executing on a 64-bit version of Windows must use the <strong>SCSI_PASS_THROUGH32_EX</strong> structure as the request data type when handling an <strong><a href="ioctl_scsi_pass_through_ex" title="// CTL_CODE(0x0004, 0x411, METHOD_BUFFERED, FILE_READ_ACCESS | FILE_WRITE_ACCESS)&#10;#define IOCTL_SCSI_PASS_THROUGH_EX 0x0004D044">IOCTL_SCSI_PASS_THROUGH_EX</a></strong> request from a 32-bit process.</p>
</blockquote>
<h2>See also</h2>
<p><strong><a href="ioctl_scsi_pass_through" title="// CTL_CODE(0x0004, 0x401, METHOD_BUFFERED, FILE_READ_ACCESS | FILE_WRITE_ACCESS)&#10;#define IOCTL_SCSI_PASS_THROUGH 0x0004D004">IOCTL_SCSI_PASS_THROUGH</a></strong></p>
<p><strong><a href="ioctl_scsi_pass_through_ex" title="// CTL_CODE(0x0004, 0x411, METHOD_BUFFERED, FILE_READ_ACCESS | FILE_WRITE_ACCESS)&#10;#define IOCTL_SCSI_PASS_THROUGH_EX 0x0004D044">IOCTL_SCSI_PASS_THROUGH_EX</a></strong></p>
<p><strong><a href="scsi_pass_through" title="typedef struct _SCSI_PASS_THROUGH {&#10;  USHORT    Length;&#10;  UCHAR     ScsiStatus;&#10;  UCHAR     PathId;&#10;  UCHAR     TargetId;&#10;  UCHAR     Lun;&#10;  UCHAR     CdbLength;&#10;  UCHAR     SenseInfoLength;&#10;  UCHAR     DataIn;&#10;  ULONG     DataTransferLength;&#10;  ULONG     TimeOutValue;&#10;  ULONG_PTR DataBufferOffset;&#10;  ULONG     SenseInfoOffset;&#10;  UCHAR     Cdb[16];&#10;} SCSI_PASS_THROUGH, *PSCSI_PASS_THROUGH;">SCSI_PASS_THROUGH</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddscsi/ns-ntddscsi-_scsi_pass_through_ex">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddscsi/ns-ntddscsi-_scsi_pass_through_ex.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
