<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PREGISTER_EVENT_CALLBACK - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PREGISTER_EVENT_CALLBACK - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PREGISTER_EVENT_CALLBACK - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// hdaudio.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PREGISTER_EVENT_CALLBACK PregisterEventCallback;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> PregisterEventCallback(
  [in]  PVOID _context,
  [in]  <a href="phdaudio_unsolicited_response_callback" title="PHDAUDIO_UNSOLICITED_RESPONSE_CALLBACK PhdaudioUnsolicitedResponseCallback;&#10;&#10;VOID PhdaudioUnsolicitedResponseCallback(&#10;  HDAUDIO_CODEC_RESPONSE unnamedParam1,&#10;  PVOID unnamedParam2&#10;)&#10;{...}">PHDAUDIO_UNSOLICITED_RESPONSE_CALLBACK</a> Routine,
  [in]  PVOID Context,
  [out] PUCHAR Tag
)
{...}</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/hdaudio/nc-hdaudio-pregister_event_callback">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pregister_event_callback.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-hdaudio-pregister_event_callback)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pregister_event_callback-callback-function">PREGISTER_EVENT_CALLBACK callback function</h1>

<h2 id="description">Description</h2>

<p>The <em>RegisterEventCallback</em> routine registers a callback routine for an unsolicited response from a codec or codecs.</p>

<p>The function pointer type for a <em>RegisterEventCallback</em> routine is defined as follows.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="_context-in"><code>_context</code> [in]</h3>

<p>Specifies the context value from the <strong>Context</strong> member of the <a href="hdaudio_bus_interface" title="typedef struct _HDAUDIO_BUS_INTERFACE {&#10;  USHORT                       Size;&#10;  USHORT                       Version;&#10;  PVOID                        Context;&#10;  PINTERFACE_REFERENCE         InterfaceReference;&#10;  PINTERFACE_DEREFERENCE       InterfaceDereference;&#10;  PTRANSFER_CODEC_VERBS        TransferCodecVerbs;&#10;  PALLOCATE_CAPTURE_DMA_ENGINE AllocateCaptureDmaEngine;&#10;  PALLOCATE_RENDER_DMA_ENGINE  AllocateRenderDmaEngine;&#10;  PCHANGE_BANDWIDTH_ALLOCATION ChangeBandwidthAllocation;&#10;  PALLOCATE_DMA_BUFFER         AllocateDmaBuffer;&#10;  PFREE_DMA_BUFFER             FreeDmaBuffer;&#10;  PFREE_DMA_ENGINE             FreeDmaEngine;&#10;  PSET_DMA_ENGINE_STATE        SetDmaEngineState;&#10;  PGET_WALL_CLOCK_REGISTER     GetWallClockRegister;&#10;  PGET_LINK_POSITION_REGISTER  GetLinkPositionRegister;&#10;  PREGISTER_EVENT_CALLBACK     RegisterEventCallback;&#10;  PUNREGISTER_EVENT_CALLBACK   UnregisterEventCallback;&#10;  PGET_DEVICE_INFORMATION      GetDeviceInformation;&#10;  PGET_RESOURCE_INFORMATION    GetResourceInformation;&#10;...">HDAUDIO_BUS_INTERFACE</a>, <a href="hdaudio_bus_interface_v2" title="typedef struct _HDAUDIO_BUS_INTERFACE_V2 {&#10;  USHORT                                 Size;&#10;  USHORT                                 Version;&#10;  PVOID                                  Context;&#10;  PINTERFACE_REFERENCE                   InterfaceReference;&#10;  PINTERFACE_DEREFERENCE                 InterfaceDereference;&#10;  PTRANSFER_CODEC_VERBS                  TransferCodecVerbs;&#10;  PALLOCATE_CAPTURE_DMA_ENGINE           AllocateCaptureDmaEngine;&#10;  PALLOCATE_RENDER_DMA_ENGINE            AllocateRenderDmaEngine;&#10;  PCHANGE_BANDWIDTH_ALLOCATION           ChangeBandwidthAllocation;&#10;  PALLOCATE_DMA_BUFFER                   AllocateDmaBuffer;&#10;  PFREE_DMA_BUFFER                       FreeDmaBuffer;&#10;  PFREE_DMA_ENGINE                       FreeDmaEngine;&#10;  PSET_DMA_ENGINE_STATE                  SetDmaEngineState;&#10;  PGET_WALL_CLOCK_REGISTER               GetWallClockRegister;&#10;  PGET_LINK_POSITION_REGISTER            GetLinkPositionRegister;&#10;  PREGISTER_EVENT_CALLBACK               RegisterEventCallback;&#10;  PUNREGISTER_EVENT_CALLBACK             UnregisterEventCallback;&#10;  PGET_DEVICE_INFORMATION                GetDeviceInformation;&#10;  PGET_RESOURCE_INFORMATION              GetResourceInformation;&#10;...">HDAUDIO_BUS_INTERFACE_V2</a>, or <a href="hdaudio_bus_interface_bdl" title="typedef struct _HDAUDIO_BUS_INTERFACE_BDL {&#10;  USHORT                          Size;&#10;  USHORT                          Version;&#10;  PVOID                           Context;&#10;  PINTERFACE_REFERENCE            InterfaceReference;&#10;  PINTERFACE_DEREFERENCE          InterfaceDereference;&#10;  PTRANSFER_CODEC_VERBS           TransferCodecVerbs;&#10;  PALLOCATE_CAPTURE_DMA_ENGINE    AllocateCaptureDmaEngine;&#10;  PALLOCATE_RENDER_DMA_ENGINE     AllocateRenderDmaEngine;&#10;  PCHANGE_BANDWIDTH_ALLOCATION    ChangeBandwidthAllocation;&#10;  PALLOCATE_CONTIGUOUS_DMA_BUFFER AllocateContiguousDmaBuffer;&#10;  PSETUP_DMA_ENGINE_WITH_BDL      SetupDmaEngineWithBdl;&#10;  PFREE_CONTIGUOUS_DMA_BUFFER     FreeContiguousDmaBuffer;&#10;  PFREE_DMA_ENGINE                FreeDmaEngine;&#10;  PSET_DMA_ENGINE_STATE           SetDmaEngineState;&#10;  PGET_WALL_CLOCK_REGISTER        GetWallClockRegister;&#10;  PGET_LINK_POSITION_REGISTER     GetLinkPositionRegister;&#10;  PREGISTER_EVENT_CALLBACK        RegisterEventCallback;&#10;  PUNREGISTER_EVENT_CALLBACK      UnregisterEventCallback;&#10;  PGET_DEVICE_INFORMATION         GetDeviceInformation;&#10;...">HDAUDIO_BUS_INTERFACE_BDL</a> structure.</p>

<h3 id="routine-in"><code>Routine</code> [in]</h3>

<p>Function pointer to a callback routine. This parameter must be a valid, non-NULL function pointer of type <a href="phdaudio_unsolicited_response_callback" title="PHDAUDIO_UNSOLICITED_RESPONSE_CALLBACK PhdaudioUnsolicitedResponseCallback;&#10;&#10;VOID PhdaudioUnsolicitedResponseCallback(&#10;  HDAUDIO_CODEC_RESPONSE unnamedParam1,&#10;  PVOID unnamedParam2&#10;)&#10;{...}">PHDAUDIO_UNSOLICITED_RESPONSE_CALLBACK</a>. For more information, see the following Remarks section.</p>

<h3 id="context-in"><code>Context</code> [in]</h3>

<p>Specifies a context value for the callback routine. The caller casts the context value to type PVOID. When a codec generates an unsolicited response that contains the specified tag, the HD Audio bus driver passes the context value to the callback routine as a call parameter.</p>

<h3 id="tag-out"><code>Tag</code> [out]</h3>

<p>Retrieves a tag value that identifies the unsolicited response. This parameter points to a caller-allocated <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> variable into which the routine writes the tag value. The caller should specify this tag value when programming the codec or codecs to generate the unsolicited response. For more information, see the following Remarks section.</p>

<h2 id="return-value">Return value</h2>

<p><em>RegisterEventCallback</em> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the call succeeds in registering the event. Otherwise, the routine returns an appropriate error code. The following table shows a possible return status code.</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>STATUS_INSUFFICIENT_RESOURCES</strong></td>
  <td>Indicates that not enough resources are available to complete the operation.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>This routine registers a callback routine for an unsolicited response from a codec. The routine outputs a tag to identify the unsolicited response. When the HD Audio bus driver encounters an unsolicited response from any codec with a matching tag value, the routine calls the specified callback routine at IRQL DISPATCH_LEVEL and passes the specified context value to the routine as a call parameter.</p>

<p>Following the call to <em>RegisterEventCallback</em>, the function driver is responsible for programming the codec or codecs to generate unsolicited responses with the specified tag.</p>

<p>The routine assigns a unique tag to each registered callback routine. The unique association between tag and callback routine persists as long as the callback routine remains registered. The function driver can delete the registration of a callback routine by calling <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/hdaudio/nc-hdaudio-punregister_event_callback">UnregisterEventCallback</a>.</p>

<p>Currently, the bus driver can supply up to 64 unique tags per codec.</p>

<p>The callback parameter is a function pointer to a callback routine in the function driver. The function pointer type for the callback routine is defined as:</p>

<div class="codehilite">
<pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="n">VOID</span>
<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n"><a href="phdaudio_unsolicited_response_callback" title="PHDAUDIO_UNSOLICITED_RESPONSE_CALLBACK PhdaudioUnsolicitedResponseCallback;&#10;&#10;VOID PhdaudioUnsolicitedResponseCallback(&#10;  HDAUDIO_CODEC_RESPONSE unnamedParam1,&#10;  PVOID unnamedParam2&#10;)&#10;{...}">PHDAUDIO_UNSOLICITED_RESPONSE_CALLBACK</a></span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="n"><a href="hdaudio_codec_response" title="typedef struct _HDAUDIO_CODEC_RESPONSE {&#10;  union {&#10;    struct {&#10;      union {&#10;        struct {&#10;          ULONG Response : 21;&#10;          ULONG SubTag : 5;&#10;          ULONG Tag : 6;&#10;        } Unsolicited;&#10;        ULONG Response;&#10;      };&#10;      ULONG SDataIn : 4;&#10;      ULONG IsUnsolicitedResponse : 1;&#10;      ULONG HasFifoOverrun : 1;&#10;      ULONG IsValid : 1;&#10;    };&#10;    ULONGLONG CompleteResponse;&#10;  };&#10;} HDAUDIO_CODEC_RESPONSE, *PHDAUDIO_CODEC_RESPONSE;">HDAUDIO_CODEC_RESPONSE</a></span><span class="p">,</span><span class="w"> </span><span class="n">PVOID</span><span class="p">);</span>
</code></pre>
</div>

<p>The first call parameter is a structure of type <a href="hdaudio_codec_response" title="typedef struct _HDAUDIO_CODEC_RESPONSE {&#10;  union {&#10;    struct {&#10;      union {&#10;        struct {&#10;          ULONG Response : 21;&#10;          ULONG SubTag : 5;&#10;          ULONG Tag : 6;&#10;        } Unsolicited;&#10;        ULONG Response;&#10;      };&#10;      ULONG SDataIn : 4;&#10;      ULONG IsUnsolicitedResponse : 1;&#10;      ULONG HasFifoOverrun : 1;&#10;      ULONG IsValid : 1;&#10;    };&#10;    ULONGLONG CompleteResponse;&#10;  };&#10;} HDAUDIO_CODEC_RESPONSE, *PHDAUDIO_CODEC_RESPONSE;">HDAUDIO_CODEC_RESPONSE</a> that specifies the codec's response to the command. This structure is passed by value. The second call parameter is the <em>callbackContext</em> value that was passed previously to <em>RegisterEventCallback</em>. The HD Audio bus driver calls the callback routine at IRQL DISPATCH_LEVEL.</p>

<h2 id="see-also">See also</h2>

<p><a href="hdaudio_bus_interface" title="typedef struct _HDAUDIO_BUS_INTERFACE {&#10;  USHORT                       Size;&#10;  USHORT                       Version;&#10;  PVOID                        Context;&#10;  PINTERFACE_REFERENCE         InterfaceReference;&#10;  PINTERFACE_DEREFERENCE       InterfaceDereference;&#10;  PTRANSFER_CODEC_VERBS        TransferCodecVerbs;&#10;  PALLOCATE_CAPTURE_DMA_ENGINE AllocateCaptureDmaEngine;&#10;  PALLOCATE_RENDER_DMA_ENGINE  AllocateRenderDmaEngine;&#10;  PCHANGE_BANDWIDTH_ALLOCATION ChangeBandwidthAllocation;&#10;  PALLOCATE_DMA_BUFFER         AllocateDmaBuffer;&#10;  PFREE_DMA_BUFFER             FreeDmaBuffer;&#10;  PFREE_DMA_ENGINE             FreeDmaEngine;&#10;  PSET_DMA_ENGINE_STATE        SetDmaEngineState;&#10;  PGET_WALL_CLOCK_REGISTER     GetWallClockRegister;&#10;  PGET_LINK_POSITION_REGISTER  GetLinkPositionRegister;&#10;  PREGISTER_EVENT_CALLBACK     RegisterEventCallback;&#10;  PUNREGISTER_EVENT_CALLBACK   UnregisterEventCallback;&#10;  PGET_DEVICE_INFORMATION      GetDeviceInformation;&#10;  PGET_RESOURCE_INFORMATION    GetResourceInformation;&#10;...">HDAUDIO_BUS_INTERFACE</a></p>

<p><a href="hdaudio_bus_interface_bdl" title="typedef struct _HDAUDIO_BUS_INTERFACE_BDL {&#10;  USHORT                          Size;&#10;  USHORT                          Version;&#10;  PVOID                           Context;&#10;  PINTERFACE_REFERENCE            InterfaceReference;&#10;  PINTERFACE_DEREFERENCE          InterfaceDereference;&#10;  PTRANSFER_CODEC_VERBS           TransferCodecVerbs;&#10;  PALLOCATE_CAPTURE_DMA_ENGINE    AllocateCaptureDmaEngine;&#10;  PALLOCATE_RENDER_DMA_ENGINE     AllocateRenderDmaEngine;&#10;  PCHANGE_BANDWIDTH_ALLOCATION    ChangeBandwidthAllocation;&#10;  PALLOCATE_CONTIGUOUS_DMA_BUFFER AllocateContiguousDmaBuffer;&#10;  PSETUP_DMA_ENGINE_WITH_BDL      SetupDmaEngineWithBdl;&#10;  PFREE_CONTIGUOUS_DMA_BUFFER     FreeContiguousDmaBuffer;&#10;  PFREE_DMA_ENGINE                FreeDmaEngine;&#10;  PSET_DMA_ENGINE_STATE           SetDmaEngineState;&#10;  PGET_WALL_CLOCK_REGISTER        GetWallClockRegister;&#10;  PGET_LINK_POSITION_REGISTER     GetLinkPositionRegister;&#10;  PREGISTER_EVENT_CALLBACK        RegisterEventCallback;&#10;  PUNREGISTER_EVENT_CALLBACK      UnregisterEventCallback;&#10;  PGET_DEVICE_INFORMATION         GetDeviceInformation;&#10;...">HDAUDIO_BUS_INTERFACE_BDL</a></p>

<p><a href="hdaudio_bus_interface_v2" title="typedef struct _HDAUDIO_BUS_INTERFACE_V2 {&#10;  USHORT                                 Size;&#10;  USHORT                                 Version;&#10;  PVOID                                  Context;&#10;  PINTERFACE_REFERENCE                   InterfaceReference;&#10;  PINTERFACE_DEREFERENCE                 InterfaceDereference;&#10;  PTRANSFER_CODEC_VERBS                  TransferCodecVerbs;&#10;  PALLOCATE_CAPTURE_DMA_ENGINE           AllocateCaptureDmaEngine;&#10;  PALLOCATE_RENDER_DMA_ENGINE            AllocateRenderDmaEngine;&#10;  PCHANGE_BANDWIDTH_ALLOCATION           ChangeBandwidthAllocation;&#10;  PALLOCATE_DMA_BUFFER                   AllocateDmaBuffer;&#10;  PFREE_DMA_BUFFER                       FreeDmaBuffer;&#10;  PFREE_DMA_ENGINE                       FreeDmaEngine;&#10;  PSET_DMA_ENGINE_STATE                  SetDmaEngineState;&#10;  PGET_WALL_CLOCK_REGISTER               GetWallClockRegister;&#10;  PGET_LINK_POSITION_REGISTER            GetLinkPositionRegister;&#10;  PREGISTER_EVENT_CALLBACK               RegisterEventCallback;&#10;  PUNREGISTER_EVENT_CALLBACK             UnregisterEventCallback;&#10;  PGET_DEVICE_INFORMATION                GetDeviceInformation;&#10;  PGET_RESOURCE_INFORMATION              GetResourceInformation;&#10;...">HDAUDIO_BUS_INTERFACE_V2</a></p>

<p><a href="hdaudio_codec_response" title="typedef struct _HDAUDIO_CODEC_RESPONSE {&#10;  union {&#10;    struct {&#10;      union {&#10;        struct {&#10;          ULONG Response : 21;&#10;          ULONG SubTag : 5;&#10;          ULONG Tag : 6;&#10;        } Unsolicited;&#10;        ULONG Response;&#10;      };&#10;      ULONG SDataIn : 4;&#10;      ULONG IsUnsolicitedResponse : 1;&#10;      ULONG HasFifoOverrun : 1;&#10;      ULONG IsValid : 1;&#10;    };&#10;    ULONGLONG CompleteResponse;&#10;  };&#10;} HDAUDIO_CODEC_RESPONSE, *PHDAUDIO_CODEC_RESPONSE;">HDAUDIO_CODEC_RESPONSE</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/hdaudio/nc-hdaudio-punregister_event_callback">UnregisterEventCallback</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/hdaudio/">hdaudio.h</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/hdaudio/nc-hdaudio-pregister_event_callback">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/hdaudio/nc-hdaudio-pregister_event_callback.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
