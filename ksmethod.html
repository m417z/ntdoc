<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="KSMETHOD - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>KSMETHOD - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            KSMETHOD - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ks.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">struct KSMETHOD {
  GUID Set;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Id;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Flags;
};</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ksmethod-structure">View the official Windows hardware development documentation</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ksmethod.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows hardware development documentation (ksmethod-structure)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="ksmethod-structure">KSMETHOD structure</h1>

<p>The <strong>KSMETHOD</strong> structure specifies a single kernel streaming method within a method set.</p>

<p>The <strong><a href="ksevent" title="struct KSEVENT {&#10;  GUID Set;&#10;  ULONG Id;&#10;  ULONG Flags;&#10;};">KSEVENT</a></strong>, <strong>KSMETHOD</strong>, and <strong><a href="ksproperty" title="struct KSPROPERTY {&#10;  GUID Set;&#10;  ULONG Id;&#10;  ULONG Flags;&#10;};">KSPROPERTY</a></strong> structures are aliases for the <strong><a href="ksidentifier" title="typedef struct {&#10;  union {&#10;    struct {&#10;      GUID  Set;&#10;      ULONG Id;&#10;      ULONG Flags;&#10;    } _IDENTIFIER;&#10;    struct {&#10;      GUID  Set;&#10;      ULONG Id;&#10;      ULONG Flags;&#10;    };&#10;    LONGLONG Alignment;&#10;  };&#10;} KSIDENTIFIER, *PKSIDENTIFIER;">KSIDENTIFIER</a></strong> structure. As such, their definitions are identical.</p>

<h2 id="members">Members</h2>

<p><code>Set</code></p>

<p>Specifies a GUID that identifies a kernel streaming method set.</p>

<p>For more information about method set GUIDs, see the <strong>Remarks</strong> section below.</p>

<p><code>Id</code></p>

<p>Specifies the member of the method set.</p>

<p><code>Flags</code></p>

<p>Specifies the request type. Also, see the <em>KSMETHOD_TYPE_Xxx</em> flags for <strong><a href="ksmethod_item" title="typedef struct {&#10;  ULONG        MethodId;&#10;  union {&#10;    PFNKSHANDLER MethodHandler;&#10;    BOOLEAN      MethodSupported;&#10;  };&#10;  ULONG        MinMethod;&#10;  ULONG        MinData;&#10;  PFNKSHANDLER SupportHandler;&#10;  ULONG        Flags;&#10;} KSMETHOD_ITEM, *PKSMETHOD_ITEM;">KSMETHOD_ITEM</a></strong>).</p>

<p>A request can contain a combination of the values listed in the following table.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Type of method request</th>
</tr>
</thead>
<tbody>
<tr>
  <td>KSMETHOD_TYPE_BASICSUPPORT</td>
  <td>Indicates to query the minidriver to determine if it supports the specified method of the method set.</td>
</tr>
<tr>
  <td>KSMETHOD_TYPE_SEND</td>
  <td>Indicates that the minidriver should execute the specified method. The effect of the method on the given parameters must be known to the client, that is, whether the parameters are read from, written to, both, or neither. The minidriver uses the <strong><a href="ksmethod_item" title="typedef struct {&#10;  ULONG        MethodId;&#10;  union {&#10;    PFNKSHANDLER MethodHandler;&#10;    BOOLEAN      MethodSupported;&#10;  };&#10;  ULONG        MinMethod;&#10;  ULONG        MinData;&#10;  PFNKSHANDLER SupportHandler;&#10;  ULONG        Flags;&#10;} KSMETHOD_ITEM, *PKSMETHOD_ITEM;">KSMETHOD_ITEM</a></strong> structure to specify the method's effect on the parameters.</td>
</tr>
<tr>
  <td>KSMETHOD_TYPE_SETSUPPORT</td>
  <td>Indicates to query the minidriver to determine if it supports the specified method set.</td>
</tr>
<tr>
  <td>KSMETHOD_TYPE_TOPOLOGY</td>
  <td>Indicates that the specified method is of type <strong><a href="ksm_node" title="typedef struct {&#10;  KSMETHOD Method;&#10;  ULONG    NodeId;&#10;  ULONG    Reserved;&#10;} KSM_NODE, *PKSM_NODE;">KSM_NODE</a></strong>, where the <strong>NodeId</strong> member is the identifier of the topology node. Do not set this flag on its own; instead, OR it with other flags from this list.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>Microsoft provides several system-defined method set GUIDs. Minidrivers specify one of these GUIDs in the <strong>Set</strong> member. Kernel streaming method sets typically begin with a <em>KSMETHODSETID</em> prefix. Kernel streaming method sets are defined in <em>ks.h</em>, <em>ksmedia.h</em>, <em>bdamedia.h</em>, and possibly other header files.</p>

<p>For more information about kernel streaming events, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ks-properties--events--and-methods">KS Properties, Events, and Methods</a>.</p>

<p>A client can use the <a href="ioctl_ks_method" title="// CTL_CODE(0x002f, 0x003, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define IOCTL_KS_METHOD 0x002F000F">IOCTL_KS_METHOD</a> request along with the KSMETHOD structure to execute methods on a kernel streaming object that the minidriver handles. For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ks-methods">KS Methods</a>.</p>

<h2 id="requirements">Requirements</h2>

<p><strong>Header:</strong> ks.h (include Ks.h)</p>

<h2 id="see-also">See also</h2>

<p><strong><a href="ksevent" title="struct KSEVENT {&#10;  GUID Set;&#10;  ULONG Id;&#10;  ULONG Flags;&#10;};">KSEVENT</a></strong></p>

<p><strong><a href="ksproperty" title="struct KSPROPERTY {&#10;  GUID Set;&#10;  ULONG Id;&#10;  ULONG Flags;&#10;};">KSPROPERTY</a></strong></p>

<p><strong><a href="ksidentifier" title="typedef struct {&#10;  union {&#10;    struct {&#10;      GUID  Set;&#10;      ULONG Id;&#10;      ULONG Flags;&#10;    } _IDENTIFIER;&#10;    struct {&#10;      GUID  Set;&#10;      ULONG Id;&#10;      ULONG Flags;&#10;    };&#10;    LONGLONG Alignment;&#10;  };&#10;} KSIDENTIFIER, *PKSIDENTIFIER;">KSIDENTIFIER</a></strong></p>

<p><strong><a href="ksmethod_item" title="typedef struct {&#10;  ULONG        MethodId;&#10;  union {&#10;    PFNKSHANDLER MethodHandler;&#10;    BOOLEAN      MethodSupported;&#10;  };&#10;  ULONG        MinMethod;&#10;  ULONG        MinData;&#10;  PFNKSHANDLER SupportHandler;&#10;  ULONG        Flags;&#10;} KSMETHOD_ITEM, *PKSMETHOD_ITEM;">KSMETHOD_ITEM</a></strong></p>

<p><strong><a href="kse_node" title="typedef struct {&#10;  KSEVENT Event;&#10;  ULONG   NodeId;&#10;  ULONG   Reserved;&#10;} KSE_NODE, *PKSE_NODE;">KSE_NODE</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ksmethod-structure">View the official Windows hardware development documentation</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs/blob/staging/windows-driver-docs-pr/stream/ksmethod-structure.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
