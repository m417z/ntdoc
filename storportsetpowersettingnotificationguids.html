<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="StorPortSetPowerSettingNotificationGuids - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>StorPortSetPowerSettingNotificationGuids - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            StorPortSetPowerSettingNotificationGuids - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// storport.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> StorPortSetPowerSettingNotificationGuids(
  [in] PVOID  HwDeviceExtension,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  GuidCount,
  [in] LPGUID Guid
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/storport/nf-storport-storportsetpowersettingnotificationguids">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/storportsetpowersettingnotificationguids.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-storport-storportsetpowersettingnotificationguids)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="storportsetpowersettingnotificationguids-function">StorPortSetPowerSettingNotificationGuids function</h1>

<h2 id="description">Description</h2>

<p>The <strong>StorPortSetPowerSettingNotificationGuids</strong> routine enables a miniport to receive power setting notifications. The miniport registers an array of GUIDs which identify the power settings to receive power change notifications for.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="hwdeviceextension-in"><code>HwDeviceExtension</code> [in]</h3>

<p>A pointer to the hardware device extension for the host bus adapter (HBA).</p>

<h3 id="guidcount-in"><code>GuidCount</code> [in]</h3>

<p>The number of GUIDs in the <em>Guid</em> array.</p>

<h3 id="guid-in"><code>Guid</code> [in]</h3>

<p>An array of power setting GUIDs to register for notification. A typical use for registering these GUIDs is for SATA miniports to receive notifications for AHCI Link Power Management setting changes. The AHCI Link Power Management settings defined by the Microsoft AHCI StorPort miniport driver are the following.</p>

<h4 id="hipmdipm-setting-0b2d69d7-a2a1-449c-9680-f91c70521c60">HIPM/DIPM Setting (0b2d69d7-a2a1-449c-9680-f91c70521c60)</h4>

<p>Configures the link power management mode for disk and storage devices that are attached to the system through an AHCI interface.</p>

<table>
<thead>
<tr>
  <th>Index</th>
  <th>Name</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>0</td>
  <td>Active</td>
  <td>Link power management is not used.</td>
</tr>
<tr>
  <td>1</td>
  <td>HIPM</td>
  <td>Host-Initiated Power Management (HIPM) is used.</td>
</tr>
<tr>
  <td>2</td>
  <td>HIPM and DIPM</td>
  <td>HIPM and Device-Initiated Power Management (DIPM) are used.</td>
</tr>
</tbody>
</table>

<h4 id="adaptive-setting-dab60367-53fe-4fbc-825e-521d069d2456">Adaptive Setting (dab60367-53fe-4fbc-825e-521d069d2456)</h4>

<p>The period of AHCI link idle time before the link is put into a slumber state when HIPM or DIPM is enabled.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>0</td>
  <td>Minimum value in milliseconds (only use Partial state).</td>
</tr>
<tr>
  <td>...</td>
  <td>Any intermediate value.</td>
</tr>
<tr>
  <td>300000</td>
  <td>Maximum value in milliseconds (5 minutes).</td>
</tr>
</tbody>
</table>

<p>Other miniports may define and register their own power setting GUIDs.</p>

<h2 id="return-value">Return value</h2>

<p>The <strong>StorPortSetPowerSettingNotificationGuids</strong> routine returns one of these status codes:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>STOR_STATUS_INSUFFICIENT_RESOURCES</strong></td>
  <td>Insufficient resources are available to register for notifications.</td>
</tr>
<tr>
  <td><strong>STOR_STATUS_SUCCESS</strong></td>
  <td>The notification GUIDs were registered successfully.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>A miniport calls <strong>StorPortSetPowerSettingNotificationGuids</strong> in its <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/storport/nc-storport-hw_find_adapter">HwStorFindAdapter</a> routine to register the GUIDs it requests to receive notifications for.</p>

<p>When a power state change occurs for a registered notification, the miniport is notified in its <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/storport/nc-storport-hw_adapter_control">HwStorAdapterControl</a> routine. The control type of <strong>ScsiPowerSettingNotification</strong> is set in the <em>ControlType</em> parameter.</p>

<p>The AHCI Link Power management settings are part of the Disk Settings subgroup (0012ee47-9041-4b5d-9b77-535fba8b1442) in the power policy configuration. These are managed under the SUB_DISK configuration alias with <em>powercfg.exe</em>.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/storport/nc-storport-hw_adapter_control">HwStorAdapterControl</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/storport/nc-storport-hw_find_adapter">HwStorFindAdapter</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/storport/nf-storport-storportsetpowersettingnotificationguids">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/storport/nf-storport-storportsetpowersettingnotificationguids.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
