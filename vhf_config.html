<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="VHF_CONFIG - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>VHF_CONFIG - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            VHF_CONFIG - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// vhf.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _VHF_CONFIG {

    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                               Size;

    PVOID                               VhfClientContext;

    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                               OperationContextSize;

#ifdef _KERNEL_MODE
    <a href="device_object" title="typedef struct _DEVICE_OBJECT {&#10;  CSHORT                   Type;&#10;  USHORT                   Size;&#10;  LONG                     ReferenceCount;&#10;  struct _DRIVER_OBJECT    *DriverObject;&#10;  struct _DEVICE_OBJECT    *NextDevice;&#10;  struct _DEVICE_OBJECT    *AttachedDevice;&#10;  struct _IRP              *CurrentIrp;&#10;  PIO_TIMER                Timer;&#10;  ULONG                    Flags;&#10;  ULONG                    Characteristics;&#10;  __volatile PVPB          Vpb;&#10;  PVOID                    DeviceExtension;&#10;  DEVICE_TYPE              DeviceType;&#10;  CCHAR                    StackSize;&#10;  union {&#10;    LIST_ENTRY         ListEntry;&#10;    WAIT_CONTEXT_BLOCK Wcb;&#10;  } Queue;&#10;  ULONG                    AlignmentRequirement;&#10;...">PDEVICE_OBJECT</a>                      DeviceObject;
#else
    HANDLE                              FileHandle;
#endif

    <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>                              VendorID;
    <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>                              ProductID;
    <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>                              VersionNumber;

    GUID                                ContainerID;

    <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>                              InstanceIDLength;
    _Field_size_bytes_full_(InstanceIDLength)   
    PWSTR                               InstanceID;

    <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>                              ReportDescriptorLength;
    _Field_size_full_(ReportDescriptorLength)
    PUCHAR                              ReportDescriptor;

    PEVT_VHF_READY_FOR_NEXT_READ_REPORT EvtVhfReadyForNextReadReport;
    PEVT_VHF_ASYNC_OPERATION            EvtVhfAsyncOperationGetFeature;
    PEVT_VHF_ASYNC_OPERATION            EvtVhfAsyncOperationSetFeature;
    PEVT_VHF_ASYNC_OPERATION            EvtVhfAsyncOperationWriteReport;
    PEVT_VHF_ASYNC_OPERATION            EvtVhfAsyncOperationGetInputReport;
    PEVT_VHF_CLEANUP                    EvtVhfCleanup;

    <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>                              HardwareIDsLength;
    _Field_size_bytes_full_(HardwareIDsLength)
    PWSTR                               HardwareIDs;

} VHF_CONFIG, *PVHF_CONFIG;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/vhf/ns-vhf-_vhf_config">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/vhf_config.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-vhf-_vhf_config)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_vhf_config-structure">_VHF_CONFIG structure</h1>

<h2 id="description">Description</h2>

<p>Contains initial configuration information that is provided by the HID source driver when it calls <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/vhf/nf-vhf-vhfcreate">VhfCreate</a> to create a virtual HID device.</p>

<h2 id="syntax">Syntax</h2>

<p><!-- CODE_MARKER --></p>

<div class="codehilite">
<pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">_VHF_CONFIG</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n"><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></span><span class="w">                               </span><span class="n">Size</span><span class="p">;</span>

<span class="w">    </span><span class="n">PVOID</span><span class="w">                               </span><span class="n">VhfClientContext</span><span class="p">;</span>

<span class="w">    </span><span class="n"><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></span><span class="w">                               </span><span class="n">OperationContextSize</span><span class="p">;</span>

<span class="cp">#ifdef _KERNEL_MODE</span>
<span class="w">    </span><span class="n"><a href="device_object" title="typedef struct _DEVICE_OBJECT {&#10;  CSHORT                   Type;&#10;  USHORT                   Size;&#10;  LONG                     ReferenceCount;&#10;  struct _DRIVER_OBJECT    *DriverObject;&#10;  struct _DEVICE_OBJECT    *NextDevice;&#10;  struct _DEVICE_OBJECT    *AttachedDevice;&#10;  struct _IRP              *CurrentIrp;&#10;  PIO_TIMER                Timer;&#10;  ULONG                    Flags;&#10;  ULONG                    Characteristics;&#10;  __volatile PVPB          Vpb;&#10;  PVOID                    DeviceExtension;&#10;  DEVICE_TYPE              DeviceType;&#10;  CCHAR                    StackSize;&#10;  union {&#10;    LIST_ENTRY         ListEntry;&#10;    WAIT_CONTEXT_BLOCK Wcb;&#10;  } Queue;&#10;  ULONG                    AlignmentRequirement;&#10;...">PDEVICE_OBJECT</a></span><span class="w">                      </span><span class="n">DeviceObject</span><span class="p">;</span>
<span class="cp">#else</span>
<span class="w">    </span><span class="n">HANDLE</span><span class="w">                              </span><span class="n">FileHandle</span><span class="p">;</span>
<span class="cp">#endif</span>

<span class="w">    </span><span class="n"><a href="ushort" title="typedef unsigned short USHORT;">USHORT</a></span><span class="w">                              </span><span class="n">VendorID</span><span class="p">;</span>
<span class="w">    </span><span class="n"><a href="ushort" title="typedef unsigned short USHORT;">USHORT</a></span><span class="w">                              </span><span class="n">ProductID</span><span class="p">;</span>
<span class="w">    </span><span class="n"><a href="ushort" title="typedef unsigned short USHORT;">USHORT</a></span><span class="w">                              </span><span class="n">VersionNumber</span><span class="p">;</span>

<span class="w">    </span><span class="n">GUID</span><span class="w">                                </span><span class="n">ContainerID</span><span class="p">;</span>

<span class="w">    </span><span class="n"><a href="ushort" title="typedef unsigned short USHORT;">USHORT</a></span><span class="w">                              </span><span class="n">InstanceIDLength</span><span class="p">;</span>
<span class="w">    </span><span class="n">_Field_size_bytes_full_</span><span class="p">(</span><span class="n">InstanceIDLength</span><span class="p">)</span>
<span class="w">    </span><span class="n">PWSTR</span><span class="w">                               </span><span class="n">InstanceID</span><span class="p">;</span>

<span class="w">    </span><span class="n"><a href="ushort" title="typedef unsigned short USHORT;">USHORT</a></span><span class="w">                              </span><span class="n">ReportDescriptorLength</span><span class="p">;</span>
<span class="w">    </span><span class="n">_Field_size_full_</span><span class="p">(</span><span class="n">ReportDescriptorLength</span><span class="p">)</span>
<span class="w">    </span><span class="n">PUCHAR</span><span class="w">                              </span><span class="n">ReportDescriptor</span><span class="p">;</span>

<span class="w">    </span><span class="n">PEVT_VHF_READY_FOR_NEXT_READ_REPORT</span><span class="w"> </span><span class="n">EvtVhfReadyForNextReadReport</span><span class="p">;</span>
<span class="w">    </span><span class="n">PEVT_VHF_ASYNC_OPERATION</span><span class="w">            </span><span class="n">EvtVhfAsyncOperationGetFeature</span><span class="p">;</span>
<span class="w">    </span><span class="n">PEVT_VHF_ASYNC_OPERATION</span><span class="w">            </span><span class="n">EvtVhfAsyncOperationSetFeature</span><span class="p">;</span>
<span class="w">    </span><span class="n">PEVT_VHF_ASYNC_OPERATION</span><span class="w">            </span><span class="n">EvtVhfAsyncOperationWriteReport</span><span class="p">;</span>
<span class="w">    </span><span class="n">PEVT_VHF_ASYNC_OPERATION</span><span class="w">            </span><span class="n">EvtVhfAsyncOperationGetInputReport</span><span class="p">;</span>
<span class="w">    </span><span class="n">PEVT_VHF_CLEANUP</span><span class="w">                    </span><span class="n">EvtVhfCleanup</span><span class="p">;</span>

<span class="w">    </span><span class="n"><a href="ushort" title="typedef unsigned short USHORT;">USHORT</a></span><span class="w">                              </span><span class="n">HardwareIDsLength</span><span class="p">;</span>
<span class="w">    </span><span class="n">_Field_size_bytes_full_</span><span class="p">(</span><span class="n">HardwareIDsLength</span><span class="p">)</span>
<span class="w">    </span><span class="n">PWSTR</span><span class="w">                               </span><span class="n">HardwareIDs</span><span class="p">;</span>

<span class="p">}</span><span class="w"> </span><span class="n">VHF_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">PVHF_CONFIG</span><span class="p">;</span>
</code></pre>
</div>

<h2 id="members">Members</h2>

<h3 id="size"><code>Size</code></h3>

<p>Required. Size of this structure initialized by <a href="vhf_config_init" title="FORCEINLINE&#10;VOID&#10;VHF_CONFIG_INIT(&#10;    _Out_&#10;        PVHF_CONFIG     Config,&#10;#ifdef _KERNEL_MODE&#10;    _In_&#10;        PDEVICE_OBJECT  DeviceObject,&#10;#else&#10;    _In_&#10;        HANDLE          FileHandle,&#10;#endif&#10;    _In_&#10;        USHORT          ReportDescriptorLength,&#10;    _In_reads_bytes_(ReportDescriptorLength)&#10;        PUCHAR          ReportDescriptor    &#10;    )">VHF_CONFIG_INIT</a>.</p>

<h3 id="vhfclientcontext"><code>VhfClientContext</code></h3>

<p>Optional. An opaque pointer to HID source driver-allocated memory that the Virtual HID Framework (VHF) passes when it invokes those callback functions.</p>

<h3 id="operationcontextsize"><code>OperationContextSize</code></h3>

<p>Optional. Size of the buffer that VHF must allocate for an asynchronous operation started by <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/vhf/nc-vhf-evt_vhf_async_operation">EvtVhfAsyncOperation</a>. If non-zero, VHF allocates a buffer of this size and passes a pointer to that buffer in the <em>VhfOperationContext</em> parameter each time it invokes <em>EvtVhfAsyncOperation</em> to start a new operation.</p>

<h3 id="deviceobject"><code>DeviceObject</code></h3>

<p>Required for kernel-mode drivers. A pointer to the <a href="device_object" title="typedef struct _DEVICE_OBJECT {&#10;  CSHORT                   Type;&#10;  USHORT                   Size;&#10;  LONG                     ReferenceCount;&#10;  struct _DRIVER_OBJECT    *DriverObject;&#10;  struct _DEVICE_OBJECT    *NextDevice;&#10;  struct _DEVICE_OBJECT    *AttachedDevice;&#10;  struct _IRP              *CurrentIrp;&#10;  PIO_TIMER                Timer;&#10;  ULONG                    Flags;&#10;  ULONG                    Characteristics;&#10;  __volatile PVPB          Vpb;&#10;  PVOID                    DeviceExtension;&#10;  DEVICE_TYPE              DeviceType;&#10;  CCHAR                    StackSize;&#10;  union {&#10;    LIST_ENTRY         ListEntry;&#10;    WAIT_CONTEXT_BLOCK Wcb;&#10;  } Queue;&#10;  ULONG                    AlignmentRequirement;&#10;...">DEVICE_OBJECT</a> structure for the HID source driver. Get that pointer by calling <a href="wdfdevicewdmgetdeviceobject" title="PDEVICE_OBJECT WdfDeviceWdmGetDeviceObject(&#10;  WDFDEVICE Device&#10;);">WdfDeviceWdmGetDeviceObject</a> and passing the WDFDEVICE handle that the driver received in the <a href="wdfdevicecreate" title="NTSTATUS WdfDeviceCreate(&#10;  [in, out]      PWDFDEVICE_INIT        *DeviceInit,&#10;  [in, optional] PWDF_OBJECT_ATTRIBUTES DeviceAttributes,&#10;  [out]          WDFDEVICE              *Device&#10;);">WdfDeviceCreate</a> call.</p>

<h3 id="filehandle"><code>FileHandle</code></h3>

<p>Required for user-mode drivers. A file handle obtained by calling <strong><a href="wdfiotargetwdmgettargetfilehandle" title="HANDLE WdfIoTargetWdmGetTargetFileHandle(&#10;  [in] WDFIOTARGET IoTarget&#10;);">WdfIoTargetWdmGetTargetFileHandle</a></strong>.
To open a WDFIOTARGET, a user-mode (UMDF) VHF source driver should call <strong><a href="wdfiotargetopen" title="NTSTATUS WdfIoTargetOpen(&#10;  [in] WDFIOTARGET                IoTarget,&#10;  [in] PWDF_IO_TARGET_OPEN_PARAMS OpenParams&#10;);">WdfIoTargetOpen</a></strong> with <strong>OpenParams.Type</strong> set
to <strong>WdfIoTargetOpenLocalTargetByFile</strong>.</p>

<h3 id="vendorid"><code>VendorID</code></h3>

<p>Optional. Vendor ID of the virtual HID device to be created.</p>

<h3 id="productid"><code>ProductID</code></h3>

<p>Optional. Product ID of the virtual HID device to be created.</p>

<h3 id="versionnumber"><code>VersionNumber</code></h3>

<p>Optional. Version number of the virtual HID device to be created.</p>

<h3 id="containerid"><code>ContainerID</code></h3>

<p>Optional. Container ID of the virtual HID device to be created.</p>

<h3 id="instanceidlength"><code>InstanceIDLength</code></h3>

<h3 id="instanceid"><code>InstanceID</code></h3>

<h3 id="reportdescriptorlength"><code>ReportDescriptorLength</code></h3>

<p>Required. The length of the HID Report Descriptor contained in a buffer pointed by <strong>ReportDescriptor</strong>.</p>

<h3 id="reportdescriptor"><code>ReportDescriptor</code></h3>

<p>Required. A pointer to a HID source driver-allocated buffer that contains the HID Report Descriptor.</p>

<h3 id="evtvhfreadyfornextreadreport"><code>EvtVhfReadyForNextReadReport</code></h3>

<p>Optional. A pointer to an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/vhf/nc-vhf-evt_vhf_ready_for_next_read_report">EvtVhfReadyForNextReadReport</a> callback. The HID source driver must implement and register this callback function if it wants to handle the buffering policy for submitting HID Input Reports. If this callback is specified, VHF does not buffer those reports. The HID source driver should submit one report by calling <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/vhf/nf-vhf-vhfreadreportsubmit">VhfReadReportSubmit</a>, each time VHF invokes <em>EvtVhfReadyForNextReadReport</em>.</p>

<h3 id="evtvhfasyncoperationgetfeature"><code>EvtVhfAsyncOperationGetFeature</code></h3>

<p>Optional. A pointer to an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/vhf/nc-vhf-evt_vhf_async_operation">EvtVhfAsyncOperation</a> callback. The HID source driver must implement and register this callback function if it wants to a get a HID Feature Report associated with a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/hid/top-level-collections">Top-Level Collection</a> from the HID class driver pair.
The driver can get a Feature Report only if the Report Descriptor declares it.</p>

<h3 id="evtvhfasyncoperationsetfeature"><code>EvtVhfAsyncOperationSetFeature</code></h3>

<p>Optional. A pointer to an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/vhf/nc-vhf-evt_vhf_async_operation">EvtVhfAsyncOperation</a> callback. The HID source driver must implement and register this callback function if it wants to a send a HID Feature Report associated with a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/hid/top-level-collections">Top-Level Collection</a> to the HID class driver pair. The driver can set a Feature Report only if the Report Descriptor declares it.</p>

<h3 id="evtvhfasyncoperationwritereport"><code>EvtVhfAsyncOperationWriteReport</code></h3>

<p>Optional. A pointer to an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/vhf/nc-vhf-evt_vhf_async_operation">EvtVhfAsyncOperation</a> callback. The HID source driver must implement and register this callback function if it wants to a support HID Output Reports and send them to the HID class driver pair.</p>

<h3 id="evtvhfasyncoperationgetinputreport"><code>EvtVhfAsyncOperationGetInputReport</code></h3>

<p>Optional. A pointer to an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/vhf/nc-vhf-evt_vhf_async_operation">EvtVhfAsyncOperation</a> callback. The HID source driver must implement and register this callback function if it wants to support on-demand query for Input Reports.</p>

<h3 id="evtvhfcleanup"><code>EvtVhfCleanup</code></h3>

<p>Optional. A pointer to a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/vhf/nc-vhf-evt_vhf_cleanup">EvtVhfCleanup</a> callback. The HID source driver can implement and register this callback function if it wants to free the allocated resources for the virtual HID device.</p>

<h3 id="hardwareidslength"><code>HardwareIDsLength</code></h3>

<h3 id="hardwareids"><code>HardwareIDs</code></h3>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/hid/virtual-hid-framework--vhf-">Write a HID source driver by using Virtual HID Framework (VHF)</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/vhf/ns-vhf-_vhf_config">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/vhf/ns-vhf-_vhf_config.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
