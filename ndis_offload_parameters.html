<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NDIS_OFFLOAD_PARAMETERS - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NDIS_OFFLOAD_PARAMETERS - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NDIS_OFFLOAD_PARAMETERS - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _NDIS_OFFLOAD_PARAMETERS {
  <a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a>                 Header;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>                              IPv4Checksum;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>                              TCPIPv4Checksum;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>                              UDPIPv4Checksum;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>                              TCPIPv6Checksum;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>                              UDPIPv6Checksum;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>                              LsoV1;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>                              IPsecV1;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>                              LsoV2IPv4;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>                              LsoV2IPv6;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>                              TcpConnectionIPv4;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>                              TcpConnectionIPv6;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                              Flags;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>                              IPsecV2;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>                              IPsecV2IPv4;
  struct {
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> RscIPv4;
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> RscIPv6;
  };
  struct {
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> EncapsulatedPacketTaskOffload;
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> EncapsulationTypes;
  };
  union {
    struct {
      <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a> VxlanUDPPortNumber;
    } VxlanParameters;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Value;
  } EncapsulationProtocolParameters;
  _ENCAPSULATION_PROTOCOL_PARAMETERS _ENCAPSULATION_PROTOCOL_PARAMETERS;
  struct {
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> IPv4;
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> IPv6;
  } UdpSegmentation;
  struct {
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> Enabled;
  } UdpRsc;
} NDIS_OFFLOAD_PARAMETERS, *PNDIS_OFFLOAD_PARAMETERS;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_offload_parameters">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndis_offload_parameters.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddndis-_ndis_offload_parameters)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_ndis_offload_parameters-structure">_NDIS_OFFLOAD_PARAMETERS structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>NDIS_OFFLOAD_PARAMETERS</strong> structure specifies the current task offload configuration settings in
response to an
OID set request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp-offload-parameters">OID_TCP_OFFLOAD_PARAMETERS</a>.</p>

<h2 id="members">Members</h2>

<h3 id="header"><code>Header</code></h3>

<p>The <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/content/objectheader/ns-objectheader-ndis_object_header"><strong>NDIS_OBJECT_HEADER</strong></a> structure for the <strong>NDIS_OFFLOAD_PARAMETERS</strong> structure. Set the <strong>Type</strong> member of the structure that <strong>Header</strong> specifies to NDIS_OBJECT_TYPE_DEFAULT.</p>

<p>To indicate the version of the <strong>NDIS_OFFLOAD_PARAMETERS</strong> structure, set the <strong>Revision</strong> member to one of the following values:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_REVISION_6</strong><br>6</td>
  <td>Supports the <strong>UdpRsc</strong> member for NDIS 6.89. Set the <strong>Size</strong> member to NDIS_SIZEOF_OFFLOAD_PARAMETERS_REVISION_6.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_REVISION_5</strong><br>5</td>
  <td>Supports the <strong>UdpSegmentation</strong> for IPv4 and IPv6 for NDIS 6.83. Set the <strong>Size</strong> member to NDIS_SIZEOF_OFFLOAD_PARAMETERS_REVISION_5.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_REVISION_4</strong><br>4</td>
  <td>Supports the <strong>EncapsulationProtocolParameters</strong> and its nested <strong>VxlanParameters</strong> for NDIS 6.50. Set the <strong>Size</strong> member to NDIS_SIZEOF_OFFLOAD_PARAMETERS_REVISION_4.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_REVISION_3</strong><br>3</td>
  <td>Supports the <strong>RscIPv4</strong>, <strong>RscIPv6</strong>, <strong>EncapsulatedPacketTaskOffload</strong>, and <strong>EncapsulationTypes</strong> members for NDIS 6.30. Set the <strong>Size</strong> member to NDIS_SIZEOF_OFFLOAD_PARAMETERS_REVISION_3.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_REVISION_2</strong><br>2</td>
  <td>Supports the <strong>IPsecV2</strong>, <strong>IPsecV2IPv4</strong>, <strong>Reserved1</strong>, and <strong>Reserved2</strong> members for NDIS 6.1. Set the <strong>Size</strong> member to NDIS_SIZEOF_OFFLOAD_PARAMETERS_REVISION_2.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_REVISION_1</strong><br>1</td>
  <td>Original version for NDIS 6.0. Set the <strong>Size</strong> member to NDIS_SIZEOF_OFFLOAD_PARAMETERS_REVISION_1.</td>
</tr>
</tbody>
</table>

<h3 id="ipv4checksum"><code>IPv4Checksum</code></h3>

<p>The IPv4 checksum setting of the miniport adapter. For more information, see the following Remarks
section.</p>

<h3 id="tcpipv4checksum"><code>TCPIPv4Checksum</code></h3>

<p>The IPv4 checksum setting of the miniport adapter for TCP packets. For more information, see the
following Remarks section.</p>

<h3 id="udpipv4checksum"><code>UDPIPv4Checksum</code></h3>

<p>The IPv4 checksum setting of the miniport adapter for UDP packets. For more information, see the
following Remarks section.</p>

<h3 id="tcpipv6checksum"><code>TCPIPv6Checksum</code></h3>

<p>The IPv6 checksum setting of the miniport adapter for TCP packets. For more information, see the
following Remarks section.</p>

<h3 id="udpipv6checksum"><code>UDPIPv6Checksum</code></h3>

<p>The IPv6 checksum setting of the miniport adapter for UDP packets. For more information, see the
following Remarks section.</p>

<h3 id="lsov1"><code>LsoV1</code></h3>

<p>The large send offload version 1 (LSOV1) setting of the miniport adapter. This setting should be one of the following values:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_NO_CHANGE</strong></td>
  <td>The miniport driver should not change the current setting.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_LSOV1_DISABLED</strong></td>
  <td>LSOV1 is disabled.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_LSOV1_ENABLED</strong></td>
  <td>LSOV1 is enabled.</td>
</tr>
</tbody>
</table>

<h3 id="ipsecv1"><code>IPsecV1</code></h3>

<p>The Internet protocol security (IPsec) offload setting of the miniport adapter. This setting
should be one of the following values:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_NO_CHANGE</strong></td>
  <td>The miniport driver should not change the current setting.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_IPSECV1_DISABLED</strong></td>
  <td>IPsec offload is disabled.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_IPSECV1_AH_ENABLED</strong></td>
  <td>The IPsec offload Authentication Header (AH) feature should be enabled for transmit and receive.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_IPSECV1_ESP_ENABLED</strong></td>
  <td>The IPsec offload Encapsulating Security Payload (ESP) feature should be enabled for transmit and receive.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_IPSECV1_AH_AND_ESP_ENABLED</strong></td>
  <td>The IPsec offload AH and ESP features are enabled for transmit and receive.</td>
</tr>
</tbody>
</table>

<h3 id="lsov2ipv4"><code>LsoV2IPv4</code></h3>

<p>The IPv4 large send offload version 2 (LSOV2) setting of the miniport adapter. This setting should be one of the following values:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_NO_CHANGE</strong></td>
  <td>The miniport driver should not change the current setting.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_LSOV2_DISABLED</strong></td>
  <td>LSOV2 for IPv4 is disabled.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_LSOV2_ENABLED</strong></td>
  <td>LSOV2 for IPv4 is enabled.</td>
</tr>
</tbody>
</table>

<h3 id="lsov2ipv6"><code>LsoV2IPv6</code></h3>

<p>The IPv6 LSOV2 setting of the miniport adapter. These settings are specified as one of the
following values:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_NO_CHANGE</strong></td>
  <td>The miniport driver should not change the current setting.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_LSOV2_DISABLED</strong></td>
  <td>LSOV2 for IPv6 is disabled.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_LSOV2_ENABLED</strong></td>
  <td>LSOV2 for IPv6 is enabled.</td>
</tr>
</tbody>
</table>

<h3 id="tcpconnectionipv4"><code>TcpConnectionIPv4</code></h3>

<p>The IPv4 connection offload setting of the miniport adapter. These settings are specified as one
of the following values:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_NO_CHANGE</strong></td>
  <td>The miniport driver should not change the current setting.</td>
</tr>
</tbody>
</table>

<h3 id="tcpconnectionipv6"><code>TcpConnectionIPv6</code></h3>

<p>The IPv6 connection offload setting of the miniport adapter. These settings are specified as one of the following values:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_NO_CHANGE</strong></td>
  <td>The miniport driver should not change the current setting.</td>
</tr>
</tbody>
</table>

<h3 id="flags"><code>Flags</code></h3>

<p>A set of flags that can be combined with a bitwise OR operation. Set this member to zero or the following value:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_SKIP_REGISTRY_UPDATE</strong><br>0x00000001</td>
  <td>Allows UDP Receive Segment Coalescing Offload (URO) to be disabled only at runtime. Changes made with this flag aren't saved to the registry.</td>
</tr>
</tbody>
</table>

<h3 id="ipsecv2"><code>IPsecV2</code></h3>

<p>The Internet protocol security (IPsec) offload version 2 setting of a miniport adapter that supports IPv6 and IPv4. This member specifies the setting for both IPv6 and IPv4 support. This setting should be one of the following values:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_NO_CHANGE</strong></td>
  <td>The miniport driver should not change the current setting.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_IPSECV2_DISABLED</strong></td>
  <td>IPsec offload version 2 is disabled.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_IPSECV2_AH_ENABLED</strong></td>
  <td>The IPsec offload version 2 Authentication Header (AH) feature should be enabled for transmit and receive.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_IPSECV2_ESP_ENABLED</strong></td>
  <td>The IPsec offload version 2 Encapsulating Security Payload (ESP) feature should be enabled for transmit and receive.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_IPSECV2_AH_AND_ESP_ENABLED</strong></td>
  <td>The IPsec offload version 2 AH and ESP features are enabled for transmit and receive.</td>
</tr>
</tbody>
</table>

<h3 id="ipsecv2ipv4"><code>IPsecV2IPv4</code></h3>

<p>The Internet protocol security (IPsec) offload version 2 setting of a miniport adapter that supports
IPv4 and does not support IPv6. If the miniport driver supports IPv6, the
<strong>IPsecV2</strong> member specifies the IPv4 setting and this member is not used. This setting should be one
of the following values:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_NO_CHANGE</strong></td>
  <td>The miniport driver should not change the current setting.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_IPSECV2_DISABLED</strong></td>
  <td>IPsec offload version 2 is disabled.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_IPSECV2_AH_ENABLED</strong></td>
  <td>The IPsec offload version 2 Authentication Header (AH) feature should be enabled for transmit and receive.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_IPSECV2_ESP_ENABLED</strong></td>
  <td>The IPsec offload version 2 Encapsulating Security Payload (ESP) feature should be enabled for transmit and receive.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_IPSECV2_AH_AND_ESP_ENABLED</strong></td>
  <td>The IPsec offload version 2 AH and ESP features are enabled for transmit and receive.</td>
</tr>
</tbody>
</table>

<h3 id="rscipv4"><code>RscIPv4</code></h3>

<p>Indicates Receive Segment Coalescing state for IPv4.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_NO_CHANGE</strong></td>
  <td>The RSC state is unchanged.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_RSC_ENABLED</strong></td>
  <td>The RSC state is enabled.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_RSC_DISABLED</strong></td>
  <td>The RSC state is disabled.</td>
</tr>
</tbody>
</table>

<h3 id="rscipv6"><code>RscIPv6</code></h3>

<p>Indicates Receive Segment Coalescing state for IPv6.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_NO_CHANGE</strong></td>
  <td>The RSC state is unchanged.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_RSC_ENABLED</strong></td>
  <td>The RSC state is enabled.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_RSC_DISABLED</strong></td>
  <td>The RSC state is disabled.</td>
</tr>
</tbody>
</table>

<h3 id="encapsulatedpackettaskoffload"><code>EncapsulatedPacketTaskOffload</code></h3>

<p>A protocol driver sets <strong>EncapsulatedPacketTaskOffload</strong> as follows:</p>

<p><strong>Note</strong>: For receive side offloads such as VMQ and RSS, there are other set OIDs that the protocol driver sends down to enable and configure the offload parameters (for example, queues, hash, and indirection table). The <strong>EncapsulatedPacketTaskOffload</strong> member is supplemental to those OIDs and instructs the NIC to also do these offloads for encapsulated packets.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_SET_NO_CHANGE</strong><br>0</td>
  <td>The NVGRE and VXLAN task offload states are unchanged.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_SET_ON</strong><br>1</td>
  <td>Enables NVGRE and VXLAN task offloads.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_SET_OFF</strong><br>2</td>
  <td>Disables NVGRE and VXLAN task offloads.</td>
</tr>
</tbody>
</table>

<h3 id="encapsulationtypes"><code>EncapsulationTypes</code></h3>

<p>This field is effective only when the <strong>EncapsulatedPacketTaskOffload</strong> is set to <strong>NDIS_OFFLOAD_SET_ON</strong>. If the <strong>EncapsulatedPacketTaskOffload</strong> member is not set to <strong>NDIS_OFFLOAD_SET_ON</strong>, this member is zero. A protocol driver must set <strong>EncapsulationTypes</strong> to the bitwise OR of the flags corresponding to encapsulation types that it requires. It can select flags from the following:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_ENCAPSULATION_TYPE_GRE_MAC</strong><br>0x00000001</td>
  <td>Specifies GRE MAC encapsulation (NVGRE).</td>
</tr>
<tr>
  <td><strong>NDIS_ENCAPSULATION_TYPE_VXLAN</strong><br>0x00000002</td>
  <td>Specifies VXLAN encapsulation.</td>
</tr>
</tbody>
</table>

<h3 id="encapsulationprotocolparameters"><code>EncapsulationProtocolParameters</code></h3>

<p>A union that describes the encapsulation parameters for VXLAN encapsulation.</p>

<p>If the miniport driver advertised <strong>VxlanUDPPortNumerConfigurable</strong> as <strong>TRUE</strong>, then a protocol driver can set <strong>EncapsulationProtocolParameters.VxlanParameters.VxlanUDPPortNumber</strong> to a non-0 value. The miniport driver must use this port number for matching and generating VXLAN frames after succeeding the OID, and also advertise the updated value in its capabilities. If the protocol driver passes a value of <strong>0</strong>, then the miniport driver continues to use the port number initialized from the standardized keyword.</p>

<h3 id="encapsulationprotocolparametersvxlanparameters"><code>EncapsulationProtocolParameters.VxlanParameters</code></h3>

<p>A structure that contains the <strong>VxlanUDPPortNumber</strong>.</p>

<h3 id="encapsulationprotocolparametersvxlanparametersvxlanudpportnumber"><code>EncapsulationProtocolParameters.VxlanParameters.VxlanUDPPortNumber</code></h3>

<p>The VXLAN destination port value. This value is set to the IANA-assigned value of 4789 by default. If the miniport driver supports a configurable port number as advertised in the <strong><a href="ndis_offload" title="typedef struct _NDIS_OFFLOAD {&#10;  NDIS_OBJECT_HEADER                       Header;&#10;  NDIS_TCP_IP_CHECKSUM_OFFLOAD             Checksum;&#10;  NDIS_TCP_LARGE_SEND_OFFLOAD_V1           LsoV1;&#10;  NDIS_IPSEC_OFFLOAD_V1                    IPsecV1;&#10;  NDIS_TCP_LARGE_SEND_OFFLOAD_V2           LsoV2;&#10;  ULONG                                    Flags;&#10;  NDIS_IPSEC_OFFLOAD_V2                    IPsecV2;&#10;  NDIS_TCP_RECV_SEG_COALESCE_OFFLOAD       Rsc;&#10;  NDIS_ENCAPSULATED_PACKET_TASK_OFFLOAD    EncapsulatedPacketTaskOffloadGre;&#10;  NDIS_ENCAPSULATED_PACKET_TASK_OFFLOAD_V2 EncapsulatedPacketTaskOffloadVxlan;&#10;  UCHAR                                    EncapsulationTypes;&#10;  NDIS_RFC6877_464XLAT_OFFLOAD             Rfc6877Xlat;&#10;  NDIS_UDP_SEGMENTATION_OFFLOAD            UdpSegmentation;&#10;  NDIS_UDP_RSC_OFFLOAD                     UdpRsc;&#10;} NDIS_OFFLOAD, *PNDIS_OFFLOAD;">NDIS_OFFLOAD</a></strong> structure, a protocol driver can issue an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp-offload-parameters">OID_TCP_OFFLOAD_PARAMETERS</a> OID to enable NDIS_ENCAPSULATION_TYPE_VXLAN with a different value in <strong>VxlanUDPPortNumber</strong>. The miniport driver must use <strong>VxlanUDPPortNumber</strong> to determine VXLAN encapsulated packets for performing receive offloads.</p>

<h3 id="encapsulationprotocolparametersvalue"><code>EncapsulationProtocolParameters.Value</code></h3>

<p>The port value if <strong>EncapsulationTypes</strong> is not set to NDIS_ENCAPSULATION_TYPE_VXLAN.</p>

<h3 id="_encapsulation_protocol_parameters"><code>_ENCAPSULATION_PROTOCOL_PARAMETERS</code></h3>

<p>The type name for <strong>EncapsulationProtocolParameters</strong>.</p>

<h3 id="udpsegmentation"><code>UdpSegmentation</code></h3>

<p>A structure that describes the miniport adapter's UDP Segmentation Offload (USO) settings.</p>

<h3 id="udpsegmentationipv4"><code>UdpSegmentation.IPv4</code></h3>

<p>The IPv4 UDP Segmentation Offload (USO) setting of the miniport adapter. This setting should be one of the following values:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_NO_CHANGE</strong></td>
  <td>The miniport driver should not change the current setting.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_UDP_SEG_DISABLED</strong></td>
  <td>USO is disabled.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_UDP_SEG_ENABLED</strong></td>
  <td>USO is enabled.</td>
</tr>
</tbody>
</table>

<h3 id="udpsegmentationipv6"><code>UdpSegmentation.IPv6</code></h3>

<p>The IPv6 UDP Segmentation Offload (USO) setting of the miniport adapter. This setting should be one of the following values:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_NO_CHANGE</strong></td>
  <td>The miniport driver should not change the current setting.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_UDP_SEG_DISABLED</strong></td>
  <td>USO is disabled.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_UDP_SEG_ENABLED</strong></td>
  <td>USO is enabled.</td>
</tr>
</tbody>
</table>

<h3 id="udprsc"><code>UdpRsc</code></h3>

<p>A structure that describes the miniport adapter's UDP Receive Segment Coalescing Offload (URO) settings.</p>

<h3 id="udprscenabled"><code>UdpRsc.Enabled</code></h3>

<p>The URO setting of the miniport adapter. This setting should be one of the following values:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_UDP_RSC_NO_CHANGE</strong><br>0</td>
  <td>The miniport driver should not change the current setting.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_UDP_RSC_DISABLED</strong><br>1</td>
  <td>URO is disabled.</td>
</tr>
<tr>
  <td><strong>NDIS_OFFLOAD_PARAMETERS_UDP_RSC_ENABLED</strong><br>2</td>
  <td>URO is enabled.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>In response to an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp-offload-parameters">OID_TCP_OFFLOAD_PARAMETERS</a> OID set request, a miniport driver uses the settings in the <strong>NDIS_OFFLOAD_PARAMETERS</strong> structure to set the current configuration of the miniport adapter.</p>

<p>NDIS retains the requested settings in the registry in the offload standardized keywords. When NDIS restarts the miniport adapter, the miniport driver reads the offload standardized keywords and uses them to set the default offload configuration of the NIC.</p>

<p>To access the checksum offload settings, use the following members of the <strong>NDIS_OFFLOAD_PARAMETERS</strong> structure:</p>

<p><strong>IPv4Checksum</strong></p>

<p><strong>TCPIPv4Checksum</strong></p>

<p><strong>UDPIPv4Checksum</strong></p>

<p><strong>TCPIPv6Checksum</strong></p>

<p><strong>UDPIPv6Checksum</strong></p>

<p>The preceding members can have one of the following values:</p>

<p>NDIS_OFFLOAD_PARAMETERS_NO_CHANGE
The miniport driver should not change the current setting.</p>

<p>NDIS_OFFLOAD_PARAMETERS_TX_RX_DISABLED
The feature that the member specifies is disabled.</p>

<p>NDIS_OFFLOAD_PARAMETERS_TX_ENABLED_RX_DISABLED
The feature that the member specifies is enabled for transmit and disabled for receive.</p>

<p>NDIS_OFFLOAD_PARAMETERS_RX_ENABLED_TX_DISABLED
The feature that the member specifies is enabled for receive and disabled for transmit.</p>

<p>NDIS_OFFLOAD_PARAMETERS_TX_RX_ENABLED
The feature that the member specifies is enabled for transmit and receive.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/content/objectheader/ns-objectheader-ndis_object_header">NDIS_OBJECT_HEADER</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp-connection-offload-hardware-capabilities">OID_TCP_OFFLOAD_HARDWARE_CAPABILITIES</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp-offload-parameters">OID_TCP_OFFLOAD_PARAMETERS</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_offload_parameters">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddndis/ns-ntddndis-_ndis_offload_parameters.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
