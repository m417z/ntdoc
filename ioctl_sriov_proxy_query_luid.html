<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="IOCTL_SRIOV_PROXY_QUERY_LUID - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>IOCTL_SRIOV_PROXY_QUERY_LUID - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            IOCTL_SRIOV_PROXY_QUERY_LUID - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// pcivirt.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">// <a href="ctl_code" title="void CTL_CODE(&#10;  DeviceType,&#10;  Function,&#10;  Method,&#10;  Access&#10;);">CTL_CODE</a>(0x0022, 0x819, METHOD_BUFFERED, FILE_READ_ACCESS)
#define IOCTL_SRIOV_PROXY_QUERY_LUID 0x00226064</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pcivirt/ni-pcivirt-ioctl_sriov_proxy_query_luid">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ioctl_sriov_proxy_query_luid.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ni-pcivirt-ioctl_sriov_proxy_query_luid)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>IOCTL_SRIOV_PROXY_QUERY_LUID IOCTL</h1>
<h2>Major Code</h2>
<p><a href="https://learn.microsoft.com/windows-hardware/drivers/ifs/irp-mj-device-control">IRP_MJ_DEVICE_CONTROL</a></p>
<h2>Description</h2>
<p>This request supplies the local unique
identifier of the SR_IOV device implementing the interface.</p>
<h2>Parameters</h2>
<h3>Major code</h3>
<p><a href="https://learn.microsoft.com/windows-hardware/drivers/ifs/irp-mj-device-control">IRP_MJ_DEVICE_CONTROL</a></p>
<h3>Input buffer</h3>
<p><strong>NULL</strong>. No input buffer is required for this operation.</p>
<h3>Input buffer length</h3>
<p>Zero.</p>
<h3>Output buffer</h3>
<p>A pointer to a <a href="sriov_proxy_query_luid_output" title="typedef struct _SRIOV_PROXY_QUERY_LUID_OUTPUT {&#10;  LUID  DeviceLuid;&#10;} SRIOV_PROXY_QUERY_LUID_OUTPUT, SRIOV_PROXY_QUERY_LUID_OUTPUT;">SRIOV_PROXY_QUERY_LUID_OUTPUT</a> structure that is filled with the identifier.</p>
<h3>Output buffer length</h3>
<p>The size of the <a href="sriov_proxy_query_luid_output" title="typedef struct _SRIOV_PROXY_QUERY_LUID_OUTPUT {&#10;  LUID  DeviceLuid;&#10;} SRIOV_PROXY_QUERY_LUID_OUTPUT, SRIOV_PROXY_QUERY_LUID_OUTPUT;">SRIOV_PROXY_QUERY_LUID_OUTPUT</a> structure</p>
<h3>Input/output buffer</h3>
<p>Not used with this operation; set this parameter to <strong>NULL</strong>.</p>
<h3>Input/output buffer length</h3>
<p>Not used with this operation; set this parameter to zero.</p>
<h3>Status block</h3>
<p><strong>Irp-&gt;IoStatus.Status</strong> is set to <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the request is successful. Otherwise, <strong>Status</strong> to the appropriate error condition as a <a href="https://learn.microsoft.com/windows-hardware/drivers/kernel/ntstatus-values">NTSTATUS</a> code.</p>
<h2>Remarks</h2>
<p>This IOCTL request is sent by the virtualization stack to the PCI Express SR-IOV Physical Function (PF) driver that exposes GUID_DEVINTERFACE_VIRTUALIZABLE_DEVICE.</p>
<p>This IOCTL request originates in the user mode and is handled by the physical function (PF) driver in order to supply the local unique
identifier of the physical device. This request is only required for SR-IOV devices doing direct assignment.</p>
<p>Before sending this request, the user mode application must obtain a handle to the PCI Express SR-IOV device by querying for GUID_DEVINTERFACE_VIRTUALIZABLE_DEVICE.</p>
<p>In this example, the PF driver generates a unique identifier by calling <a href="ntallocatelocallyuniqueid" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtAllocateLocallyUniqueId(&#10;    _Out_ PLUID Luid&#10;    );">ZwAllocateLocallyUniqueId</a> and stores it in the device context.</p>
<pre><code>    case IOCTL_SRIOV_PROXY_QUERY_LUID:

        status = <a href="wdfrequestretrieveoutputbuffer" title="NTSTATUS WdfRequestRetrieveOutputBuffer(&#10;  [in]            WDFREQUEST Request,&#10;  [in]            size_t     MinimumRequiredSize,&#10;  [out]           PVOID      *Buffer,&#10;  [out, optional] size_t     *Length&#10;);">WdfRequestRetrieveOutputBuffer</a>(Request,
                                                sizeof(<a href="luid" title="typedef struct _LUID {&#10;  DWORD LowPart;&#10;  LONG  HighPart;&#10;} LUID, *PLUID;">LUID</a>),
                                                &amp;luid,
                                                NULL);
        if (!<a href="nt_success" title="#define NT_SUCCESS(Status) (((NTSTATUS)(Status)) &gt;= 0)">NT_SUCCESS</a>(status))
        {
            break;
        }

        <a href="rtlcopymemory" title="void RtlCopyMemory(&#10;  Destination,&#10;  Source,&#10;  Length&#10;);">RtlCopyMemory</a>(luid, &amp;deviceContext-&gt;Luid, sizeof(<a href="luid" title="typedef struct _LUID {&#10;  DWORD LowPart;&#10;  LONG  HighPart;&#10;} LUID, *PLUID;">LUID</a>));
        <a href="wdfrequestsetinformation" title="VOID WdfRequestSetInformation(&#10;  [in] WDFREQUEST Request,&#10;  [in] ULONG_PTR  Information&#10;);">WdfRequestSetInformation</a>(Request, sizeof(<a href="luid" title="typedef struct _LUID {&#10;  DWORD LowPart;&#10;  LONG  HighPart;&#10;} LUID, *PLUID;">LUID</a>));
        status = <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a>;
        break;

</code></pre>
<h2>See also</h2>
<ul>
<li><a href="sriov_proxy_query_luid_output" title="typedef struct _SRIOV_PROXY_QUERY_LUID_OUTPUT {&#10;  LUID  DeviceLuid;&#10;} SRIOV_PROXY_QUERY_LUID_OUTPUT, SRIOV_PROXY_QUERY_LUID_OUTPUT;">SRIOV_PROXY_QUERY_LUID_OUTPUT</a></li>
</ul>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pcivirt/ni-pcivirt-ioctl_sriov_proxy_query_luid">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/pcivirt/ni-pcivirt-ioctl_sriov_proxy_query_luid.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
