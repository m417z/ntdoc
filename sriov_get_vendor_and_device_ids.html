<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="SRIOV_GET_VENDOR_AND_DEVICE_IDS - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>SRIOV_GET_VENDOR_AND_DEVICE_IDS - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            SRIOV_GET_VENDOR_AND_DEVICE_IDS - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// pcivirt.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">SRIOV_GET_VENDOR_AND_DEVICE_IDS SriovGetVendorAndDeviceIds;

VOID SriovGetVendorAndDeviceIds(
  [in]  PVOID Context,
  [in]  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a> VfIndex,
  [out] PUSHORT VendorId,
  [out] PUSHORT DeviceId
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pcivirt/nc-pcivirt-sriov_get_vendor_and_device_ids">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/sriov_get_vendor_and_device_ids.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-pcivirt-sriov_get_vendor_and_device_ids)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>SRIOV_GET_VENDOR_AND_DEVICE_IDS callback</h1>
<h2>Description</h2>
<p>Supplies the Vendor and Device ID for a PCI Express SR-IOV Virtual Function (VF) to be used for generating a more generic Plug and Play ID for the VF. These IDs cannot be read directly from the VF's configuration space.</p>
<h2>Parameters</h2>
<h3><code>Context</code> [in]</h3>
<p>A pointer to a driver-defined context.</p>
<h3><code>VfIndex</code> [in]</h3>
<p>A zero-based index of the VF to which this write operation applies.</p>
<h3><code>VendorId</code> [out]</h3>
<p>A pointer to a <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a> variable that is filled with the vendor ID of the VF.</p>
<h3><code>DeviceId</code> [out]</h3>
<p>A pointer to a <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a> variable that is filled with the device ID of the VF.</p>
<h2>Prototype</h2>
<pre><code>VOID SRIOV_GET_VENDOR_AND_DEVICE_IDS (
    _In_        PVOID           Context,
    _In_        <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>          VfIndex,
    _Out_       PUSHORT         VendorId,
    _Out_       PUSHORT         DeviceId
    );
typedef SRIOV_GET_VENDOR_AND_DEVICE_IDS *PSRIOV_GET_VENDOR_AND_DEVICE_IDS;
</code></pre>
<h2>Remarks</h2>
<p>This callback function is implemented by the physical function (PF) driver. It is invoked when the system wants to retrieve the vendor and device identifiers of the specified VF.</p>
<p>The PCI Express SR-IOV Specification requires that all VFs have the same Vendor and Device IDs. This is a requirement of compliant hardware. However, it's possible to provision VFs such that their capabilities differ from each other, and it's often useful to load different drivers on different hardware. So Windows allows the PF driver to supply separate Device and Vendor IDs (with different class codes, through the configuration space interfaces) such that each VF may appear with the Plug and Play IDs that are most appropriate for its use.</p>
<p>The PF driver registers its implementation by setting the <strong>GetVendorAndDevice</strong> member of the <a href="sriov_device_interface_standard" title="typedef struct _SRIOV_DEVICE_INTERFACE_STANDARD {&#10;  USHORT                           Size;&#10;  USHORT                           Version;&#10;  PVOID                            Context;&#10;  PINTERFACE_REFERENCE             InterfaceReference;&#10;  PINTERFACE_REFERENCE             InterfaceDereference;&#10;  PSRIOV_READ_CONFIG               ReadVfConfig;&#10;  PSRIOV_WRITE_CONFIG              WriteVfConfig;&#10;  PSRIOV_READ_BLOCK                ReadVfConfigBlock;&#10;  PSRIOV_WRITE_BLOCK               WriteVfConfigBlock;&#10;  PSRIOV_QUERY_PROBED_BARS         QueryProbedBars;&#10;  PSRIOV_GET_VENDOR_AND_DEVICE_IDS GetVendorAndDevice;&#10;  PSRIOV_GET_DEVICE_LOCATION       GetDeviceLocation;&#10;  PSRIOV_RESET_FUNCTION            ResetVf;&#10;  PSRIOV_SET_POWER_STATE           SetVfPowerState;&#10;  PSRIOV_GET_RESOURCE_FOR_BAR      GetResourceForBar;&#10;  PSRIOV_QUERY_LUID                QueryLuid;&#10;} SRIOV_DEVICE_INTERFACE_STANDARD, SRIOV_DEVICE_INTERFACE_STANDARD;">SRIOV_DEVICE_INTERFACE_STANDARD</a>, configuring a <a href="wdf_query_interface_config" title="typedef struct _WDF_QUERY_INTERFACE_CONFIG {&#10;  ULONG                                          Size;&#10;  PINTERFACE                                     Interface;&#10;  const GUID                                     *InterfaceType;&#10;  BOOLEAN                                        SendQueryToParentStack;&#10;  PFN_WDF_DEVICE_PROCESS_QUERY_INTERFACE_REQUEST EvtDeviceProcessQueryInterfaceRequest;&#10;  BOOLEAN                                        ImportInterface;&#10;} WDF_QUERY_INTERFACE_CONFIG, *PWDF_QUERY_INTERFACE_CONFIG;">WDF_QUERY_INTERFACE_CONFIG</a> structure, and calling <a href="wdfdeviceaddqueryinterface" title="NTSTATUS WdfDeviceAddQueryInterface(&#10;  [in] WDFDEVICE                   Device,&#10;  [in] PWDF_QUERY_INTERFACE_CONFIG InterfaceConfig&#10;);">WdfDeviceAddQueryInterface</a>.</p>
<p>Here is an example implementation of this callback function.</p>
<pre><code>Virtualization_GetVendorAndDevice (
    _In_    PVOID           Context,
    _In_    <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>          VfIndex,
    _Out_   PUSHORT         VendorId,
    _Out_   PUSHORT         DeviceId
    )
{
    PDEVICE_CONTEXT deviceContext;
    UNREFERENCED_PARAMETER(VfIndex);
    PAGED_CODE();
    deviceContext = (PDEVICE_CONTEXT)Context;
    *VendorId = deviceContext-&gt;VendorId;
    *DeviceId = deviceContext-&gt;DeviceId;
}
</code></pre>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pcivirt/nc-pcivirt-sriov_get_vendor_and_device_ids">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/pcivirt/nc-pcivirt-sriov_get_vendor_and_device_ids.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
