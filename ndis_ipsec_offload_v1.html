<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NDIS_IPSEC_OFFLOAD_V1 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NDIS_IPSEC_OFFLOAD_V1 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NDIS_IPSEC_OFFLOAD_V1 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _NDIS_IPSEC_OFFLOAD_V1 {
  struct {
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Encapsulation;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> AhEspCombined;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> TransportTunnelCombined;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> IPv4Options;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Flags;
  } Supported;
  struct {
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Md5 : 2;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Sha_1 : 2;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Transport : 2;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Tunnel : 2;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Send : 2;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Receive : 2;
  } IPv4AH;
  struct {
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Des : 2;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Reserved : 2;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> TripleDes : 2;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> NullEsp : 2;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Transport : 2;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Tunnel : 2;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Send : 2;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Receive : 2;
  } IPv4ESP;
} NDIS_IPSEC_OFFLOAD_V1, *PNDIS_IPSEC_OFFLOAD_V1;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_ipsec_offload_v1">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndis_ipsec_offload_v1.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddndis-_ndis_ipsec_offload_v1)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_ndis_ipsec_offload_v1-structure">_NDIS_IPSEC_OFFLOAD_V1 structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>NDIS_IPSEC_OFFLOAD_V1</strong> structure provides Internet protocol security (IPsec) task offload
information in the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_offload">NDIS_OFFLOAD</a> structure.</p>

<p><strong>Note</strong> <strong>NDIS_IPSEC_OFFLOAD_V1</strong> is only for NDIS 6.0. For NDIS 6.1 and later, use <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_ipsec_offload_v2">NDIS_IPSEC_OFFLOAD_V2</a>.</p>

<h2 id="members">Members</h2>

<h3 id="supported"><code>Supported</code></h3>

<p>A structure within NDIS_IPSEC_OFFLOAD_V1 that specifies support for IPsec task offload and that
contains the following information:</p>

<h3 id="supportedencapsulation"><code>Supported.Encapsulation</code></h3>

<p>Encapsulation settings for IPsec. For more information about this member, see the following
Remarks section.</p>

<h3 id="supportedahespcombined"><code>Supported.AhEspCombined</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the hardware can perform IPsec
operations on send and receive packets that contain both an authentication header (AH) security
payload and an encapsulating security payload (ESP). A value of zero in
<strong>AhEspCombined</strong> indicates that the NIC does not support this capability.</p>

<h3 id="supportedtransporttunnelcombined"><code>Supported.TransportTunnelCombined</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC can process security payloads
for both the transport-mode portion and the tunnel-mode portion of send and receive packets. (The
transport-mode portion of a packet pertains to an end-to-end connection. The tunnel-mode portion of a
packet pertains to a tunnel connection.) A value of zero in
<strong>TransportTunnelCombined</strong> indicates that the NIC does not support this capability.</p>

<h3 id="supportedipv4options"><code>Supported.IPv4Options</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC can perform IPsec operations
on IPv4 send and receive packets whose IP headers contain IP options. A value of zero in
<strong>IPv4Options</strong> indicates that the NIC does not support this capability.</p>

<h3 id="supportedflags"><code>Supported.Flags</code></h3>

<p>The types of UDP-encapsulated ESP data packets that the NIC can parse. For a description of the
UDP-encapsulation types, see
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/udp-esp-encapsulation-types">UDP-ESP Encapsulation Types</a>.
This member can be one or more of the following flags:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>IPSEC_TPT_UDPESP_ENCAPTYPE_IKE</strong></td>
  <td>Reserved for internal use.</td>
</tr>
<tr>
  <td><strong>IPSEC_TUN_UDPESP_ENCAPTYPE_IKE</strong></td>
  <td>Reserved for internal use.</td>
</tr>
<tr>
  <td><strong>IPSEC_TPTOVERTUN_UDPESP_ENCAPTYPE_IKE</strong></td>
  <td>Reserved for internal use.</td>
</tr>
<tr>
  <td><strong>IPSEC_TPT_UDPESP_OVER_PURE_TUN_ENCAPTYPE_IKE</strong></td>
  <td>Reserved for internal use.</td>
</tr>
<tr>
  <td><strong>IPSEC_TPT_UDPESP_ENCAPTYPE_OTHER</strong></td>
  <td>When this flag is set, the NIC can parse UDP-encapsulated transport-mode packets.<br><br>When this flag is cleared, the NIC cannot parse UDP-encapsulated transport-mode packets.</td>
</tr>
<tr>
  <td><strong>IPSEC_TUN_UDPESP_ENCAPTYPE_OTHER</strong></td>
  <td>When this flag set, the NIC can parse UDP-encapsulated tunnel-mode packets.<br><br>When this flag is cleared, the NIC does not have this capability.</td>
</tr>
<tr>
  <td><strong>IPSEC_TPTOVERTUN_UDPESP_ENCAPTYPE_OTHER</strong></td>
  <td>When this flag is set, the NIC can parse transport over UDP-encapsulated tunnel-mode packets.<br><br>When this flag is cleared, the NIC does not have this capability.</td>
</tr>
<tr>
  <td><strong>IPSEC_TPT_UDPESP_OVER_PURE_TUN_ENCAPTYPE_OTHER</strong></td>
  <td>When this flag is set, the NIC can parse UDP-encapsulated transport over tunnel-mode packets.<br><br>When this flag is cleared, the NIC does not have this capability.</td>
</tr>
</tbody>
</table>

<p>A miniport driver whose NIC is incapable of parsing UDP-encapsulated ESP packets must not set any
flags in the
<strong>Flags</strong> member.</p>

<h3 id="ipv4ah"><code>IPv4AH</code></h3>

<p>A structure within NDIS_IPSEC_OFFLOAD_V1 that specifies support for AH payloads and that contains
the following information:</p>

<h3 id="ipv4ahmd5"><code>IPv4AH.Md5</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC can use the keyed MD5
algorithm for computing or validating a cryptographic checksum for an AH payload, ESP payload, or
both.</p>

<h3 id="ipv4ahsha_1"><code>IPv4AH.Sha_1</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC can use the SHA 1 algorithm
for computing or validating a cryptographic checksum for an AH payload, ESP payload, or both.</p>

<h3 id="ipv4ahtransport"><code>IPv4AH.Transport</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC can calculate or validate the
cryptographic checksums for the portion of a packet that pertains to an end-to-end connection.</p>

<h3 id="ipv4ahtunnel"><code>IPv4AH.Tunnel</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC can calculate or validate
cryptographic checksums for the portion of a packet that pertains to a tunnel connection.</p>

<h3 id="ipv4ahsend"><code>IPv4AH.Send</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC can calculate cryptographic
checksums for send packets.</p>

<h3 id="ipv4ahreceive"><code>IPv4AH.Receive</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC can validate cryptographic
checksums for receive packets.</p>

<h3 id="ipv4esp"><code>IPv4ESP</code></h3>

<p>A structure within NDIS_IPSEC_OFFLOAD_V1 that specifies support for ESP payloads and that contains
the following information:</p>

<h3 id="ipv4espdes"><code>IPv4ESP.Des</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC supports the DES algorithm
for encrypting and decrypting ESP payloads.</p>

<h3 id="ipv4espreserved"><code>IPv4ESP.Reserved</code></h3>

<p>This member is reserved.</p>

<h3 id="ipv4esptripledes"><code>IPv4ESP.TripleDes</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC supports the triple-DES
algorithm for encrypting and decrypting ESP payloads.</p>

<h3 id="ipv4espnullesp"><code>IPv4ESP.NullEsp</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC supports null
encryption--that is, the ESP payload without encryption but with authentication information.</p>

<h3 id="ipv4esptransport"><code>IPv4ESP.Transport</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC can encrypt and decrypt ESP
data for the portion of a packet that pertains to an end-to-end connection.</p>

<h3 id="ipv4esptunnel"><code>IPv4ESP.Tunnel</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC can encrypt and decrypt ESP
data for the portion of a packet that pertains to a tunnel connection.</p>

<h3 id="ipv4espsend"><code>IPv4ESP.Send</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC can encrypt and decrypt ESP
payloads in send packets.</p>

<h3 id="ipv4espreceive"><code>IPv4ESP.Receive</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that a miniport driver sets to indicate that the NIC can encrypt and decrypt ESP
payloads in receive packets.</p>

<h2 id="remarks">Remarks</h2>

<p>The <strong>NDIS_IPSEC_OFFLOAD_V1</strong> structure is used in the
<strong>IPsecV1</strong> member of the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_offload">NDIS_OFFLOAD</a> structure. The
NDIS_IPSEC_OFFLOAD_V1 structure specifies the current or supported services that a miniport adapter
provides for Internet protocol security (IPsec).</p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_offload">NDIS_OFFLOAD</a> is used in the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/ns-ndis-_ndis_miniport_adapter_offload_attributes">NDIS_MINIPORT_ADAPTER_OFFLOAD_ATTRIBUTES</a> structure,
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/ns-ndis-_ndis_bind_parameters">NDIS_BIND_PARAMETERS</a> structure,
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/ns-ndis-_ndis_filter_attach_parameters">NDIS_FILTER_ATTACH_PARAMETERS</a> structure,
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp-offload-current-config">OID_TCP_OFFLOAD_CURRENT_CONFIG</a> OID, and the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-task-offload-current-config">NDIS_STATUS_TASK_OFFLOAD_CURRENT_CONFIG</a> status indication.</p>

<p>For
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp-offload-current-config">OID_TCP_OFFLOAD_CURRENT_CONFIG</a>,
the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_offload">NDIS_OFFLOAD</a> structure specifies the task offload capabilities that a miniport adapter supports. If
the current offloads capabilities change, a miniport driver reports the new capabilities in an
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-task-offload-current-config">NDIS_STATUS_TASK_OFFLOAD_CURRENT_CONFIG</a> status indication.</p>

<p>The
<strong>Encapsulation</strong> member of <strong>NDIS_IPSEC_OFFLOAD_V1</strong> defines the IPsec offload encapsulation settings for
the miniport adapter.</p>

<p>In response to an
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp-offload-current-config">OID_TCP_OFFLOAD_CURRENT_CONFIG</a> query request, NDIS provides a bitwise OR of the encapsulation
flags, which indicate the supported encapsulation settings, in the
<strong>Encapsulation</strong> member. Miniport drivers must provide Ethernet encapsulation
(NDIS_ENCAPSULATION_IEEE_802_3). The other types of encapsulation are optional.</p>

<p>For an
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-task-offload-current-config">NDIS_STATUS_TASK_OFFLOAD_CURRENT_CONFIG</a> status indication, the miniport driver provides a bitwise
OR of the encapsulation flags, which indicate the current capabilities, in the
<strong>Encapsulation</strong> member.</p>

<p>The following flags are defined for the
<strong>Encapsulation</strong> member:</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/ns-ndis-_ndis_bind_parameters">NDIS_BIND_PARAMETERS</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/ns-ndis-_ndis_filter_attach_parameters">NDIS_FILTER_ATTACH_PARAMETERS</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_ipsec_offload_v2">NDIS_IPSEC_OFFLOAD_V2</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/ns-ndis-_ndis_miniport_adapter_offload_attributes">NDIS_MINIPORT_ADAPTER_OFFLOAD_ATTRIBUTES</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_offload">NDIS_OFFLOAD</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/oidrequest/ns-oidrequest-ndis_oid_request">NDIS_OID_REQUEST</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-task-offload-current-config">NDIS_STATUS_TASK_OFFLOAD_CURRENT_CONFIG</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/nbl/ns-nbl-net_buffer_list">NET_BUFFER_LIST</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp-offload-current-config">OID_TCP_OFFLOAD_CURRENT_CONFIG</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_ipsec_offload_v1">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddndis/ns-ntddndis-_ndis_ipsec_offload_v1.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
