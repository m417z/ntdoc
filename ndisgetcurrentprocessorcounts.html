<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NdisGetCurrentProcessorCounts - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NdisGetCurrentProcessorCounts - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NdisGetCurrentProcessorCounts - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">VOID NdisGetCurrentProcessorCounts(
  [out] PULONG pIdleCount,
  [out] PULONG pKernelAndUser,
  [out] PULONG pIndex
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndisgetcurrentprocessorcounts">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndisgetcurrentprocessorcounts.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ndis-ndisgetcurrentprocessorcounts)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="ndisgetcurrentprocessorcounts-function">NdisGetCurrentProcessorCounts function</h1>

<h2 id="description">Description</h2>

<p>The
<strong>NdisGetCurrentProcessorCounts</strong> function returns counts for the current processor that a driver can use
to determine CPU usage for a particular time interval.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="pidlecount-out"><code>pIdleCount</code> [out]</h3>

<p>A pointer to a caller-supplied variable in which this function returns the cumulative idle time
for the processor since the system was booted.</p>

<h3 id="pkernelanduser-out"><code>pKernelAndUser</code> [out]</h3>

<p>A pointer to a caller-supplied variable in which this function returns the cumulative processing
time (kernel-mode time plus user-mode time) for the processor since the system was booted.</p>

<h3 id="pindex-out"><code>pIndex</code> [out]</h3>

<p>A pointer to a caller-supplied variable in which this function returns a zero-based index that
identifies the processor within the computer.</p>

<h2 id="remarks">Remarks</h2>

<p><strong>NdisGetCurrentProcessorCounts</strong> returns idle and CPU-usage counts that the caller can use to
determine CPU usage for the current processor. The CPU utilization value indicates how loaded the CPU was
since the immediately preceding call to this function. If the CPU was heavily loaded, such a driver can
change how it handles certain operations to improve driver performance.</p>

<p><strong>Note</strong> Estimating processor usage is difficult, and drivers generally don't do it. Note that, even if you have an accurate estimate of processor usage, there are other factors that you need to take into account, such as what is causing the load on the CPU â€“ and how important that particular load might be.</p>

<p>A driver might call
<strong>NdisGetCurrentProcessorCounts</strong> periodically within a timer function. The driver can use the
following calculation to determine the CPU usage for a multiple of the timer interval:</p>

<p><!-- CODE_MARKER --></p>

<pre><code>CpuUsage = 100-100*(Idle - Idle[n])/(KernelAndUser - KernelAndUser[n]);
</code></pre>

<p>where:</p>

<ul>
<li>CpuUsage is CPU usage as a percentage of the total interval time</li>
<li>Idle is the
<em>IdleCount</em> value returned by the most recent call to
<strong>NdisGetCurrentProcessorCounts</strong></li>
<li>Idle[n] is an
<em>IdleCount</em> value returned by a previous call, stored as the nth element in an array</li>
<li>KernelandUser is the
<em>KernelAndUser</em> value returned by the most recent call to
<strong>NdisGetCurrentProcessorCounts</strong></li>
<li>KernelandUser[n] is the KernelandUser value returned by a previous call, stored as the nth element
in an array</li>
</ul>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndisgetcurrentprocessorcounts">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ndis/nf-ndis-ndisgetcurrentprocessorcounts.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
