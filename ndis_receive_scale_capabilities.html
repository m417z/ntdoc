<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NDIS_RECEIVE_SCALE_CAPABILITIES - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NDIS_RECEIVE_SCALE_CAPABILITIES - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NDIS_RECEIVE_SCALE_CAPABILITIES - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _NDIS_RECEIVE_SCALE_CAPABILITIES {
  <a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a>  Header;
  NDIS_RSS_CAPS_FLAGS CapabilitiesFlags;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>               NumberOfInterruptMessages;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>               NumberOfReceiveQueues;
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>              NumberOfIndirectionTableEntries;
} NDIS_RECEIVE_SCALE_CAPABILITIES, *PNDIS_RECEIVE_SCALE_CAPABILITIES;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_receive_scale_capabilities">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndis_receive_scale_capabilities.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddndis-_ndis_receive_scale_capabilities)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_ndis_receive_scale_capabilities-structure">_NDIS_RECEIVE_SCALE_CAPABILITIES structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>NDIS_RECEIVE_SCALE_CAPABILITIES</strong> structure specifies the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-receive-side-scaling2">receive side scaling (RSS)</a> capabilities of a miniport adapter.</p>

<h2 id="members">Members</h2>

<h3 id="header"><code>Header</code></h3>

<p>The
<a rel="noopener" target="_blank" href="ndis_object_header">NDIS_OBJECT_HEADER</a> structure for the
<strong>NDIS_RECEIVE_SCALE_CAPABILITIES</strong> structure. Set the
<strong>Type</strong> member of the structure that
<strong>Header</strong> specifies to <strong>NDIS_OBJECT_TYPE_RSS_CAPABILITIES</strong>.</p>

<p>For NDIS 6.60 and later, set the
<strong>Revision</strong> member to <strong>NDIS_RECEIVE_SCALE_CAPABILITIES_REVISION_3</strong> and the
<strong>Size</strong> member to <strong>NDIS_SIZEOF_RECEIVE_SCALE_CAPABILITIES_REVISION_3</strong>.</p>

<p>For NDIS 6.30 and later, set the
<strong>Revision</strong> member to <strong>NDIS_RECEIVE_SCALE_CAPABILITIES_REVISION_2</strong> and the
<strong>Size</strong> member to <strong>NDIS_SIZEOF_RECEIVE_SCALE_CAPABILITIES_REVISION_2</strong>.</p>

<p>For NDIS 6.0, 6.1, and 6.20, set the
<strong>Revision</strong> member to <strong>NDIS_RECEIVE_SCALE_CAPABILITIES_REVISION_1</strong> and the
<strong>Size</strong> member to <strong>NDIS_SIZEOF_RECEIVE_SCALE_CAPABILITIES_REVISION_1</strong>.</p>

<h3 id="capabilitiesflags"><code>CapabilitiesFlags</code></h3>

<p>A bitmask of flags that specify the RSS capabilities of the NIC. The
miniport driver can specify the following flags:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_RSS_CAPS_MESSAGE_SIGNALED_INTERRUPTS</strong></td>
  <td>Set this flag if the NIC supports message-signaled interrupts (MSIs). This flag indicates that the NIC can generate a separate interrupt for each CPU after it queues the packets that are assigned to that CPU.</td>
</tr>
<tr>
  <td><strong>NDIS_RSS_CAPS_CLASSIFICATION_AT_ISR</strong></td>
  <td>Set this flag if the NIC can indicate to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-miniport_isr">MiniportInterrupt</a> function which target CPUs have queued received packets.</td>
</tr>
<tr>
  <td><strong>NDIS_RSS_CAPS_USING_MSI_X</strong></td>
  <td>Set this flag if the NIC is using message signaled interrupts (MSIs). This flag is supported in NDIS 6.20 and later.</td>
</tr>
<tr>
  <td><strong>NDIS_RSS_CAPS_RSS_AVAILABLE_ON_PORTS</strong></td>
  <td>Set this flag if the NIC supports independent RSS configuration of ports. This flag is supported in NDIS 6.30 and later.</td>
</tr>
<tr>
  <td><strong>NDIS_RSS_CAPS_SUPPORTS_MSI_X</strong></td>
  <td>Set this flag if the NIC supports MSIs. This flag is supported in NDIS 6.30 and later.</td>
</tr>
<tr>
  <td><strong>NDIS_RSS_CAPS_CLASSIFICATION_AT_DPC</strong></td>
  <td>Set this flag if the miniport driver can detect which target CPUs have queued receive packets from its <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-miniport_interrupt_dpc">MiniportInterruptDPC</a> function.</td>
</tr>
<tr>
  <td><strong>NDIS_RSS_CAPS_HASH_TYPE_TCP_IPV4</strong></td>
  <td>Set this flag if the NIC can identify an IPv4 packet (with or without options). Also, the NIC supports calculation of the hash value over the IPv4 header fields and TCP header fields.</td>
</tr>
<tr>
  <td><strong>NDIS_RSS_CAPS_HASH_TYPE_TCP_IPV6</strong></td>
  <td>Set this flag if the NIC can identify an IPv6 packet and compute a hash value over fields in an IPv6 packet. The NIC must be able to compute a hash value over fields in the basic IPv6 header and over fields in the TCP header. Use this flag if the NIC cannot compute a hash value over fields that are located in IPv6 extension headers.</td>
</tr>
<tr>
  <td><strong>NDIS_RSS_CAPS_HASH_TYPE_TCP_IPV6_EX</strong></td>
  <td>Set this flag if the NIC can identify an IPv6 packet and compute a hash value over fields in an IPv6 packet that contains IPv6 extension headers. The NIC can compute a hash value over fields in the basic IPv6 header, IPv6 extension headers, and TCP header. The NIC must be able to compute hash values over fields in the home address option and the type-2 routing header in the IPv6 extension headers.</td>
</tr>
<tr>
  <td><strong>NDIS_RSS_CAPS_HASH_TYPE_UDP_IPV4</strong></td>
  <td>Set this flag if the NIC can identify an IPv4 packet, with or without options, and if the NIC supports calculation of the hash value over the IPv4 header fields and UDP header fields.</td>
</tr>
<tr>
  <td><strong>NDIS_RSS_CAPS_HASH_TYPE_UDP_IPV6</strong></td>
  <td>Set this flag if the NIC can identify an IPv6 packet and compute a hash value over fields in an IPv6 packet. The NIC must be able to compute a hash value over fields in the basic IPv6 header and over fields in the UDP header. Use this flag if the NIC cannot compute a hash value over fields that are located in IPv6 extension headers.</td>
</tr>
<tr>
  <td><strong>NDIS_RSS_CAPS_HASH_TYPE_UDP_IPV6_EX</strong></td>
  <td>Set this flag if the NIC can identify an IPv6 packet and compute a hash value over fields in an IPv6 packet that contains IPv6 extension headers. The NIC can compute a hash value over fields in the basic IPv6 header, IPv6 extension headers, and the UDP header. The NIC must be able to compute hash values over fields in the home address option and the type-2 routing header in the IPv6 extension headers.</td>
</tr>
<tr>
  <td><strong>NdisHashFunctionToeplitz</strong></td>
  <td>Set this flag if the NIC supports the toeplitz hash function. If the NIC supports RSS, support for the hash function is mandatory. For more information about hash functions, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-rss-hash-info-from-type-and-func">NDIS_RSS_HASH_FUNC_FROM_HASH_INFO</a>.</td>
</tr>
<tr>
  <td><strong>NdisHashFunctionReserved1</strong></td>
  <td>This flag is reserved for future use.</td>
</tr>
<tr>
  <td><strong>NdisHashFunctionReserved2</strong></td>
  <td>This flag is reserved for future use.</td>
</tr>
<tr>
  <td><strong>NdisHashFunctionReserved3</strong></td>
  <td>This flag is reserved for future use.</td>
</tr>
</tbody>
</table>

<h3 id="numberofinterruptmessages"><code>NumberOfInterruptMessages</code></h3>

<p>The number of interrupt messages that the NIC supports if the NIC supports MSIs. If the NIC does
not support MSIs but supports line-based interrupts, set this number to 1.</p>

<h3 id="numberofreceivequeues"><code>NumberOfReceiveQueues</code></h3>

<p>The number of hardware receive queues that the NIC supports.</p>

<h3 id="numberofindirectiontableentries"><code>NumberOfIndirectionTableEntries</code></h3>

<p>The maximum number of entries that the miniport driver supports in the indirection table. This value must be a power of 2. All NDIS 6.30 and later miniport adapters must support this member, which is required for virtual functions.</p>

<h2 id="remarks">Remarks</h2>

<p>Overlying drivers can use the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-gen-receive-scale-capabilities">OID_GEN_RECEIVE_SCALE_CAPABILITIES</a> OID to query the receive side scaling (RSS) capabilities of a
NIC and its miniport driver.</p>

<p>The miniport driver returns the RSS capabilities in an <strong>NDIS_RECEIVE_SCALE_CAPABILITIES</strong> structure.</p>

<p>For some workloads, a subset of UDP packets could be fragmented due to route changes or the sender not adhering to MTU limitations. In such rare cases, packets of the same flow could be indicated on different processors based on the 4-tuple or 2-tuple hash. Therefore, miniport drivers that advertise <strong>NDIS_RSS_CAPS_HASH_TYPE_UDP_IPV4</strong>, <strong>NDIS_RSS_CAPS_HASH_TYPE_UDP_IPV6</strong>, and <strong>NDIS_RSS_CAPS_HASH_TYPE_UDP_IPV6_EX</strong> should provide a way to disable UDP RSS capabilities via Advanced Properties.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-miniport_isr">MiniportInterrupt</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-miniport_interrupt_dpc">MiniportInterruptDPC</a></p>

<p><a rel="noopener" target="_blank" href="ndis_object_header">NDIS_OBJECT_HEADER</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-rss-hash-info-from-type-and-func">NDIS_RSS_HASH_FUNC_FROM_HASH_INFO</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-gen-receive-scale-capabilities">OID_GEN_RECEIVE_SCALE_CAPABILITIES</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-receive-side-scaling2">Receive Side Scaling (RSS)</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_receive_scale_capabilities">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddndis/ns-ntddndis-_ndis_receive_scale_capabilities.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
