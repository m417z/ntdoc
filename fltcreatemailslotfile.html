<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FltCreateMailslotFile - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FltCreateMailslotFile - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FltCreateMailslotFile - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// fltkernel.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> FLTAPI FltCreateMailslotFile(
  [in]            PFLT_FILTER               Filter,
  [in, optional]  PFLT_INSTANCE             Instance,
  [out]           PHANDLE                   FileHandle,
  [out, optional] <a href="file_object" title="typedef struct _FILE_OBJECT {&#10;  CSHORT                                Type;&#10;  CSHORT                                Size;&#10;  PDEVICE_OBJECT                        DeviceObject;&#10;  PVPB                                  Vpb;&#10;  PVOID                                 FsContext;&#10;  PVOID                                 FsContext2;&#10;  PSECTION_OBJECT_POINTERS              SectionObjectPointer;&#10;  PVOID                                 PrivateCacheMap;&#10;  NTSTATUS                              FinalStatus;&#10;  struct _FILE_OBJECT                   *RelatedFileObject;&#10;  BOOLEAN                               LockOperation;&#10;  BOOLEAN                               DeletePending;&#10;  BOOLEAN                               ReadAccess;&#10;  BOOLEAN                               WriteAccess;&#10;  BOOLEAN                               DeleteAccess;&#10;  BOOLEAN                               SharedRead;&#10;  BOOLEAN                               SharedWrite;&#10;  BOOLEAN                               SharedDelete;&#10;  ULONG                                 Flags;&#10;...">PFILE_OBJECT</a>              *FileObject,
  [in]            <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                     DesiredAccess,
  [in]            <a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PVOID SecurityDescriptor; // PSECURITY_DESCRIPTOR;&#10;    PVOID SecurityQualityOfService; // PSECURITY_QUALITY_OF_SERVICE&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">POBJECT_ATTRIBUTES</a>        ObjectAttributes,
  [out]           <a href="io_status_block" title="typedef struct _IO_STATUS_BLOCK&#10;{&#10;    union&#10;    {&#10;        NTSTATUS Status;&#10;        PVOID Pointer;&#10;    };&#10;    ULONG_PTR Information;&#10;} IO_STATUS_BLOCK, *PIO_STATUS_BLOCK;">PIO_STATUS_BLOCK</a>          IoStatusBlock,
  [in]            <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                     CreateOptions,
  [in]            <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                     MailslotQuota,
  [in]            <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                     MaximumMessageSize,
  [in]            PLARGE_INTEGER            ReadTimeout,
  [in, optional]  <a href="io_driver_create_context" title="typedef struct _IO_DRIVER_CREATE_CONTEXT {&#10;  CSHORT               Size;&#10;  struct _ECP_LIST     *ExtraCreateParameter;&#10;  PVOID                DeviceObjectHint;&#10;  PTXN_PARAMETER_BLOCK TxnParameters;&#10;  PESILO               SiloContext;&#10;} IO_DRIVER_CREATE_CONTEXT, *PIO_DRIVER_CREATE_CONTEXT;">PIO_DRIVER_CREATE_CONTEXT</a> DriverContext
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fltkernel/nf-fltkernel-fltcreatemailslotfile">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/fltcreatemailslotfile.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-fltkernel-fltcreatemailslotfile)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="fltcreatemailslotfile-function">FltCreateMailslotFile function</h1>

<h2 id="description">Description</h2>

<p>Minifilter drivers call <strong>FltCreateMailslotFile</strong> to create a new pipe or open an existing mailslot.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="filter-in"><code>Filter</code> [in]</h3>

<p>An opaque filter pointer for the caller.</p>

<h3 id="instance-in-optional"><code>Instance</code> [in, optional]</h3>

<p>An opaque instance pointer for the minifilter driver instance that the create request is to be sent to. The instance must be attached to the volume for the mailslot file system. This parameter is optional and can be <strong>NULL</strong>. If this parameter is <strong>NULL</strong>, the request is sent to the device object at the top of the file system driver stack for the volume. If it is non-<strong>NULL</strong>, the request is sent only to minifilter driver instances that are attached below the specified instance.</p>

<h3 id="filehandle-out"><code>FileHandle</code> [out]</h3>

<p>A pointer to a caller-allocated variable that receives the file handle if the call to <strong>FltCreateMailslotFile</strong> is successful.</p>

<h3 id="fileobject-out-optional"><code>FileObject</code> [out, optional]</h3>

<p>A pointer to a caller-allocated variable that receives the file object pointer if the call to <strong>FltCreateMailslotFile</strong> is successful. This parameter is optional and can be <strong>NULL</strong>.</p>

<h3 id="desiredaccess-in"><code>DesiredAccess</code> [in]</h3>

<p>A bitmask of flags that specify the type of access that the caller requires to the file or directory. The set of system-defined <strong>DesiredAccess</strong> flags determines the following specific access rights for file objects.</p>

<table>
<thead>
<tr>
  <th>DesiredAccess Flag</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>FILE_READ_DATA</td>
  <td>Data can be read from the named mailslot.</td>
</tr>
<tr>
  <td>FILE_READ_ATTRIBUTES</td>
  <td><strong>FileAttributes</strong> flags can be read. For additional information, see the table of valid flag values in the <strong>FileAttributes</strong> parameter of <strong><a href="fltcreatefileex2" title="NTSTATUS FLTAPI FltCreateFileEx2(&#10;  [in]            PFLT_FILTER               Filter,&#10;  [in, optional]  PFLT_INSTANCE             Instance,&#10;  [out]           PHANDLE                   FileHandle,&#10;  [out, optional] PFILE_OBJECT              *FileObject,&#10;  [in]            ACCESS_MASK               DesiredAccess,&#10;  [in]            POBJECT_ATTRIBUTES        ObjectAttributes,&#10;  [out]           PIO_STATUS_BLOCK          IoStatusBlock,&#10;  [in, optional]  PLARGE_INTEGER            AllocationSize,&#10;  [in]            ULONG                     FileAttributes,&#10;  [in]            ULONG                     ShareAccess,&#10;  [in]            ULONG                     CreateDisposition,&#10;  [in]            ULONG                     CreateOptions,&#10;  [in, optional]  PVOID                     EaBuffer,&#10;  [in]            ULONG                     EaLength,&#10;  [in]            ULONG                     Flags,&#10;  [in, optional]  PIO_DRIVER_CREATE_CONTEXT DriverContext&#10;);">FltCreateFileEx2</a></strong>.</td>
</tr>
<tr>
  <td>READ_CONTROL</td>
  <td>The access control list <a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a> and ownership information associated with the mailslot can be read.</td>
</tr>
<tr>
  <td>FILE_WRITE_DATA</td>
  <td>Data can be written to the mailslot.</td>
</tr>
<tr>
  <td>FILE_WRITE_ATTRIBUTES</td>
  <td><strong>FileAttributes</strong> flags can be written.</td>
</tr>
<tr>
  <td>FILE_APPEND_DATA</td>
  <td>Data can be appended to the mailslot.</td>
</tr>
<tr>
  <td>WRITE_DAC</td>
  <td>The discretionary access control list <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_acl">DACL</a> associated with the mailslot can be written.</td>
</tr>
<tr>
  <td>WRITE_OWNER</td>
  <td>Ownership information associated with the mailslot can be written.</td>
</tr>
<tr>
  <td>ACCESS_SYSTEM_SECURITY</td>
  <td>The caller will have write access to the mailslot's SACL.</td>
</tr>
<tr>
  <td>SYNCHRONIZE</td>
  <td>The caller can synchronize the completion of an I/O operation by waiting for the returned <strong>FileHandle</strong> to be set to the Signaled state. This flag must be set if the <strong>CreateOptions</strong> <a href="file_synchronous_io_alert" title="#define FILE_SYNCHRONOUS_IO_ALERT 0x00000010">FILE_SYNCHRONOUS_IO_ALERT</a> or <a href="file_synchronous_io_nonalert" title="#define FILE_SYNCHRONOUS_IO_NONALERT 0x00000020">FILE_SYNCHRONOUS_IO_NONALERT</a> flag is set.</td>
</tr>
</tbody>
</table>

<p>Alternatively, for any file object that does not represent a directory, you can specify one or more of the following generic <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/access-mask">ACCESS_MASK</a> flags. (The STANDARD_RIGHTS_<em>XXX</em> flags are predefined system values that are used to enforce security on system objects.) You can also combine these generic flags with additional flags from the preceding table.</p>

<table>
<thead>
<tr>
  <th>DesiredAccess to File Values</th>
  <th>Maps to DesiredAccess Flags</th>
</tr>
</thead>
<tbody>
<tr>
  <td>GENERIC_READ</td>
  <td>STANDARD_RIGHTS_READ, FILE_READ_DATA, and SYNCHRONIZE.</td>
</tr>
<tr>
  <td>GENERIC_WRITE</td>
  <td>STANDARD_RIGHTS_WRITE, FILE_WRITE_DATA, FILE_APPEND_DATA, and SYNCHRONIZE.</td>
</tr>
</tbody>
</table>

<h3 id="objectattributes-in"><code>ObjectAttributes</code> [in]</h3>

<p>Pointer to an opaque <a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PVOID SecurityDescriptor; // PSECURITY_DESCRIPTOR;&#10;    PVOID SecurityQualityOfService; // PSECURITY_QUALITY_OF_SERVICE&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">OBJECT_ATTRIBUTES</a> structure that is already initialized with <strong><a href="initializeobjectattributes" title="#define InitializeObjectAttributes(p, n, a, r, s) { \&#10;    (p)-&gt;Length = sizeof(OBJECT_ATTRIBUTES); \&#10;    (p)-&gt;RootDirectory = r; \&#10;    (p)-&gt;Attributes = a; \&#10;    (p)-&gt;ObjectName = n; \&#10;    (p)-&gt;SecurityDescriptor = s; \&#10;    (p)-&gt;SecurityQualityOfService = NULL; \&#10;    }">InitializeObjectAttributes</a></strong>. If the caller is running in the system process context, this parameter can be <strong>NULL</strong>. Otherwise, the caller must set the <a href="obj_kernel_handle" title="#define OBJ_KERNEL_HANDLE 0x00000200L">OBJ_KERNEL_HANDLE</a> attribute in the call to <strong><a href="initializeobjectattributes" title="#define InitializeObjectAttributes(p, n, a, r, s) { \&#10;    (p)-&gt;Length = sizeof(OBJECT_ATTRIBUTES); \&#10;    (p)-&gt;RootDirectory = r; \&#10;    (p)-&gt;Attributes = a; \&#10;    (p)-&gt;ObjectName = n; \&#10;    (p)-&gt;SecurityDescriptor = s; \&#10;    (p)-&gt;SecurityQualityOfService = NULL; \&#10;    }">InitializeObjectAttributes</a></strong>. Members of this structure for a file object are listed in the following table.</p>

<table>
<thead>
<tr>
  <th>Member</th>
  <th>Value</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Length</strong></td>
  <td>Number of bytes of data that are contained in the structure pointed to by <strong>ObjectAttributes</strong>. This value must be at least <code>sizeof(<a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PVOID SecurityDescriptor; // PSECURITY_DESCRIPTOR;&#10;    PVOID SecurityQualityOfService; // PSECURITY_QUALITY_OF_SERVICE&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">OBJECT_ATTRIBUTES</a>)</code>.</td>
</tr>
<tr>
  <td><strong><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">PUNICODE_STRING</a> ObjectName</strong></td>
  <td>Pointer to a <strong><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></strong> structure that contains the name of the mailslot to be created or opened. This name must be a fully qualified file specification or the name of a device object unless it is the name of a file relative to the directory specified by <strong>RootDirectory</strong>. For example, "\Device\Mailslot\myslot" or "\??\mailslot\myslot" could both be valid file specifications. (Note: "\??" replaces "\DosDevices" as the name of the Win32 object namespace. "\DosDevices" still works, but "\??" is translated faster by the object manager.</td>
</tr>
<tr>
  <td><strong>HANDLE RootDirectory</strong></td>
  <td>Optional handle to a directory, obtained by a preceding call to <strong><a href="fltcreatefileex2" title="NTSTATUS FLTAPI FltCreateFileEx2(&#10;  [in]            PFLT_FILTER               Filter,&#10;  [in, optional]  PFLT_INSTANCE             Instance,&#10;  [out]           PHANDLE                   FileHandle,&#10;  [out, optional] PFILE_OBJECT              *FileObject,&#10;  [in]            ACCESS_MASK               DesiredAccess,&#10;  [in]            POBJECT_ATTRIBUTES        ObjectAttributes,&#10;  [out]           PIO_STATUS_BLOCK          IoStatusBlock,&#10;  [in, optional]  PLARGE_INTEGER            AllocationSize,&#10;  [in]            ULONG                     FileAttributes,&#10;  [in]            ULONG                     ShareAccess,&#10;  [in]            ULONG                     CreateDisposition,&#10;  [in]            ULONG                     CreateOptions,&#10;  [in, optional]  PVOID                     EaBuffer,&#10;  [in]            ULONG                     EaLength,&#10;  [in]            ULONG                     Flags,&#10;  [in, optional]  PIO_DRIVER_CREATE_CONTEXT DriverContext&#10;);">FltCreateFileEx2</a></strong>. If this value is <strong>NULL</strong>, the <strong>ObjectName</strong> member must be a fully qualified file specification that includes the full path to the target mailslot. If this value is non-<strong>NULL</strong>, the <strong>ObjectName</strong> member specifies a mailslot name that is relative to this directory.</td>
</tr>
<tr>
  <td><strong>PSECURITY_DESCRIPTOR SecurityDescriptor</strong></td>
  <td>Optional <strong><a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a></strong> to be applied to a mailslot. <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_acl">ACLs</a> specified by such a security descriptor are only applied to the mailslot when it is created. If the value is <strong>NULL</strong> when a mailslot is created, the <a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a> placed on the mailslot is dependent on the mailslot file system and may allow a client with any access to create an instance.</td>
</tr>
<tr>
  <td><strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Attributes</strong></td>
  <td>A set of flags that controls the file object attributes. If the caller is running in the system process context, this parameter can be zero. Otherwise, the caller must set the <a href="obj_kernel_handle" title="#define OBJ_KERNEL_HANDLE 0x00000200L">OBJ_KERNEL_HANDLE</a> flag. The caller can also optionally set the <a href="obj_case_insensitive" title="#define OBJ_CASE_INSENSITIVE 0x00000040L">OBJ_CASE_INSENSITIVE</a> flag, which indicates that name-lookup code should ignore the case of <strong>ObjectName</strong> rather than performing an exact-match search.</td>
</tr>
</tbody>
</table>

<h3 id="iostatusblock-out"><code>IoStatusBlock</code> [out]</h3>

<p>Pointer to an <strong><a href="io_status_block" title="typedef struct _IO_STATUS_BLOCK&#10;{&#10;    union&#10;    {&#10;        NTSTATUS Status;&#10;        PVOID Pointer;&#10;    };&#10;    ULONG_PTR Information;&#10;} IO_STATUS_BLOCK, *PIO_STATUS_BLOCK;">IO_STATUS_BLOCK</a></strong> structure that receives the final completion status and information about the requested operation. On return from <strong>FltCreateMailslotFile</strong>, the <strong>Information</strong> member of the variable contains one of the following values:</p>

<ul>
<li><a href="file_created" title="#define FILE_CREATED 0x00000002">FILE_CREATED</a></li>
<li><a href="file_opened" title="#define FILE_OPENED 0x00000001">FILE_OPENED</a></li>
</ul>

<h3 id="createoptions-in"><code>CreateOptions</code> [in]</h3>

<p>The options to be applied when creating or opening the mailslot, as a compatible combination of the following flags.</p>

<table>
<thead>
<tr>
  <th>Flags</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><a href="file_write_through" title="#define FILE_WRITE_THROUGH 0x00000002">FILE_WRITE_THROUGH</a></td>
  <td>System services, file systems, and drivers that write data to the mailslot must actually transfer the data into the mailslot before any requested write operation is considered complete. This flag is automatically set if the <strong>CreateOptions</strong> flag <a href="file_no_intermediate_buffering" title="#define FILE_NO_INTERMEDIATE_BUFFERING 0x00000008">FILE_NO_INTERMEDIATE_BUFFERING</a> is set.</td>
</tr>
<tr>
  <td><a href="file_synchronous_io_alert" title="#define FILE_SYNCHRONOUS_IO_ALERT 0x00000010">FILE_SYNCHRONOUS_IO_ALERT</a></td>
  <td>All operations on the mailslot are performed synchronously. Any wait on behalf of the caller is subject to premature termination from alerts. This flag also causes the I/O system to maintain the mailslot position context. If this flag is set, the <strong>DesiredAccess</strong> SYNCHRONIZE flag also must be set so that the I/O Manager uses the file object as a synchronization object.</td>
</tr>
<tr>
  <td><a href="file_synchronous_io_nonalert" title="#define FILE_SYNCHRONOUS_IO_NONALERT 0x00000020">FILE_SYNCHRONOUS_IO_NONALERT</a></td>
  <td>All operations on the mailslot are performed synchronously. Waits in the system to synchronize I/O queuing and completion are not subject to alerts. This flag also causes the I/O system to maintain the file position context. If this flag is set, the <strong>DesiredAccess</strong> SYNCHRONIZE flag also must be set so that the I/O Manager uses the file object as a synchronization object.</td>
</tr>
</tbody>
</table>

<h3 id="mailslotquota-in"><code>MailslotQuota</code> [in]</h3>

<p>The size, in bytes, of the buffer for writes to the mailslot.</p>

<h3 id="maximummessagesize-in"><code>MaximumMessageSize</code> [in]</h3>

<p>The maximum size, in bytes, of a message to write to the mailslot. A message of any size is specified by the value 0.</p>

<h3 id="readtimeout-in"><code>ReadTimeout</code> [in]</h3>

<p>The time a read operation waits for a message to be available in the mailslot. The default timeout is expressed in 100-nanosecond increments as a negative integer. For example, 250 milliseconds is specified as <code>–10*1000*250</code>. Additionally, the following values have special meanings.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>0</td>
  <td>Returns immediately if no message is present.</td>
</tr>
<tr>
  <td>-1</td>
  <td>Waits forever for a message.</td>
</tr>
</tbody>
</table>

<h3 id="drivercontext-in-optional"><code>DriverContext</code> [in, optional]</h3>

<p>Optional pointer to an <strong><a href="io_driver_create_context" title="typedef struct _IO_DRIVER_CREATE_CONTEXT {&#10;  CSHORT               Size;&#10;  struct _ECP_LIST     *ExtraCreateParameter;&#10;  PVOID                DeviceObjectHint;&#10;  PTXN_PARAMETER_BLOCK TxnParameters;&#10;  PESILO               SiloContext;&#10;} IO_DRIVER_CREATE_CONTEXT, *PIO_DRIVER_CREATE_CONTEXT;">IO_DRIVER_CREATE_CONTEXT</a></strong> structure already initialized by <strong><a href="ioinitializedrivercreatecontext" title="VOID IoInitializeDriverCreateContext(&#10;  PIO_DRIVER_CREATE_CONTEXT DriverContext&#10;);">IoInitializeDriverCreateContext</a></strong>.</p>

<h2 id="return-value">Return value</h2>

<p><strong>FltCreateMailslotFile</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> or an appropriate <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> value such as one of the following.</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>STATUS_FLT_DELETING_OBJECT</td>
  <td>The filter or instance specified in the <strong>Filter</strong> or <strong>Instance</strong> parameters is being torn down. This status code can be received if the open request crosses a volume mount point and the <strong>Instance</strong> parameter is non-<strong>NULL</strong>. This is an error code.</td>
</tr>
<tr>
  <td>STATUS_OBJECT_PATH_SYNTAX_BAD</td>
  <td>The <strong>ObjectAttributes</strong> parameter did not contain a <strong>RootDirectory</strong> member, but the <strong>ObjectName</strong> member in the <a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PVOID SecurityDescriptor; // PSECURITY_DESCRIPTOR;&#10;    PVOID SecurityQualityOfService; // PSECURITY_QUALITY_OF_SERVICE&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">OBJECT_ATTRIBUTES</a> structure was an empty string or did not contain an OBJECT_NAME_PATH_SEPARATOR character. This error code indicates incorrect syntax for the object path.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>The <strong>FltCreateMailslotFile</strong> function allows minifilter drivers to create or open mailslot instances. This is useful for creating virtual mailslots or for creating a mailslot group that distributes to several other mailslots.</p>

<p>The <strong>Instance</strong> parameter is either <strong>NULL</strong> or is previously set by attaching to the mailslot volume. A volume pointer is obtained by passing "\Device\Mailslot" as the volume name to <strong><a href="fltgetvolumefromname" title="NTSTATUS FLTAPI FltGetVolumeFromName(&#10;  [in]  PFLT_FILTER      Filter,&#10;  [in]  PCUNICODE_STRING VolumeName,&#10;  [out] PFLT_VOLUME      *RetVolume&#10;);">FltGetVolumeFromName</a></strong>.</p>

<p>To specify an extra create parameter (ECP) as part of a create operation, initialize the <strong>ExtraCreateParameter</strong> member of the <strong><a href="io_driver_create_context" title="typedef struct _IO_DRIVER_CREATE_CONTEXT {&#10;  CSHORT               Size;&#10;  struct _ECP_LIST     *ExtraCreateParameter;&#10;  PVOID                DeviceObjectHint;&#10;  PTXN_PARAMETER_BLOCK TxnParameters;&#10;  PESILO               SiloContext;&#10;} IO_DRIVER_CREATE_CONTEXT, *PIO_DRIVER_CREATE_CONTEXT;">IO_DRIVER_CREATE_CONTEXT</a></strong> structure with the <strong><a href="fltallocateextracreateparameterlist" title="NTSTATUS FLTAPI FltAllocateExtraCreateParameterList(&#10;  [in]  PFLT_FILTER                  Filter,&#10;  [in]  FSRTL_ALLOCATE_ECPLIST_FLAGS Flags,&#10;  [out] PECP_LIST                    *EcpList&#10;);">FltAllocateExtraCreateParameterList</a></strong> routine. If ECPs are used, they must be allocated, initialized, and freed using their associated support routines. Upon returning from the call of <strong>FltCreateMailslotFile</strong>, the ECP list is unchanged and may be passed to additional calls of <strong>FltCreateMailslotFile</strong> for other create operations. The ECP list structure is not automatically deallocated. The caller of <strong>FltCreateMailslotFile</strong> must deallocate this structure by calling the <strong><a href="fltfreeextracreateparameterlist" title="VOID FLTAPI FltFreeExtraCreateParameterList(&#10;  [in] PFLT_FILTER Filter,&#10;  [in] PECP_LIST   EcpList&#10;);">FltFreeExtraCreateParameterList</a></strong> routine.</p>

<p>If <strong>Instance</strong> is not <strong>NULL</strong>, the create request from <strong>FltCreateMailslotFile</strong> is sent only to the instances attached below the specified minifilter driver instance and to the mailslot file system. The specified instance and the instances attached above it do not receive the create request. If no instance is specified, the request goes to the top of the stack and is received by all instances and the mailslot file system.</p>

<h2 id="see-also">See also</h2>

<p><strong><a href="fltallocateextracreateparameterlist" title="NTSTATUS FLTAPI FltAllocateExtraCreateParameterList(&#10;  [in]  PFLT_FILTER                  Filter,&#10;  [in]  FSRTL_ALLOCATE_ECPLIST_FLAGS Flags,&#10;  [out] PECP_LIST                    *EcpList&#10;);">FltAllocateExtraCreateParameterList</a></strong></p>

<p><strong><a href="fltfreeextracreateparameterlist" title="VOID FLTAPI FltFreeExtraCreateParameterList(&#10;  [in] PFLT_FILTER Filter,&#10;  [in] PECP_LIST   EcpList&#10;);">FltFreeExtraCreateParameterList</a></strong></p>

<p><strong><a href="io_driver_create_context" title="typedef struct _IO_DRIVER_CREATE_CONTEXT {&#10;  CSHORT               Size;&#10;  struct _ECP_LIST     *ExtraCreateParameter;&#10;  PVOID                DeviceObjectHint;&#10;  PTXN_PARAMETER_BLOCK TxnParameters;&#10;  PESILO               SiloContext;&#10;} IO_DRIVER_CREATE_CONTEXT, *PIO_DRIVER_CREATE_CONTEXT;">IO_DRIVER_CREATE_CONTEXT</a></strong></p>

<p><strong><a href="initializeobjectattributes" title="#define InitializeObjectAttributes(p, n, a, r, s) { \&#10;    (p)-&gt;Length = sizeof(OBJECT_ATTRIBUTES); \&#10;    (p)-&gt;RootDirectory = r; \&#10;    (p)-&gt;Attributes = a; \&#10;    (p)-&gt;ObjectName = n; \&#10;    (p)-&gt;SecurityDescriptor = s; \&#10;    (p)-&gt;SecurityQualityOfService = NULL; \&#10;    }">InitializeObjectAttributes</a></strong></p>

<p><strong><a href="ioinitializedrivercreatecontext" title="VOID IoInitializeDriverCreateContext(&#10;  PIO_DRIVER_CREATE_CONTEXT DriverContext&#10;);">IoInitializeDriverCreateContext</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fltkernel/nf-fltkernel-fltcreatemailslotfile">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/fltkernel/nf-fltkernel-fltcreatemailslotfile.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
