<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NDIS_PM_CAPABILITIES - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NDIS_PM_CAPABILITIES - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NDIS_PM_CAPABILITIES - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _NDIS_PM_CAPABILITIES {
  <a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a>      Header;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   Flags;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   SupportedWoLPacketPatterns;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   NumTotalWoLPatterns;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   MaxWoLPatternSize;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   MaxWoLPatternOffset;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   MaxWoLPacketSaveBuffer;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   SupportedProtocolOffloads;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   NumArpOffloadIPv4Addresses;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   NumNSOffloadIPv6Addresses;
  <a href="ndis_device_power_state" title="typedef enum _NDIS_DEVICE_POWER_STATE {&#10;  NdisDeviceStateUnspecified,&#10;  NdisDeviceStateD0,&#10;  NdisDeviceStateD1,&#10;  NdisDeviceStateD2,&#10;  NdisDeviceStateD3,&#10;  NdisDeviceStateMaximum&#10;} NDIS_DEVICE_POWER_STATE, *PNDIS_DEVICE_POWER_STATE;">NDIS_DEVICE_POWER_STATE</a> MinMagicPacketWakeUp;
  <a href="ndis_device_power_state" title="typedef enum _NDIS_DEVICE_POWER_STATE {&#10;  NdisDeviceStateUnspecified,&#10;  NdisDeviceStateD0,&#10;  NdisDeviceStateD1,&#10;  NdisDeviceStateD2,&#10;  NdisDeviceStateD3,&#10;  NdisDeviceStateMaximum&#10;} NDIS_DEVICE_POWER_STATE, *PNDIS_DEVICE_POWER_STATE;">NDIS_DEVICE_POWER_STATE</a> MinPatternWakeUp;
  <a href="ndis_device_power_state" title="typedef enum _NDIS_DEVICE_POWER_STATE {&#10;  NdisDeviceStateUnspecified,&#10;  NdisDeviceStateD0,&#10;  NdisDeviceStateD1,&#10;  NdisDeviceStateD2,&#10;  NdisDeviceStateD3,&#10;  NdisDeviceStateMaximum&#10;} NDIS_DEVICE_POWER_STATE, *PNDIS_DEVICE_POWER_STATE;">NDIS_DEVICE_POWER_STATE</a> MinLinkChangeWakeUp;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   SupportedWakeUpEvents;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   MediaSpecificWakeUpEvents;
} NDIS_PM_CAPABILITIES, *PNDIS_PM_CAPABILITIES;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_pm_capabilities">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndis_pm_capabilities.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddndis-_ndis_pm_capabilities)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>_NDIS_PM_CAPABILITIES structure</h1>
<h2>Description</h2>
<p>The <strong>NDIS_PM_CAPABILITIES</strong> structure specifies power management capabilities of a network adapter.</p>
<h2>Members</h2>
<h3><code>Header</code></h3>
<p>The type, revision, and size of the <strong>NDIS_PM_CAPABILITIES</strong> structure. This member is formatted as an <a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a> structure.</p>
<p>The miniport driver must set the <strong>Type</strong> member of <strong>Header</strong> to NDIS_OBJECT_TYPE_DEFAULT. To specify the version of the <strong>NDIS_PM_CAPABILITIES</strong> structure, the driver must set the <strong>Revision</strong> member of <strong>Header</strong> to the following value:</p>
<h4>NDIS_PM_CAPABILITIES_REVISION_2</h4>
<p>Added various changes for NDIS 6.30.</p>
<p>Set the <strong>Size</strong> member to NDIS_SIZEOF_NDIS_PM_CAPABILITIES_REVISION_2.</p>
<h4>NDIS_PM_CAPABILITIES_REVISION_1</h4>
<p>Original version for NDIS 6.20.</p>
<p>Set the <strong>Size</strong> member to NDIS_SIZEOF_NDIS_PM_CAPABILITIES_REVISION_1.</p>
<h3><code>Flags</code></h3>
<p>A <strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></strong> value that contains a bitwise <strong>OR</strong> of flags. For NDIS 6.20, this member is reserved for NDIS.</p>
<p>Starting with NDIS 6.30, the following flags are defined:</p>
<h4>NDIS_PM_WAKE_PACKET_INDICATION_SUPPORTED</h4>
<p>If this flag is set, the network adapter must be able to save the received packet that caused the adapter to generate a wake-up event.</p>
<p>If this flag is set, the miniport driver must be able to do the following with this packet after the network adapter transitions to a full-power state:</p>
<ul>
<li>
The miniport driver must be able to indicate the packet by calling <a href="ndismindicatereceivenetbufferlists" title="VOID NdisMIndicateReceiveNetBufferLists(&#10;  [in] NDIS_HANDLE      MiniportAdapterHandle,&#10;       PNET_BUFFER_LIST NetBufferList,&#10;  [in] NDIS_PORT_NUMBER PortNumber,&#10;  [in] ULONG            NumberOfNetBufferLists,&#10;  [in] ULONG            ReceiveFlags&#10;);">NdisMIndicateReceiveNetBufferLists</a>.
</li>
<li>
The miniport driver must be able to issue an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-pm-wake-reason">NDIS_STATUS_PM_WAKE_REASON</a> status indication and must pass the packet with the indication.
</li>
</ul>
<p>For more information about this power management capability, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/overview-of-ndis-wake-reason-statue-indications">NDIS Wake Reason Status Indications</a>.</p>
<h4>NDIS_PM_SELECTIVE_SUSPEND_SUPPORTED</h4>
<p>If this flag is set, the miniport driver supports NDIS selective suspend for network adapters.</p>
<p>For more information about this power management capability, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_netvista/">NDIS Selective Suspend</a>.</p>
<h3><code>SupportedWoLPacketPatterns</code></h3>
<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains a bitwise OR of flags that specify the wake-on-LAN (WOL) patterns that
a network adapter supports. Miniport drivers use these flags to advertise packet based WOL patterns that a network adapter
supports.</p>
<p>For more information about this member, see the Remarks section. For more information about WOL
patterns, see
<a href="ndis_pm_wol_pattern" title="typedef struct _NDIS_PM_WOL_PATTERN {&#10;  NDIS_OBJECT_HEADER     Header;&#10;  ULONG                  Flags;&#10;  ULONG                  Priority;&#10;  NDIS_PM_WOL_PACKET     WoLPacketType;&#10;  NDIS_PM_COUNTED_STRING FriendlyName;&#10;  ULONG                  PatternId;&#10;  ULONG                  NextWoLPatternOffset;&#10;  union {&#10;    struct {&#10;      ULONG  Flags;&#10;      UCHAR  IPv4SourceAddress[4];&#10;      UCHAR  IPv4DestAddress[4];&#10;      USHORT TCPSourcePortNumber;&#10;      USHORT TCPDestPortNumber;&#10;    } IPv4TcpSynParameters;&#10;    struct {&#10;      ULONG  Flags;&#10;      UCHAR  IPv6SourceAddress[16];&#10;      UCHAR  IPv6DestAddress[16];&#10;...">NDIS_PM_WOL_PATTERN</a>.</p>
<h4>NDIS_PM_WOL_BITMAP_PATTERN_SUPPORTED</h4>
<p>The network adapter can generate a wake-up event when it receives a packet that matches a
configured bitmap pattern.</p>
<h4>NDIS_PM_WOL_MAGIC_PACKET_SUPPORTED</h4>
<p>The network adapter can generate a wake-up event when it receives a WOL magic packet. A
<em>magic packet</em> contains within its payload a string of six bytes with a value of 0xFF, followed
immediately by 16 contiguous copies of the receiving network adapter's Ethernet address.</p>
<h4>NDIS_PM_WOL_IPV4_TCP_SYN_SUPPORTED</h4>
<p>The network adapter can generate a wake-up event when it receives an IPv4 TCP SYN packet.
Remote hosts send TCP SYN packets to initiate a TCP connection to the local computer.</p>
<h4>NDIS_PM_WOL_IPV6_TCP_SYN_SUPPORTED</h4>
<p>The network adapter can generate a wake-up event when it receives an IPv6 TCP SYN
packet.</p>
<h4>NDIS_PM_WOL_IPV4_DEST_ADDR_WILDCARD_SUPPORTED</h4>
<p>If this flag is set, the network adapter supports as
<em>wildcard values</em> any zero-filled, or
<em>unspecified</em>, values for IPv4 addresses and TCP/UDP ports in a WOL pattern.
In this way, the wildcard value matches any IPv4 address and any port value of the incoming packet in
the location that is specified by the WOL pattern.</p>
<p>When a network adapter supports an IPv4 based wake on LAN packet pattern, such as an IPv4 TCP SYN
pattern, it must support the generation of a wake-up event if the IPv4 addresses and port values of
the incoming packet match the ones that are specified in the wake-up pattern.</p>
<p>However, if the NDIS_PM_WOL_IPV4_DEST_ADDR_WILDCARD_SUPPORTED flag is set, the network adapter
can also generate a wake-up event if the following pattern matching conditions are true:</p>
<ul>
<li>Any value from the incoming packet in the location that is specified by the WOL pattern is a match, if
the WOL pattern for that location contains a wildcard value.</li>
<li>A value from the incoming packet in the location that is specified by the WOL pattern is a match if the
WOL pattern for that location contains a nonzero value that equals the packet's value.</li>
</ul>
<p>The miniport driver must restrict wake-up events to the specified IPv4 addresses and ports unless
an overlying driver enables this capability.</p>
<p><strong>Note</strong> Wildcard values that are enabled by this flag can include unspecified IPv4
source and destination addresses, as well as unspecified source and destination ports.</p>
<h4>NDIS_PM_WOL_IPV6_DEST_ADDR_WILDCARD_SUPPORTED</h4>
<p>If this flag is set, the network adapter supports as
<em>wildcard values</em> any zero-filled, or
<em>unspecified</em>, values for IPv6 addresses and TCP/UDP ports in a WOL pattern.
In this way, the wildcard value matches any IPv6 address and any port value of the incoming packet in
the location that is specified by the WOL pattern.</p>
<p>When a network adapter supports an IPv6 based wake on LAN packet pattern, such as an IPv6 TCP SYN
pattern, it must support the generation of a wake-up event if the IPv6 addresses and port values of
the incoming packet match the ones that are specified in the wake-up pattern.</p>
<p>However, if the NDIS_PM_WOL_IPV6_DEST_ADDR_WILDCARD_SUPPORTED flag is set, the network adapter
can also generate a wake-up event if the following pattern matching conditions are true:</p>
<ul>
<li>Any value from the incoming packet in the location that is specified by the WOL pattern is a match, if
the WOL pattern for that location contains a wildcard value.</li>
<li>A value from the incoming packet in the location that is specified by the WOL pattern is a match if the
WOL pattern for that location contains a nonzero value that equals the packet's value.</li>
</ul>
<p>The miniport driver must restrict wake-up events to the specified IPv6 addresses and ports unless
an overlying driver enables this capability.</p>
<p><strong>Note</strong> Wildcard values that are enabled by this flag can include unspecified IPv6
source and destination addresses, as well as unspecified source and destination ports.</p>
<h4>NDIS_PM_WOL_EAPOL_REQUEST_ID_MESSAGE_SUPPORTED</h4>
<p>The network adapter can generate a wake-up event when it receives an EAPOL request identifier
message.</p>
<h3><code>NumTotalWoLPatterns</code></h3>
<p>A <strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></strong> value that contains the total number of WOL patterns that a network adapter supports. This is the sum of "number of
supported WOL protocol patterns" and "number of supported WOL bitmap patterns."</p>
<p>For example, if your driver supports 8 flexible bitmap patterns, IPv4 TCP SYN (via preset filter), and magic packet, then you would report 9 in NumTotalWoLPatterns. (8 bitmaps + 1 IPv4 TCP SYN = 9)</p>
<p><strong>Note</strong> The total number of WOL patterns does not include the magic packet wake-up
pattern.</p>
<p>For more information about WOL
protocol patterns, see
<a href="ndis_pm_wol_pattern" title="typedef struct _NDIS_PM_WOL_PATTERN {&#10;  NDIS_OBJECT_HEADER     Header;&#10;  ULONG                  Flags;&#10;  ULONG                  Priority;&#10;  NDIS_PM_WOL_PACKET     WoLPacketType;&#10;  NDIS_PM_COUNTED_STRING FriendlyName;&#10;  ULONG                  PatternId;&#10;  ULONG                  NextWoLPatternOffset;&#10;  union {&#10;    struct {&#10;      ULONG  Flags;&#10;      UCHAR  IPv4SourceAddress[4];&#10;      UCHAR  IPv4DestAddress[4];&#10;      USHORT TCPSourcePortNumber;&#10;      USHORT TCPDestPortNumber;&#10;    } IPv4TcpSynParameters;&#10;    struct {&#10;      ULONG  Flags;&#10;      UCHAR  IPv6SourceAddress[16];&#10;      UCHAR  IPv6DestAddress[16];&#10;...">NDIS_PM_WOL_PATTERN</a>.</p>
<h3><code>MaxWoLPatternSize</code></h3>
<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains the maximum number of bytes that can be compared with a
pattern.</p>
<h3><code>MaxWoLPatternOffset</code></h3>
<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains the number of bytes in a packet that can be examined, starting at
the beginning of the MAC header.</p>
<h3><code>MaxWoLPacketSaveBuffer</code></h3>
<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains the number of bytes of a WOL packet that a miniport driver can save to
a buffer and indicate up the driver stack. This value must be less than or equal to the size, in bytes, of the maximum transmission unit (MTU) for the network media. The driver reports the MTU size through OID query requests of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-gen-maximum-frame-size">OID_GEN_MAXIMUM_FRAME_SIZE</a>.</p>
<p><strong>Note</strong> This member is ignored in NDIS 6.20 and earlier versions of NDIS. Starting with NDIS 6.30, this member must contain a nonzero value if the NDIS_PM_WAKE_PACKET_INDICATION_SUPPORTED flag is set in the <strong>Flags</strong> member.</p>
<h3><code>SupportedProtocolOffloads</code></h3>
<p>A <strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></strong> value that contains a bitwise <strong>OR</strong> of flags that specify the protocol offload features that
a network adapter supports. Miniport drivers use these flags to report the low power protocol offload capabilities
of a network adapter.</p>
<h4>NDIS_PM_PROTOCOL_OFFLOAD_ARP_SUPPORTED</h4>
<p>If this bit is set, the network adapter can respond to IPv4 ARP packets while it is in a low
power state</p>
<p>For more information about the ARP protocol, see RFC 826.</p>
<h4>NDIS_PM_PROTOCOL_OFFLOAD_NS_SUPPORTED</h4>
<p>If this bit is set, the network adapter can respond to IPv6 Neighbor Solicitation (NS) packets
while it is in a low power state.</p>
<p>For more information about IPv6 NS messages, see <a rel="noopener" target="_blank" href="https://go.microsoft.com/fwlink/p/?linkid=268370">RFC 4861</a>.</p>
<h4>NDIS_PM_PROTOCOL_OFFLOAD_80211_RSN_REKEY_SUPPORTED</h4>
<p>The network adapter can respond to IEEE 802.11i Robust Security Network (RSN) re-key requests
while it is in a low power state.</p>
<h3><code>NumArpOffloadIPv4Addresses</code></h3>
<p>A <strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></strong> value that contains the number of IPv4 addresses that the adapter supports for ARP
offload.</p>
<h3><code>NumNSOffloadIPv6Addresses</code></h3>
<p>A <strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></strong> value that contains the number of IPv6 NS offload requests that the adapter supports. This should be at least 2.</p>
<p><strong>Note</strong> Despite its name, the <strong>NumNSOffloadIPv6Addresses</strong> contains the number of supported requests, not addresses.</p>
<h3><code>MinMagicPacketWakeUp</code></h3>
<p>Specifies the lowest device power state from which a network adapter can signal a wake-up event on receipt of
a magic packet. A
<em>magic packet</em> contains within its payload a string of six bytes with a value of 0xFF, followed
immediately by 16 contiguous copies of the receiving network adapter's MAC address.</p>
<p><strong>Note</strong> Device power states are specified by a value of D<em>x</em>, where D0 is the highest device power state and D3 is the lowest device power state.</p>
<p>The device power state is specified as one of the following <a href="ndis_device_power_state" title="typedef enum _NDIS_DEVICE_POWER_STATE {&#10;  NdisDeviceStateUnspecified,&#10;  NdisDeviceStateD0,&#10;  NdisDeviceStateD1,&#10;  NdisDeviceStateD2,&#10;  NdisDeviceStateD3,&#10;  NdisDeviceStateMaximum&#10;} NDIS_DEVICE_POWER_STATE, *PNDIS_DEVICE_POWER_STATE;">NDIS_DEVICE_POWER_STATE</a> values:</p>
<h4>NdisDeviceStateUnspecified</h4>
<p>The network adapter does not support magic packet wake-ups.</p>
<p><strong>Note</strong> If the <strong>MinMagicPacketWakeUp</strong> member is set to this value, the NDIS_PM_WOL_MAGIC_PACKET_SUPPORTED flag must not be set in the <strong>SupportedWoLPacketPatterns</strong> member.</p>
<h4>NdisDeviceStateD0</h4>
<p>The network adapter can signal a magic packet wake-up from device power state D0. Because D0 is the fully
powered state, this does not cause a wake-up, but can be used as a run-time event.</p>
<p><strong>Note</strong> Starting with NDIS 6.20, signaling a magic packet wake-up from NdisDeviceStateD0 is no longer supported.</p>
<h4>NdisDeviceStateD1</h4>
<p>The network adapter can signal a magic packet wake-up from a device power state of D1.</p>
<h4>NdisDeviceStateD2</h4>
<p>The network adapter can signal a magic packet wake-up from a device state of D2.</p>
<h4>NdisDeviceStateD3</h4>
<p>The network adapter can signal a magic packet wake-up from a device power state of D3.</p>
<h3><code>MinPatternWakeUp</code></h3>
<p>Specifies the lowest device power state from which a network adapter can signal a wake-up event on receipt of
a network frame that contains a pattern that is specified by the protocol driver. The power state is
specified as one of the following <a href="ndis_device_power_state" title="typedef enum _NDIS_DEVICE_POWER_STATE {&#10;  NdisDeviceStateUnspecified,&#10;  NdisDeviceStateD0,&#10;  NdisDeviceStateD1,&#10;  NdisDeviceStateD2,&#10;  NdisDeviceStateD3,&#10;  NdisDeviceStateMaximum&#10;} NDIS_DEVICE_POWER_STATE, *PNDIS_DEVICE_POWER_STATE;">NDIS_DEVICE_POWER_STATE</a> values:</p>
<h4>NdisDeviceStateUnspecified</h4>
<p>The network adapter does not support pattern-match wake-ups.</p>
<p><strong>Note</strong> If the <strong>MinPatternWakeUp</strong> member is set to this value, only the NDIS_PM_WOL_MAGIC_PACKET_SUPPORTED flag can be set in the <strong>SupportedWoLPacketPatterns</strong>  member.</p>
<h4>NdisDeviceStateD0</h4>
<p>The network adapter can signal a pattern-match wake-up from device power state D0. Because D0 is the fully
powered state, this does not cause a wake-up but can be used as a run-time event.</p>
<p><strong>Note</strong> Starting with NDIS 6.20, signaling a pattern-match wake-up from NdisDeviceStateD0 is no longer supported.</p>
<h4>NdisDeviceStateD1</h4>
<p>The network adapter can signal a pattern-match wake-up from a device power state of D1.</p>
<h4>NdisDeviceStateD2</h4>
<p>The network adapter can signal a pattern-match wake-up from a device power state of D2.</p>
<h4>NdisDeviceStateD3</h4>
<p>The network adapter can signal a pattern-match wake-up from a device power state of D3.</p>
<h3><code>MinLinkChangeWakeUp</code></h3>
<p>Starting with NDIS 6.20, this member specifies the lowest device power state from which a network adapter can signal a wake-up event when the link
state changes from media disconnected to media connected.</p>
<p>Starting with NDIS 6.30, this member specifies the lowest device power state from which a network adapter can signal wake-up events. These events are specified in the <strong>SupportedWakeUpEvents</strong> member.</p>
<p>The power state is specified as one of the
following <a href="ndis_device_power_state" title="typedef enum _NDIS_DEVICE_POWER_STATE {&#10;  NdisDeviceStateUnspecified,&#10;  NdisDeviceStateD0,&#10;  NdisDeviceStateD1,&#10;  NdisDeviceStateD2,&#10;  NdisDeviceStateD3,&#10;  NdisDeviceStateMaximum&#10;} NDIS_DEVICE_POWER_STATE, *PNDIS_DEVICE_POWER_STATE;">NDIS_DEVICE_POWER_STATE</a> values:</p>
<h4>NdisDeviceStateUnspecified</h4>
<p>The network adapter does not support link change wake-ups.</p>
<p><strong>Note</strong> If the <strong>MinLinkChangeWakeUp</strong> member is set to this value, the<strong>SupportedWakeUpEvents</strong> member must be set to zero.</p>
<h4>NdisDeviceStateD0</h4>
<p>The network adapter can signal a link change wake-up from device power state D0. Because D0 is the fully
powered state, this does not cause a wake-up but can be used as a run-time event.</p>
<p><strong>Note</strong> Starting with NDIS 6.20, signaling a link change wake-up from NdisDeviceStateD0 is no longer supported.</p>
<h4>NdisDeviceStateD1</h4>
<p>The network adapter can signal a link change wake-up from a device power state of D1.</p>
<h4>NdisDeviceStateD2</h4>
<p>The network adapter can signal a link change wake-up from a device power state of D2.</p>
<h4>NdisDeviceStateD3</h4>
<p>The network adapter can signal a link change wake-up from a device power state of D3.</p>
<h3><code>SupportedWakeUpEvents</code></h3>
<p>A <strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></strong> value that contains a bitwise <strong>OR</strong> of flags. These flags specify the media-independent wake-up events that a network adapter supports.
These events are not specific to media type.</p>
<p>Starting with NDIS 6.30, the following flags are defined:</p>
<h4>NDIS_PM_WAKE_ON_MEDIA_CONNECT_SUPPORTED</h4>
<p>If this flag is set, the network adapter can generate a wake-up event when it becomes connected to the networking interface.</p>
<h4>NDIS_PM_WAKE_ON_MEDIA_DISCONNECT_SUPPORTED</h4>
<p>If this flag is set, the network adapter can generate a wake-up event when it becomes disconnected to the networking interface.</p>
<h3><code>MediaSpecificWakeUpEvents</code></h3>
<p>A <strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></strong> value that contains a bitwise <strong>OR</strong> of flags. These flags specify the media-specific wake-up events that a network adapter supports.</p>
<p>Starting with NDIS 6.30, the following flags are defined:</p>
<h4>NDIS_WLAN_WAKE_ON_NLO_DISCOVERY_SUPPORTED</h4>
<p>If this flag is set, the 802.11 network adapter can generate a wake-up event if it detects a service set identifier (SSID) that was specified through a network list offload (NLO).</p>
<p>For more information about NLO, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/wi-fi-network-list-offload">Wi-Fi Network List Offload</a>.</p>
<h4>NDIS_WLAN_WAKE_ON_AP_ASSOCIATION_LOST_SUPPORTED</h4>
<p>If this flag is set, the 802.11 network adapter can generate a wake-up event if it disassociates with the access point (AP).</p>
<h4>NDIS_WLAN_WAKE_ON_GTK_HANDSHAKE_ERROR_SUPPORTED</h4>
<p>If this flag is set, the 802.11 network adapter can generate a wake-up event if it encounters an error during the IEEE 802.11i RSN group transient key (GTK) handshake with the AP.</p>
<h4>NDIS_WLAN_WAKE_ON_4WAY_HANDSHAKE_REQUEST_SUPPORTED</h4>
<p>If this flag is set, the 802.11 network adapter can generate a wake-up event if it receives the first frame of the IEEE 802.11i RSN 4-way handshake with the AP. This handshake is performed when the adapter authenticates with the AP.</p>
<h4>NDIS_WWAN_WAKE_ON_REGISTER_STATE_SUPPORTED</h4>
<p>If this flag is set, the mobile broadband (MB) network adapter can generate a wake-up event if its registration state to the MB Service has changed.</p>
<h4>NDIS_WWAN_WAKE_ON_SMS_RECEIVE_SUPPORTED</h4>
<p>If this flag is set, the MB network adapter can generate a wake-up event if the MB Service has to be notified about the receipt of a Short Message Service (SMS) message. The adapter generates this wake-up event either after the completion of a previously issued <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-wwan-sms-read">OID_WWAN_SMS_READ</a> query request, or the arrival of a new class-0 (flash/alert) message from the network provider as an event notification.</p>
<h4>NDIS_WWAN_WAKE_ON_USSD_RECEIVE_SUPPORTED</h4>
<p>If this flag is set, the MB network adapter can generate a wake-up event if it receives an Unstructured Supplementary Service Data (USSD) message.</p>
<h2>Remarks</h2>
<p>The <strong>NDIS_PM_CAPABILITIES</strong> structure is used in the
<strong>PowerManagementCapabilitiesEx</strong> member of the
<a href="ndis_miniport_adapter_general_attributes" title="typedef struct _NDIS_MINIPORT_ADAPTER_GENERAL_ATTRIBUTES {&#10;  NDIS_OBJECT_HEADER               Header;&#10;  ULONG                            Flags;&#10;  NDIS_MEDIUM                      MediaType;&#10;  NDIS_PHYSICAL_MEDIUM             PhysicalMediumType;&#10;  ULONG                            MtuSize;&#10;  ULONG64                          MaxXmitLinkSpeed;&#10;  ULONG64                          XmitLinkSpeed;&#10;  ULONG64                          MaxRcvLinkSpeed;&#10;  ULONG64                          RcvLinkSpeed;&#10;  NDIS_MEDIA_CONNECT_STATE         MediaConnectState;&#10;  NDIS_MEDIA_DUPLEX_STATE          MediaDuplexState;&#10;  ULONG                            LookaheadSize;&#10;  PNDIS_PNP_CAPABILITIES           PowerManagementCapabilities;&#10;  ULONG                            MacOptions;&#10;  ULONG                            SupportedPacketFilters;&#10;  ULONG                            MaxMulticastListSize;&#10;  USHORT                           MacAddressLength;&#10;  UCHAR                            PermanentMacAddress[NDIS_MAX_PHYS_ADDRESS_LENGTH];&#10;  UCHAR                            CurrentMacAddress[NDIS_MAX_PHYS_ADDRESS_LENGTH];&#10;...">NDIS_MINIPORT_ADAPTER_GENERAL_ATTRIBUTES</a> and
<a href="ndis_bind_parameters" title="typedef struct _NDIS_BIND_PARAMETERS {&#10;  NDIS_OBJECT_HEADER                Header;&#10;  PNDIS_STRING                      ProtocolSection;&#10;  PNDIS_STRING                      AdapterName;&#10;  PDEVICE_OBJECT                    PhysicalDeviceObject;&#10;  NDIS_MEDIUM                       MediaType;&#10;  ULONG                             MtuSize;&#10;  ULONG64                           MaxXmitLinkSpeed;&#10;  ULONG64                           XmitLinkSpeed;&#10;  ULONG64                           MaxRcvLinkSpeed;&#10;  ULONG64                           RcvLinkSpeed;&#10;  NDIS_MEDIA_CONNECT_STATE          MediaConnectState;&#10;  NDIS_MEDIA_DUPLEX_STATE           MediaDuplexState;&#10;  ULONG                             LookaheadSize;&#10;  PNDIS_PNP_CAPABILITIES            PowerManagementCapabilities;&#10;  ULONG                             SupportedPacketFilters;&#10;  ULONG                             MaxMulticastListSize;&#10;  USHORT                            MacAddressLength;&#10;  UCHAR                             CurrentMacAddress[NDIS_MAX_PHYS_ADDRESS_LENGTH];&#10;  NDIS_PHYSICAL_MEDIUM              PhysicalMediumType;&#10;...">NDIS_BIND_PARAMETERS</a> structures and in
the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-pm-capabilities-change">NDIS_STATUS_PM_CAPABILITIES_CHANGE</a> status indication.</p>
<p>During miniport initialization, the miniport driver initializes an <strong>NDIS_PM_CAPABILITIES</strong> structure with
the power management capabilities of the network adapter hardware. The miniport driver then sets the
<strong>PowerManagementCapabilitiesEx</strong> member of the <a href="ndis_miniport_adapter_general_attributes" title="typedef struct _NDIS_MINIPORT_ADAPTER_GENERAL_ATTRIBUTES {&#10;  NDIS_OBJECT_HEADER               Header;&#10;  ULONG                            Flags;&#10;  NDIS_MEDIUM                      MediaType;&#10;  NDIS_PHYSICAL_MEDIUM             PhysicalMediumType;&#10;  ULONG                            MtuSize;&#10;  ULONG64                          MaxXmitLinkSpeed;&#10;  ULONG64                          XmitLinkSpeed;&#10;  ULONG64                          MaxRcvLinkSpeed;&#10;  ULONG64                          RcvLinkSpeed;&#10;  NDIS_MEDIA_CONNECT_STATE         MediaConnectState;&#10;  NDIS_MEDIA_DUPLEX_STATE          MediaDuplexState;&#10;  ULONG                            LookaheadSize;&#10;  PNDIS_PNP_CAPABILITIES           PowerManagementCapabilities;&#10;  ULONG                            MacOptions;&#10;  ULONG                            SupportedPacketFilters;&#10;  ULONG                            MaxMulticastListSize;&#10;  USHORT                           MacAddressLength;&#10;  UCHAR                            PermanentMacAddress[NDIS_MAX_PHYS_ADDRESS_LENGTH];&#10;  UCHAR                            CurrentMacAddress[NDIS_MAX_PHYS_ADDRESS_LENGTH];&#10;...">NDIS_MINIPORT_ADAPTER_GENERAL_ATTRIBUTES</a> structure to
point to the initialized <strong>NDIS_PM_CAPABILITIES</strong> structure.</p>
<p>An overlying driver should not try to enable capabilities that a network adapter does not support. To
allow an overlying driver to determine what capabilities a network adapter provides, NDIS provides the
capabilities in the
<strong>PowerManagementCapabilitiesEx</strong> member of the <a href="ndis_bind_parameters" title="typedef struct _NDIS_BIND_PARAMETERS {&#10;  NDIS_OBJECT_HEADER                Header;&#10;  PNDIS_STRING                      ProtocolSection;&#10;  PNDIS_STRING                      AdapterName;&#10;  PDEVICE_OBJECT                    PhysicalDeviceObject;&#10;  NDIS_MEDIUM                       MediaType;&#10;  ULONG                             MtuSize;&#10;  ULONG64                           MaxXmitLinkSpeed;&#10;  ULONG64                           XmitLinkSpeed;&#10;  ULONG64                           MaxRcvLinkSpeed;&#10;  ULONG64                           RcvLinkSpeed;&#10;  NDIS_MEDIA_CONNECT_STATE          MediaConnectState;&#10;  NDIS_MEDIA_DUPLEX_STATE           MediaDuplexState;&#10;  ULONG                             LookaheadSize;&#10;  PNDIS_PNP_CAPABILITIES            PowerManagementCapabilities;&#10;  ULONG                             SupportedPacketFilters;&#10;  ULONG                             MaxMulticastListSize;&#10;  USHORT                            MacAddressLength;&#10;  UCHAR                             CurrentMacAddress[NDIS_MAX_PHYS_ADDRESS_LENGTH];&#10;  NDIS_PHYSICAL_MEDIUM              PhysicalMediumType;&#10;...">NDIS_BIND_PARAMETERS</a> structure.</p>
<p><strong>Note</strong> NDIS 6.20 drivers must use the
<strong>PowerManagementCapabilitiesEx</strong> member instead of the
<strong>PowerManagementCapabilities</strong> member.</p>
<p>The
<strong>SupportedProtocolOffloads</strong> member contains flags that specify the protocol offload features that a
network adapter supports. The network adapter handles these protocols in a low power state. For example, if the network adapter hardware can
handle IPv4 ARP packets for the driver stack while it is in a low power state, the miniport driver sets
the NDIS_PM_PROTOCOL_OFFLOAD_ARP_SUPPORTED bit in
<strong>SupportedProtocolOffloads</strong>.</p>
<h2>See also</h2>
<p><a href="ndis_bind_parameters" title="typedef struct _NDIS_BIND_PARAMETERS {&#10;  NDIS_OBJECT_HEADER                Header;&#10;  PNDIS_STRING                      ProtocolSection;&#10;  PNDIS_STRING                      AdapterName;&#10;  PDEVICE_OBJECT                    PhysicalDeviceObject;&#10;  NDIS_MEDIUM                       MediaType;&#10;  ULONG                             MtuSize;&#10;  ULONG64                           MaxXmitLinkSpeed;&#10;  ULONG64                           XmitLinkSpeed;&#10;  ULONG64                           MaxRcvLinkSpeed;&#10;  ULONG64                           RcvLinkSpeed;&#10;  NDIS_MEDIA_CONNECT_STATE          MediaConnectState;&#10;  NDIS_MEDIA_DUPLEX_STATE           MediaDuplexState;&#10;  ULONG                             LookaheadSize;&#10;  PNDIS_PNP_CAPABILITIES            PowerManagementCapabilities;&#10;  ULONG                             SupportedPacketFilters;&#10;  ULONG                             MaxMulticastListSize;&#10;  USHORT                            MacAddressLength;&#10;  UCHAR                             CurrentMacAddress[NDIS_MAX_PHYS_ADDRESS_LENGTH];&#10;  NDIS_PHYSICAL_MEDIUM              PhysicalMediumType;&#10;...">NDIS_BIND_PARAMETERS</a></p>
<p><a href="ndis_miniport_adapter_general_attributes" title="typedef struct _NDIS_MINIPORT_ADAPTER_GENERAL_ATTRIBUTES {&#10;  NDIS_OBJECT_HEADER               Header;&#10;  ULONG                            Flags;&#10;  NDIS_MEDIUM                      MediaType;&#10;  NDIS_PHYSICAL_MEDIUM             PhysicalMediumType;&#10;  ULONG                            MtuSize;&#10;  ULONG64                          MaxXmitLinkSpeed;&#10;  ULONG64                          XmitLinkSpeed;&#10;  ULONG64                          MaxRcvLinkSpeed;&#10;  ULONG64                          RcvLinkSpeed;&#10;  NDIS_MEDIA_CONNECT_STATE         MediaConnectState;&#10;  NDIS_MEDIA_DUPLEX_STATE          MediaDuplexState;&#10;  ULONG                            LookaheadSize;&#10;  PNDIS_PNP_CAPABILITIES           PowerManagementCapabilities;&#10;  ULONG                            MacOptions;&#10;  ULONG                            SupportedPacketFilters;&#10;  ULONG                            MaxMulticastListSize;&#10;  USHORT                           MacAddressLength;&#10;  UCHAR                            PermanentMacAddress[NDIS_MAX_PHYS_ADDRESS_LENGTH];&#10;  UCHAR                            CurrentMacAddress[NDIS_MAX_PHYS_ADDRESS_LENGTH];&#10;...">NDIS_MINIPORT_ADAPTER_GENERAL_ATTRIBUTES</a></p>
<p><a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a></p>
<p><a href="ndis_pm_wol_pattern" title="typedef struct _NDIS_PM_WOL_PATTERN {&#10;  NDIS_OBJECT_HEADER     Header;&#10;  ULONG                  Flags;&#10;  ULONG                  Priority;&#10;  NDIS_PM_WOL_PACKET     WoLPacketType;&#10;  NDIS_PM_COUNTED_STRING FriendlyName;&#10;  ULONG                  PatternId;&#10;  ULONG                  NextWoLPatternOffset;&#10;  union {&#10;    struct {&#10;      ULONG  Flags;&#10;      UCHAR  IPv4SourceAddress[4];&#10;      UCHAR  IPv4DestAddress[4];&#10;      USHORT TCPSourcePortNumber;&#10;      USHORT TCPDestPortNumber;&#10;    } IPv4TcpSynParameters;&#10;    struct {&#10;      ULONG  Flags;&#10;      UCHAR  IPv6SourceAddress[16];&#10;      UCHAR  IPv6DestAddress[16];&#10;...">NDIS_PM_WOL_PATTERN</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-pm-capabilities-change">NDIS_STATUS_PM_CAPABILITIES_CHANGE</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-pm-wake-reason">NDIS_STATUS_PM_WAKE_REASON</a></p>
<p><a href="ndismindicatereceivenetbufferlists" title="VOID NdisMIndicateReceiveNetBufferLists(&#10;  [in] NDIS_HANDLE      MiniportAdapterHandle,&#10;       PNET_BUFFER_LIST NetBufferList,&#10;  [in] NDIS_PORT_NUMBER PortNumber,&#10;  [in] ULONG            NumberOfNetBufferLists,&#10;  [in] ULONG            ReceiveFlags&#10;);">NdisMIndicateReceiveNetBufferLists</a></p>
<p><a href="ndismindicatestatusex" title="VOID NdisMIndicateStatusEx(&#10;  [in] NDIS_HANDLE             MiniportAdapterHandle,&#10;  [in] PNDIS_STATUS_INDICATION StatusIndication&#10;);">NdisMIndicateStatusEx</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_pm_capabilities">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddndis/ns-ntddndis-_ndis_pm_capabilities.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
