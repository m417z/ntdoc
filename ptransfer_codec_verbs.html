<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PTRANSFER_CODEC_VERBS - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PTRANSFER_CODEC_VERBS - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PTRANSFER_CODEC_VERBS - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// hdaudio.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PTRANSFER_CODEC_VERBS PtransferCodecVerbs;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> PtransferCodecVerbs(
  [in]      PVOID _context,
  [in]      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Count,
  [in, out] <a href="hdaudio_codec_transfer" title="typedef struct _HDAUDIO_CODEC_TRANSFER {&#10;  HDAUDIO_CODEC_COMMAND  Output;&#10;  HDAUDIO_CODEC_RESPONSE Input;&#10;} HDAUDIO_CODEC_TRANSFER, *PHDAUDIO_CODEC_TRANSFER;">PHDAUDIO_CODEC_TRANSFER</a> CodecTransfer,
  [in]      <a href="phdaudio_transfer_complete_callback" title="PHDAUDIO_TRANSFER_COMPLETE_CALLBACK PhdaudioTransferCompleteCallback;&#10;&#10;VOID PhdaudioTransferCompleteCallback(&#10;  HDAUDIO_CODEC_TRANSFER *unnamedParam1,&#10;  PVOID unnamedParam2&#10;)&#10;{...}">PHDAUDIO_TRANSFER_COMPLETE_CALLBACK</a> Callback,
  [in]      PVOID Context
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/hdaudio/nc-hdaudio-ptransfer_codec_verbs">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ptransfer_codec_verbs.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-hdaudio-ptransfer_codec_verbs)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>PTRANSFER_CODEC_VERBS callback function</h1>
<h2>Description</h2>
<p>The <em>TransferCodecVerbs</em> routine transfers one or more commands to a codec or codecs and retrieves the responses to those commands.</p>
<p>The function pointer type for a <em>TransferCodecVerbs</em> routine is defined as follows.</p>
<h2>Parameters</h2>
<h3><code>_context</code> [in]</h3>
<p>Specifies the context value from the <strong>Context</strong> member of the <a href="hdaudio_bus_interface" title="typedef struct _HDAUDIO_BUS_INTERFACE {&#10;  USHORT                       Size;&#10;  USHORT                       Version;&#10;  PVOID                        Context;&#10;  PINTERFACE_REFERENCE         InterfaceReference;&#10;  PINTERFACE_DEREFERENCE       InterfaceDereference;&#10;  PTRANSFER_CODEC_VERBS        TransferCodecVerbs;&#10;  PALLOCATE_CAPTURE_DMA_ENGINE AllocateCaptureDmaEngine;&#10;  PALLOCATE_RENDER_DMA_ENGINE  AllocateRenderDmaEngine;&#10;  PCHANGE_BANDWIDTH_ALLOCATION ChangeBandwidthAllocation;&#10;  PALLOCATE_DMA_BUFFER         AllocateDmaBuffer;&#10;  PFREE_DMA_BUFFER             FreeDmaBuffer;&#10;  PFREE_DMA_ENGINE             FreeDmaEngine;&#10;  PSET_DMA_ENGINE_STATE        SetDmaEngineState;&#10;  PGET_WALL_CLOCK_REGISTER     GetWallClockRegister;&#10;  PGET_LINK_POSITION_REGISTER  GetLinkPositionRegister;&#10;  PREGISTER_EVENT_CALLBACK     RegisterEventCallback;&#10;  PUNREGISTER_EVENT_CALLBACK   UnregisterEventCallback;&#10;  PGET_DEVICE_INFORMATION      GetDeviceInformation;&#10;  PGET_RESOURCE_INFORMATION    GetResourceInformation;&#10;...">HDAUDIO_BUS_INTERFACE</a>, <a href="hdaudio_bus_interface_v2" title="typedef struct _HDAUDIO_BUS_INTERFACE_V2 {&#10;  USHORT                                 Size;&#10;  USHORT                                 Version;&#10;  PVOID                                  Context;&#10;  PINTERFACE_REFERENCE                   InterfaceReference;&#10;  PINTERFACE_DEREFERENCE                 InterfaceDereference;&#10;  PTRANSFER_CODEC_VERBS                  TransferCodecVerbs;&#10;  PALLOCATE_CAPTURE_DMA_ENGINE           AllocateCaptureDmaEngine;&#10;  PALLOCATE_RENDER_DMA_ENGINE            AllocateRenderDmaEngine;&#10;  PCHANGE_BANDWIDTH_ALLOCATION           ChangeBandwidthAllocation;&#10;  PALLOCATE_DMA_BUFFER                   AllocateDmaBuffer;&#10;  PFREE_DMA_BUFFER                       FreeDmaBuffer;&#10;  PFREE_DMA_ENGINE                       FreeDmaEngine;&#10;  PSET_DMA_ENGINE_STATE                  SetDmaEngineState;&#10;  PGET_WALL_CLOCK_REGISTER               GetWallClockRegister;&#10;  PGET_LINK_POSITION_REGISTER            GetLinkPositionRegister;&#10;  PREGISTER_EVENT_CALLBACK               RegisterEventCallback;&#10;  PUNREGISTER_EVENT_CALLBACK             UnregisterEventCallback;&#10;  PGET_DEVICE_INFORMATION                GetDeviceInformation;&#10;  PGET_RESOURCE_INFORMATION              GetResourceInformation;&#10;...">HDAUDIO_BUS_INTERFACE_V2</a>, or <a href="hdaudio_bus_interface_bdl" title="typedef struct _HDAUDIO_BUS_INTERFACE_BDL {&#10;  USHORT                          Size;&#10;  USHORT                          Version;&#10;  PVOID                           Context;&#10;  PINTERFACE_REFERENCE            InterfaceReference;&#10;  PINTERFACE_DEREFERENCE          InterfaceDereference;&#10;  PTRANSFER_CODEC_VERBS           TransferCodecVerbs;&#10;  PALLOCATE_CAPTURE_DMA_ENGINE    AllocateCaptureDmaEngine;&#10;  PALLOCATE_RENDER_DMA_ENGINE     AllocateRenderDmaEngine;&#10;  PCHANGE_BANDWIDTH_ALLOCATION    ChangeBandwidthAllocation;&#10;  PALLOCATE_CONTIGUOUS_DMA_BUFFER AllocateContiguousDmaBuffer;&#10;  PSETUP_DMA_ENGINE_WITH_BDL      SetupDmaEngineWithBdl;&#10;  PFREE_CONTIGUOUS_DMA_BUFFER     FreeContiguousDmaBuffer;&#10;  PFREE_DMA_ENGINE                FreeDmaEngine;&#10;  PSET_DMA_ENGINE_STATE           SetDmaEngineState;&#10;  PGET_WALL_CLOCK_REGISTER        GetWallClockRegister;&#10;  PGET_LINK_POSITION_REGISTER     GetLinkPositionRegister;&#10;  PREGISTER_EVENT_CALLBACK        RegisterEventCallback;&#10;  PUNREGISTER_EVENT_CALLBACK      UnregisterEventCallback;&#10;  PGET_DEVICE_INFORMATION         GetDeviceInformation;&#10;...">HDAUDIO_BUS_INTERFACE_BDL</a> structure.</p>
<h3><code>Count</code> [in]</h3>
<p>Specifies the number of elements in the <em>codecTransfer</em> array.</p>
<h3><code>CodecTransfer</code> [in, out]</h3>
<p>Pointer to an array of <a href="hdaudio_codec_transfer" title="typedef struct _HDAUDIO_CODEC_TRANSFER {&#10;  HDAUDIO_CODEC_COMMAND  Output;&#10;  HDAUDIO_CODEC_RESPONSE Input;&#10;} HDAUDIO_CODEC_TRANSFER, *PHDAUDIO_CODEC_TRANSFER;">HDAUDIO_CODEC_TRANSFER</a> structures. Each array element is a structure that contains storage for both an output command from the caller and the corresponding input response from the codec.</p>
<h3><code>Callback</code> [in]</h3>
<p>Function pointer to a callback routine. This parameter is a function pointer of type HDAUDIO_TRANSFER_COMPLETE_CALLBACK. The parameter can be specified as <strong>NULL</strong>. For more information, see the following Remarks section.</p>
<h3><code>Context</code> [in]</h3>
<p>A context value for the callback routine. The caller casts the context value to type PVOID. After completing the commands asynchronously, the HD Audio bus driver passes the context value to the callback routine as a call parameter.</p>
<h2>Return value</h2>
<p><em>TransferCodecVerbs</em> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the call succeeds. Otherwise, the routine returns an appropriate error code. The following table shows a possible return status code.</p>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>STATUS_NO_MEMORY</strong></td>
<td>Indicates that the request could not be added to the command queue due to a shortage of nonpaged memory.</td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>This routine submits one or more codec commands to the HD Audio bus driver. The bus driver issues the commands to the codecs, retrieves the codecs' responses to the commands, and outputs the responses to the caller.</p>
<p>The caller specifies the commands in an array of <a href="hdaudio_codec_transfer" title="typedef struct _HDAUDIO_CODEC_TRANSFER {&#10;  HDAUDIO_CODEC_COMMAND  Output;&#10;  HDAUDIO_CODEC_RESPONSE Input;&#10;} HDAUDIO_CODEC_TRANSFER, *PHDAUDIO_CODEC_TRANSFER;">HDAUDIO_CODEC_TRANSFER</a> structures. Each structure contains storage for both a command and the codec's response to that command. Before calling <em>TransferCodecVerbs</em>, the caller fills in the commands in each of the structures in the array. As each command completes, the HD Audio bus driver retrieves the codec's response and writes it into the structure. After the last command completes, the caller can read the responses from the array.</p>
<p>The routine can operate either synchronously or asynchronously:</p>
<ul>
<li>If the caller specifies <strong>NULL</strong> for the value of input parameter <em>callback</em>, the HD Audio bus driver completes the commands in the <em>codecTransfer</em> array synchronously. (In other words, the routine returns only after the codecs have processed all the commands and the responses to those commands are available.)</li>
<li>If the caller specifies a non-<strong>NULL</strong> value for the <em>callback</em> parameter, the routine operates asynchronously. (In other words, the routine returns immediately after adding the commands to its internal queue without waiting for the codecs to process all the commands.) After the codecs process the commands, the HD Audio bus driver calls the callback routine. In the asynchronous case, the caller should not attempt to read the responses to the commands before the bus driver calls the callback routine.</li>
</ul>
<p>The function pointer type for the callback parameter is defined as:</p>
<pre><code>typedef VOID
  (*<a href="phdaudio_transfer_complete_callback" title="PHDAUDIO_TRANSFER_COMPLETE_CALLBACK PhdaudioTransferCompleteCallback;&#10;&#10;VOID PhdaudioTransferCompleteCallback(&#10;  HDAUDIO_CODEC_TRANSFER *unnamedParam1,&#10;  PVOID unnamedParam2&#10;)&#10;{...}">PHDAUDIO_TRANSFER_COMPLETE_CALLBACK</a>)
    (<a href="hdaudio_codec_transfer" title="typedef struct _HDAUDIO_CODEC_TRANSFER {&#10;  HDAUDIO_CODEC_COMMAND  Output;&#10;  HDAUDIO_CODEC_RESPONSE Input;&#10;} HDAUDIO_CODEC_TRANSFER, *PHDAUDIO_CODEC_TRANSFER;">HDAUDIO_CODEC_TRANSFER</a> *, PVOID);
</code></pre>
<p>The first call parameter is a pointer to the <em>codecTransfer</em> array element that contains the codec command and the response that triggered the callback. The second call parameter is the same context value that was specified previously in the <em>TransferCodecVerbs</em> routine's <em>callbackContext</em> parameter.</p>
<p>If successful, <em>TransferCodecVerbs</em> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a>. The meaning of this status code depends on whether the routine operates synchronously or asynchronously:</p>
<ul>
<li>In the synchronous case (<em>callback</em> is <strong>NULL</strong>), <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> means that the bus driver has all the commands in the codecTransfer array to the codecs and that the routine has written all the responses to those commands into the array. However, the caller must check the individual responses to determine whether they are valid. Individual responses might be invalid due to codec timeouts or FIFO overrun.</li>
<li>In the asynchronous case (<em>callback</em> is non-<strong>NULL</strong>), <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> means only that the routine has successfully added the commands to the HD Audio bus driver's internal queue. The caller must not attempt to read the responses to those commands until the bus driver calls the callback routine.</li>
</ul>
<p>If a response is invalid due to a FIFO overrun, the likely cause is that the codec responded to the command but the response was lost due to an insufficiently sized response input ring buffer (RIRB). If a FIFO overrun is not the cause of the invalid response, the failure probably occurred because the codec did not respond in time (timed out). In this case, the caller can assume that the command did not reach the codec.</p>
<p>If the <em>callback</em> parameter is <strong>NULL</strong>, the caller must be running at IRQL PASSIVE_LEVEL. If <em>callback</em> is non-<strong>NULL</strong>, the caller can call <em>TransferCodecVerbs</em> at IRQL &lt;= DISPATCH_LEVEL, in which case the call returns immediately without waiting for the codecs to process all the commands; after the commands complete, the HD Audio bus driver calls the callback routine at IRQL DISPATCH_LEVEL.</p>
<p>The caller must allocate the <em>codecTransfer</em> array from the nonpaged pool.</p>
<h2>See also</h2>
<p><a href="hdaudio_bus_interface" title="typedef struct _HDAUDIO_BUS_INTERFACE {&#10;  USHORT                       Size;&#10;  USHORT                       Version;&#10;  PVOID                        Context;&#10;  PINTERFACE_REFERENCE         InterfaceReference;&#10;  PINTERFACE_DEREFERENCE       InterfaceDereference;&#10;  PTRANSFER_CODEC_VERBS        TransferCodecVerbs;&#10;  PALLOCATE_CAPTURE_DMA_ENGINE AllocateCaptureDmaEngine;&#10;  PALLOCATE_RENDER_DMA_ENGINE  AllocateRenderDmaEngine;&#10;  PCHANGE_BANDWIDTH_ALLOCATION ChangeBandwidthAllocation;&#10;  PALLOCATE_DMA_BUFFER         AllocateDmaBuffer;&#10;  PFREE_DMA_BUFFER             FreeDmaBuffer;&#10;  PFREE_DMA_ENGINE             FreeDmaEngine;&#10;  PSET_DMA_ENGINE_STATE        SetDmaEngineState;&#10;  PGET_WALL_CLOCK_REGISTER     GetWallClockRegister;&#10;  PGET_LINK_POSITION_REGISTER  GetLinkPositionRegister;&#10;  PREGISTER_EVENT_CALLBACK     RegisterEventCallback;&#10;  PUNREGISTER_EVENT_CALLBACK   UnregisterEventCallback;&#10;  PGET_DEVICE_INFORMATION      GetDeviceInformation;&#10;  PGET_RESOURCE_INFORMATION    GetResourceInformation;&#10;...">HDAUDIO_BUS_INTERFACE</a></p>
<p><a href="hdaudio_bus_interface_bdl" title="typedef struct _HDAUDIO_BUS_INTERFACE_BDL {&#10;  USHORT                          Size;&#10;  USHORT                          Version;&#10;  PVOID                           Context;&#10;  PINTERFACE_REFERENCE            InterfaceReference;&#10;  PINTERFACE_DEREFERENCE          InterfaceDereference;&#10;  PTRANSFER_CODEC_VERBS           TransferCodecVerbs;&#10;  PALLOCATE_CAPTURE_DMA_ENGINE    AllocateCaptureDmaEngine;&#10;  PALLOCATE_RENDER_DMA_ENGINE     AllocateRenderDmaEngine;&#10;  PCHANGE_BANDWIDTH_ALLOCATION    ChangeBandwidthAllocation;&#10;  PALLOCATE_CONTIGUOUS_DMA_BUFFER AllocateContiguousDmaBuffer;&#10;  PSETUP_DMA_ENGINE_WITH_BDL      SetupDmaEngineWithBdl;&#10;  PFREE_CONTIGUOUS_DMA_BUFFER     FreeContiguousDmaBuffer;&#10;  PFREE_DMA_ENGINE                FreeDmaEngine;&#10;  PSET_DMA_ENGINE_STATE           SetDmaEngineState;&#10;  PGET_WALL_CLOCK_REGISTER        GetWallClockRegister;&#10;  PGET_LINK_POSITION_REGISTER     GetLinkPositionRegister;&#10;  PREGISTER_EVENT_CALLBACK        RegisterEventCallback;&#10;  PUNREGISTER_EVENT_CALLBACK      UnregisterEventCallback;&#10;  PGET_DEVICE_INFORMATION         GetDeviceInformation;&#10;...">HDAUDIO_BUS_INTERFACE_BDL</a></p>
<p><a href="hdaudio_bus_interface_v2" title="typedef struct _HDAUDIO_BUS_INTERFACE_V2 {&#10;  USHORT                                 Size;&#10;  USHORT                                 Version;&#10;  PVOID                                  Context;&#10;  PINTERFACE_REFERENCE                   InterfaceReference;&#10;  PINTERFACE_DEREFERENCE                 InterfaceDereference;&#10;  PTRANSFER_CODEC_VERBS                  TransferCodecVerbs;&#10;  PALLOCATE_CAPTURE_DMA_ENGINE           AllocateCaptureDmaEngine;&#10;  PALLOCATE_RENDER_DMA_ENGINE            AllocateRenderDmaEngine;&#10;  PCHANGE_BANDWIDTH_ALLOCATION           ChangeBandwidthAllocation;&#10;  PALLOCATE_DMA_BUFFER                   AllocateDmaBuffer;&#10;  PFREE_DMA_BUFFER                       FreeDmaBuffer;&#10;  PFREE_DMA_ENGINE                       FreeDmaEngine;&#10;  PSET_DMA_ENGINE_STATE                  SetDmaEngineState;&#10;  PGET_WALL_CLOCK_REGISTER               GetWallClockRegister;&#10;  PGET_LINK_POSITION_REGISTER            GetLinkPositionRegister;&#10;  PREGISTER_EVENT_CALLBACK               RegisterEventCallback;&#10;  PUNREGISTER_EVENT_CALLBACK             UnregisterEventCallback;&#10;  PGET_DEVICE_INFORMATION                GetDeviceInformation;&#10;  PGET_RESOURCE_INFORMATION              GetResourceInformation;&#10;...">HDAUDIO_BUS_INTERFACE_V2</a></p>
<p><a href="hdaudio_codec_transfer" title="typedef struct _HDAUDIO_CODEC_TRANSFER {&#10;  HDAUDIO_CODEC_COMMAND  Output;&#10;  HDAUDIO_CODEC_RESPONSE Input;&#10;} HDAUDIO_CODEC_TRANSFER, *PHDAUDIO_CODEC_TRANSFER;">HDAUDIO_CODEC_TRANSFER</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/hdaudio/nc-hdaudio-ptransfer_codec_verbs">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/hdaudio/nc-hdaudio-ptransfer_codec_verbs.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
