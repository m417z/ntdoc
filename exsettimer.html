<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="ExSetTimer - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ExSetTimer - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            ExSetTimer - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">BOOLEAN ExSetTimer(
  [in]           PEX_TIMER           Timer,
  [in]           <a href="longlong" title="typedef __int64 LONGLONG;">LONGLONG</a>            DueTime,
  [in]           <a href="longlong" title="typedef __int64 LONGLONG;">LONGLONG</a>            Period,
  [in, optional] <a href="ext_set_parameters" title="typedef struct _EXT_SET_PARAMETERS_V0 {&#10;  ULONG    Version;&#10;  ULONG    Reserved;&#10;  LONGLONG NoWakeTolerance;&#10;} EXT_SET_PARAMETERS, *PEXT_SET_PARAMETERS;">PEXT_SET_PARAMETERS</a> Parameters
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-exsettimer">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/exsettimer.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-wdm-exsettimer)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="exsettimer-function">ExSetTimer function</h1>

<h2 id="description">Description</h2>

<p>The <strong>ExSetTimer</strong> routine starts a timer operation and sets the timer to expire at the specified due time.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="timer-in"><code>Timer</code> [in]</h3>

<p>A pointer to an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/exxxxtimer-routines-and-ex-timer-objects">EX_TIMER</a> structure. This structure is a timer object that was previously allocated by the <a href="exallocatetimer" title="PEX_TIMER ExAllocateTimer(&#10;  [in, optional] PEXT_CALLBACK Callback,&#10;  [in, optional] PVOID         CallbackContext,&#10;  [in]           ULONG         Attributes&#10;);">ExAllocateTimer</a> routine.</p>

<h3 id="duetime-in"><code>DueTime</code> [in]</h3>

<p>The absolute or relative time at which the timer is to expire. If the value of the <em>DueTime</em> parameter is negative, the expiration time is relative to the current system time. Otherwise, the expiration time is absolute. The expiration time is expressed in system time units (100-nanosecond intervals). Absolute expiration times track any changes in the system time; relative expiration times are not affected by system time changes. An absolute time is expressed as the amount of time passed, in system time units, since the start of the year 1601.</p>

<p>The <em>DueTime</em> parameter for a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/high-resolution-timers">high-resolution timer</a> must be a relative time (negative value), or the routine bug checks.</p>

<h3 id="period-in"><code>Period</code> [in]</h3>

<p>An optional period for the timer in system time units (100-nanosecond intervals). Must be less than or equal to <a href="maxlong" title="#define MAXLONG 0x7fffffff // winnt">MAXLONG</a>. For a timer that is one-shot instead of periodic, set <em>Period</em> to zero.</p>

<h3 id="parameters-in-optional"><code>Parameters</code> [in, optional]</h3>

<p>A pointer to an <a href="ext_set_parameters" title="typedef struct _EXT_SET_PARAMETERS_V0 {&#10;  ULONG    Version;&#10;  ULONG    Reserved;&#10;  LONGLONG NoWakeTolerance;&#10;} EXT_SET_PARAMETERS, *PEXT_SET_PARAMETERS;">EXT_SET_PARAMETERS</a> structure. The calling driver previously called the <a href="exinitializesettimerparameters" title="VOID ExInitializeSetTimerParameters(&#10;  [out] PEXT_SET_PARAMETERS Parameters&#10;);">ExInitializeSetTimerParameters</a> routine to initialize this structure.</p>

<h2 id="return-value">Return value</h2>

<p>This routine returns <strong>TRUE</strong> if it cancels a timer that was pending at the time that the routine was called. Otherwise, the routine returns <strong>FALSE</strong>. For more information, see Remarks.</p>

<h2 id="remarks">Remarks</h2>

<p>Your driver can call this routine to set a timer to expire at a future time. The driver can then wait for the timer to expire. Or, the driver can implement a callback routine that is called when the timer expires.</p>

<p>After a driver calls <strong>ExSetTimer</strong>, the driver can call a routine such as <a href="kewaitforsingleobject" title="NTSTATUS&#10;KeWaitForSingleObject (&#10;    PVOID Object,&#10;    KWAIT_REASON WaitReason,&#10;    KPROCESSOR_MODE WaitMode,&#10;    BOOLEAN Alertable,&#10;    PLARGE_INTEGER Timeout&#10;    );">KeWaitForSingleObject</a> or <a href="kewaitformultipleobjects" title="NTSTATUS&#10;KeWaitForMultipleObjects (&#10;    ULONG Count,&#10;    PVOID Object[],&#10;    WaitType,&#10;    KWAIT_REASON WaitReason,&#10;    KPROCESSOR_MODE WaitMode,&#10;    BOOLEAN Alertable,&#10;    PLARGE_INTEGER Timeout,&#10;    PKWAIT_BLOCK WaitBlockArray&#10;    );">KeWaitForMultipleObjects</a> to wait for the timer to expire. When the timer expires, the operating system signals the timer object.</p>

<p>As an option, the driver can implement an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-ext_callback">ExTimerCallback</a> callback routine, and supply a pointer to this routine as an input parameter to the <a href="exallocatetimer" title="PEX_TIMER ExAllocateTimer(&#10;  [in, optional] PEXT_CALLBACK Callback,&#10;  [in, optional] PVOID         CallbackContext,&#10;  [in]           ULONG         Attributes&#10;);">ExAllocateTimer</a> routine. When the timer expires, the operating system calls the <em>ExTimerCallback</em> routine.</p>

<p>An <strong>ExSetTimer</strong> call implicitly cancels any previously started set-timer operation on the timer object specified by <em>Timer</em>. If your driver previously called <strong>ExSetTimer</strong> to set a timer that uses <em>Timer</em>, and this timer has not yet expired when <strong>ExSetTimer</strong> is called a second time, the second call cancels the timer from the first call and then starts the new timer. In this case, the second call returns <strong>TRUE</strong>. However, if the timer started by the first call expires before the second call can cancel this timer, the second call starts the new timer and returns <strong>FALSE</strong>.</p>

<p>If the <em>Period</em> parameter is nonzero, the timer is periodic. For a periodic timer, the <em>DueTime</em> parameter specifies the time of the initial timer expiration, and <em>Period</em> specifies the interval between subsequent expirations.</p>

<p>The hardware timer used for the system clock signals interrupt requests at uniform intervals, but the handling of these interrupts might be delayed by interrupt processing for other devices. Thus, for a periodic timer, the delay from a periodic expiration time to the time at which the timer object is signaled or the <em>ExTimerCallback</em> routine runs might vary from one period to the next. For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/timer-accuracy">Timer Accuracy</a>.</p>

<p>A periodic timer can expire no more than once per system clock tick. Setting the period of a timer to a value smaller than the interval between system clock ticks does not cause the timer to expire more than once per system clock tick, but might cause the intervals between successive expirations to vary if the system clock rate changes. For example, the operating system might temporarily increase the system clock rate to meet the timing requirements of a high-resolution timer. For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/high-resolution-timers">High-Resolution Timers</a>.</p>

<p>For a periodic timer that is not a high-resolution timer, a driver can achieve relatively uniform periodic expirations by setting <em>Period</em> to an integer multiple of the default interval between system clock ticks.</p>

<p>To avoid excessive power consumption, a driver should not set the period of a long-running high-resolution timer to a value less than the default interval between system clock ticks. Otherwise, the system clock timer will continuously generate interrupts at the maximum allowed system clock rate.</p>

<p>For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/exxxxtimer-routines-and-ex-timer-objects">ExXxxTimer Routines and EX_TIMER Objects</a>.</p>

<h2 id="see-also">See also</h2>

<p><a href="ext_set_parameters" title="typedef struct _EXT_SET_PARAMETERS_V0 {&#10;  ULONG    Version;&#10;  ULONG    Reserved;&#10;  LONGLONG NoWakeTolerance;&#10;} EXT_SET_PARAMETERS, *PEXT_SET_PARAMETERS;">EXT_SET_PARAMETERS</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/exxxxtimer-routines-and-ex-timer-objects">EX_TIMER</a></p>

<p><a href="exallocatetimer" title="PEX_TIMER ExAllocateTimer(&#10;  [in, optional] PEXT_CALLBACK Callback,&#10;  [in, optional] PVOID         CallbackContext,&#10;  [in]           ULONG         Attributes&#10;);">ExAllocateTimer</a></p>

<p><a href="exinitializesettimerparameters" title="VOID ExInitializeSetTimerParameters(&#10;  [out] PEXT_SET_PARAMETERS Parameters&#10;);">ExInitializeSetTimerParameters</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-ext_callback">ExTimerCallback</a></p>

<p><a href="kewaitformultipleobjects" title="NTSTATUS&#10;KeWaitForMultipleObjects (&#10;    ULONG Count,&#10;    PVOID Object[],&#10;    WaitType,&#10;    KWAIT_REASON WaitReason,&#10;    KPROCESSOR_MODE WaitMode,&#10;    BOOLEAN Alertable,&#10;    PLARGE_INTEGER Timeout,&#10;    PKWAIT_BLOCK WaitBlockArray&#10;    );">KeWaitForMultipleObjects</a></p>

<p><a href="kewaitforsingleobject" title="NTSTATUS&#10;KeWaitForSingleObject (&#10;    PVOID Object,&#10;    KWAIT_REASON WaitReason,&#10;    KPROCESSOR_MODE WaitMode,&#10;    BOOLEAN Alertable,&#10;    PLARGE_INTEGER Timeout&#10;    );">KeWaitForSingleObject</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-exsettimer">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/nf-wdm-exsettimer.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
