<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="WdfIoQueueReadyNotify - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>WdfIoQueueReadyNotify - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            WdfIoQueueReadyNotify - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdfio.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> WdfIoQueueReadyNotify(
  [in]           WDFQUEUE               Queue,
  [in, optional] PFN_WDF_IO_QUEUE_STATE QueueReady,
  [in, optional] WDFCONTEXT             Context
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfio/nf-wdfio-wdfioqueuereadynotify">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/wdfioqueuereadynotify.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-wdfio-wdfioqueuereadynotify)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="wdfioqueuereadynotify-function">WdfIoQueueReadyNotify function</h1>

<h2 id="description">Description</h2>

<p>[Applies to KMDF and UMDF]</p>

<p>The <strong>WdfIoQueueReadyNotify</strong> method registers (or deregisters) an event callback function that the framework calls each time a specified I/O queue that was previously empty receives one or more I/O requests.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="queue-in"><code>Queue</code> [in]</h3>

<p>A handle to a framework queue object.</p>

<h3 id="queueready-in-optional"><code>QueueReady</code> [in, optional]</h3>

<p>A pointer to a driver-supplied <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfio/nc-wdfio-evt_wdf_io_queue_state">EvtIoQueueState</a> callback function, if the driver is registering for ready notification, or <strong>NULL</strong> if the driver is deregistering.</p>

<h3 id="context-in-optional"><code>Context</code> [in, optional]</h3>

<p>An untyped pointer to driver-supplied context information that the framework passes to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfio/nc-wdfio-evt_wdf_io_queue_state">EvtIoQueueState</a> callback function, if the driver is registering for ready notification, or <strong>NULL</strong> if the driver is deregistering.</p>

<h2 id="return-value">Return value</h2>

<p><strong>WdfIoQueueReadyNotify</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the operation succeeds. Otherwise, this method might return one of the following values:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>STATUS_INVALID_PARAMETER</strong></td>
  <td>The driver supplied an invalid handle.</td>
</tr>
<tr>
  <td><strong>STATUS_INVALID_DEVICE_REQUEST</strong></td>
  <td>This value is returned if one of the following occurs:<br><br>* The <strong>DispatchType</strong> member of the specified I/O queue's <a href="wdf_io_queue_config" title="typedef struct _WDF_IO_QUEUE_CONFIG {&#10;  ULONG                                       Size;&#10;  WDF_IO_QUEUE_DISPATCH_TYPE                  DispatchType;&#10;  WDF_TRI_STATE                               PowerManaged;&#10;  BOOLEAN                                     AllowZeroLengthRequests;&#10;  BOOLEAN                                     DefaultQueue;&#10;  PFN_WDF_IO_QUEUE_IO_DEFAULT                 EvtIoDefault;&#10;  PFN_WDF_IO_QUEUE_IO_READ                    EvtIoRead;&#10;  PFN_WDF_IO_QUEUE_IO_WRITE                   EvtIoWrite;&#10;  PFN_WDF_IO_QUEUE_IO_DEVICE_CONTROL          EvtIoDeviceControl;&#10;  PFN_WDF_IO_QUEUE_IO_INTERNAL_DEVICE_CONTROL EvtIoInternalDeviceControl;&#10;  PFN_WDF_IO_QUEUE_IO_STOP                    EvtIoStop;&#10;  PFN_WDF_IO_QUEUE_IO_RESUME                  EvtIoResume;&#10;  PFN_WDF_IO_QUEUE_IO_CANCELED_ON_QUEUE       EvtIoCanceledOnQueue;&#10;  union {&#10;    struct {&#10;      ULONG NumberOfPresentedRequests;&#10;    } Parallel;&#10;  } Settings;&#10;  WDFDRIVER                                   Driver;&#10;...">WDF_IO_QUEUE_CONFIG</a> structure is not <strong>WdfIoQueueDispatchManual</strong>.<br>* The driver had previously called WdfIoQueueReadyNotify and registered an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfio/nc-wdfio-evt_wdf_io_queue_state">EvtIoQueueState</a> callback function.<br>* The driver is attempting to deregister its notification callback function, but a callback function is not registered or the driver has not called <a href="wdfioqueuestop" title="VOID WdfIoQueueStop(&#10;  [in]           WDFQUEUE               Queue,&#10;  [in, optional] PFN_WDF_IO_QUEUE_STATE StopComplete,&#10;  [in, optional] WDFCONTEXT             Context&#10;);">WdfIoQueueStop</a> or <a href="wdfioqueuestopsynchronously" title="VOID WdfIoQueueStopSynchronously(&#10;  [in] WDFQUEUE Queue&#10;);">WdfIoQueueStopSynchronously</a>.</td>
</tr>
</tbody>
</table>

<p>This method also might return other <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/ntstatus-values">NTSTATUS values</a>.</p>

<p>A bug check occurs if the driver supplies an invalid object handle.</p>

<h2 id="remarks">Remarks</h2>

<p>After a driver has called <strong>WdfIoQueueReadyNotify</strong> to register a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfio/nc-wdfio-evt_wdf_io_queue_state">EvtIoQueueState</a> callback function, the framework calls the callback function each time the specified queue's state changes from empty to non-empty. Specifically, the framework calls <em>EvtIoQueueState</em> when a request arrives on an empty queue, even if the driver still owns previously delivered requests from the queue that it has not yet completed. You can modify the IRQL at which the callback runs by specifying <strong>ExecutionLevel</strong> in <a href="wdf_object_attributes" title="typedef struct _WDF_OBJECT_ATTRIBUTES {&#10;  ULONG                          Size;&#10;  PFN_WDF_OBJECT_CONTEXT_CLEANUP EvtCleanupCallback;&#10;  PFN_WDF_OBJECT_CONTEXT_DESTROY EvtDestroyCallback;&#10;  WDF_EXECUTION_LEVEL            ExecutionLevel;&#10;  WDF_SYNCHRONIZATION_SCOPE      SynchronizationScope;&#10;  WDFOBJECT                      ParentObject;&#10;  size_t                         ContextSizeOverride;&#10;  PCWDF_OBJECT_CONTEXT_TYPE_INFO ContextTypeInfo;&#10;} WDF_OBJECT_ATTRIBUTES, *PWDF_OBJECT_ATTRIBUTES;">WDF_OBJECT_ATTRIBUTES</a> at queue creation time. For more info, see the Remarks section of<em><a href="evt_wdf_io_queue_state" title="EVT_WDF_IO_QUEUE_STATE EvtWdfIoQueueState;&#10;&#10;VOID EvtWdfIoQueueState(&#10;  [in] WDFQUEUE Queue,&#10;  [in] WDFCONTEXT Context&#10;)&#10;{...}">EVT_WDF_IO_QUEUE_STATE</a></em>.</p>

<p>The framework does not call <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfio/nc-wdfio-evt_wdf_io_queue_state">EvtIoQueueState</a> while the specified queue is stopped. When the queue starts, the framework calls <em>EvtIoQueueState</em> if the queue is non-empty.</p>

<p>Your driver can call <strong>WdfIoQueueReadyNotify</strong> only for I/O queues that use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/wdf/dispatching-methods-for-i-o-requests">manual dispatching</a> method.</p>

<p>The <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfio/nc-wdfio-evt_wdf_io_queue_state">EvtIoQueueState</a> callback function typically calls <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/kmdf-wdfioqueueretrievenextrequest">WdfIoQueueRetrieveNextRequest</a> or <a href="wdfioqueueretrieverequestbyfileobject" title="NTSTATUS WdfIoQueueRetrieveRequestByFileObject(&#10;  [in]  WDFQUEUE      Queue,&#10;  [in]  WDFFILEOBJECT FileObject,&#10;  [out] WDFREQUEST    *OutRequest&#10;);">WdfIoQueueRetrieveRequestByFileObject</a> in a loop to retrieve all of the requests that have arrived since the last time the callback function executed.</p>

<p>To stop the framework from calling the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfio/nc-wdfio-evt_wdf_io_queue_state">EvtIoQueueState</a> callback function, the driver must call <strong>WdfIoQueueReadyNotify</strong> again with the <em>QueueReady</em> parameter set to <strong>NULL</strong>. However, the driver must first call <a href="wdfioqueuestop" title="VOID WdfIoQueueStop(&#10;  [in]           WDFQUEUE               Queue,&#10;  [in, optional] PFN_WDF_IO_QUEUE_STATE StopComplete,&#10;  [in, optional] WDFCONTEXT             Context&#10;);">WdfIoQueueStop</a> or <a href="wdfioqueuestopsynchronously" title="VOID WdfIoQueueStopSynchronously(&#10;  [in] WDFQUEUE Queue&#10;);">WdfIoQueueStopSynchronously</a> to stop the I/O queue. The driver can subsequently call <a href="wdfioqueuestart" title="VOID WdfIoQueueStart(&#10;  [in] WDFQUEUE Queue&#10;);">WdfIoQueueStart</a> to restart the queue.</p>

<p>When a driver calls <strong>WdfIoQueueReadyNotify</strong> to register a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfio/nc-wdfio-evt_wdf_io_queue_state">EvtIoQueueState</a> callback function, it is possible for the framework to call the callback function before <strong>WdfIoQueueReadyNotify</strong> returns.</p>

<p>For more information about the <strong>WdfIoQueueReadyNotify</strong> method, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/wdf/dispatching-methods-for-i-o-requests">Dispatching Methods for I/O Requests</a>.</p>

<h4 id="examples">Examples</h4>

<p>The following code example registers a driver's <strong>EvtIoQueueReady</strong> function, so that this function will be called when the specified I/O queue receives an I/O request.</p>

<p><!-- CODE_MARKER --></p>

<div class="codehilite">
<pre><span></span><code><span class="n">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WdfIoQueueReadyNotify</span><span class="p">(</span>
<span class="w">                               </span><span class="n">ReadQueue</span><span class="p">,</span>
<span class="w">                               </span><span class="n">EvtIoQueueReady</span><span class="p">,</span>
<span class="w">                               </span><span class="n">myQueueContext</span>
<span class="w">                               </span><span class="p">);</span>
</code></pre>
</div>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfio/nc-wdfio-evt_wdf_io_queue_state">EvtIoQueueState</a></p>

<p><a href="wdf_io_queue_config" title="typedef struct _WDF_IO_QUEUE_CONFIG {&#10;  ULONG                                       Size;&#10;  WDF_IO_QUEUE_DISPATCH_TYPE                  DispatchType;&#10;  WDF_TRI_STATE                               PowerManaged;&#10;  BOOLEAN                                     AllowZeroLengthRequests;&#10;  BOOLEAN                                     DefaultQueue;&#10;  PFN_WDF_IO_QUEUE_IO_DEFAULT                 EvtIoDefault;&#10;  PFN_WDF_IO_QUEUE_IO_READ                    EvtIoRead;&#10;  PFN_WDF_IO_QUEUE_IO_WRITE                   EvtIoWrite;&#10;  PFN_WDF_IO_QUEUE_IO_DEVICE_CONTROL          EvtIoDeviceControl;&#10;  PFN_WDF_IO_QUEUE_IO_INTERNAL_DEVICE_CONTROL EvtIoInternalDeviceControl;&#10;  PFN_WDF_IO_QUEUE_IO_STOP                    EvtIoStop;&#10;  PFN_WDF_IO_QUEUE_IO_RESUME                  EvtIoResume;&#10;  PFN_WDF_IO_QUEUE_IO_CANCELED_ON_QUEUE       EvtIoCanceledOnQueue;&#10;  union {&#10;    struct {&#10;      ULONG NumberOfPresentedRequests;&#10;    } Parallel;&#10;  } Settings;&#10;  WDFDRIVER                                   Driver;&#10;...">WDF_IO_QUEUE_CONFIG</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/kmdf-wdfioqueueretrievenextrequest">WdfIoQueueRetrieveNextRequest</a></p>

<p><a href="wdfioqueueretrieverequestbyfileobject" title="NTSTATUS WdfIoQueueRetrieveRequestByFileObject(&#10;  [in]  WDFQUEUE      Queue,&#10;  [in]  WDFFILEOBJECT FileObject,&#10;  [out] WDFREQUEST    *OutRequest&#10;);">WdfIoQueueRetrieveRequestByFileObject</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdfio/nf-wdfio-wdfioqueuereadynotify">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdfio/nf-wdfio-wdfioqueuereadynotify.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
