<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FWPS_TRANSPORT_SEND_PARAMS0_ - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FWPS_TRANSPORT_SEND_PARAMS0_ - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FWPS_TRANSPORT_SEND_PARAMS0_ - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// fwpsk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct FWPS_TRANSPORT_SEND_PARAMS0_ {
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>      *remoteAddress;
  SCOPE_ID   remoteScopeId;
  WSACMSGHDR *controlData;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>      controlDataLength;
} FWPS_TRANSPORT_SEND_PARAMS0;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/ns-fwpsk-fwps_transport_send_params0_">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/fwps_transport_send_params0_.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-fwpsk-fwps_transport_send_params0_)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="fwps_transport_send_params0_-structure">FWPS_TRANSPORT_SEND_PARAMS0_ structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>FWPS_TRANSPORT_SEND_PARAMS0</strong> structure defines properties of an outbound transport layer
packet.</p>

<p><strong>Note</strong> <strong>FWPS_TRANSPORT_SEND_PARAMS0</strong> is the specific version of <strong>FWPS_TRANSPORT_SEND_PARAMS</strong> used in Windows Vista and later. See <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/FWP/wfp-version-independent-names-and-targeting-specific-versions-of-windows">WFP Version-Independent Names and Targeting Specific Versions of Windows</a> for more information. For Windows 7, <a href="fwps_transport_send_params1_" title="typedef struct FWPS_TRANSPORT_SEND_PARAMS1_ {&#10;  UCHAR      *remoteAddress;&#10;  SCOPE_ID   remoteScopeId;&#10;  WSACMSGHDR *controlData;&#10;  ULONG      controlDataLength;&#10;  UCHAR      *headerIncludeHeader;&#10;  ULONG      headerIncludeHeaderLength;&#10;} FWPS_TRANSPORT_SEND_PARAMS1;">FWPS_TRANSPORT_SEND_PARAMS1</a> is available.</p>

<h2 id="members">Members</h2>

<h3 id="remoteaddress"><code>remoteAddress</code></h3>

<p>A pointer to a buffer that specifies the remote IP address to which to send the socket. The remote
address specified by this member can be different than the one passed as one of the incoming data values
to the callout driver's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_netvista/">classifyFn</a> callout function.</p>

<p>The buffer can contain an IPv4 address (4 bytes) or an IPv6 address (16 bytes), and the address must
be specified in network byte order. The IP version must match the
<em>AddressFamily</em> parameter specified in the
<a href="fwpsinjecttransportsendasync0" title="NTSTATUS FwpsInjectTransportSendAsync0(&#10;  [in]           HANDLE                      injectionHandle,&#10;  [in, optional] HANDLE                      injectionContext,&#10;  [in]           UINT64                      endpointHandle,&#10;  [in]           UINT32                      flags,&#10;  [in, optional] FWPS_TRANSPORT_SEND_PARAMS0 *sendArgs,&#10;  [in]           ADDRESS_FAMILY              addressFamily,&#10;  [in]           COMPARTMENT_ID              compartmentId,&#10;  [in, out]      NET_BUFFER_LIST             *netBufferList,&#10;  [in]           FWPS_INJECT_COMPLETE0       completionFn,&#10;  [in, optional] HANDLE                      completionContext&#10;);">FwpsInjectTransportSendAsync0</a> function.</p>

<p>The buffer must remain valid until the injection completion function is called.</p>

<h3 id="remotescopeid"><code>remoteScopeId</code></h3>

<p>A <strong>SCOPE_ID</strong> structure that contains the scope identifier for the remote IP address. The scope
identifier is provided to a callout through the
<strong>remoteScopeId</strong> member of the
<a href="fwps_incoming_metadata_values0_" title="typedef struct FWPS_INCOMING_METADATA_VALUES0_ {&#10;  UINT32                          currentMetadataValues;&#10;  UINT32                          flags;&#10;  UINT64                          reserved;&#10;  FWPS_DISCARD_METADATA0          discardMetadata;&#10;  UINT64                          flowHandle;&#10;  UINT32                          ipHeaderSize;&#10;  UINT32                          transportHeaderSize;&#10;  FWP_BYTE_BLOB                   *processPath;&#10;  UINT64                          token;&#10;  UINT64                          processId;&#10;  UINT32                          sourceInterfaceIndex;&#10;  UINT32                          destinationInterfaceIndex;&#10;  ULONG                           compartmentId;&#10;  FWPS_INBOUND_FRAGMENT_METADATA0 fragmentMetadata;&#10;  ULONG                           pathMtu;&#10;  HANDLE                          completionHandle;&#10;  UINT64                          transportEndpointHandle;&#10;  SCOPE_ID                        remoteScopeId;&#10;  WSACMSGHDR                      *controlData;&#10;...">FWPS_INCOMING_METADATA_VALUES0</a> structure that is passed to the callout driver's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_netvista/">classifyFn</a> callout function. The <strong>SCOPE_ID</strong>
structure is defined in
Ws2ipdef.h as follows.</p>

<pre><code>typedef struct {
  union {
    struct {
      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  Zone : 28;
      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  Level : 4;
    };
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  Value;
  };
} SCOPE_ID, *PSCOPE_ID;
</code></pre>

<h3 id="controldata"><code>controlData</code></h3>

<p>An optional pointer to a buffer that contains socket control data specified by the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winsock2/nf-winsock2-wsasendmsg">WSASendMsg</a> function. For information about the <strong>WSACMSGHDR</strong> type, see
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/ws2def/ns-ws2def-wsacmsghdr">CMSGHDR</a>.</p>

<p>If present, socket control data is provided to a callout with the
<strong>controlData</strong> member of the
<a href="fwps_incoming_metadata_values0_" title="typedef struct FWPS_INCOMING_METADATA_VALUES0_ {&#10;  UINT32                          currentMetadataValues;&#10;  UINT32                          flags;&#10;  UINT64                          reserved;&#10;  FWPS_DISCARD_METADATA0          discardMetadata;&#10;  UINT64                          flowHandle;&#10;  UINT32                          ipHeaderSize;&#10;  UINT32                          transportHeaderSize;&#10;  FWP_BYTE_BLOB                   *processPath;&#10;  UINT64                          token;&#10;  UINT64                          processId;&#10;  UINT32                          sourceInterfaceIndex;&#10;  UINT32                          destinationInterfaceIndex;&#10;  ULONG                           compartmentId;&#10;  FWPS_INBOUND_FRAGMENT_METADATA0 fragmentMetadata;&#10;  ULONG                           pathMtu;&#10;  HANDLE                          completionHandle;&#10;  UINT64                          transportEndpointHandle;&#10;  SCOPE_ID                        remoteScopeId;&#10;  WSACMSGHDR                      *controlData;&#10;...">FWPS_INCOMING_METADATA_VALUES0</a> structure that is passed to the callout driver's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_netvista/">classifyFn</a> callout function.</p>

<p>If socket control data is not <strong>NULL</strong>, it must be deep-copied in the callout driver's implementation
of the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_netvista/">classifyFn</a> function, and the <strong>controlData</strong> buffer must be kept valid
until the injection completion function is called.</p>

<h3 id="controldatalength"><code>controlDataLength</code></h3>

<p>The length, in bytes, of the
<strong>controlData</strong> member.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/ws2def/ns-ws2def-wsacmsghdr">CMSGHDR</a></p>

<p><a href="fwps_incoming_metadata_values0_" title="typedef struct FWPS_INCOMING_METADATA_VALUES0_ {&#10;  UINT32                          currentMetadataValues;&#10;  UINT32                          flags;&#10;  UINT64                          reserved;&#10;  FWPS_DISCARD_METADATA0          discardMetadata;&#10;  UINT64                          flowHandle;&#10;  UINT32                          ipHeaderSize;&#10;  UINT32                          transportHeaderSize;&#10;  FWP_BYTE_BLOB                   *processPath;&#10;  UINT64                          token;&#10;  UINT64                          processId;&#10;  UINT32                          sourceInterfaceIndex;&#10;  UINT32                          destinationInterfaceIndex;&#10;  ULONG                           compartmentId;&#10;  FWPS_INBOUND_FRAGMENT_METADATA0 fragmentMetadata;&#10;  ULONG                           pathMtu;&#10;  HANDLE                          completionHandle;&#10;  UINT64                          transportEndpointHandle;&#10;  SCOPE_ID                        remoteScopeId;&#10;  WSACMSGHDR                      *controlData;&#10;...">FWPS_INCOMING_METADATA_VALUES0</a></p>

<p><a href="fwps_transport_send_params1_" title="typedef struct FWPS_TRANSPORT_SEND_PARAMS1_ {&#10;  UCHAR      *remoteAddress;&#10;  SCOPE_ID   remoteScopeId;&#10;  WSACMSGHDR *controlData;&#10;  ULONG      controlDataLength;&#10;  UCHAR      *headerIncludeHeader;&#10;  ULONG      headerIncludeHeaderLength;&#10;} FWPS_TRANSPORT_SEND_PARAMS1;">FWPS_TRANSPORT_SEND_PARAMS1</a></p>

<p><a href="fwpsinjecttransportsendasync0" title="NTSTATUS FwpsInjectTransportSendAsync0(&#10;  [in]           HANDLE                      injectionHandle,&#10;  [in, optional] HANDLE                      injectionContext,&#10;  [in]           UINT64                      endpointHandle,&#10;  [in]           UINT32                      flags,&#10;  [in, optional] FWPS_TRANSPORT_SEND_PARAMS0 *sendArgs,&#10;  [in]           ADDRESS_FAMILY              addressFamily,&#10;  [in]           COMPARTMENT_ID              compartmentId,&#10;  [in, out]      NET_BUFFER_LIST             *netBufferList,&#10;  [in]           FWPS_INJECT_COMPLETE0       completionFn,&#10;  [in, optional] HANDLE                      completionContext&#10;);">FwpsInjectTransportSendAsync0</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winsock2/nf-winsock2-wsasendmsg">WSASendMsg</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_netvista/">classifyFn</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/ns-fwpsk-fwps_transport_send_params0_">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/fwpsk/ns-fwpsk-fwps_transport_send_params0_.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
