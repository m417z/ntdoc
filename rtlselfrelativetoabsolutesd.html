<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="RtlSelfRelativeToAbsoluteSD - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>RtlSelfRelativeToAbsoluteSD - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            RtlSelfRelativeToAbsoluteSD - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTRTL_H

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NTSYSAPI
<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>
NTAPI
RtlSelfRelativeToAbsoluteSD(
    _In_ PSECURITY_DESCRIPTOR SelfRelativeSecurityDescriptor,
    _Out_writes_bytes_to_opt_(*AbsoluteSecurityDescriptorSize, *AbsoluteSecurityDescriptorSize) PSECURITY_DESCRIPTOR AbsoluteSecurityDescriptor,
    _Inout_ PULONG AbsoluteSecurityDescriptorSize,
    _Out_writes_bytes_to_opt_(*DaclSize, *DaclSize) PACL Dacl,
    _Inout_ PULONG DaclSize,
    _Out_writes_bytes_to_opt_(*SaclSize, *SaclSize) PACL Sacl,
    _Inout_ PULONG SaclSize,
    _Out_writes_bytes_to_opt_(*OwnerSize, *OwnerSize) PSID Owner,
    _Inout_ PULONG OwnerSize,
    _Out_writes_bytes_to_opt_(*PrimaryGroupSize, *PrimaryGroupSize) PSID PrimaryGroup,
    _Inout_ PULONG PrimaryGroupSize
    );
</span><span class="ntdoc-code-footer">
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/f11386415b0d5ba3bb6df2b6977a74073126c518/phnt/include/ntrtl.h#L8999">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntifs.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NTSYSAPI <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> RtlSelfRelativeToAbsoluteSD(
  [in]      PSECURITY_DESCRIPTOR SelfRelativeSecurityDescriptor,
  [out]     PSECURITY_DESCRIPTOR AbsoluteSecurityDescriptor,
  [in, out] PULONG               AbsoluteSecurityDescriptorSize,
  [out]     PACL                 Dacl,
  [in, out] PULONG               DaclSize,
  [out]     PACL                 Sacl,
  [in, out] PULONG               SaclSize,
  [out]     PSID                 Owner,
  [in, out] PULONG               OwnerSize,
  [out]     PSID                 PrimaryGroup,
  [in, out] PULONG               PrimaryGroupSize
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-rtlselfrelativetoabsolutesd">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<p>This function is <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/nf-ntifs-rtlselfrelativetoabsolutesd">documented in Windows Driver Kit</a>.</p>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/rtlselfrelativetoabsolutesd.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ntifs-rtlselfrelativetoabsolutesd)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="rtlselfrelativetoabsolutesd-function">RtlSelfRelativeToAbsoluteSD function</h1>

<h2 id="description">Description</h2>

<p>The <strong>RtlSelfRelativeToAbsoluteSD</strong> routine creates a new security descriptor in absolute format by using a security descriptor in self-relative format as a template.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="selfrelativesecuritydescriptor-in"><code>SelfRelativeSecurityDescriptor</code> [in]</h3>

<p>Pointer to a caller-allocated buffer that contains a <a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a> structure in self-relative format. <strong>RtlSelfRelativeToAbsoluteSD</strong> creates a version of this security descriptor in absolute format without modifying the original.</p>

<h3 id="absolutesecuritydescriptor-out"><code>AbsoluteSecurityDescriptor</code> [out]</h3>

<p>Pointer to a caller-allocated buffer that receives the main body of an absolute-format security descriptor. This information is formatted as a <a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a> structure.</p>

<h3 id="absolutesecuritydescriptorsize-in-out"><code>AbsoluteSecurityDescriptorSize</code> [in, out]</h3>

<p>Pointer to a caller-allocated variable that specifies the size, in bytes, of the buffer pointed to by the <em>AbsoluteSecurityDescriptor</em> parameter. If the buffer is not large enough to hold the security descriptor, <strong>RtlSelfRelativeToAbsoluteSD</strong> returns STATUS_BUFFER_TOO_SMALL and sets this variable to the minimum required size.</p>

<h3 id="dacl-out"><code>Dacl</code> [out]</h3>

<p>Pointer to a caller-allocated buffer that receives the DACL of the absolute-format security descriptor. The main body of the absolute-format security descriptor references this pointer.</p>

<h3 id="daclsize-in-out"><code>DaclSize</code> [in, out]</h3>

<p>Pointer to a caller-allocated variable that specifies the size, in bytes, of the buffer pointed to by the <em>Dacl</em> parameter. If the buffer is not large enough to hold the DACL, <strong>RtlSelfRelativeToAbsoluteSD</strong> returns STATUS_BUFFER_TOO_SMALL and sets this variable to the minimum required size.</p>

<h3 id="sacl-out"><code>Sacl</code> [out]</h3>

<p>Pointer to a caller-allocated buffer that receives the SACL of the absolute-format security descriptor. The main body of the absolute-format security descriptor references this pointer.</p>

<h3 id="saclsize-in-out"><code>SaclSize</code> [in, out]</h3>

<p>Pointer to a caller-allocated variable that specifies the size, in bytes, of the buffer pointed to by the <em>Sacl</em> parameter. If the buffer is not large enough to hold the SACL, <strong>RtlSelfRelativeToAbsoluteSD</strong> returns STATUS_BUFFER_TOO_SMALL and sets this variable to the minimum required size.</p>

<h3 id="owner-out"><code>Owner</code> [out]</h3>

<p>Pointer to a caller-allocated buffer that receives the <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> of the owner of the absolute-format security descriptor. The main body of the absolute-format security descriptor references this pointer.</p>

<h3 id="ownersize-in-out"><code>OwnerSize</code> [in, out]</h3>

<p>Pointer to a caller-allocated variable that specifies the size, in bytes, of the buffer pointed to by the <em>Owner</em> parameter. If the buffer is not large enough to hold the <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a>, <strong>RtlSelfRelativeToAbsoluteSD</strong> returns STATUS_BUFFER_TOO_SMALL and sets this variable to the minimum required size.</p>

<h3 id="primarygroup-out"><code>PrimaryGroup</code> [out]</h3>

<p>Pointer to a caller-allocated buffer that receives the <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> of the primary group of the absolute-format security descriptor. The main body of the absolute-format security descriptor references this pointer.</p>

<h3 id="primarygroupsize-in-out"><code>PrimaryGroupSize</code> [in, out]</h3>

<p>Pointer to a caller-allocated variable that specifies the size, in bytes, of the buffer pointed to by the <em>PrimaryGroup</em> parameter. If the buffer is not large enough to hold the <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a>, <strong>RtlSelfRelativeToAbsoluteSD</strong> returns STATUS_BUFFER_TOO_SMALL and sets this variable to the minimum required size.</p>

<h2 id="return-value">Return value</h2>

<p><strong>RtlSelfRelativeToAbsoluteSD</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> or an appropriate <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> value such as one of the following:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>STATUS_BAD_DESCRIPTOR_FORMAT</strong></td>
  <td>The buffer pointed to by the <em>AbsoluteSecurityDescriptor</em> parameter did not contain a <a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a> structure in absolute format. STATUS_BAD_DESCRIPTOR_FORMAT is an error code.</td>
</tr>
<tr>
  <td><strong>STATUS_BUFFER_TOO_SMALL</strong></td>
  <td>The buffer pointed to by the <em>AbsoluteSecurityDescriptor</em> , <em>Dacl</em>, <em>Sacl</em>, <em>Owner</em>, or <em>PrimaryGroup</em> parameter was too small. STATUS_BUFFER_TOO_SMALL is an error code.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>A security descriptor in absolute format contains pointers to the information, rather than containing the information itself. A security descriptor in self-relative format contains the information in a contiguous block of memory. In a self-relative security descriptor, a <a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a> structure always starts the information, but the security descriptor's other components can follow the <a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a> structure in any order. Instead of using memory addresses, the components of the security descriptor are identified by offsets from the beginning of the security descriptor. This format is useful when a security descriptor must be stored on a floppy disk or transmitted by means of a communications protocol.</p>

<p>Note that the <em>AbsoluteSecurityDescriptor</em> parameter receives only the main body of the absolute security descriptor. The entire absolute security descriptor consists of this main body, plus all of the security descriptor components returned in the <em>Dacl</em>, <em>Sacl</em>, <em>Owner</em>, and <em>PrimaryGroup</em> buffers. Thus, the caller cannot free these buffers after calling <strong>RtlSelfRelativeToAbsoluteSD</strong>, because doing so would invalidate the absolute security descriptor.</p>

<p>To create a new security descriptor in self-relative format by using a security descriptor in absolute format as a template, use <a href="rtlabsolutetoselfrelativesd" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlAbsoluteToSelfRelativeSD(&#10;    _In_ PSECURITY_DESCRIPTOR AbsoluteSecurityDescriptor,&#10;    _Out_writes_bytes_to_opt_(*BufferLength, *BufferLength) PSECURITY_DESCRIPTOR SelfRelativeSecurityDescriptor,&#10;    _Inout_ PULONG BufferLength&#10;    );">RtlAbsoluteToSelfRelativeSD</a>.</p>

<p>For more information about security and access control, see the Microsoft Windows SDK documentation.</p>

<h2 id="see-also">See also</h2>

<p><a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a></p>

<p><a href="rtlabsolutetoselfrelativesd" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlAbsoluteToSelfRelativeSD(&#10;    _In_ PSECURITY_DESCRIPTOR AbsoluteSecurityDescriptor,&#10;    _Out_writes_bytes_to_opt_(*BufferLength, *BufferLength) PSECURITY_DESCRIPTOR SelfRelativeSecurityDescriptor,&#10;    _Inout_ PULONG BufferLength&#10;    );">RtlAbsoluteToSelfRelativeSD</a></p>

<p><a href="rtlcreatesecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlCreateSecurityDescriptor(&#10;    _Out_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_ ULONG Revision&#10;    );">RtlCreateSecurityDescriptor</a></p>

<p><a href="rtllengthsecuritydescriptor" title="NTSYSAPI&#10;ULONG&#10;NTAPI&#10;RtlLengthSecurityDescriptor(&#10;    _In_ PSECURITY_DESCRIPTOR SecurityDescriptor&#10;    );">RtlLengthSecurityDescriptor</a></p>

<p><a href="rtlsetdaclsecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlSetDaclSecurityDescriptor(&#10;    _Inout_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_ BOOLEAN DaclPresent,&#10;    _In_opt_ PACL Dacl,&#10;    _In_ BOOLEAN DaclDefaulted&#10;    );">RtlSetDaclSecurityDescriptor</a></p>

<p><a href="rtlsetownersecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlSetOwnerSecurityDescriptor(&#10;    _Inout_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_opt_ PSID Owner,&#10;    _In_ BOOLEAN OwnerDefaulted&#10;    );">RtlSetOwnerSecurityDescriptor</a></p>

<p><a href="rtlvalidsecuritydescriptor" title="_Check_return_&#10;NTSYSAPI&#10;BOOLEAN&#10;NTAPI&#10;RtlValidSecurityDescriptor(&#10;    _In_ PSECURITY_DESCRIPTOR SecurityDescriptor&#10;    );">RtlValidSecurityDescriptor</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-rtlselfrelativetoabsolutesd">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntifs/nf-ntifs-rtlselfrelativetoabsolutesd.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
