<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="AtaPortInitializeEx - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>AtaPortInitializeEx - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            AtaPortInitializeEx - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// irb.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> AtaPortInitializeEx(
  [in] PVOID                     DriverObject,
  [in] PVOID                     RegistryPath,
  [in] <a href="ide_controller_interface" title="typedef struct _IDE_CONTROLLER_INTERFACE {&#10;  USHORT                   Version;&#10;  USHORT                   Reserved;&#10;  ULONG                    ControllerExtensionSize;&#10;  ULONG                    ChannelExtensionSize;&#10;  ULONG                    AlignmentMask;&#10;  IDE_CHANNEL_INIT         AtaChannelInitRoutine;&#10;  IDE_CHANNEL_ENABLED      AtaControllerChannelEnabled;&#10;  IDE_TRANSFER_MODE_SELECT AtaControllerTransferModeSelect;&#10;  IDE_ADAPTER_CONTROL      AtaAdapterControl;&#10;} IDE_CONTROLLER_INTERFACE, *PIDE_CONTROLLER_INTERFACE;">PIDE_CONTROLLER_INTERFACE</a> ControllerInterface
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/irb/nf-irb-ataportinitializeex">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ataportinitializeex.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-irb-ataportinitializeex)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>AtaPortInitializeEx function</h1>
<h2>Description</h2>
<p>The <strong>AtaPortInitializeEx</strong> ATA port driver library routine initializes the port and miniport drivers.</p>
<p><strong>Note</strong> The ATA port driver and ATA miniport driver models may be altered or unavailable in the future. Instead, we recommend using the <a href="https://learn.microsoft.com/windows-hardware/drivers/storage/storport-driver">Storport driver</a> and <a href="https://learn.microsoft.com/windows-hardware/drivers/storage/storport-miniport-drivers">Storport miniport</a> driver models.</p>
<h2>Parameters</h2>
<h3><code>DriverObject</code> [in]</h3>
<p>A pointer to the miniport driver object.</p>
<h3><code>RegistryPath</code> [in]</h3>
<p>Contains a Unicode string that indicates the location in the registry where the miniport driver configuration information is stored.</p>
<h3><code>ControllerInterface</code> [in]</h3>
<p>Contains the entry points for the <em><strong>AtaAdapterControl</strong></em>, <em><strong>AtaChannelInitRoutine</strong></em>, <em><strong>AtaControllerChannelEnabled</strong></em>, and <em><strong>AtaControllerTransferModeSelect</strong></em> routines.</p>
<h2>Return value</h2>
<p><strong>AtaPortInitializeEx</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the operation succeeds. Otherwise, it returns an error code.</p>
<h2>Remarks</h2>
<p>The <strong>AtaPortInitializeEx</strong> routine initializes key data structures that are used by the port and miniport drivers. It also starts the initialization of the controller's channels. The following sequence describes the principal actions taken by this routine:</p>
<ol>
<li>While in its <a href="https://learn.microsoft.com/windows-hardware/drivers/storage/driverentry-of-ide-controller-minidriver">DriverEntry</a> routine, the miniport driver calls the port driver's <strong>AtaPortInitializeEx</strong> library routine and passes it the following key parameters:
<ul>
<li><em>ControllerInterface</em>: Contains the entry points for the <em><strong>AtaAdapterControl</strong></em>, <em><strong>AtaChannelInitRoutine</strong></em>, <em><strong>AtaControllerChannelEnabled</strong></em>, and <em><strong>AtaControllerTransferModeSelect</strong></em> routines.</li>
</ul>
</li>
<li>The <strong>AtaPortInitializeEx</strong> routine initializes key data structures that are used by the port and miniport drivers and performs the following actions:
<ol>
<li>Initializes the miniport driver's dispatch tables.</li>
<li>Allocates an extension for the driver object.</li>
<li>Copies ControllerInterface into the driver extension.</li>
<li>After <em><strong>AtaPortInitializeEx</strong></em> completes the initialization of the port driver, it returns to the miniport driver's <em><strong><a href="driverentry" title="NTSTATUS DriverEntry(&#10;  [in] PDRIVER_OBJECT  DriverObject,&#10;  [in] PUNICODE_STRING RegistryPath&#10;);">DriverEntry</a></strong></em> routine.</li>
</ol>
</li>
<li>While starting the adapter device, the miniport driver routine <em><strong>AtaAdapterControl</strong></em> will be called by the port driver with control action <strong>IdeStart</strong>.</li>
<li>When the ATA port driver is processing a channel device start request, the miniport driver routine <a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/irb/nc-irb-ide_channel_enabled">AtaControllerChannelEnabled</a> is called for each channel on the controller to determine whether it is enabled.</li>
<li>After the <a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/irb/nc-irb-ide_channel_enabled">AtaControllerChannelEnabled</a> routine determines which channels are enabled, the ATA port driver calls <a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/irb/nc-irb-ide_channel_init">AtaChannelInitRoutine</a> for this channel.</li>
</ol>
<h2>See also</h2>
<p><a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/irb/nc-irb-ide_channel_init">AtaChannelInitRoutine</a></p>
<p><a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/irb/nc-irb-ide_channel_enabled">AtaControllerChannelEnabled</a></p>
<p><a href="https://learn.microsoft.com/windows-hardware/drivers/storage/driverentry-of-ide-controller-minidriver">DriverEntry</a></p>
<p><a href="ide_controller_configuration" title="typedef struct _IDE_CONTROLLER_CONFIGURATION {&#10;  USHORT                  Version;&#10;  UCHAR                   NumberOfChannels;&#10;  IDE_OPERATION_MODE      ControllerMode;&#10;  UCHAR                   NumberOfPhysicalBreaks;&#10;  ULONG                   MaximumTransferLength;&#10;  BOOLEAN                 Reserved;&#10;  BOOLEAN                 NativeModeEnabled;&#10;  BOOLEAN                 Dma64BitAddress;&#10;  BOOLEAN                 BusMaster;&#10;  IDE_BUS_TYPE            AtaBusType;&#10;  PIDE_MINIPORT_RESOURCES ControllerResources;&#10;} IDE_CONTROLLER_CONFIGURATION, *PIDE_CONTROLLER_CONFIGURATION;">IDE_CONTROLLER_CONFIGURATION</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/irb/nf-irb-ataportinitializeex">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/irb/nf-irb-ataportinitializeex.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
