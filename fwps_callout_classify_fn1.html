<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FWPS_CALLOUT_CLASSIFY_FN1 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FWPS_CALLOUT_CLASSIFY_FN1 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FWPS_CALLOUT_CLASSIFY_FN1 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// fwpsk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">FWPS_CALLOUT_CLASSIFY_FN1 FwpsCalloutClassifyFn1;

void FwpsCalloutClassifyFn1(
  [in]           const FWPS_INCOMING_VALUES0 *inFixedValues,
  [in]           const <a href="fwps_incoming_metadata_values0_" title="typedef struct FWPS_INCOMING_METADATA_VALUES0_ {&#10;  UINT32                          currentMetadataValues;&#10;  UINT32                          flags;&#10;  UINT64                          reserved;&#10;  FWPS_DISCARD_METADATA0          discardMetadata;&#10;  UINT64                          flowHandle;&#10;  UINT32                          ipHeaderSize;&#10;  UINT32                          transportHeaderSize;&#10;  FWP_BYTE_BLOB                   *processPath;&#10;  UINT64                          token;&#10;  UINT64                          processId;&#10;  UINT32                          sourceInterfaceIndex;&#10;  UINT32                          destinationInterfaceIndex;&#10;  ULONG                           compartmentId;&#10;  FWPS_INBOUND_FRAGMENT_METADATA0 fragmentMetadata;&#10;  ULONG                           pathMtu;&#10;  HANDLE                          completionHandle;&#10;  UINT64                          transportEndpointHandle;&#10;  SCOPE_ID                        remoteScopeId;&#10;  WSACMSGHDR                      *controlData;&#10;...">FWPS_INCOMING_METADATA_VALUES0</a> *inMetaValues,
  [in, out]      void *layerData,
  [in, optional] const void *classifyContext,
  [in]           const FWPS_FILTER1 *filter,
  [in]           <a href="uint64" title="typedef unsigned __int64 UINT64;">UINT64</a> flowContext,
  [in, out]      FWPS_CLASSIFY_OUT0 *classifyOut
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nc-fwpsk-fwps_callout_classify_fn1">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/fwps_callout_classify_fn1.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-fwpsk-fwps_callout_classify_fn1)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="fwps_callout_classify_fn1-callback-function">FWPS_CALLOUT_CLASSIFY_FN1 callback function</h1>

<h2 id="description">Description</h2>

<p>The filter engine calls a callout's
<em>classifyFn1</em> callout function whenever there is data to be processed by the callout.</p>

<p><strong>Note</strong> <em>classifyFn1</em> is the specific version of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_netvista/">classifyFn</a> used in Windows 7 and later. See <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/FWP/wfp-version-independent-names-and-targeting-specific-versions-of-windows">WFP Version-Independent Names and Targeting Specific Versions of Windows</a> for more information. For Windows 8, <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nc-fwpsk-fwps_callout_classify_fn2">classifyFn2</a> is available. For Windows Vista, <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nc-fwpsk-fwps_callout_classify_fn0">classifyFn0</a> is available.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="infixedvalues-in"><code>inFixedValues</code> [in]</h3>

<p>A pointer to an
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/fwpstypes/ns-fwpstypes-fwps_incoming_values0">FWPS_INCOMING_VALUES0</a> structure. This
structure contains the values for each of the data fields in the layer being filtered.</p>

<h3 id="inmetavalues-in"><code>inMetaValues</code> [in]</h3>

<p>A pointer to an
<a href="fwps_incoming_metadata_values0_" title="typedef struct FWPS_INCOMING_METADATA_VALUES0_ {&#10;  UINT32                          currentMetadataValues;&#10;  UINT32                          flags;&#10;  UINT64                          reserved;&#10;  FWPS_DISCARD_METADATA0          discardMetadata;&#10;  UINT64                          flowHandle;&#10;  UINT32                          ipHeaderSize;&#10;  UINT32                          transportHeaderSize;&#10;  FWP_BYTE_BLOB                   *processPath;&#10;  UINT64                          token;&#10;  UINT64                          processId;&#10;  UINT32                          sourceInterfaceIndex;&#10;  UINT32                          destinationInterfaceIndex;&#10;  ULONG                           compartmentId;&#10;  FWPS_INBOUND_FRAGMENT_METADATA0 fragmentMetadata;&#10;  ULONG                           pathMtu;&#10;  HANDLE                          completionHandle;&#10;  UINT64                          transportEndpointHandle;&#10;  SCOPE_ID                        remoteScopeId;&#10;  WSACMSGHDR                      *controlData;&#10;...">FWPS_INCOMING_METADATA_VALUES0</a> structure. This structure contains the values for each of the
metadata fields in the layer being filtered.</p>

<h3 id="layerdata-in-out"><code>layerData</code> [in, out]</h3>

<p>A pointer to a structure that describes the raw data in the layer being filtered. This parameter
might be <strong>NULL</strong>, depending on the layer being filtered and the conditions under which the
<em>classifyFn1</em> callout function is called. For the stream layer, this parameter points to an
<a href="fwps_stream_callout_io_packet0_" title="typedef struct FWPS_STREAM_CALLOUT_IO_PACKET0_ {&#10;  FWPS_STREAM_DATA0       *streamData;&#10;  SIZE_T                  missedBytes;&#10;  UINT32                  countBytesRequired;&#10;  SIZE_T                  countBytesEnforced;&#10;  FWPS_STREAM_ACTION_TYPE streamAction;&#10;} FWPS_STREAM_CALLOUT_IO_PACKET0;">FWPS_STREAM_CALLOUT_IO_PACKET0</a> structure. For all of the other layers, this parameter points to a
<a href="net_buffer_list" title="typedef struct _NET_BUFFER_LIST {&#10;  union {&#10;    struct {&#10;      NET_BUFFER_LIST *Next;&#10;      NET_BUFFER      *FirstNetBuffer;&#10;    };&#10;    SLIST_HEADER           Link;&#10;    NET_BUFFER_LIST_HEADER NetBufferListHeader;&#10;  };&#10;  NET_BUFFER_LIST_CONTEXT *Context;&#10;  NET_BUFFER_LIST         *ParentNetBufferList;&#10;  NDIS_HANDLE             NdisPoolHandle;&#10;  PVOID                   NdisReserved[2];&#10;  PVOID                   ProtocolReserved[4];&#10;  PVOID                   MiniportReserved[2];&#10;  PVOID                   Scratch;&#10;  NDIS_HANDLE             SourceHandle;&#10;  ULONG                   NblFlags;&#10;  LONG                    ChildRefCount;&#10;  ULONG                   Flags;&#10;...">NET_BUFFER_LIST</a> structure if it is not
<strong>NULL</strong>.</p>

<h3 id="classifycontext-in-optional"><code>classifyContext</code> [in, optional]</h3>

<p>A pointer to context data associated with the callout driver by the filter engine.</p>

<h3 id="filter-in"><code>filter</code> [in]</h3>

<p>A pointer to an
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/fwpstypes/ns-fwpstypes-fwps_filter1">FWPS_FILTER1</a> structure. This structure
describes the filter that specifies the callout for the filter's action.</p>

<h3 id="flowcontext-in"><code>flowContext</code> [in]</h3>

<p>A <a href="uint64" title="typedef unsigned __int64 UINT64;">UINT64</a>-typed variable that contains the context associated with the data flow. If no context is
associated with the data flow, then this parameter is zero. If the callout is added to the filter engine
at a filtering layer that does not support data flows, the
<em>classifyFn1</em> callout function should ignore this parameter.</p>

<h3 id="classifyout-in-out"><code>classifyOut</code> [in, out]</h3>

<p>A pointer to an
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/fwpstypes/ns-fwpstypes-fwps_classify_out0">FWPS_CLASSIFY_OUT0</a> structure that
receives any data that the
<em>classifyFn1</em> callout function returns to the caller.</p>

<h2 id="remarks">Remarks</h2>

<p>A callout driver registers a callout's callout functions with the filter engine by calling the
<a href="fwpscalloutregister1" title="NTSTATUS FwpsCalloutRegister1(&#10;  [in, out]       void                *deviceObject,&#10;  [in]            const FWPS_CALLOUT1 *callout,&#10;  [out, optional] UINT32              *calloutId&#10;);">FwpsCalloutRegister1</a> function.</p>

<p>The filter engine calls a callout's
<em>classifyFn1</em> callout function with data to be processed whenever all of the test conditions are true
for a filter in the filter engine that specifies the callout for the filter's action.</p>

<p>A callout's
<em>classifyFn1</em> callout function should clear the FWPS_RIGHT_ACTION_WRITE flag in the
<strong>rights</strong> member of the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/fwpstypes/ns-fwpstypes-fwps_classify_out0">FWPS_CLASSIFY_OUT0</a> structure in any of
the following situations:</p>

<ul>
<li>When the
<em>classifyFn1</em> callout function sets the
<strong>actionType</strong> member of the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/fwpstypes/ns-fwpstypes-fwps_classify_out0">FWPS_CLASSIFY_OUT0</a> structure to
FWP_ACTION_BLOCK.</li>
<li>When the
<em>classifyFn1</em> callout function sets the
<strong>actionType</strong> member of the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/fwpstypes/ns-fwpstypes-fwps_classify_out0">FWPS_CLASSIFY_OUT0</a> structure to
FWP_ACTION_PERMIT and the FWPS_FILTER_FLAG_CLEAR_ACTION_RIGHT flag is set in the
<strong>Flags</strong> member of the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/fwpstypes/ns-fwpstypes-fwps_filter1">FWPS_FILTER1</a> structure.</li>
<li>When a callout has indicated that it intends to modify the clone net buffer list by setting the
<em>intendToModify</em> parameter to <strong>TRUE</strong> in a call to the
<a href="fwpsreferencenetbufferlist0" title="void FwpsReferenceNetBufferList0(&#10;  [in, out] NET_BUFFER_LIST *netBufferList,&#10;  [in]      BOOLEAN         intendToModify&#10;);">FwpsReferenceNetBufferList0</a> function.</li>
</ul>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/associating-context-with-a-data-flow">Associating Context with a Data Flow</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_netvista/">Callout Driver Callout Functions</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/data-logging">Data Logging</a></p>

<p><a href="fwps_callout0_" title="typedef struct FWPS_CALLOUT0_ {&#10;  GUID                                calloutKey;&#10;  UINT32                              flags;&#10;  FWPS_CALLOUT_CLASSIFY_FN0           classifyFn;&#10;  FWPS_CALLOUT_NOTIFY_FN0             notifyFn;&#10;  FWPS_CALLOUT_FLOW_DELETE_NOTIFY_FN0 flowDeleteFn;&#10;} FWPS_CALLOUT0;">FWPS_CALLOUT0</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/fwpstypes/ns-fwpstypes-fwps_classify_out0">FWPS_CLASSIFY_OUT0</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/fwpstypes/ns-fwpstypes-fwps_filter1">FWPS_FILTER1</a></p>

<p><a href="fwps_incoming_metadata_values0_" title="typedef struct FWPS_INCOMING_METADATA_VALUES0_ {&#10;  UINT32                          currentMetadataValues;&#10;  UINT32                          flags;&#10;  UINT64                          reserved;&#10;  FWPS_DISCARD_METADATA0          discardMetadata;&#10;  UINT64                          flowHandle;&#10;  UINT32                          ipHeaderSize;&#10;  UINT32                          transportHeaderSize;&#10;  FWP_BYTE_BLOB                   *processPath;&#10;  UINT64                          token;&#10;  UINT64                          processId;&#10;  UINT32                          sourceInterfaceIndex;&#10;  UINT32                          destinationInterfaceIndex;&#10;  ULONG                           compartmentId;&#10;  FWPS_INBOUND_FRAGMENT_METADATA0 fragmentMetadata;&#10;  ULONG                           pathMtu;&#10;  HANDLE                          completionHandle;&#10;  UINT64                          transportEndpointHandle;&#10;  SCOPE_ID                        remoteScopeId;&#10;  WSACMSGHDR                      *controlData;&#10;...">FWPS_INCOMING_METADATA_VALUES0</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/fwpstypes/ns-fwpstypes-fwps_incoming_values0">FWPS_INCOMING_VALUES0</a></p>

<p><a href="fwpscalloutregister1" title="NTSTATUS FwpsCalloutRegister1(&#10;  [in, out]       void                *deviceObject,&#10;  [in]            const FWPS_CALLOUT1 *callout,&#10;  [out, optional] UINT32              *calloutId&#10;);">FwpsCalloutRegister1</a></p>

<p><a href="fwpsreferencenetbufferlist0" title="void FwpsReferenceNetBufferList0(&#10;  [in, out] NET_BUFFER_LIST *netBufferList,&#10;  [in]      BOOLEAN         intendToModify&#10;);">FwpsReferenceNetBufferList0</a></p>

<p><a href="net_buffer_list" title="typedef struct _NET_BUFFER_LIST {&#10;  union {&#10;    struct {&#10;      NET_BUFFER_LIST *Next;&#10;      NET_BUFFER      *FirstNetBuffer;&#10;    };&#10;    SLIST_HEADER           Link;&#10;    NET_BUFFER_LIST_HEADER NetBufferListHeader;&#10;  };&#10;  NET_BUFFER_LIST_CONTEXT *Context;&#10;  NET_BUFFER_LIST         *ParentNetBufferList;&#10;  NDIS_HANDLE             NdisPoolHandle;&#10;  PVOID                   NdisReserved[2];&#10;  PVOID                   ProtocolReserved[4];&#10;  PVOID                   MiniportReserved[2];&#10;  PVOID                   Scratch;&#10;  NDIS_HANDLE             SourceHandle;&#10;  ULONG                   NblFlags;&#10;  LONG                    ChildRefCount;&#10;  ULONG                   Flags;&#10;...">NET_BUFFER_LIST</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/packet-modification-examples">Packet Modification Examples</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/registering-callouts-with-the-filter-engine">Registering Callouts with the Filter Engine</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/using-a-callout-for-deep-inspection-of-stream-data">Using a Callout
for Deep Inspection of Stream Data</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/using-a-callout-for-deep-inspection">Using a Callout for Deep Inspection</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_netvista/">classifyFn</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nc-fwpsk-fwps_callout_classify_fn0">classifyFn0</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nc-fwpsk-fwps_callout_classify_fn2">classifyFn2</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nc-fwpsk-fwps_callout_classify_fn1">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/fwpsk/nc-fwpsk-fwps_callout_classify_fn1.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
