<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PoFxIssueComponentPerfStateChange - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PoFxIssueComponentPerfStateChange - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PoFxIssueComponentPerfStateChange - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">VOID PoFxIssueComponentPerfStateChange(
  [in] POHANDLE                 Handle,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                    Flags,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                    Component,
  [in] <a href="po_fx_perf_state_change" title="typedef struct _PO_FX_PERF_STATE_CHANGE {&#10;  ULONG Set;&#10;  union {&#10;    ULONG     StateIndex;&#10;    ULONGLONG StateValue;&#10;  };&#10;} PO_FX_PERF_STATE_CHANGE, *PPO_FX_PERF_STATE_CHANGE;">PPO_FX_PERF_STATE_CHANGE</a> PerfChange,
  [in] PVOID                    Context
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-pofxissuecomponentperfstatechange">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pofxissuecomponentperfstatechange.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-wdm-pofxissuecomponentperfstatechange)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pofxissuecomponentperfstatechange-function">PoFxIssueComponentPerfStateChange function</h1>

<h2 id="description">Description</h2>

<p>The <strong>PoFxIssueComponentPerfStateChange</strong> routine submits a request to place a device component in a
particular performance state.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="handle-in"><code>Handle</code> [in]</h3>

<p>A handle that represents the registration of the device with PoFx. The device driver previously received this handle from the <a href="pofxregisterdevice" title="NTSTATUS PoFxRegisterDevice(&#10;  [in]  PDEVICE_OBJECT Pdo,&#10;  [in]  PPO_FX_DEVICE  Device,&#10;  [out] POHANDLE       *Handle&#10;);">PoFxRegisterDevice</a> routine.</p>

<h3 id="flags-in"><code>Flags</code> [in]</h3>

<p>The flags that modify the behavior of the performance state change operation. Set this member to zero or to one of the following flag <strong>PO_FX_FLAG_*XXX</strong>* bits:</p>

<p>These two flag bits are mutually exclusive. For more information, see Remarks.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>PO_FX_FLAG_BLOCKING</strong><br><br>0x1</td>
  <td>Make the condition change synchronous. If this flag is set, the routine that requests the condition change does not return control to the calling driver until the component hardware completes the transition to the new condition. This flag can be used only if the caller is running at IRQL &lt; DISPATCH_LEVEL.</td>
</tr>
<tr>
  <td><strong>PO_FX_FLAG_ASYNC_ONLY</strong><br><br>0x2</td>
  <td>Make the condition change fully asynchronous. If this flag is set, the calling driver's callback routine is called from a thread other than the thread in which the routine that requests the condition change is called. Thus, the routine that requests the condition change always returns asynchronously without waiting for the callback to complete.</td>
</tr>
</tbody>
</table>

<h3 id="component-in"><code>Component</code> [in]</h3>

<p>The index that identifies the component. This parameter is an index into the <strong>Components</strong> array in the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_po_fx_device_v1">PO_FX_DEVICE</a> structure that the device driver used to register the device with PoFx. If the <strong>Components</strong> array contains N elements, component indexes range from 0 to Nâ€“1.</p>

<h3 id="perfchange-in"><code>PerfChange</code> [in]</h3>

<p>A pointer to a <a href="po_fx_perf_state_change" title="typedef struct _PO_FX_PERF_STATE_CHANGE {&#10;  ULONG Set;&#10;  union {&#10;    ULONG     StateIndex;&#10;    ULONGLONG StateValue;&#10;  };&#10;} PO_FX_PERF_STATE_CHANGE, *PPO_FX_PERF_STATE_CHANGE;">PO_FX_PERF_STATE_CHANGE</a> structure that represents the new performance state of the component.</p>

<h3 id="context-in"><code>Context</code> [in]</h3>

<p>A pointer to the context for the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_perf_state_callback">ComponentPerfStateCallback</a> callback routine. This parameter is optional. It is provided so that a driver or device context can be passed to the callback routine. If this parameter is not used, it must be set to NULL.</p>

<h2 id="remarks">Remarks</h2>

<p>When a driver calls <strong>PoFxIssueComponentPerfStateChange</strong>, the power management framework (PoFx) requests the platform extension plug-in (PEP) to place
the component's performance state set in the specified performance state. This routine may be used with both discrete and range-based types of performance state sets. For more information about discrete and range-based performance state sets, see <a href="po_fx_perf_state_type" title="typedef enum _PO_FX_PERF_STATE_TYPE {&#10;  PoFxPerfStateTypeDiscrete,&#10;  PoFxPerfStateTypeRange,&#10;  PoFxPerfStateTypeMaximum&#10;} PO_FX_PERF_STATE_TYPE, *PPO_FX_PERF_STATE_TYPE;">PO_FX_PERF_STATE_TYPE</a>.</p>

<p>If <em>Flags</em> = <strong>PO_FX_FLAG_BLOCKING</strong>, the <strong>PoFxIssueComponentPerfStateChange</strong> call is synchronous. In this case, <strong>PoFxIssueComponentPerfStateChange</strong> waits to return until the component completes the performance state transition. The driver's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_perf_state_callback">ComponentPerfStateCallback</a> routine is called to inform the driver that the component's performance state change is complete. This callback occurs in the same thread as the call to <strong>PoFxIssueComponentPerfStateChange</strong>, and <strong>PoFxIssueComponentPerfStateChange</strong> returns only after the <em>ComponentPerfStateCallback</em> callback returns.</p>

<p>If <em>Flags</em> = <strong>PO_FX_FLAG_ASYNC_ONLY</strong>, the <strong>PoFxIssueComponentPerfStateChange</strong> call is asynchronous. In this case, <strong>PoFxIssueComponentPerfStateChange</strong> schedules the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_perf_state_callback">ComponentPerfStateCallback</a> routine to occur in another thread, and then returns without waiting for the callback to occur. The callback can occur before or after <strong>PoFxIssueComponentPerfStateChange</strong> returns. The driver should rely on the <em>ComponentPerfStateCallback</em> routine to determine when the component completes the transition to the new performance state.</p>

<p>The driver can set <em>Flags</em> = 0 to indicate that it does not care whether the <strong>PoFxIssueComponentPerfStateChange</strong> call is synchronous or asynchronous. In this case, PoFx decides the synchronicity of the call based on whether the PEP uses a synchronous or asynchronous request to issue the performance state change to the component.</p>

<p>If <em>Flags</em> = <strong>PO_FX_FLAG_ASYNC_ONLY</strong> or no flags are passed, this routine requires an IRQL of &lt;= DISPATCH_LEVEL. If <em>Flags</em> = <strong>PO_FX_FLAG_BLOCKING</strong>, this routine requires an IRQL of &lt;= APC_LEVEL.</p>

<p>This function will always result in a call to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_perf_state_callback">ComponentPerfStateCallback</a> routine regardless of the synchronicity of the call. Because the PEP may choose to deny the request to change the performance state, the driver must wait until receiving the callback before committing the performance state to hardware.</p>

<p>Only a single call of the <strong>PoFxIssueComponentPerfStateChange</strong> routine is allowed at a time per component, regardless of whether the call is synchronous or asynchronous. After issuing a performance state change request, the driver must wait until the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_perf_state_callback">ComponentPerfStateCallback</a> is received before calling this routine again, even if the request involves a different performance state set. If this routine is called again before waiting until the <em>ComponentPerfStateCallback</em> is received, a bugcheck will occur.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_perf_state_callback">ComponentPerfStateCallback</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/component-level-performance-management">Device Performance State Management</a></p>

<p><a href="po_fx_perf_state_type" title="typedef enum _PO_FX_PERF_STATE_TYPE {&#10;  PoFxPerfStateTypeDiscrete,&#10;  PoFxPerfStateTypeRange,&#10;  PoFxPerfStateTypeMaximum&#10;} PO_FX_PERF_STATE_TYPE, *PPO_FX_PERF_STATE_TYPE;">PO_FX_PERF_STATE_TYPE</a></p>

<p><a href="pofxissuecomponentperfstatechangemultiple" title="VOID PoFxIssueComponentPerfStateChangeMultiple(&#10;  [in] POHANDLE                   Handle,&#10;  [in] ULONG                      Flags,&#10;  [in] ULONG                      Component,&#10;  [in] ULONG                      PerfChangesCount,&#10;  [in] PO_FX_PERF_STATE_CHANGE [] PerfChanges,&#10;  [in] PVOID                      Context&#10;);">PoFxIssueComponentPerfStateChangeMultiple</a></p>

<p><a href="pofxregistercomponentperfstates" title="NTSTATUS PoFxRegisterComponentPerfStates(&#10;  [in]  POHANDLE                             Handle,&#10;  [in]  ULONG                                Component,&#10;  [in]  ULONGLONG                            Flags,&#10;  [in]  PPO_FX_COMPONENT_PERF_STATE_CALLBACK ComponentPerfStateCallback,&#10;  [in]  PPO_FX_COMPONENT_PERF_INFO           InputStateInfo,&#10;  [out] PPO_FX_COMPONENT_PERF_INFO           *OutputStateInfo&#10;);">PoFxRegisterComponentPerfStates</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-pofxissuecomponentperfstatechange">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/nf-wdm-pofxissuecomponentperfstatechange.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
