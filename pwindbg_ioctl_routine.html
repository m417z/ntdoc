<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PWINDBG_IOCTL_ROUTINE - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PWINDBG_IOCTL_ROUTINE - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PWINDBG_IOCTL_ROUTINE - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdbgexts.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PWINDBG_IOCTL_ROUTINE PwindbgIoctlRoutine;

<a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> PwindbgIoctlRoutine(
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a> IoctlType,
  PVOID lpvData,
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> cbSize
)
{...}</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdbgexts/nc-wdbgexts-pwindbg_ioctl_routine">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pwindbg_ioctl_routine.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-wdbgexts-pwindbg_ioctl_routine)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pwindbg_ioctl_routine-callback-function">PWINDBG_IOCTL_ROUTINE callback function</h1>

<h2 id="description">Description</h2>

<p>The <strong>PWINDBG_IOCTL_ROUTINE</strong> (<strong>Ioctl</strong>) function performs a variety of different operations. Much of its functionality mirrors the functionality of other functions in wdbgexts.h.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="ioctltype"><code>IoctlType</code></h3>

<p>Specifies which <strong>Ioctl</strong> operation to perform. For a list of possible <em>IoctlType</em> values, see the "Remarks" section.</p>

<h3 id="lpvdata"><code>lpvData</code></h3>

<p>Points to the address of a data structure. The type of structure that is required depends on the value of <em>IoctlType</em>.</p>

<h3 id="cbsize"><code>cbSize</code></h3>

<p>Specifies the size of the structure that <em>lpvData</em> points to.</p>

<h2 id="return-value">Return value</h2>

<p>The meaning of return value depends on <em>IoctlType</em>. See the page for the corresponding <strong>Ioctl</strong> operation for the meaning of the return value.</p>

<h2 id="remarks">Remarks</h2>

<p>The <strong>Ioctl</strong> function is the entry point for many of the functionalities supplied for WdbgExts extensions. Many of the other functions in wdbgexts.h are simply wrappers for calls to <strong>Ioctl</strong>.</p>

<p>The following table lists the possible <em>IoctlType</em> values. If the <em>IoctlType</em> corresponds to another function, that function is provided; otherwise, a link to the page describing the <strong>Ioctl</strong> operation is provided.</p>

<table>
<thead>
<tr>
  <th><em>IoctlType</em> constant</th>
  <th>Equivalent function</th>
  <th>lpData structure</th>
</tr>
</thead>
<tbody>
<tr>
  <td>IG_KD_CONTEXT</td>
  <td><a href="getkdcontext" title="void GetKdContext(&#10;  ppi&#10;);">GetKdContext</a></td>
  <td></td>
</tr>
<tr>
  <td>IG_READ_CONTROL_SPACE</td>
  <td><a href="readcontrolspace" title="VOID ReadControlSpace(&#10;  USHORT processor,&#10;  ULONG  address,&#10;  PVOID  buf,&#10;  ULONG  size&#10;);">ReadControlSpace</a>&lt;br&gt;&lt;br&gt;<strong><a href="readcontrolspace64" title="VOID ReadControlSpace64(&#10;  USHORT  processor,&#10;  ULONG64 address,&#10;  PVOID   buf,&#10;  ULONG   size&#10;);">ReadControlSpace64</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_WRITE_CONTROL_SPACE</td>
  <td><strong><a href="writecontrolspace" title="VOID WriteControlSpace(&#10;  USHORT processor,&#10;  ULONG  address,&#10;  PVOID  buf,&#10;  ULONG  size&#10;);">WriteControlSpace</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_READ_IO_SPACE</td>
  <td><a href="readiospace" title="VOID ReadIoSpace(&#10;  ULONG  address,&#10;  PULONG data,&#10;  PULONG size&#10;);">ReadIoSpace</a>&lt;br&gt;&lt;br&gt;<strong><a href="readiospace64" title="VOID ReadIoSpace64(&#10;  ULONG64 address,&#10;  PULONG  data,&#10;  PULONG  size&#10;);">ReadIoSpace64</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_WRITE_IO_SPACE</td>
  <td><a href="writeiospace" title="VOID WriteIoSpace(&#10;  ULONG  address,&#10;  ULONG  data,&#10;  PULONG size&#10;);">WriteIoSpace</a>&lt;br&gt;&lt;br&gt;<strong><a href="writeiospace64" title="VOID WriteIoSpace64(&#10;  ULONG64 address,&#10;  ULONG   data,&#10;  PULONG  size&#10;);">WriteIoSpace64</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_READ_PHYSICAL</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dbgeng/nf-dbgeng-idebugdataspaces4-readphysical">ReadPhysical</a></td>
  <td></td>
</tr>
<tr>
  <td>IG_WRITE_PHYSICAL</td>
  <td><a href="writephysical" title="VOID WritePhysical(&#10;  [in]            ULONG64 address,&#10;  [in]            PVOID   buf,&#10;  [in]            ULONG   size,&#10;  [out, optional] PULONG  sizew&#10;);">WritePhysical</a></td>
  <td></td>
</tr>
<tr>
  <td>IG_READ_IO_SPACE_EX</td>
  <td><a href="readiospaceex" title="VOID ReadIoSpaceEx(&#10;  ULONG  address,&#10;  PULONG data,&#10;  PULONG size,&#10;  ULONG  interfacetype,&#10;  ULONG  busnumber,&#10;  ULONG  addressspace&#10;);">ReadIoSpaceEx</a>&lt;br&gt;&lt;br&gt;<strong><a href="readiospaceex64" title="VOID ReadIoSpaceEx64(&#10;  ULONG64 address,&#10;  PULONG  data,&#10;  PULONG  size,&#10;  ULONG   interfacetype,&#10;  ULONG   busnumber,&#10;  ULONG   addressspace&#10;);">ReadIoSpaceEx64</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_WRITE_IO_SPACE_EX</td>
  <td><a href="writeiospaceex" title="VOID WriteIoSpaceEx(&#10;  ULONG  address,&#10;  ULONG  data,&#10;  PULONG size,&#10;  ULONG  interfacetype,&#10;  ULONG  busnumber,&#10;  ULONG  addressspace&#10;);">WriteIoSpaceEx</a>&lt;br&gt;&lt;br&gt;<strong><a href="writeiospaceex64" title="VOID WriteIoSpaceEx64(&#10;  ULONG64 address,&#10;  ULONG   data,&#10;  PULONG  size,&#10;  ULONG   interfacetype,&#10;  ULONG   busnumber,&#10;  ULONG   addressspace&#10;);">WriteIoSpaceEx64</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_SET_THREAD</td>
  <td><a href="setthreadforoperation" title="VOID SetThreadForOperation(&#10;  ULONG_PTR *Thread&#10;);">SetThreadForOperation</a>&lt;br&gt;&lt;br&gt;<strong><a href="setthreadforoperation64" title="VOID SetThreadForOperation64(&#10;  PULONG64 Thread&#10;);">SetThreadForOperation64</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_READ_MSR</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dbgeng/nf-dbgeng-idebugdataspaces4-readmsr">ReadMsr</a></td>
  <td></td>
</tr>
<tr>
  <td>IG_WRITE_MSR</td>
  <td><a href="writemsr" title="VOID WriteMsr(&#10;  [in] ULONG     MsrReg,&#10;  [in] ULONGLONG MsrValue&#10;);">WriteMsr</a></td>
  <td></td>
</tr>
<tr>
  <td>IG_GET_DEBUGGER_DATA</td>
  <td><a href="getdebuggerdata" title="void GetDebuggerData(&#10;  TAG,&#10;  BUF,&#10;  SIZE&#10;);">GetDebuggerData</a></td>
  <td></td>
</tr>
<tr>
  <td>IG_GET_KERNEL_VERSION</td>
  <td></td>
  <td><a href="dbgkd_get_version64" title="typedef struct _DBGKD_GET_VERSION64 {&#10;  USHORT  MajorVersion;&#10;  USHORT  MinorVersion;&#10;  UCHAR   ProtocolVersion;&#10;  UCHAR   KdSecondaryVersion;&#10;  USHORT  Flags;&#10;  USHORT  MachineType;&#10;  UCHAR   MaxPacketType;&#10;  UCHAR   MaxStateChange;&#10;  UCHAR   MaxManipulate;&#10;  UCHAR   Simulation;&#10;  USHORT  Unused[1];&#10;  ULONG64 KernBase;&#10;  ULONG64 PsLoadedModuleList;&#10;  ULONG64 DebuggerDataList;&#10;} DBGKD_GET_VERSION64, *PDBGKD_GET_VERSION64;">DBGKD_GET_VERSION64</a></td>
</tr>
<tr>
  <td>IG_RELOAD_SYMBOLS</td>
  <td><strong><a href="reloadsymbols" title="VOID ReloadSymbols(&#10;  PSTR Arg&#10;);">ReloadSymbols</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_GET_SET_SYMPATH</td>
  <td><a href="getsetsympath" title="VOID GetSetSympath(&#10;  [in]  PSTR Arg,&#10;  [out] PSTR Result,&#10;  [in]  int  Length&#10;);">GetSetSympath</a></td>
  <td></td>
</tr>
<tr>
  <td>IG_GET_EXCEPTION_RECORD</td>
  <td></td>
  <td></td>
</tr>
<tr>
  <td>IG_IS_PTR64</td>
  <td><strong><a href="isptr64" title="ULONG IsPtr64();">IsPtr64</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_GET_BUS_DATA</td>
  <td></td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdbgexts/ns-wdbgexts-_getsetbusdata">GETSETBUSDATA</a></td>
</tr>
<tr>
  <td>IG_SET_BUS_DATA</td>
  <td></td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdbgexts/ns-wdbgexts-_getsetbusdata">GETSETBUSDATA</a></td>
</tr>
<tr>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdbgexts/ns-wdbgexts-_sym_dump_param">IG_DUMP_SYMBOL_INFO</a></td>
  <td></td>
  <td><a href="sym_dump_param" title="typedef struct _SYM_DUMP_PARAM {&#10;  ULONG                    size;&#10;  PUCHAR                   sName;&#10;  ULONG                    Options;&#10;  ULONG64                  addr;&#10;  PFIELD_INFO              listLink;&#10;  union {&#10;    PVOID Context;&#10;    PVOID pBuffer;&#10;  };&#10;  PSYM_DUMP_FIELD_CALLBACK CallbackRoutine;&#10;  ULONG                    nFields;&#10;  PFIELD_INFO              Fields;&#10;  ULONG64                  ModBase;&#10;  ULONG                    TypeId;&#10;  ULONG                    TypeSize;&#10;  ULONG                    BufferSize;&#10;  ULONG                    fPointer : 2;&#10;  ULONG                    fArray : 1;&#10;  ULONG                    fStruct : 1;&#10;...">SYM_DUMP_PARAM</a></td>
</tr>
<tr>
  <td>IG_LOWMEM_CHECK</td>
  <td></td>
  <td>See Remarks.</td>
</tr>
<tr>
  <td>IG_SEARCH_MEMORY</td>
  <td><strong><a href="searchmemory" title="VOID SearchMemory(&#10;  ULONG64  SearchAddress,&#10;  ULONG64  SearchLength,&#10;  ULONG    PatternLength,&#10;  PVOID    Pattern,&#10;  PULONG64 FoundAddress&#10;);">SearchMemory</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_GET_CURRENT_THREAD</td>
  <td><strong><a href="getcurrentthreadaddr" title="VOID GetCurrentThreadAddr(&#10;  DWORD    Processor,&#10;  PULONG64 Address&#10;);">GetCurrentThreadAddr</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_GET_CURRENT_PROCESS</td>
  <td><strong><a href="getcurrentprocessaddr" title="VOID GetCurrentProcessAddr(&#10;  DWORD    Processor,&#10;  ULONG64  CurrentThread,&#10;  PULONG64 Address&#10;);">GetCurrentProcessAddr</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_GET_TYPE_SIZE</td>
  <td><strong><a href="gettypesize" title="ULONG GetTypeSize(&#10;  [in] IN LPCSTR Type&#10;);">GetTypeSize</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_GET_CURRENT_PROCESS_HANDLE</td>
  <td><strong><a href="getcurrentprocesshandle" title="VOID GetCurrentProcessHandle(&#10;  PHANDLE hp&#10;);">GetCurrentProcessHandle</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_GET_INPUT_LINE</td>
  <td><strong><a href="getinputline" title="ULONG GetInputLine(&#10;  PCSTR Prompt,&#10;  PSTR  Buffer,&#10;  ULONG BufferSize&#10;);">GetInputLine</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_GET_EXPRESSION_EX</td>
  <td><strong><a href="getexpressionex" title="BOOL GetExpressionEx(&#10;  PCSTR   Expression,&#10;  ULONG64 *Value,&#10;  PCSTR   *Remainder&#10;);">GetExpressionEx</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_TRANSLATE_VIRTUAL_TO_PHYSICAL</td>
  <td><strong><a href="translatevirtualtophysical" title="BOOL TranslateVirtualToPhysical(&#10;  ULONG64 Virtual,&#10;  ULONG64 *Physical&#10;);">TranslateVirtualToPhysical</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_GET_CACHE_SIZE</td>
  <td><strong><a href="getdebuggercachesize" title="BOOL GetDebuggerCacheSize(&#10;  [out] OUT PULONG64 CacheSize&#10;);">GetDebuggerCacheSize</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_READ_PHYSICAL_WITH_FLAGS</td>
  <td><strong><a href="readphysicalwithflags" title="VOID ReadPhysicalWithFlags(&#10;  ULONG64 address,&#10;  PVOID   buf,&#10;  ULONG   size,&#10;  ULONG   flags,&#10;  PULONG  sizer&#10;);">ReadPhysicalWithFlags</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_WRITE_PHYSICAL_WITH_FLAGS</td>
  <td><strong><a href="writephysicalwithflags" title="VOID WritePhysicalWithFlags(&#10;  ULONG64 address,&#10;  PVOID   buf,&#10;  ULONG   size,&#10;  ULONG   flags,&#10;  PULONG  sizew&#10;);">WritePhysicalWithFlags</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_POINTER_SEARCH_PHYSICAL</td>
  <td></td>
  <td><a href="pointer_search_physical" title="typedef struct _POINTER_SEARCH_PHYSICAL {&#10;  IN ULONG64   Offset;&#10;  IN ULONG64   Length;&#10;  IN ULONG64   PointerMin;&#10;  IN ULONG64   PointerMax;&#10;  IN ULONG     Flags;&#10;  OUT PULONG64 MatchOffsets;&#10;  IN ULONG     MatchOffsetsSize;&#10;  OUT ULONG    MatchOffsetsCount;&#10;} POINTER_SEARCH_PHYSICAL, *PPOINTER_SEARCH_PHYSICAL;">POINTER_SEARCH_PHYSICAL</a></td>
</tr>
<tr>
  <td>IG_GET_THREAD_OS_INFO</td>
  <td></td>
  <td><a href="wdbgexts_thread_os_info" title="typedef struct _WDBGEXTS_THREAD_OS_INFO {&#10;  ULONG   ThreadId;&#10;  ULONG   ExitStatus;&#10;  ULONG   PriorityClass;&#10;  ULONG   Priority;&#10;  ULONG64 CreateTime;&#10;  ULONG64 ExitTime;&#10;  ULONG64 KernelTime;&#10;  ULONG64 UserTime;&#10;  ULONG64 StartOffset;&#10;  ULONG64 Affinity;&#10;} WDBGEXTS_THREAD_OS_INFO, *PWDBGEXTS_THREAD_OS_INFO;">WDBGEXTS_THREAD_OS_INFO</a></td>
</tr>
<tr>
  <td>IG_GET_CLR_DATA_INTERFACE</td>
  <td></td>
  <td></td>
</tr>
<tr>
  <td>IG_GET_TEB_ADDRESS</td>
  <td><strong><a href="gettebaddress" title="VOID GetTebAddress(&#10;  PULONGLONG Address&#10;);">GetTebAddress</a></strong></td>
  <td></td>
</tr>
<tr>
  <td>IG_GET_PEB_ADDRESS</td>
  <td><strong><a href="getpebaddress" title="VOID GetPebAddress(&#10;  ULONG64    CurrentThread,&#10;  PULONGLONG Address&#10;);">GetPebAddress</a></strong></td>
  <td></td>
</tr>
</tbody>
</table>

<p>The IG_LOWMEM_CHECK <strong>Ioctl</strong> operation looks for memory corruption in the low 4 GB of memory.</p>

<p>This <strong>Ioctl</strong> operation does not take any parameters and the <em>lpvData</em> and <em>cbSizeOfContext</em> parameters should be set to <strong>NULL</strong> and zero respectively.</p>

<h3 id="return-value-2">Return Value</h3>

<p>If no corrupt memory was found, the return value is <strong>TRUE</strong>; otherwise, it is <strong>FALSE</strong>.</p>

<p>This operation is only available in kernel-mode debugging, and is only useful when the kernel was started using the <strong>/nolowmem</strong> option.</p>

<p>When the kernel is started with the <strong>/nolowmem</strong> option, the kernel, drivers, operating system, and applications are loaded in memory above 4 GB, while the low 4 GB of memory is filled with a unique pattern. The IG_LOWMEM_CHECK <strong>Ioctl</strong> operation checks this pattern for corruption.</p>

<p>This can be used to verify that a driver works correctly when using physical addresses greater than 32 bits in length. See <em>Physical Address Extension (PAE)</em>, <strong>/pae</strong>, and <strong>/nolowmem</strong> in the Windows Driver Kit.</p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdbgexts/nc-wdbgexts-pwindbg_ioctl_routine">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdbgexts/nc-wdbgexts-pwindbg_ioctl_routine.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
