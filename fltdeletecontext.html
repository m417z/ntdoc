<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FltDeleteContext - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FltDeleteContext - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FltDeleteContext - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// fltkernel.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">VOID FLTAPI FltDeleteContext(
  [in] PFLT_CONTEXT Context
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fltkernel/nf-fltkernel-fltdeletecontext">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/fltdeletecontext.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-fltkernel-fltdeletecontext)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="fltdeletecontext-function">FltDeleteContext function</h1>

<h2 id="description">Description</h2>

<p><strong>FltDeleteContext</strong> marks a specified context for deletion.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="context-in"><code>Context</code> [in]</h3>

<p>A pointer to the context to delete. This parameter is required and cannot be <strong>NULL</strong>.</p>

<h2 id="return-value">Return value</h2>

<p>None.</p>

<h2 id="remarks">Remarks</h2>

<p>For more information about contexts, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ifs/managing-contexts-in-a-minifilter-driver">About minifilter contexts</a>.</p>

<p>Because contexts are reference-counted, it is not usually necessary for a minifilter driver to call a routine, such as <strong>FltDeleteContext</strong>, to explicitly delete a context.</p>

<p><strong>FltDeleteContext</strong> marks a context for deletion. The context is usually freed as soon as the current reference on it is released, unless there is an outstanding reference on it (for example, because the context is still being used by another thread).</p>

<p>You should consider the following items when you use <strong>FltDeleteContext</strong>:</p>

<ul>
<li><p>When a minifilter driver calls <strong>FltDeleteContext</strong>, the minifilter driver must already have a reference to the context. However, when the minifilter driver calls <a href="fltdeletestreamhandlecontext" title="NTSTATUS FLTAPI FltDeleteStreamHandleContext(&#10;  [in]  PFLT_INSTANCE Instance,&#10;  [in]  PFILE_OBJECT  FileObject,&#10;  [out] PFLT_CONTEXT  *OldContext&#10;);">FltDeleteStreamHandleContext</a>, <a href="fltdeletestreamcontext" title="NTSTATUS FLTAPI FltDeleteStreamContext(&#10;  [in]  PFLT_INSTANCE Instance,&#10;  [in]  PFILE_OBJECT  FileObject,&#10;  [out] PFLT_CONTEXT  *OldContext&#10;);">FltDeleteStreamContext</a>, <a href="fltdeleteinstancecontext" title="NTSTATUS FLTAPI FltDeleteInstanceContext(&#10;  [in]  PFLT_INSTANCE Instance,&#10;  [out] PFLT_CONTEXT  *OldContext&#10;);">FltDeleteInstanceContext</a>, and so on, the minifilter driver does not require a reference to the context. After the minifilter driver calls <strong>FltDeleteContext</strong>, that reference to the context is still valid. The minifilter driver must call the <a href="fltreleasecontext" title="VOID FLTAPI FltReleaseContext(&#10;  [in] PFLT_CONTEXT Context&#10;);">FltReleaseContext</a> routine to release the reference to the context.</p></li>
<li><p><strong>FltDeleteContext</strong> removes the context from the internal filter manager structures. Then, further calls to functions that get contexts, such as <strong><a href="fltgetcontexts" title="VOID FLTAPI FltGetContexts(&#10;  PCFLT_RELATED_OBJECTS FltObjects,&#10;  FLT_CONTEXT_TYPE      DesiredContexts,&#10;  PFLT_RELATED_CONTEXTS Contexts&#10;);">FltGetContexts</a></strong> and <strong><a href="fltgetinstancecontext" title="NTSTATUS FLTAPI FltGetInstanceContext(&#10;  [in]  PFLT_INSTANCE Instance,&#10;  [out] PFLT_CONTEXT  *Context&#10;);">FltGetInstanceContext</a></strong>, cannot locate that context. However, the context memory is not released until the reference count for the context goes to 0.</p></li>
</ul>

<p>Contexts can also be deleted by calling the appropriate delete-context routine from the following table.</p>

<table>
<thead>
<tr>
  <th>Context Type</th>
  <th>Delete-Context Routine</th>
</tr>
</thead>
<tbody>
<tr>
  <td>FLT_FILE_CONTEXT</td>
  <td><a href="fltdeletefilecontext" title="NTSTATUS FLTAPI FltDeleteFileContext(&#10;  [in]  PFLT_INSTANCE Instance,&#10;  [in]  PFILE_OBJECT  FileObject,&#10;  [out] PFLT_CONTEXT  *OldContext&#10;);">FltDeleteFileContext</a> (Windows Vista and later only.)</td>
</tr>
<tr>
  <td>FLT_INSTANCE_CONTEXT</td>
  <td><a href="fltdeleteinstancecontext" title="NTSTATUS FLTAPI FltDeleteInstanceContext(&#10;  [in]  PFLT_INSTANCE Instance,&#10;  [out] PFLT_CONTEXT  *OldContext&#10;);">FltDeleteInstanceContext</a></td>
</tr>
<tr>
  <td>FLT_SECTION_CONTEXT</td>
  <td><a href="fltclosesectionfordatascan" title="NTSTATUS FLTAPI FltCloseSectionForDataScan(&#10;  [in] PFLT_CONTEXT SectionContext&#10;);">FltCloseSectionForDataScan</a> (Windows 8 and later only.)</td>
</tr>
<tr>
  <td>FLT_STREAM_CONTEXT</td>
  <td><a href="fltdeletestreamcontext" title="NTSTATUS FLTAPI FltDeleteStreamContext(&#10;  [in]  PFLT_INSTANCE Instance,&#10;  [in]  PFILE_OBJECT  FileObject,&#10;  [out] PFLT_CONTEXT  *OldContext&#10;);">FltDeleteStreamContext</a></td>
</tr>
<tr>
  <td>FLT_STREAMHANDLE_CONTEXT</td>
  <td><a href="fltdeletestreamhandlecontext" title="NTSTATUS FLTAPI FltDeleteStreamHandleContext(&#10;  [in]  PFLT_INSTANCE Instance,&#10;  [in]  PFILE_OBJECT  FileObject,&#10;  [out] PFLT_CONTEXT  *OldContext&#10;);">FltDeleteStreamHandleContext</a></td>
</tr>
<tr>
  <td>FLT_TRANSACTION_CONTEXT</td>
  <td><a href="fltdeletetransactioncontext" title="NTSTATUS FLTAPI FltDeleteTransactionContext(&#10;  [in]            PFLT_INSTANCE Instance,&#10;  [in]            PKTRANSACTION Transaction,&#10;  [out, optional] PFLT_CONTEXT  *OldContext&#10;);">FltDeleteTransactionContext</a> (Windows Vista and later only.)</td>
</tr>
<tr>
  <td>FLT_VOLUME_CONTEXT</td>
  <td><a href="fltdeletevolumecontext" title="NTSTATUS FLTAPI FltDeleteVolumeContext(&#10;  [in]            PFLT_FILTER  Filter,&#10;  [in]            PFLT_VOLUME  Volume,&#10;  [out, optional] PFLT_CONTEXT *OldContext&#10;);">FltDeleteVolumeContext</a></td>
</tr>
</tbody>
</table>

<p>To allocate a new context, call <a href="fltallocatecontext" title="NTSTATUS FLTAPI FltAllocateContext(&#10;  [in]  PFLT_FILTER      Filter,&#10;  [in]  FLT_CONTEXT_TYPE ContextType,&#10;  [in]  SIZE_T           ContextSize,&#10;  [in]  POOL_TYPE        PoolType,&#10;  [out] PFLT_CONTEXT     *ReturnedContext&#10;);">FltAllocateContext</a>.</p>

<p>To increment the reference count on a context, call <a href="fltreferencecontext" title="VOID FLTAPI FltReferenceContext(&#10;  [in] PFLT_CONTEXT Context&#10;);">FltReferenceContext</a>.</p>

<p>To decrement the reference count on a context, call <a href="fltreleasecontext" title="VOID FLTAPI FltReleaseContext(&#10;  [in] PFLT_CONTEXT Context&#10;);">FltReleaseContext</a>.</p>

<p>A section context, FLT_SECTION_CONTEXT type, must not be deleted using <strong>FltDeleteContext</strong>. Instead, use <a href="fltreleasecontext" title="VOID FLTAPI FltReleaseContext(&#10;  [in] PFLT_CONTEXT Context&#10;);">FltReleaseContext</a> to deallocate a section context.</p>

<h2 id="see-also">See also</h2>

<p><a href="fltallocatecontext" title="NTSTATUS FLTAPI FltAllocateContext(&#10;  [in]  PFLT_FILTER      Filter,&#10;  [in]  FLT_CONTEXT_TYPE ContextType,&#10;  [in]  SIZE_T           ContextSize,&#10;  [in]  POOL_TYPE        PoolType,&#10;  [out] PFLT_CONTEXT     *ReturnedContext&#10;);">FltAllocateContext</a></p>

<p><a href="fltclosesectionfordatascan" title="NTSTATUS FLTAPI FltCloseSectionForDataScan(&#10;  [in] PFLT_CONTEXT SectionContext&#10;);">FltCloseSectionForDataScan</a></p>

<p><a href="fltdeletefilecontext" title="NTSTATUS FLTAPI FltDeleteFileContext(&#10;  [in]  PFLT_INSTANCE Instance,&#10;  [in]  PFILE_OBJECT  FileObject,&#10;  [out] PFLT_CONTEXT  *OldContext&#10;);">FltDeleteFileContext</a></p>

<p><a href="fltdeleteinstancecontext" title="NTSTATUS FLTAPI FltDeleteInstanceContext(&#10;  [in]  PFLT_INSTANCE Instance,&#10;  [out] PFLT_CONTEXT  *OldContext&#10;);">FltDeleteInstanceContext</a></p>

<p><a href="fltdeletestreamcontext" title="NTSTATUS FLTAPI FltDeleteStreamContext(&#10;  [in]  PFLT_INSTANCE Instance,&#10;  [in]  PFILE_OBJECT  FileObject,&#10;  [out] PFLT_CONTEXT  *OldContext&#10;);">FltDeleteStreamContext</a></p>

<p><a href="fltdeletestreamhandlecontext" title="NTSTATUS FLTAPI FltDeleteStreamHandleContext(&#10;  [in]  PFLT_INSTANCE Instance,&#10;  [in]  PFILE_OBJECT  FileObject,&#10;  [out] PFLT_CONTEXT  *OldContext&#10;);">FltDeleteStreamHandleContext</a></p>

<p><a href="fltdeletetransactioncontext" title="NTSTATUS FLTAPI FltDeleteTransactionContext(&#10;  [in]            PFLT_INSTANCE Instance,&#10;  [in]            PKTRANSACTION Transaction,&#10;  [out, optional] PFLT_CONTEXT  *OldContext&#10;);">FltDeleteTransactionContext</a></p>

<p><a href="fltdeletevolumecontext" title="NTSTATUS FLTAPI FltDeleteVolumeContext(&#10;  [in]            PFLT_FILTER  Filter,&#10;  [in]            PFLT_VOLUME  Volume,&#10;  [out, optional] PFLT_CONTEXT *OldContext&#10;);">FltDeleteVolumeContext</a></p>

<p><a href="fltreferencecontext" title="VOID FLTAPI FltReferenceContext(&#10;  [in] PFLT_CONTEXT Context&#10;);">FltReferenceContext</a></p>

<p><a href="fltreleasecontext" title="VOID FLTAPI FltReleaseContext(&#10;  [in] PFLT_CONTEXT Context&#10;);">FltReleaseContext</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fltkernel/nf-fltkernel-fltdeletecontext">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/fltkernel/nf-fltkernel-fltdeletecontext.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
