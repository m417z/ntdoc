<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="MINIPORT_CO_ACTIVATE_VC - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>MINIPORT_CO_ACTIVATE_VC - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github.ntdoc.min.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github-dark-dimmed.ntdoc.min.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            MINIPORT_CO_ACTIVATE_VC - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header language-cpp">// ndis.h

</span><span class="ntdoc-code-intro language-cpp"></span><span class="ntdoc-code-body language-cpp">MINIPORT_CO_ACTIVATE_VC MiniportCoActivateVc;

NDIS_STATUS MiniportCoActivateVc(
  [in]      NDIS_HANDLE MiniportVcContext,
  [in, out] PCO_CALL_PARAMETERS CallParameters
)
{...}</span><span class="ntdoc-code-footer language-cpp"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-miniport_co_activate_vc">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/miniport_co_activate_vc.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-ndis-miniport_co_activate_vc)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>MINIPORT_CO_ACTIVATE_VC callback function</h1>
<h2>Description</h2>
<p>The
<strong>MiniportCoActivateVc</strong> function is required for connection-oriented miniports.
<strong>MiniportCoActivateVc</strong> is called by NDIS to indicate to the miniport driver that a
virtual connection is being activated.</p>
<p><strong>Note</strong> You must declare the function by using the <strong>MINIPORT_CO_ACTIVATE_VC</strong> type. For more
information, see the following Examples section.</p>
<h2>Parameters</h2>
<h3><code>MiniportVcContext</code> [in]</h3>
<p>Specifies the handle to a miniport driver-allocated context area in which the miniport driver
maintains its per-VC state. The miniport driver supplied this handle to NDIS from its
<strong>MiniportCoCreateVc</strong> function.</p>
<h3><code>CallParameters</code> [in, out]</h3>
<p>Specifies the call parameters, as specified by the call manager, to be established for this VC. On
output, the miniport driver returns altered call parameters if certain flags are set in the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/hardware/network/ff545384(v=vs.85)">CO_CALL_PARAMETERS</a> structure.</p>
<h2>Return value</h2>
<table>
<thead>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>NDIS_STATUS_SUCCESS</strong></td>
<td>Indicates that the VC was activated successfully.</td>
</tr>
<tr>
<td><strong>NDIS_STATUS_PENDING</strong></td>
<td>Indicates that the miniport driver will complete the request to activate a VC asynchronously. When the miniport driver has finished with its operations, it must call <a href="ndismcoactivatevccomplete" title="VOID NdisMCoActivateVcComplete(&#10;  [in] NDIS_STATUS         Status,&#10;  [in] NDIS_HANDLE         NdisVcHandle,&#10;  [in] PCO_CALL_PARAMETERS CallParameters&#10;);">NdisMCoActivateVcComplete</a>.</td>
</tr>
<tr>
<td><strong>NDIS_STATUS_INVALID_DATA</strong></td>
<td>Indicates that the call parameters specified at <strong>CallParameters</strong> are invalid or illegal for the media type that this miniport driver supports.</td>
</tr>
<tr>
<td><strong>NDIS_STATUS_RESOURCES</strong></td>
<td>Indicates that the miniport driver could not activate the VC because it could not allocate all of the required resources that the miniport driver needs to maintain state information about the active VC.</td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>The miniport driver must validate the call parameters for this VC, as specified in
<strong>CallParameters</strong>, to verify that the adapter can support the requested call. If
the requested call parameters cannot be satisfied, the miniport driver should fail the request with
NDIS_STATUS_INVALID_DATA.</p>
<p><strong>MiniportCoActivateVc</strong> can be called many times for a single VC in order to
change the call parameters for an already active call. At every call, the miniport driver should validate
the parameters and perform any processing as required by its adapter in order to satisfy the request.
However, if it cannot set the given call parameters,
<strong>MiniportCoActivateVc</strong> must leave the VC in a usable state, because the
connection-oriented client or a call manager can continue to send or receive data using the older call
parameters.</p>
<p>If the ROUND_UP_FLOW or ROUND_DOWN_FLOW flags are set in the call parameters structure at
<strong>CallParameters-&gt;MediaParameters-&gt;Flags</strong>, the miniport driver has been
requested to return the actual flow rate of the VC after the flow rate has been rounded according to the
appropriate flag that has been set. If the miniport driver does change any of the call parameters because
these flags have been set, it must return the actual call parameters in use for the VC at
<strong>CallParameters</strong>.</p>
<p>If the call parameters are acceptable,
<strong>MiniportCoActivateVc</strong> communicates with its adapter as necessary to prepare the
adapter to receive or transmit data across the virtual connection (in other words, programming receive
buffers).</p>
<h3>Examples</h3>
<p>To define a <strong>MiniportCoActivateVc</strong> function, you must first provide a function declaration that identifies the type of function you're defining. Windows provides a set of function types for drivers. Declaring a function using the function types helps <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/code-analysis-for-drivers">Code Analysis for Drivers</a>, <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/static-driver-verifier">Static Driver Verifier</a> (SDV), and other verification tools find errors, and it's a requirement for writing drivers for the Windows operating system.</p>
<p>For example, to define a <strong>MiniportCoActivateVc</strong> function that is named &quot;MyCoActivateVc&quot;, use the <strong>MINIPORT_CO_ACTIVATE_VC</strong> type as shown in this code example:</p>
<pre><code>MINIPORT_CO_ACTIVATE_VC MyCoActivateVc;
</code></pre>
<p>Then, implement your function as follows:</p>
<pre><code>_Use_decl_annotations_
NDIS_STATUS
 MyCoActivateVc(
    NDIS_HANDLE  MiniportVcContext,
    PCO_CALL_PARAMETERS  CallParameters
    )
  {...}
</code></pre>
<p>The <strong>MINIPORT_CO_ACTIVATE_VC</strong> function type is defined in the Ndis.h header file. To more accurately identify errors when you run the code analysis tools, be sure to add the <em>Use_decl_annotations</em> annotation to your function definition. The <em>Use_decl_annotations</em> annotation ensures that the annotations that are applied to the <strong>MINIPORT_CO_ACTIVATE_VC</strong> function type in the header file are used. For more information about the requirements for function declarations, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/declaring-functions-by-using-function-role-types-for-ndis-drivers">Declaring Functions by Using Function Role Types for NDIS Drivers</a>.</p>
<p>For information about <em>Use_decl_annotations</em>, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/visualstudio/code-quality/annotating-function-behavior">Annotating Function Behavior</a>.</p>
<h2>See also</h2>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-miniport_co_create_vc">MiniportCoCreateVc</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-miniport_co_deactivate_vc">MiniportCoDeactivateVc</a></p>
<p><a href="ndismcoactivatevccomplete" title="VOID NdisMCoActivateVcComplete(&#10;  [in] NDIS_STATUS         Status,&#10;  [in] NDIS_HANDLE         NdisVcHandle,&#10;  [in] PCO_CALL_PARAMETERS CallParameters&#10;);">NdisMCoActivateVcComplete</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-miniport_co_activate_vc">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ndis/nc-ndis-miniport_co_activate_vc.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script src="modules/highlight.js/highlight.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
