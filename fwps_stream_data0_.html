<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FWPS_STREAM_DATA0_ - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FWPS_STREAM_DATA0_ - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FWPS_STREAM_DATA0_ - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// fwpsk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct FWPS_STREAM_DATA0_ {
  <a href="uint32" title="typedef unsigned int UINT32;">UINT32</a>                   flags;
  <a href="fwps_stream_data_offset0_" title="typedef struct FWPS_STREAM_DATA_OFFSET0_ {&#10;  NET_BUFFER_LIST *netBufferList;&#10;  NET_BUFFER      *netBuffer;&#10;  MDL             *mdl;&#10;  UINT32          mdlOffset;&#10;  UINT32          netBufferOffset;&#10;  SIZE_T          streamDataOffset;&#10;} FWPS_STREAM_DATA_OFFSET0;">FWPS_STREAM_DATA_OFFSET0</a> dataOffset;
  <a href="size_t-2" title="typedef ULONG_PTR SIZE_T;">SIZE_T</a>                   dataLength;
  <a href="net_buffer_list" title="typedef struct _NET_BUFFER_LIST {&#10;  union {&#10;    struct {&#10;      NET_BUFFER_LIST *Next;&#10;      NET_BUFFER      *FirstNetBuffer;&#10;    };&#10;    SLIST_HEADER           Link;&#10;    NET_BUFFER_LIST_HEADER NetBufferListHeader;&#10;  };&#10;  NET_BUFFER_LIST_CONTEXT *Context;&#10;  NET_BUFFER_LIST         *ParentNetBufferList;&#10;  NDIS_HANDLE             NdisPoolHandle;&#10;  PVOID                   NdisReserved[2];&#10;  PVOID                   ProtocolReserved[4];&#10;  PVOID                   MiniportReserved[2];&#10;  PVOID                   Scratch;&#10;  NDIS_HANDLE             SourceHandle;&#10;  ULONG                   NblFlags;&#10;  LONG                    ChildRefCount;&#10;  ULONG                   Flags;&#10;...">NET_BUFFER_LIST</a>          *netBufferListChain;
} FWPS_STREAM_DATA0;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/ns-fwpsk-fwps_stream_data0_">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/fwps_stream_data0_.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-fwpsk-fwps_stream_data0_)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>FWPS_STREAM_DATA0_ structure</h1>
<h2>Description</h2>
<p>The <strong>FWPS_STREAM_DATA0</strong> structure describes a portion of a data stream.</p>
<p><strong>Note</strong> <strong>FWPS_STREAM_DATA0</strong> is a specific version of <strong>FWPS_STREAM_DATA</strong>. See <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/FWP/wfp-version-independent-names-and-targeting-specific-versions-of-windows">WFP Version-Independent Names and Targeting Specific Versions of Windows</a> for more information.</p>
<h2>Members</h2>
<h3><code>flags</code></h3>
<p>A variable containing flags that specify the characteristics of the data stream.</p>
<p>For inbound data streams, this can be one or more of the following flags:</p>
<h4>FWPS_STREAM_FLAG_RECEIVE</h4>
<p>Specifies that the stream is an inbound data stream. This flag is always set for inbound data
streams.</p>
<h4>FWPS_STREAM_FLAG_RECEIVE_EXPEDITED</h4>
<p>Specifies that the inbound data stream contains high-priority out-of-band data.</p>
<h4>FWPS_STREAM_FLAG_RECEIVE_DISCONNECT</h4>
<p>Specifies that the inbound data has arrived with the FIN flag set in the TCP header. This
indicates that the sender has disconnected the stream.</p>
<h4>FWPS_STREAM_FLAG_RECEIVE_ABORT</h4>
<p>Specifies that the inbound data has arrived with the RST flag set in the TCP header. This
indicates that the sender has reset the stream.</p>
<p><strong>Note</strong> This flag is not implemented in Windows Vista.</p>
<p>For outbound data streams, this can be one or more of the following flags:</p>
<h4>FWPS_STREAM_FLAG_SEND</h4>
<p>Specifies that the stream is an outbound data stream. This flag is always set for outbound data
streams.</p>
<h4>FWPS_STREAM_FLAG_SEND_EXPEDITED</h4>
<p>Specifies that the outbound data stream contains high-priority out-of-band data.</p>
<h4>FWPS_STREAM_FLAG_SEND_NODELAY</h4>
<p>Specifies that the sending client requests that the outbound data stream is not to be buffered.
If this flag is set, a callout driver should not hold onto the stream buffer any longer than
necessary.</p>
<h4>FWPS_STREAM_FLAG_SEND_DISCONNECT</h4>
<p>Specifies that the stream is to be disconnected after the data in the outbound data stream has
been sent. The network stack will set the FIN flag in the TCP header of the last packet that is sent
out.</p>
<h4>FWPS_STREAM_FLAG_SEND_ABORT</h4>
<p>Specifies that the stream is to be reset after the data in the outbound data stream has been
sent. The network stack will set the RST flag in the TCP header of the last packet that is sent out.
Callout drivers must not call the
<a href="fwpsstreaminjectasync0" title="NTSTATUS FwpsStreamInjectAsync0(&#10;  [in]           HANDLE                injectionHandle,&#10;  [in, optional] HANDLE                injectionContext,&#10;  [in]           UINT32                flags,&#10;  [in]           UINT64                flowId,&#10;  [in]           UINT32                calloutId,&#10;  [in]           UINT16                layerId,&#10;  [in]           UINT32                streamFlags,&#10;  [in, out]      NET_BUFFER_LIST       *netBufferList,&#10;  [in]           SIZE_T                dataLength,&#10;  [in]           FWPS_INJECT_COMPLETE0 completionFn,&#10;  [in, optional] HANDLE                completionContext&#10;);">FwpsStreamInjectAsync0</a> function
to inject data into the stream if this flag is set.</p>
<p><strong>Note</strong> This flag is not implemented in Windows Vista.</p>
<h3><code>dataOffset</code></h3>
<p>An
<a href="fwps_stream_data_offset0_" title="typedef struct FWPS_STREAM_DATA_OFFSET0_ {&#10;  NET_BUFFER_LIST *netBufferList;&#10;  NET_BUFFER      *netBuffer;&#10;  MDL             *mdl;&#10;  UINT32          mdlOffset;&#10;  UINT32          netBufferOffset;&#10;  SIZE_T          streamDataOffset;&#10;} FWPS_STREAM_DATA_OFFSET0;">FWPS_STREAM_DATA_OFFSET0</a> structure
that specifies the offset into the data stream where the portion of the data stream begins.</p>
<h3><code>dataLength</code></h3>
<p>The number of bytes in the portion of the data stream.</p>
<h3><code>netBufferListChain</code></h3>
<p>A pointer to a
<a href="net_buffer_list" title="typedef struct _NET_BUFFER_LIST {&#10;  union {&#10;    struct {&#10;      NET_BUFFER_LIST *Next;&#10;      NET_BUFFER      *FirstNetBuffer;&#10;    };&#10;    SLIST_HEADER           Link;&#10;    NET_BUFFER_LIST_HEADER NetBufferListHeader;&#10;  };&#10;  NET_BUFFER_LIST_CONTEXT *Context;&#10;  NET_BUFFER_LIST         *ParentNetBufferList;&#10;  NDIS_HANDLE             NdisPoolHandle;&#10;  PVOID                   NdisReserved[2];&#10;  PVOID                   ProtocolReserved[4];&#10;  PVOID                   MiniportReserved[2];&#10;  PVOID                   Scratch;&#10;  NDIS_HANDLE             SourceHandle;&#10;  ULONG                   NblFlags;&#10;  LONG                    ChildRefCount;&#10;  ULONG                   Flags;&#10;...">NET_BUFFER_LIST</a> structure that describes
the portion of the data stream.</p>
<h2>Remarks</h2>
<p>The filter engine uses the FWPS_STREAM_DATA0 structure to describe the portion of a data stream that a
callout's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_netvista/">classifyFn</a> callout function can process. The
<strong>dataStream</strong> member of the
<a href="fwps_stream_callout_io_packet0_" title="typedef struct FWPS_STREAM_CALLOUT_IO_PACKET0_ {&#10;  FWPS_STREAM_DATA0       *streamData;&#10;  SIZE_T                  missedBytes;&#10;  UINT32                  countBytesRequired;&#10;  SIZE_T                  countBytesEnforced;&#10;  FWPS_STREAM_ACTION_TYPE streamAction;&#10;} FWPS_STREAM_CALLOUT_IO_PACKET0;">FWPS_STREAM_CALLOUT_IO_PACKET0</a> structure points to an FWPS_STREAM_DATA0 structure.</p>
<h2>See also</h2>
<p><a href="fwps_stream_callout_io_packet0_" title="typedef struct FWPS_STREAM_CALLOUT_IO_PACKET0_ {&#10;  FWPS_STREAM_DATA0       *streamData;&#10;  SIZE_T                  missedBytes;&#10;  UINT32                  countBytesRequired;&#10;  SIZE_T                  countBytesEnforced;&#10;  FWPS_STREAM_ACTION_TYPE streamAction;&#10;} FWPS_STREAM_CALLOUT_IO_PACKET0;">FWPS_STREAM_CALLOUT_IO_PACKET0</a></p>
<p><a href="fwps_stream_data_offset0_" title="typedef struct FWPS_STREAM_DATA_OFFSET0_ {&#10;  NET_BUFFER_LIST *netBufferList;&#10;  NET_BUFFER      *netBuffer;&#10;  MDL             *mdl;&#10;  UINT32          mdlOffset;&#10;  UINT32          netBufferOffset;&#10;  SIZE_T          streamDataOffset;&#10;} FWPS_STREAM_DATA_OFFSET0;">FWPS_STREAM_DATA_OFFSET0</a></p>
<p><a href="fwpsstreaminjectasync0" title="NTSTATUS FwpsStreamInjectAsync0(&#10;  [in]           HANDLE                injectionHandle,&#10;  [in, optional] HANDLE                injectionContext,&#10;  [in]           UINT32                flags,&#10;  [in]           UINT64                flowId,&#10;  [in]           UINT32                calloutId,&#10;  [in]           UINT16                layerId,&#10;  [in]           UINT32                streamFlags,&#10;  [in, out]      NET_BUFFER_LIST       *netBufferList,&#10;  [in]           SIZE_T                dataLength,&#10;  [in]           FWPS_INJECT_COMPLETE0 completionFn,&#10;  [in, optional] HANDLE                completionContext&#10;);">FwpsStreamInjectAsync0</a></p>
<p><a href="net_buffer_list" title="typedef struct _NET_BUFFER_LIST {&#10;  union {&#10;    struct {&#10;      NET_BUFFER_LIST *Next;&#10;      NET_BUFFER      *FirstNetBuffer;&#10;    };&#10;    SLIST_HEADER           Link;&#10;    NET_BUFFER_LIST_HEADER NetBufferListHeader;&#10;  };&#10;  NET_BUFFER_LIST_CONTEXT *Context;&#10;  NET_BUFFER_LIST         *ParentNetBufferList;&#10;  NDIS_HANDLE             NdisPoolHandle;&#10;  PVOID                   NdisReserved[2];&#10;  PVOID                   ProtocolReserved[4];&#10;  PVOID                   MiniportReserved[2];&#10;  PVOID                   Scratch;&#10;  NDIS_HANDLE             SourceHandle;&#10;  ULONG                   NblFlags;&#10;  LONG                    ChildRefCount;&#10;  ULONG                   Flags;&#10;...">NET_BUFFER_LIST</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_netvista/">classifyFn</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/ns-fwpsk-fwps_stream_data0_">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/fwpsk/ns-fwpsk-fwps_stream_data0_.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
