<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PO_FX_DEVICE_V2 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PO_FX_DEVICE_V2 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github.ntdoc.min.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github-dark-dimmed.ntdoc.min.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PO_FX_DEVICE_V2 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _PO_FX_DEVICE_V2 {
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                                      Version;
  <a href="ulonglong" title="typedef unsigned __int64 ULONGLONG;">ULONGLONG</a>                                  Flags;
  PPO_FX_COMPONENT_ACTIVE_CONDITION_CALLBACK ComponentActiveConditionCallback;
  PPO_FX_COMPONENT_IDLE_CONDITION_CALLBACK   ComponentIdleConditionCallback;
  PPO_FX_COMPONENT_IDLE_STATE_CALLBACK       ComponentIdleStateCallback;
  PPO_FX_DEVICE_POWER_REQUIRED_CALLBACK      DevicePowerRequiredCallback;
  PPO_FX_DEVICE_POWER_NOT_REQUIRED_CALLBACK  DevicePowerNotRequiredCallback;
  PPO_FX_POWER_CONTROL_CALLBACK              PowerControlCallback;
  PVOID                                      DeviceContext;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                                      ComponentCount;
  <a href="po_fx_component_v2" title="typedef struct _PO_FX_COMPONENT_V2 {&#10;  GUID                        Id;&#10;  ULONGLONG                   Flags;&#10;  ULONG                       DeepestWakeableIdleState;&#10;  ULONG                       IdleStateCount;&#10;  PPO_FX_COMPONENT_IDLE_STATE IdleStates;&#10;  ULONG                       ProviderCount;&#10;  PULONG                      Providers;&#10;} PO_FX_COMPONENT_V2, *PPO_FX_COMPONENT_V2;">PO_FX_COMPONENT_V2</a>                         Components[ANYSIZE_ARRAY];
} PO_FX_DEVICE_V2, *PPO_FX_DEVICE_V2;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_po_fx_device_v2">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/po_fx_device_v2.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-wdm-_po_fx_device_v2)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>_PO_FX_DEVICE_V2 structure</h1>
<h2>Description</h2>
<p>The <strong>PO_FX_DEVICE</strong> structure describes the power attributes of a device to the power management framework (PoFx).</p>
<h2>Members</h2>
<h3><code>Version</code></h3>
<p>The version number of this structure. If the driver will register for performance state support with PoFx, set this member to <strong>PO_FX_VERSION_V2</strong>. Otherwise, set this member to <strong>PO_FX_VERSION_V1</strong>.</p>
<h3><code>Flags</code></h3>
<p>Set to 0. Currently, no flags are defined for this member.</p>
<h3><code>ComponentActiveConditionCallback</code></h3>
<p>A pointer to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_active_condition_callback">ComponentActiveConditionCallback</a> callback routine that is implemented by the device driver.</p>
<h3><code>ComponentIdleConditionCallback</code></h3>
<p>A pointer to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_idle_condition_callback">ComponentIdleConditionCallback</a> callback routine that is implemented by the device driver.</p>
<h3><code>ComponentIdleStateCallback</code></h3>
<p>A pointer to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_idle_state_callback">ComponentIdleStateCallback</a> callback routine that is implemented by the device driver.</p>
<h3><code>DevicePowerRequiredCallback</code></h3>
<p>A pointer to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_device_power_required_callback">DevicePowerRequiredCallback</a> callback routine that is implemented by the device driver.</p>
<h3><code>DevicePowerNotRequiredCallback</code></h3>
<p>A pointer to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_device_power_not_required_callback">DevicePowerNotRequiredCallback</a> callback routine that is implemented by the device driver.</p>
<h3><code>PowerControlCallback</code></h3>
<p>A pointer to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_power_control_callback">PowerControlCallback</a> callback routine that is implemented by the device driver.</p>
<h3><code>DeviceContext</code></h3>
<p>A pointer to a caller-allocated device context. This pointer is passed as a parameter to each driver-implemented callback function that is pointed to by this structure. The device driver uses this context to store information about the current power state of the device. This context is opaque to PoFx.</p>
<h3><code>ComponentCount</code></h3>
<p>The number of elements in the <strong>Components</strong> array. Additionally, this member specifies the number of components in the device.</p>
<h3><code>Components</code></h3>
<p>This member is the first element in an array of one or more <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_po_fx_component_v1">PO_FX_COMPONENT</a> elements. If the array contains more than one element, the additional elements immediately follow the <strong>PO_FX_DEVICE</strong> structure. The array contains one element for each component in the device. The Fx power state of each component can be controlled independently of the Fx power states of the other components in the device. The <strong>ANYSIZE_ARRAY</strong> constant is defined to be 1 in the Ntdef.h header file.</p>
<h2>Remarks</h2>
<p>To register a device with PoFx, a driver calls the <a href="pofxregisterdevice" title="NTSTATUS PoFxRegisterDevice(&#10;  [in]  PDEVICE_OBJECT Pdo,&#10;  [in]  PPO_FX_DEVICE  Device,&#10;  [out] POHANDLE       *Handle&#10;);">PoFxRegisterDevice</a> routine and supplies, as a parameter, a pointer to a <strong>PO_FX_DEVICE</strong> structure that describes the device.</p>
<p>Each element in the <strong>Components</strong> array describes the power state attributes of one component in the device. Each component in the device is identified by its <strong>Components</strong> array index. Routines such as <a href="pofxactivatecomponent" title="VOID PoFxActivateComponent(&#10;  [in] POHANDLE Handle,&#10;  [in] ULONG    Component,&#10;  [in] ULONG    Flags&#10;);">PoFxActivateComponent</a> and <a href="pofxcompleteidlecondition" title="VOID PoFxCompleteIdleCondition(&#10;  [in] POHANDLE Handle,&#10;  [in] ULONG    Component&#10;);">PoFxCompleteIdleCondition</a> use the array index of a component to identify the component.</p>
<p>A device driver is not required to implement all six callback routines. The driver can set a function pointer in the <strong>PO_FX_DEVICE</strong> structure to NULL if the driver does not implement the corresponding callback routine. However, certain callback routines must be implemented. Specifically, if one or more components in a device has more than one Fx state, the driver must implement <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_idle_state_callback">ComponentIdleStateCallback</a>, <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_active_condition_callback">ComponentActiveConditionCallback</a>, and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_idle_condition_callback">ComponentIdleConditionCallback</a> routines. Otherwise, device registration fails and <a href="pofxregisterdevice" title="NTSTATUS PoFxRegisterDevice(&#10;  [in]  PDEVICE_OBJECT Pdo,&#10;  [in]  PPO_FX_DEVICE  Device,&#10;  [out] POHANDLE       *Handle&#10;);">PoFxRegisterDevice</a> returns <strong>STATUS_INVALID_PARAMETER</strong>.</p>
<h2>See also</h2>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_active_condition_callback">ComponentActiveConditionCallback</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_idle_condition_callback">ComponentIdleConditionCallback</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_idle_state_callback">ComponentIdleStateCallback</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_device_power_not_required_callback">DevicePowerNotRequiredCallback</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_device_power_required_callback">DevicePowerRequiredCallback</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_po_fx_component_v1">PO_FX_COMPONENT</a></p>
<p><a href="pofxactivatecomponent" title="VOID PoFxActivateComponent(&#10;  [in] POHANDLE Handle,&#10;  [in] ULONG    Component,&#10;  [in] ULONG    Flags&#10;);">PoFxActivateComponent</a></p>
<p><a href="pofxcompleteidlecondition" title="VOID PoFxCompleteIdleCondition(&#10;  [in] POHANDLE Handle,&#10;  [in] ULONG    Component&#10;);">PoFxCompleteIdleCondition</a></p>
<p><a href="pofxregisterdevice" title="NTSTATUS PoFxRegisterDevice(&#10;  [in]  PDEVICE_OBJECT Pdo,&#10;  [in]  PPO_FX_DEVICE  Device,&#10;  [out] POHANDLE       *Handle&#10;);">PoFxRegisterDevice</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_power_control_callback">PowerControlCallback</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_po_fx_device_v2">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/ns-wdm-_po_fx_device_v2.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script src="modules/highlight.js/highlight.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
