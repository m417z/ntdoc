<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NDIS_PD_QUEUE_PARAMETERS - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NDIS_PD_QUEUE_PARAMETERS - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NDIS_PD_QUEUE_PARAMETERS - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _NDIS_PD_QUEUE_PARAMETERS {
  <a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a>     Header;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                  Flags;
  <a href="ndis_pd_queue_type" title="typedef enum {&#10;  PDQueueTypeUnknown,&#10;  PDQueueTypeReceive,&#10;  PDQueueTypeTransmit,&#10;  PDQueueTypeMax&#10;} NDIS_PD_QUEUE_TYPE;">NDIS_PD_QUEUE_TYPE</a>     QueueType;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                  QueueSize;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                  ReceiveDataLength;
  <a href="group_affinity" title="typedef struct _GROUP_AFFINITY {&#10;  KAFFINITY Mask;&#10;  USHORT    Group;&#10;  USHORT    Reserved[3];&#10;} GROUP_AFFINITY, *PGROUP_AFFINITY;">GROUP_AFFINITY</a>         Affinity;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                  TrafficClassId;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                  MaximumPartialBufferCount;
  NDIS_PD_COUNTER_HANDLE CounterHandle;
} NDIS_PD_QUEUE_PARAMETERS;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/ns-ndis-_ndis_pd_queue_parameters">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndis_pd_queue_parameters.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ndis-_ndis_pd_queue_parameters)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>_NDIS_PD_QUEUE_PARAMETERS structure</h1>
<h2>Description</h2>
<p>This structure is used to hold parameters for a transmit or receive queue when calling any of the queue routines.</p>
<h2>Members</h2>
<h3><code>Header</code></h3>
<p>The <a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a> structure for the <a href="ndis_pd_config" title="typedef struct _NDIS_PD_CONFIG {&#10;  NDIS_OBJECT_HEADER Header;&#10;  ULONG              Flags;&#10;  BOOLEAN            Enabled;&#10;  ULONG              CapabilitiesOffset;&#10;  ULONG              CapabilitiesSize;&#10;} NDIS_PD_CONFIG;">NDIS_PD_CONFIG</a> structure. Set the members of this structure as follows:</p>
<ul>
<li><strong>Type</strong> = <strong>NDIS_OBJECT_TYPE_DEFAULT</strong></li>
<li><strong>Revision</strong> = <strong>NDIS_PD_QUEUE_PARAMETERS_REVISION_1</strong></li>
<li><strong>Size</strong> = <strong>NDIS_SIZEOF_PD_QUEUE_PARAMETERS_REVISION_1</strong></li>
</ul>
<h3><code>Flags</code></h3>
<p>This member is reserved and must be set to 0 by the provider.</p>
<h3><code>QueueType</code></h3>
<p>The type of the queue. For more information see, <a href="ndis_pd_queue_type" title="typedef enum {&#10;  PDQueueTypeUnknown,&#10;  PDQueueTypeReceive,&#10;  PDQueueTypeTransmit,&#10;  PDQueueTypeMax&#10;} NDIS_PD_QUEUE_TYPE;">NDIS_PD_QUEUE_TYPE</a>.</p>
<h3><code>QueueSize</code></h3>
<p>The maximum amount of <a href="pd_buffer" title="typedef struct _PD_BUFFER {&#10;  struct _PD_BUFFER   *NextPDBuffer;&#10;  struct _PD_BUFFER   *NextPartialPDBuffer;&#10;  PVOID               PDClientReserved;&#10;  PVOID               PDClientContext;&#10;  PUCHAR              DataBufferVirtualAddress;&#10;  DMA_LOGICAL_ADDRESS DataBufferDmaLogicalAddress;&#10;  ULONG               DataBufferSize;&#10;  USHORT              PDClientContextSize;&#10;  USHORT              Attributes;&#10;  USHORT              Flags;&#10;  USHORT              DataStart;&#10;  ULONG               DataLength;&#10;  union {&#10;    struct {&#10;      union {&#10;        ULONG64 RxFilterContext;&#10;        ULONG64 GftFlowEntryId;&#10;      };&#10;      ULONG                         RxHashValue;&#10;...">PD_BUFFER</a> structures this queue can hold and is always equal to a number of the form (2^k)-1 (63, 127, 255, 511, 1023, etc.). This lends itself to efficient circular index arithmetic.</p>
<h3><code>ReceiveDataLength</code></h3>
<p>The minimum <a href="pd_buffer" title="typedef struct _PD_BUFFER {&#10;  struct _PD_BUFFER   *NextPDBuffer;&#10;  struct _PD_BUFFER   *NextPartialPDBuffer;&#10;  PVOID               PDClientReserved;&#10;  PVOID               PDClientContext;&#10;  PUCHAR              DataBufferVirtualAddress;&#10;  DMA_LOGICAL_ADDRESS DataBufferDmaLogicalAddress;&#10;  ULONG               DataBufferSize;&#10;  USHORT              PDClientContextSize;&#10;  USHORT              Attributes;&#10;  USHORT              Flags;&#10;  USHORT              DataStart;&#10;  ULONG               DataLength;&#10;  union {&#10;    struct {&#10;      union {&#10;        ULONG64 RxFilterContext;&#10;        ULONG64 GftFlowEntryId;&#10;      };&#10;      ULONG                         RxHashValue;&#10;...">PD_BUFFER</a> data length.</p>
<h3><code>Affinity</code></h3>
<p>The processor affinity is a hint to the provider for performance optimization. The platform will primarily be processing the queue on processors indicated by this mask. The provider must set this value to the processor core derived from the indirection table configured from <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-gen-receive-scale-parameters">OID_GEN_RECEIVE_SCALE_PARAMETERS</a></p>
<h3><code>TrafficClassId</code></h3>
<h3><code>MaximumPartialBufferCount</code></h3>
<p>For transmit queues, this is the maximum number of partial <a href="pd_buffer" title="typedef struct _PD_BUFFER {&#10;  struct _PD_BUFFER   *NextPDBuffer;&#10;  struct _PD_BUFFER   *NextPartialPDBuffer;&#10;  PVOID               PDClientReserved;&#10;  PVOID               PDClientContext;&#10;  PUCHAR              DataBufferVirtualAddress;&#10;  DMA_LOGICAL_ADDRESS DataBufferDmaLogicalAddress;&#10;  ULONG               DataBufferSize;&#10;  USHORT              PDClientContextSize;&#10;  USHORT              Attributes;&#10;  USHORT              Flags;&#10;  USHORT              DataStart;&#10;  ULONG               DataLength;&#10;  union {&#10;    struct {&#10;      union {&#10;        ULONG64 RxFilterContext;&#10;        ULONG64 GftFlowEntryId;&#10;      };&#10;      ULONG                         RxHashValue;&#10;...">PD_BUFFER</a> structures that the client is allowed to chain together to form a single L2 packet. This value must be equal to the MaximumTxPartialBufferCount value in the <a href="ndis_pd_capabilities" title="typedef struct _NDIS_PD_CAPABILITIES {&#10;  NDIS_OBJECT_HEADER Header;&#10;  ULONG              Flags;&#10;  ULONG              MaximumTxPartialBufferCount;&#10;  ULONG              MaximumRxPartialBufferCount;&#10;  UCHAR              RxFilterContextWidth;&#10;  ULONG              CapabilityFlags;&#10;  ULONG              MaxNumberOfRxQueues;&#10;  ULONG              MaxNumberOfTxQueues;&#10;  ULONG              MaxNumberOfRxQueuesForDefaultVport;&#10;  ULONG              MaxNumberOfTxQueuesForDefaultVport;&#10;  ULONG              MaxNumberOfRxQueuesPerNonDefaultVport;&#10;  ULONG              MaxNumberOfTxQueuesPerNonDefaultVport;&#10;  ULONG              ExactMatchProfileArrayOffset;&#10;  ULONG              ExactMatchProfileArrayNumElements;&#10;  ULONG              ExactMatchProfileArrayElementSize;&#10;  ULONG              WildcardMatchProfileArrayOffset;&#10;  ULONG              WildcardMatchProfileArrayNumElements;&#10;  ULONG              WildcardMatchProfileArrayElementSize;&#10;  ULONG              MinimumModerationInterval;&#10;...">NDIS_PD_CAPABILITIES</a> structure.</p>
<p>For receive queues, this is the maximum number of partial <a href="pd_buffer" title="typedef struct _PD_BUFFER {&#10;  struct _PD_BUFFER   *NextPDBuffer;&#10;  struct _PD_BUFFER   *NextPartialPDBuffer;&#10;  PVOID               PDClientReserved;&#10;  PVOID               PDClientContext;&#10;  PUCHAR              DataBufferVirtualAddress;&#10;  DMA_LOGICAL_ADDRESS DataBufferDmaLogicalAddress;&#10;  ULONG               DataBufferSize;&#10;  USHORT              PDClientContextSize;&#10;  USHORT              Attributes;&#10;  USHORT              Flags;&#10;  USHORT              DataStart;&#10;  ULONG               DataLength;&#10;  union {&#10;    struct {&#10;      union {&#10;        ULONG64 RxFilterContext;&#10;        ULONG64 GftFlowEntryId;&#10;      };&#10;      ULONG                         RxHashValue;&#10;...">PD_BUFFER</a> structures that the provider is allowed to chain together to form a single large L2 packet with RSC. This must be less than or equal to the MaximumRxPartialBufferCount value in the <a href="ndis_pd_capabilities" title="typedef struct _NDIS_PD_CAPABILITIES {&#10;  NDIS_OBJECT_HEADER Header;&#10;  ULONG              Flags;&#10;  ULONG              MaximumTxPartialBufferCount;&#10;  ULONG              MaximumRxPartialBufferCount;&#10;  UCHAR              RxFilterContextWidth;&#10;  ULONG              CapabilityFlags;&#10;  ULONG              MaxNumberOfRxQueues;&#10;  ULONG              MaxNumberOfTxQueues;&#10;  ULONG              MaxNumberOfRxQueuesForDefaultVport;&#10;  ULONG              MaxNumberOfTxQueuesForDefaultVport;&#10;  ULONG              MaxNumberOfRxQueuesPerNonDefaultVport;&#10;  ULONG              MaxNumberOfTxQueuesPerNonDefaultVport;&#10;  ULONG              ExactMatchProfileArrayOffset;&#10;  ULONG              ExactMatchProfileArrayNumElements;&#10;  ULONG              ExactMatchProfileArrayElementSize;&#10;  ULONG              WildcardMatchProfileArrayOffset;&#10;  ULONG              WildcardMatchProfileArrayNumElements;&#10;  ULONG              WildcardMatchProfileArrayElementSize;&#10;  ULONG              MinimumModerationInterval;&#10;...">NDIS_PD_CAPABILITIES</a> structure.</p>
<p><strong>Note</strong> The client never posts <a href="pd_buffer" title="typedef struct _PD_BUFFER {&#10;  struct _PD_BUFFER   *NextPDBuffer;&#10;  struct _PD_BUFFER   *NextPartialPDBuffer;&#10;  PVOID               PDClientReserved;&#10;  PVOID               PDClientContext;&#10;  PUCHAR              DataBufferVirtualAddress;&#10;  DMA_LOGICAL_ADDRESS DataBufferDmaLogicalAddress;&#10;  ULONG               DataBufferSize;&#10;  USHORT              PDClientContextSize;&#10;  USHORT              Attributes;&#10;  USHORT              Flags;&#10;  USHORT              DataStart;&#10;  ULONG               DataLength;&#10;  union {&#10;    struct {&#10;      union {&#10;        ULONG64 RxFilterContext;&#10;        ULONG64 GftFlowEntryId;&#10;      };&#10;      ULONG                         RxHashValue;&#10;...">PD_BUFFER</a> structures with the partial flag to the receive queue. The client is always required to post <strong><a href="pd_buffer" title="typedef struct _PD_BUFFER {&#10;  struct _PD_BUFFER   *NextPDBuffer;&#10;  struct _PD_BUFFER   *NextPartialPDBuffer;&#10;  PVOID               PDClientReserved;&#10;  PVOID               PDClientContext;&#10;  PUCHAR              DataBufferVirtualAddress;&#10;  DMA_LOGICAL_ADDRESS DataBufferDmaLogicalAddress;&#10;  ULONG               DataBufferSize;&#10;  USHORT              PDClientContextSize;&#10;  USHORT              Attributes;&#10;  USHORT              Flags;&#10;  USHORT              DataStart;&#10;  ULONG               DataLength;&#10;  union {&#10;    struct {&#10;      union {&#10;        ULONG64 RxFilterContext;&#10;        ULONG64 GftFlowEntryId;&#10;      };&#10;      ULONG                         RxHashValue;&#10;...">PD_BUFFER</a></strong> structures with at least MTU-size space, starting from the data start position. The provider performs chaining only in the case of RSC. Some providers may not be able to support RSC chaining, these providers set a value of 1 to the MaximumRxPartialBufferCount member in the <a href="ndis_pd_capabilities" title="typedef struct _NDIS_PD_CAPABILITIES {&#10;  NDIS_OBJECT_HEADER Header;&#10;  ULONG              Flags;&#10;  ULONG              MaximumTxPartialBufferCount;&#10;  ULONG              MaximumRxPartialBufferCount;&#10;  UCHAR              RxFilterContextWidth;&#10;  ULONG              CapabilityFlags;&#10;  ULONG              MaxNumberOfRxQueues;&#10;  ULONG              MaxNumberOfTxQueues;&#10;  ULONG              MaxNumberOfRxQueuesForDefaultVport;&#10;  ULONG              MaxNumberOfTxQueuesForDefaultVport;&#10;  ULONG              MaxNumberOfRxQueuesPerNonDefaultVport;&#10;  ULONG              MaxNumberOfTxQueuesPerNonDefaultVport;&#10;  ULONG              ExactMatchProfileArrayOffset;&#10;  ULONG              ExactMatchProfileArrayNumElements;&#10;  ULONG              ExactMatchProfileArrayElementSize;&#10;  ULONG              WildcardMatchProfileArrayOffset;&#10;  ULONG              WildcardMatchProfileArrayNumElements;&#10;  ULONG              WildcardMatchProfileArrayElementSize;&#10;  ULONG              MinimumModerationInterval;&#10;...">NDIS_PD_CAPABILITIES</a> structure.</p>
<h3><code>CounterHandle</code></h3>
<p>This is a handle to the transmit queue counter for transmit queues and a receive queue counter for receive queues.During queue creation, a client can optionally provide a counter handle. In this case and depending on the queue type, the provider must update the counter values as activity occurs on the queue. The client is responsible for closing the counter handle only after the queue is closed.</p>
<p>For queues that are not directly created by the client, such as RSS receive queues obtained using the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/">NdisPDOnRssReceiveQueues</a>routine, the provider must always have an associated counter handle with the queue. That is, for a given set of RSS receive queues, the provider must have one dedicated receive queue counter for each receive queue.</p>
<h2>Remarks</h2>
<p>This structure must be aligned on an 8-byte boundary.</p>
<h2>See also</h2>
<p><a href="ndis_pd_queue_type" title="typedef enum {&#10;  PDQueueTypeUnknown,&#10;  PDQueueTypeReceive,&#10;  PDQueueTypeTransmit,&#10;  PDQueueTypeMax&#10;} NDIS_PD_QUEUE_TYPE;">NDIS_PD_QUEUE_TYPE</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-ndis_pd_allocate_queue">NdisPDAllocateQueue</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/ns-ndis-_ndis_pd_queue_parameters">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ndis/ns-ndis-_ndis_pd_queue_parameters.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
