<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="WWAN_REGISTRATION_STATE - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>WWAN_REGISTRATION_STATE - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            WWAN_REGISTRATION_STATE - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wwan.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _WWAN_REGISTRATION_STATE {
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>               uNwError;
  <a href="wwan_register_state" title="typedef enum _WWAN_REGISTER_STATE {&#10;  WwanRegisterStateUnknown,&#10;  WwanRegisterStateDeregistered,&#10;  WwanRegisterStateSearching,&#10;  WwanRegisterStateHome,&#10;  WwanRegisterStateRoaming,&#10;  WwanRegisterStatePartner,&#10;  WwanRegisterStateDenied,&#10;  WwanRegisterStateMax&#10;} WWAN_REGISTER_STATE, *PWWAN_REGISTER_STATE;">WWAN_REGISTER_STATE</a> RegisterState;
  <a href="wwan_register_mode" title="typedef enum _WWAN_REGISTER_MODE {&#10;  WwanRegisterModeUnknown,&#10;  WwanRegisterModeAutomatic,&#10;  WwanRegisterModeManual,&#10;  WwanRegisterModeMax&#10;} WWAN_REGISTER_MODE, *PWWAN_REGISTER_MODE;">WWAN_REGISTER_MODE</a>  RegisterMode;
  WCHAR               ProviderId[WWAN_PROVIDERID_LEN];
  WCHAR               ProviderName[WWAN_PROVIDERNAME_LEN];
  WCHAR               RoamingText[WWAN_ROAMTEXT_LEN];
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>               WwanRegFlags;
  <a href="wwan_cellular_class" title="typedef enum _WWAN_CELLULAR_CLASS {&#10;  WwanCellularClassUnknown,&#10;  WwanCellularClassGsm,&#10;  WwanCellularClassCdma,&#10;  WwanCellularClassMax&#10;} WWAN_CELLULAR_CLASS, *PWWAN_CELLULAR_CLASS;">WWAN_CELLULAR_CLASS</a> CurrentCellularClass;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>               PreferredDataClasses;
} WWAN_REGISTRATION_STATE, *PWWAN_REGISTRATION_STATE;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wwan/ns-wwan-_wwan_registration_state">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/wwan_registration_state.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-wwan-_wwan_registration_state)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_wwan_registration_state-structure">_WWAN_REGISTRATION_STATE structure</h1>

<h2 id="description">Description</h2>

<p>The WWAN_REGISTRATION_STATE structure represents the registration state of the MB device.</p>

<h2 id="members">Members</h2>

<h3 id="unwerror"><code>uNwError</code></h3>

<p>A network specific error, in the event of a registration failure. For more information about this
member, see the following
"Remarks" section.</p>

<h3 id="registerstate"><code>RegisterState</code></h3>

<p>The registration state of the device. For a list of defined values, see
<a href="wwan_register_state" title="typedef enum _WWAN_REGISTER_STATE {&#10;  WwanRegisterStateUnknown,&#10;  WwanRegisterStateDeregistered,&#10;  WwanRegisterStateSearching,&#10;  WwanRegisterStateHome,&#10;  WwanRegisterStateRoaming,&#10;  WwanRegisterStatePartner,&#10;  WwanRegisterStateDenied,&#10;  WwanRegisterStateMax&#10;} WWAN_REGISTER_STATE, *PWWAN_REGISTER_STATE;">WWAN_REGISTER_STATE</a>.</p>

<p>The
<strong>WwanRegisterStatePartner</strong> value indicates the device is roaming on a preferred partner network
provider, whereas
<strong>WwanRegisterStateRoaming</strong> value indicates the device is just roaming. If the partner
characterization of the roaming state is not available, the miniport driver should report
<strong>WwanRegisterStateRoaming</strong>.</p>

<h3 id="registermode"><code>RegisterMode</code></h3>

<p>The registration mode of the device. For a list of defined values, see
<a href="wwan_register_mode" title="typedef enum _WWAN_REGISTER_MODE {&#10;  WwanRegisterModeUnknown,&#10;  WwanRegisterModeAutomatic,&#10;  WwanRegisterModeManual,&#10;  WwanRegisterModeMax&#10;} WWAN_REGISTER_MODE, *PWWAN_REGISTER_MODE;">WWAN_REGISTER_MODE</a>.</p>

<h3 id="providerid"><code>ProviderId</code></h3>

<p>A NULL-terminated numeric (0-9) string that represents the network provider identity.</p>

<p>For GSM-based networks, this string is a concatenation of a three-digit Mobile Country Code (MCC) and
a two or three-digit Mobile Network Code (MNC). GSM-based carriers may have more than one MNC, and hence
more than one
<strong>ProviderId</strong> .</p>

<p>For CDMA-based networks, this string is a five-digit System ID (<a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a>). Generally, a CDMA-based carrier
has more than one <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a>. Typically, a carrier has one <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> for each market, which is usually divided
geographically within a nation by regulations, such as Metropolitan Statistical Areas (MSA) in the
United States of America. Miniport drivers of CDMA-based devices must specify
WWAN_CDMA_DEFAULT_PROVIDER_ID if this information is not available.</p>

<p>When processing a
<em>query</em> request, and the registration state is in automatic register mode, this member contains the
provider ID that the device is currently associated with (if applicable). When the registration state is
in manual register mode, this member contains the provider ID that the device is requested to register
with (even if the provider is unavailable).</p>

<p>When processing a
<em>set</em> request and the registration state is in manual mode, this contains the provider ID selected
by the MB Service for the device to register with. When the registration state is in automatic register
mode, this parameter is ignored.</p>

<p>CDMA 1xRTT providers must be set to WWAN_CDMA_DEFAULT_PROVIDER_ID if the provider ID is not
available.</p>

<h3 id="providername"><code>ProviderName</code></h3>

<p>A NULL-terminated string that represents the network provider's name. This member is limited to,
at most, WWAN_PROVIDERNAME_LEN characters.</p>

<p>For GSM-based networks, if the Preferred Presentation of Country Initials and Mobile Network Name
(PPCI&amp;N) is longer than twenty characters, the miniport driver should abbreviate the network
name.</p>

<p>This member is ignored when the MB Service sets the preferred provider list.</p>

<p>Miniport drivers should specify a <strong>NULL</strong> string for devices that do not have this
information.</p>

<h3 id="roamingtext"><code>RoamingText</code></h3>

<p>A NULL-terminated string to inform the user that the device is roaming. This member is limited to
at most WWAN_ROAMTEXT_LEN characters.</p>

<p>This text should provide additional information to the user when the registration state is either
<strong>WwanRegisterStatePartner</strong> or
<strong>WwanRegisterStateRoaming</strong>. This member is optional.</p>

<h3 id="wwanregflags"><code>WwanRegFlags</code></h3>

<p>Registration flags.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>WWAN_REG_FLAGS_NONE</td>
  <td>No registration flags.</td>
</tr>
<tr>
  <td>WWAN_REG_FLAGS_NO_MANUAL_REG</td>
  <td>No manual attach.</td>
</tr>
<tr>
  <td>WWAN_REG_FLAGS_PS_AUTO_ATTACH</td>
  <td>Indicates that the MB device manages its own packet context. The MB Service will not send a packet detach to the miniport driver, but may send a packet attach.</td>
</tr>
</tbody>
</table>

<h3 id="currentcellularclass"><code>CurrentCellularClass</code></h3>

<p>The current cellular class of the registered network. For networks that only support a single cellular class this member should be set to that cellular class. For multi-mode capable networks the miniport driver sends NDIS_STATUS_WWAN_REGISTER_STATE notifications to the MB service when the network changes its cellular class.</p>

<h3 id="preferreddataclasses"><code>PreferredDataClasses</code></h3>

<p>A bitmask that represents the data access technologies that are preferred for a connection.</p>

<h2 id="remarks">Remarks</h2>

<p><em>Query</em> and
<em>set</em> OID requests as well as unsolicited status events use the
<strong>uNwError</strong> member. If there is no network specific error or the network specific error is not known,
miniport drivers should set this member to zero. The
"Status Indication Structure" section in
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/mb-operational-semantics">MB Operational Semantics</a> shows the
registration cause code failure values that are defined in the
<em>3GPP TS 24.008 Specification</em>.</p>

<p>The following points provide guidelines on returning network specific error in different
scenarios:</p>

<ul>
<li>If network registration fails because of network specific error, miniport drivers should return the
network specific error in response to
<em>query</em> requests. In this case, miniport drivers should set the
<strong>uStatus</strong> member of the <a href="ndis_wwan_registration_state" title="typedef struct _NDIS_WWAN_REGISTRATION_STATE {&#10;  NDIS_OBJECT_HEADER      Header;&#10;  WWAN_STATUS             uStatus;&#10;  WWAN_REGISTRATION_STATE RegistrationState;&#10;} NDIS_WWAN_REGISTRATION_STATE, *PNDIS_WWAN_REGISTRATION_STATE;">NDIS_WWAN_REGISTRATION_STATE</a> structure to WWAN_STATUS_SUCCESS and set the
<strong>uNwError</strong> member to the network specific error code.</li>
<li>If a
<em>set</em> request fails, miniport drivers should return the network specific error code. In this case,
miniport drivers should set the
<strong>uStatus</strong> member of the <a href="ndis_wwan_registration_state" title="typedef struct _NDIS_WWAN_REGISTRATION_STATE {&#10;  NDIS_OBJECT_HEADER      Header;&#10;  WWAN_STATUS             uStatus;&#10;  WWAN_REGISTRATION_STATE RegistrationState;&#10;} NDIS_WWAN_REGISTRATION_STATE, *PNDIS_WWAN_REGISTRATION_STATE;">NDIS_WWAN_REGISTRATION_STATE</a> structure to WWAN_STATUS_FAILURE and set the
<strong>uNwError</strong> member to the network specific error code.</li>
<li>Whenever the device registration state changes because the network de-registers the device (for
example, the network de-registered the device because the device's subscription expired) then
unsolicited status events should include the network specific error. In this case, the miniport driver
should set the
<strong>uStatus</strong> member of the <a href="ndis_wwan_registration_state" title="typedef struct _NDIS_WWAN_REGISTRATION_STATE {&#10;  NDIS_OBJECT_HEADER      Header;&#10;  WWAN_STATUS             uStatus;&#10;  WWAN_REGISTRATION_STATE RegistrationState;&#10;} NDIS_WWAN_REGISTRATION_STATE, *PNDIS_WWAN_REGISTRATION_STATE;">NDIS_WWAN_REGISTRATION_STATE</a> structure to WWAN_STATUS_SUCCESS and set the
<strong>uNwError</strong> member to the network specific error code.</li>
</ul>

<p>To return a network specific error when processing OID_WWAN_REGISTER_STATE requests, miniport drivers
should set the
<strong>uStatus</strong> member of the <a href="ndis_wwan_registration_state" title="typedef struct _NDIS_WWAN_REGISTRATION_STATE {&#10;  NDIS_OBJECT_HEADER      Header;&#10;  WWAN_STATUS             uStatus;&#10;  WWAN_REGISTRATION_STATE RegistrationState;&#10;} NDIS_WWAN_REGISTRATION_STATE, *PNDIS_WWAN_REGISTRATION_STATE;">NDIS_WWAN_REGISTRATION_STATE</a> structure to WWAN_STATUS_FAILURE and set the
<strong>uNwError</strong> member to the network specific error code.</p>

<p>Miniport drivers can provide additional error codes as defined by the GSM standards specification of
packet-attach error codes returned by the network. For example, miniport drivers can communicate the 3GPP
specification TS 24.008 packet-attach error codes, such as error code 12 (Location area not allowed), to
the MB Service through the
<strong>uNwError</strong> member.</p>

<p>Miniport drivers must report the cause code at the earliest possible instance. For example, if the MB
device encounters one of these codes when attempting to register the device on with a network provider,
the miniport driver should report it at that time.</p>

<p>Miniport drivers connected to a multi-mode network should indicate the cellular class change through a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-wwan-register-state">NDIS_STATUS_WWAN_REGISTER_STATE</a> notification.</p>

<h2 id="see-also">See also</h2>

<p><a href="ndis_wwan_registration_state" title="typedef struct _NDIS_WWAN_REGISTRATION_STATE {&#10;  NDIS_OBJECT_HEADER      Header;&#10;  WWAN_STATUS             uStatus;&#10;  WWAN_REGISTRATION_STATE RegistrationState;&#10;} NDIS_WWAN_REGISTRATION_STATE, *PNDIS_WWAN_REGISTRATION_STATE;">NDIS_WWAN_REGISTRATION_STATE</a></p>

<p><a href="wwan_register_mode" title="typedef enum _WWAN_REGISTER_MODE {&#10;  WwanRegisterModeUnknown,&#10;  WwanRegisterModeAutomatic,&#10;  WwanRegisterModeManual,&#10;  WwanRegisterModeMax&#10;} WWAN_REGISTER_MODE, *PWWAN_REGISTER_MODE;">WWAN_REGISTER_MODE</a></p>

<p><a href="wwan_register_state" title="typedef enum _WWAN_REGISTER_STATE {&#10;  WwanRegisterStateUnknown,&#10;  WwanRegisterStateDeregistered,&#10;  WwanRegisterStateSearching,&#10;  WwanRegisterStateHome,&#10;  WwanRegisterStateRoaming,&#10;  WwanRegisterStatePartner,&#10;  WwanRegisterStateDenied,&#10;  WwanRegisterStateMax&#10;} WWAN_REGISTER_STATE, *PWWAN_REGISTER_STATE;">WWAN_REGISTER_STATE</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wwan/ns-wwan-_wwan_registration_state">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wwan/ns-wwan-_wwan_registration_state.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
