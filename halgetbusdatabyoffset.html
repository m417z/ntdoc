<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="HalGetBusDataByOffset - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>HalGetBusDataByOffset - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            HalGetBusDataByOffset - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NTHALAPI <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> HalGetBusDataByOffset(
  [in] <a href="bus_data_type" title="typedef enum _BUS_DATA_TYPE&#10;{&#10;    ConfigurationSpaceUndefined = -1,&#10;    Cmos,&#10;    EisaConfiguration,&#10;    Pos,&#10;    CbusConfiguration,&#10;    PCIConfiguration,&#10;    VMEConfiguration,&#10;    NuBusConfiguration,&#10;    PCMCIAConfiguration,&#10;    MPIConfiguration,&#10;    MPSAConfiguration,&#10;    PNPISAConfiguration,&#10;    SgiInternalConfiguration,&#10;    MaximumBusDataType&#10;} BUS_DATA_TYPE, *PBUS_DATA_TYPE;">BUS_DATA_TYPE</a> BusDataType,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>         BusNumber,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>         SlotNumber,
  [in] PVOID         Buffer,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>         Offset,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>         Length
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddk/nf-ntddk-halgetbusdatabyoffset">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/halgetbusdatabyoffset.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ntddk-halgetbusdatabyoffset)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2 id="description">Description</h2>

<blockquote>
  <p>[!WARNING]
  <strong>HalGetBusDataByOffset</strong> and <strong><a href="halsetbusdatabyoffset" title="NTHALAPI ULONG HalSetBusDataByOffset(&#10;  [in] BUS_DATA_TYPE BusDataType,&#10;  [in] ULONG         BusNumber,&#10;  [in] ULONG         SlotNumber,&#10;  [in] PVOID         Buffer,&#10;  [in] ULONG         Offset,&#10;  [in] ULONG         Length&#10;);">HalSetBusDataByOffset</a></strong> are provided for backward compatibility but should be used only if the methods recommended in <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/accessing-device-configuration-space">Accessing Device Configuration Space</a> cannot be used.</p>
</blockquote>

<p>This function retrieves information, starting at the offset, about a slot or address on an I/O bus.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="busdatatype-in"><code>BusDataType</code> [in]</h3>

<p>Bus data to retrieve. The upper bound on the bus types supported is always MaximumBusDataType. The only supported BusDataType is <code>PCIConfiguration</code> All other types are deprecated.</p>

<h3 id="busnumber-in"><code>BusNumber</code> [in]</h3>

<p>Zero-based and system-assigned number of the bus in systems with several buses of the same BusDataType. This argument also carries the segment number. To specify the segment number, use (Segment &lt;&lt; 8) | BusNumber</p>

<h3 id="slotnumber-in"><code>SlotNumber</code> [in]</h3>

<p>Logical slot number or location of the device. If you specify PCIConfiguration as the BusDataType, this value is a <a href="pci_slot_number" title="typedef struct _PCI_SLOT_NUMBER {&#10;  union {&#10;    struct {&#10;      ULONG DeviceNumber : 5;&#10;      ULONG FunctionNumber : 3;&#10;      ULONG Reserved : 24;&#10;    } bits;&#10;    ULONG AsULONG;&#10;  } u;&#10;} PCI_SLOT_NUMBER, *PPCI_SLOT_NUMBER;">PCI_SLOT_NUMBER</a> value, which is the slot and function numbers combined.</p>

<h3 id="buffer-in"><code>Buffer</code> [in]</h3>

<p>Pointer to a caller-supplied buffer for configuration information specific to BusDataType.</p>

<p>If you specify PCIConfiguration, the buffer contains the PCI config space information for the specified SlotNumber and function number. The specified Offset and Length determine how much information to supply. Certain members of PCI config space have read-only values The caller is responsible for preserving the system-supplied values of read-only members. Note that for a Type-1 PCI device, <a href="halsetbusdatabyoffset" title="NTHALAPI ULONG HalSetBusDataByOffset(&#10;  [in] BUS_DATA_TYPE BusDataType,&#10;  [in] ULONG         BusNumber,&#10;  [in] ULONG         SlotNumber,&#10;  [in] PVOID         Buffer,&#10;  [in] ULONG         Offset,&#10;  [in] ULONG         Length&#10;);">HalSetBusDataByOffset</a> prevents writes to registers inside the common header (first 256bytes of the config space).</p>

<h3 id="offset-in"><code>Offset</code> [in]</h3>

<p>Byte offset in the <a href="pci_common_config" title="typedef struct _PCI_COMMON_CONFIG : PCI_COMMON_HEADER {&#10;  UCHAR DeviceSpecific[192];&#10;} PCI_COMMON_CONFIG, *PPCI_COMMON_CONFIG;">PCI_COMMON_CONFIG</a> structure for which the requested information should be returned. Callers can use the system-defined constant PCI_COMMON_HDR_LENGTH to specify the device-specific area of <a href="pci_common_config" title="typedef struct _PCI_COMMON_CONFIG : PCI_COMMON_HEADER {&#10;  UCHAR DeviceSpecific[192];&#10;} PCI_COMMON_CONFIG, *PPCI_COMMON_CONFIG;">PCI_COMMON_CONFIG</a>.</p>

<h3 id="length-in"><code>Length</code> [in]</h3>

<p>Maximum number of bytes in the Buffer.</p>

<h2 id="return-value">Return value</h2>

<p>The return value is the actual length read from the config space.</p>

<h2 id="remarks">Remarks</h2>

<p>Device drivers call this function during initialization to locate their devices on a particular I/O bus. You can use the returned bus-type-specific configuration data in later calls to other configuration and initialization functions, such as HalTranslateBusAddress.</p>

<p>When accessing the device-specific area of the PCI configuration space, HalGetBusDataByOffset guarantees that this function never reads or writes data outside the range specified by the input Offset and Length. Even if the input Length is exactly a 1-byte or 2-byte word, this function never accesses any data outside the requested range.</p>

<h2 id="see-also">See also</h2>

<p><a href="bus_data_type" title="typedef enum _BUS_DATA_TYPE&#10;{&#10;    ConfigurationSpaceUndefined = -1,&#10;    Cmos,&#10;    EisaConfiguration,&#10;    Pos,&#10;    CbusConfiguration,&#10;    PCIConfiguration,&#10;    VMEConfiguration,&#10;    NuBusConfiguration,&#10;    PCMCIAConfiguration,&#10;    MPIConfiguration,&#10;    MPSAConfiguration,&#10;    PNPISAConfiguration,&#10;    SgiInternalConfiguration,&#10;    MaximumBusDataType&#10;} BUS_DATA_TYPE, *PBUS_DATA_TYPE;">BUS_DATA_TYPE</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/embedded/ms899356(v=msdn.10)">HalGetBusData</a></p>

<p><a href="halsetbusdatabyoffset" title="NTHALAPI ULONG HalSetBusDataByOffset(&#10;  [in] BUS_DATA_TYPE BusDataType,&#10;  [in] ULONG         BusNumber,&#10;  [in] ULONG         SlotNumber,&#10;  [in] PVOID         Buffer,&#10;  [in] ULONG         Offset,&#10;  [in] ULONG         Length&#10;);">HalSetBusDataByOffset</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/embedded/ms899359(v=msdn.10)">HalSetBusData</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/embedded/ms899361(v=msdn.10)">HalTranslateBusAddress</a></p>

<p><strong><a href="pci_common_config" title="typedef struct _PCI_COMMON_CONFIG : PCI_COMMON_HEADER {&#10;  UCHAR DeviceSpecific[192];&#10;} PCI_COMMON_CONFIG, *PPCI_COMMON_CONFIG;">PCI_COMMON_CONFIG</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddk/nf-ntddk-halgetbusdatabyoffset">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddk/nf-ntddk-halgetbusdatabyoffset.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
