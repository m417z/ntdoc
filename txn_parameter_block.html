<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="TXN_PARAMETER_BLOCK - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>TXN_PARAMETER_BLOCK - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            TXN_PARAMETER_BLOCK - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _TXN_PARAMETER_BLOCK {
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a> Length;
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a> TxFsContext;
  PVOID  TransactionObject;
} TXN_PARAMETER_BLOCK, *PTXN_PARAMETER_BLOCK;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddk/ns-ntddk-_txn_parameter_block">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/txn_parameter_block.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddk-_txn_parameter_block)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2 id="description">Description</h2>

<p>The TXN_PARAMETER_BLOCK structure contains information about a transacted file operation.</p>

<h2 id="members">Members</h2>

<h3 id="length"><code>Length</code></h3>

<p>The size, in bytes, of the TXN_PARAMETER_BLOCK structure.</p>

<h3 id="txfscontext"><code>TxFsContext</code></h3>

<p>The miniversion ID for the file.</p>

<h3 id="transactionobject"><code>TransactionObject</code></h3>

<p>An opaque pointer to the transaction object for the transaction.</p>

<h2 id="remarks">Remarks</h2>

<p>A <em>miniversion</em> is a version of a file that a transacted writer creates during a transaction. (A <em>transacted writer</em> is a transacted file handle opened with any permission that is not part of generic read access, but is part of generic write access.)</p>

<p>If a specific miniversion number for the file is not provided, the <strong>TxFsContext</strong> member must be set to TXF_MINIVERSION_DEFAULT_VIEW.</p>

<p>The <strong>TxFsContext</strong> member of the <strong>TXN_PARAMETER_BLOCK</strong> uses TXF_MINIVERSION_DEFAULT_VIEW to get the default view of the requested file that is based on the value of the <strong>TransactionObject</strong> member. So if <strong>TransactionObject</strong> is the same transaction that has the requested file locked for transacted modification, the caller can see those modifications (the "dirty" view of the file) if the caller can specify the value of the <strong>TransactionObject</strong> member. If <strong>TransactionObject</strong> is not the same transaction that has the requested file locked for transacted modification, the caller gets a transactionally isolated view of the file if it specifies this value.</p>

<p>A miniversion exists only as a point-in-time view of a file and has not yet been written as an actual on-disk variant of a given file. A transacted writer creates a miniversion by using the <a href="fsctl_txfs_create_miniversion" title="// CTL_CODE(0x0009, 0x05f, METHOD_BUFFERED, FILE_WRITE_ACCESS)&#10;#define FSCTL_TXFS_CREATE_MINIVERSION 0x0009817C">FSCTL_TXFS_CREATE_MINIVERSION</a> control code to call <a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/ff566462(v=vs.85)">ZwFsControlFile</a>. In response, the system creates a miniversion and returns its miniversion ID. The transacted writer can continue to make changes to the file thereafter. If the file is opened later by using the returned miniversion ID as the <strong>TxFsContext</strong> member of the <strong>TXN_PARAMETER_BLOCK</strong> structure, the resulting file handle shows the file as it was at the time that miniversion was created.</p>

<p>All miniversions created in a transaction go away when the transaction ends. Afterwards, the file can no longer be opened by using the miniversion IDs.</p>

<p>A miniversion is available only to the transacted writer that created the miniversion, not to a transacted reader or non-transacted reader.</p>

<p>The <a href="iogettransactionparameterblock" title="PTXN_PARAMETER_BLOCK IoGetTransactionParameterBlock(&#10;  [in] PFILE_OBJECT FileObject&#10;);">IoGetTransactionParameterBlock</a> routine returns a pointer to this structure.</p>

<h2 id="see-also">See also</h2>

<p><a href="fsctl_txfs_create_miniversion" title="// CTL_CODE(0x0009, 0x05f, METHOD_BUFFERED, FILE_WRITE_ACCESS)&#10;#define FSCTL_TXFS_CREATE_MINIVERSION 0x0009817C">FSCTL_TXFS_CREATE_MINIVERSION</a></p>

<p><a href="iogettransactionparameterblock" title="PTXN_PARAMETER_BLOCK IoGetTransactionParameterBlock(&#10;  [in] PFILE_OBJECT FileObject&#10;);">IoGetTransactionParameterBlock</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/ff566462(v=vs.85)">ZwFsControlFile</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddk/ns-ntddk-_txn_parameter_block">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddk/ns-ntddk-_txn_parameter_block.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
