<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PFND3DDDI_DRAWRECTPATCH - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PFND3DDDI_DRAWRECTPATCH - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PFND3DDDI_DRAWRECTPATCH - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dumddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PFND3DDDI_DRAWRECTPATCH Pfnd3dddiDrawrectpatch;

HRESULT Pfnd3dddiDrawrectpatch(
  [in] HANDLE hDevice,
       const <a href="d3dddiarg_drawrectpatch" title="typedef struct _D3DDDIARG_DRAWRECTPATCH {&#10;  [in] UINT Handle;&#10;} D3DDDIARG_DRAWRECTPATCH;">D3DDDIARG_DRAWRECTPATCH</a> *unnamedParam2,
       const <a href="d3dddirectpatch_info" title="typedef struct _D3DDDIRECTPATCH_INFO {&#10;  UINT             StartVertexOffsetWidth;&#10;  UINT             StartVertexOffsetHeight;&#10;  UINT             Width;&#10;  UINT             Height;&#10;  UINT             Stride;&#10;  D3DDDIBASISTYPE  Basis;&#10;  D3DDDIDEGREETYPE Degree;&#10;} D3DDDIRECTPATCH_INFO;">D3DDDIRECTPATCH_INFO</a> *unnamedParam3,
       const FLOAT *unnamedParam4
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_drawrectpatch">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pfnd3dddi_drawrectpatch.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-d3dumddi-pfnd3dddi_drawrectpatch)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pfnd3dddi_drawrectpatch-callback-function">PFND3DDDI_DRAWRECTPATCH callback function</h1>

<h2 id="description">Description</h2>

<p>The <strong>DrawRectPatch</strong> function draws a new or cached rectangular patch or updates the specification of a previously defined patch.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="hdevice-in"><code>hDevice</code> [in]</h3>

<p>A handle to the display device (graphics context).</p>

<h3 id="unnamedparam2"><code>unnamedParam2</code></h3>

<p><em>pData</em> [in]</p>

<p>A pointer to a <a href="d3dddiarg_drawrectpatch" title="typedef struct _D3DDDIARG_DRAWRECTPATCH {&#10;  [in] UINT Handle;&#10;} D3DDDIARG_DRAWRECTPATCH;">D3DDDIARG_DRAWRECTPATCH</a> structure that describes the rectangular patch to draw.</p>

<h3 id="unnamedparam3"><code>unnamedParam3</code></h3>

<p><em>pInfo</em> [in]</p>

<p>Optional. A pointer to a <a href="d3dddirectpatch_info" title="typedef struct _D3DDDIRECTPATCH_INFO {&#10;  UINT             StartVertexOffsetWidth;&#10;  UINT             StartVertexOffsetHeight;&#10;  UINT             Width;&#10;  UINT             Height;&#10;  UINT             Stride;&#10;  D3DDDIBASISTYPE  Basis;&#10;  D3DDDIDEGREETYPE Degree;&#10;} D3DDDIRECTPATCH_INFO;">D3DDDIRECTPATCH_INFO</a> structure that describes information about the rectangular patch.</p>

<h3 id="unnamedparam4"><code>unnamedParam4</code></h3>

<p><em>pPatch</em> [in]</p>

<p>Optional. A pointer to a buffer that contains four floating-point values (D3DFLOAT[4]) that provide the segment counts for each of the four edges of the rectangular patch.</p>

<h2 id="return-value">Return value</h2>

<p><strong>DrawRectPatch</strong> returns S_OK or an appropriate error result if the rectangular patch is not successfully drawn.</p>

<h2 id="remarks">Remarks</h2>

<p>When the Microsoft Direct3D runtime calls*pPatch* the user-mode display driver's <strong>DrawRectPatch</strong> function, it can optionally supply information in the <em>pInfo</em> and parameters. The runtime sets flags in the <strong>Flags</strong> member of the <a href="d3dddiarg_drawrectpatch" title="typedef struct _D3DDDIARG_DRAWRECTPATCH {&#10;  [in] UINT Handle;&#10;} D3DDDIARG_DRAWRECTPATCH;">D3DDDIARG_DRAWRECTPATCH</a> structure that is specified by <em>pData</em> to indicate if it supplies this optional information.</p>

<p>The runtime supplies a <a href="uint" title="typedef unsigned int UINT;">UINT</a> value in the <strong>Handle</strong> member of <a href="d3dddiarg_drawrectpatch" title="typedef struct _D3DDDIARG_DRAWRECTPATCH {&#10;  [in] UINT Handle;&#10;} D3DDDIARG_DRAWRECTPATCH;">D3DDDIARG_DRAWRECTPATCH</a> to refer to the patch surface. Whenever the runtime redraws the patch surface, it passes the patch handle value and is not required to re-specify the <a href="d3dddirectpatch_info" title="typedef struct _D3DDDIRECTPATCH_INFO {&#10;  UINT             StartVertexOffsetWidth;&#10;  UINT             StartVertexOffsetHeight;&#10;  UINT             Width;&#10;  UINT             Height;&#10;  UINT             Stride;&#10;  D3DDDIBASISTYPE  Basis;&#10;  D3DDDIDEGREETYPE Degree;&#10;} D3DDDIRECTPATCH_INFO;">D3DDDIRECTPATCH_INFO</a> data structure for the patch surface. The user-mode display driver can precompute and cache forward-difference coefficients and any other information. Therefore, subsequent calls to the driver's <strong>DrawRectPatch</strong> function that use the same patch handle value run more efficiently.</p>

<p>The actual value in <strong>Handle</strong> is determined by the application and is not under runtime control. Therefore, the driver must handle any value that can be specified by a <a href="uint" title="typedef unsigned int UINT;">UINT</a>.</p>

<p>The special <strong>Handle</strong> value of zero indicates that the patch is dynamic; therefore, the driver cannot precompute or cache information for the patch. A nonzero value for <strong>Handle</strong> indicates that the patch is static (or updated with low frequency); therefore, the driver can precompute and cache information for the patch.</p>

<p>The driver must handle the following scenarios in its <strong>DrawRectPatch</strong> function:</p>

<ul>
<li>If the <strong>Handle</strong> member is zero, the patch is dynamic. The driver should neither precompute nor cache information for the patch. In this situation, the runtime passes a pointer to a <a href="d3dddirectpatch_info" title="typedef struct _D3DDDIRECTPATCH_INFO {&#10;  UINT             StartVertexOffsetWidth;&#10;  UINT             StartVertexOffsetHeight;&#10;  UINT             Width;&#10;  UINT             Height;&#10;  UINT             Stride;&#10;  D3DDDIBASISTYPE  Basis;&#10;  D3DDDIDEGREETYPE Degree;&#10;} D3DDDIRECTPATCH_INFO;">D3DDDIRECTPATCH_INFO</a> structure in the <em>pInfo</em> parameter and sets the RTPATCHFLAG_HASINFO flag in the <strong>Flags</strong> member of the <a href="d3dddiarg_drawrectpatch" title="typedef struct _D3DDDIARG_DRAWRECTPATCH {&#10;  [in] UINT Handle;&#10;} D3DDDIARG_DRAWRECTPATCH;">D3DDDIARG_DRAWRECTPATCH</a> structure to indicate the presence of the <a href="d3dddirectpatch_info" title="typedef struct _D3DDDIRECTPATCH_INFO {&#10;  UINT             StartVertexOffsetWidth;&#10;  UINT             StartVertexOffsetHeight;&#10;  UINT             Width;&#10;  UINT             Height;&#10;  UINT             Stride;&#10;  D3DDDIBASISTYPE  Basis;&#10;  D3DDDIDEGREETYPE Degree;&#10;} D3DDDIRECTPATCH_INFO;">D3DDDIRECTPATCH_INFO</a> structure at <em>pInfo</em>. Optionally, the runtime can also set the RTPATCHFLAG_HASSEGS flag in <strong>Flags</strong> to indicate the presence of the segment information that is specified by the <em>pPatch</em> parameter. However, if the runtime does not supply segment information at <em>pPatch</em>, the runtime should instead use the D3DRS_PATCHSEGMENTS render state value.</li>
<li>If a nonzero <strong>Handle</strong> value has not been previously specified in an earlier call to the driver's <strong>DrawRectPatch</strong> function, the runtime draws a new cacheable patch. The driver should allocate memory to store cached data and should add this data to its patch handle table. Because the runtime has not previously drawn this patch, the runtime should set the RTPATCHFLAG_HASINFO flag and pass a pointer to a <a href="d3dddirectpatch_info" title="typedef struct _D3DDDIRECTPATCH_INFO {&#10;  UINT             StartVertexOffsetWidth;&#10;  UINT             StartVertexOffsetHeight;&#10;  UINT             Width;&#10;  UINT             Height;&#10;  UINT             Stride;&#10;  D3DDDIBASISTYPE  Basis;&#10;  D3DDDIDEGREETYPE Degree;&#10;} D3DDDIRECTPATCH_INFO;">D3DDDIRECTPATCH_INFO</a> structure in the <em>pInfo</em> parameter. The driver must check for the RTPATCHFLAG_HASINFO flag to verify the presence of the patch information. If no patch information is specified, the driver should ignore the <strong>DrawRectPatch</strong> call and should not allocate memory for cached data in its patch handle table. Optionally, the runtime can set the RTPATCHFLAG_HASSEGS flag to indicate the presence of the segment information. However, if the runtime does not supply segment information at <em>pPatch</em>, the runtime should instead use the D3DRS_PATCHSEGMENTS render state value.</li>
<li>If a nonzero <strong>Handle</strong> value has been previously specified in an earlier call to the driver's <strong>DrawRectPatch</strong> function and the RTPATCHFLAG_HASINFO flag is set, the runtime updates the definition for the patch. The runtime passes a pointer to a <a href="d3dddirectpatch_info" title="typedef struct _D3DDDIRECTPATCH_INFO {&#10;  UINT             StartVertexOffsetWidth;&#10;  UINT             StartVertexOffsetHeight;&#10;  UINT             Width;&#10;  UINT             Height;&#10;  UINT             Stride;&#10;  D3DDDIBASISTYPE  Basis;&#10;  D3DDDIDEGREETYPE Degree;&#10;} D3DDDIRECTPATCH_INFO;">D3DDDIRECTPATCH_INFO</a> structure in the <em>pInfo</em> parameter, and the driver must recompute and recache the patch information. Optionally, the runtime can set the RTPATCHFLAG_HASSEGS flag to indicate the presence of the segment information. However, if the runtime does not supply segment information at <em>pPatch</em>, the runtime should instead use the D3DRS_PATCHSEGMENTS render state value.</li>
<li>If a nonzero <strong>Handle</strong> value has been previously specified in an earlier call to the driver's <strong>DrawRectPatch</strong> function and the RTPATCHFLAG_HASINFO flag is not set, the runtime redraws the patch. The driver should use the cached information to draw the patch. In this situation, the driver ignores the current vertex streams, and the cached information is used instead. However, the runtime can still specify new segment information; therefore, the driver should check for the RTPATCHFLAG_HASSEGS flag and handle specified segment information even if it uses a cached patch.</li>
</ul>

<p>The driver receives notification to release cached patch information through the D3DRS_DELETERTPATCH render state. The value of this render state is the patch to delete.</p>

<h2 id="see-also">See also</h2>

<p><a href="d3dddiarg_drawrectpatch" title="typedef struct _D3DDDIARG_DRAWRECTPATCH {&#10;  [in] UINT Handle;&#10;} D3DDDIARG_DRAWRECTPATCH;">D3DDDIARG_DRAWRECTPATCH</a></p>

<p><a href="d3dddi_devicefuncs" title="typedef struct _D3DDDI_DEVICEFUNCS {&#10;  PFND3DDDI_SETRENDERSTATE                           pfnSetRenderState;&#10;  PFND3DDDI_UPDATEWINFO                              pfnUpdateWInfo;&#10;  PFND3DDDI_VALIDATEDEVICE                           pfnValidateDevice;&#10;  PFND3DDDI_SETTEXTURESTAGESTATE                     pfnSetTextureStageState;&#10;  PFND3DDDI_SETTEXTURE                               pfnSetTexture;&#10;  PFND3DDDI_SETPIXELSHADER                           pfnSetPixelShader;&#10;  PFND3DDDI_SETPIXELSHADERCONST                      pfnSetPixelShaderConst;&#10;  PFND3DDDI_SETSTREAMSOURCEUM                        pfnSetStreamSourceUm;&#10;  PFND3DDDI_SETINDICES                               pfnSetIndices;&#10;  PFND3DDDI_SETINDICESUM                             pfnSetIndicesUm;&#10;  PFND3DDDI_DRAWPRIMITIVE                            pfnDrawPrimitive;&#10;  PFND3DDDI_DRAWINDEXEDPRIMITIVE                     pfnDrawIndexedPrimitive;&#10;  PFND3DDDI_DRAWRECTPATCH                            pfnDrawRectPatch;&#10;  PFND3DDDI_DRAWTRIPATCH                             pfnDrawTriPatch;&#10;  PFND3DDDI_DRAWPRIMITIVE2                           pfnDrawPrimitive2;&#10;  PFND3DDDI_DRAWINDEXEDPRIMITIVE2                    pfnDrawIndexedPrimitive2;&#10;  PFND3DDDI_VOLBLT                                   pfnVolBlt;&#10;  PFND3DDDI_BUFBLT                                   pfnBufBlt;&#10;  PFND3DDDI_TEXBLT                                   pfnTexBlt;&#10;...">D3DDDI_DEVICEFUNCS</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_drawrectpatch">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dumddi/nc-d3dumddi-pfnd3dddi_drawrectpatch.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
