<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="KsSynchronousDeviceControl - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>KsSynchronousDeviceControl - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            KsSynchronousDeviceControl - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ksproxy.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">KSDDKAPI HRESULT KsSynchronousDeviceControl(
  [in]            HANDLE Handle,
  [in]            <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  IoControl,
  [in, optional]  PVOID  InBuffer,
  [in]            <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  InLength,
  [out, optional] PVOID  OutBuffer,
  [in]            <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  OutLength,
  [in, out]       PULONG BytesReturned
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ksproxy/nf-ksproxy-kssynchronousdevicecontrol">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/kssynchronousdevicecontrol.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ksproxy-kssynchronousdevicecontrol)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="kssynchronousdevicecontrol-function">KsSynchronousDeviceControl function</h1>

<h2 id="description">Description</h2>

<p>The <strong>KsSynchronousDeviceControl</strong> function issues a synchronous device I/O control operation to the KS object that is specified by a file handle.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="handle-in"><code>Handle</code> [in]</h3>

<p>Handle to the KS object on which to perform the operation.</p>

<h3 id="iocontrol-in"><code>IoControl</code> [in]</h3>

<p>Control code that identifies a specific type of operation to perform on a KS object.</p>

<h3 id="inbuffer-in-optional"><code>InBuffer</code> [in, optional]</h3>

<p>Pointer to a buffer that contains data that specifies the operation to perform.</p>

<h3 id="inlength-in"><code>InLength</code> [in]</h3>

<p>Size, in bytes, of the buffer at <em>InBuffer</em>.</p>

<h3 id="outbuffer-out-optional"><code>OutBuffer</code> [out, optional]</h3>

<p>Pointer to a buffer that contains either data for the operation or buffer space that receives data for the operation.</p>

<h3 id="outlength-in"><code>OutLength</code> [in]</h3>

<p>Size, in bytes, of the buffer at <em>OutBuffer</em>.</p>

<h3 id="bytesreturned-in-out"><code>BytesReturned</code> [in, out]</h3>

<p>Pointer to a variable that receives the size, in bytes, of the data that <strong>KsSynchronousDeviceControl</strong> stores in the buffer at <em>OutBuffer</em>.</p>

<h2 id="return-value">Return value</h2>

<p>Returns NOERROR if successful; otherwise, returns an error code.</p>

<h2 id="remarks">Remarks</h2>

<p>To retrieve the handle to the KS object, an application should call the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ksproxy/nf-ksproxy-iksobject-ksgetobjecthandle">IKsObject::KsGetObjectHandle</a> method.</p>

<p>An application can set the control code in <em>IoControl</em> and the buffers at <em>InBuffer</em> and <em>OutBuffer</em> as follows to specify the operation to perform:</p>

<ul>
<li>Set <em>IoControl</em> to <a href="ioctl_ks_property" title="// CTL_CODE(0x002f, 0x000, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define IOCTL_KS_PROPERTY 0x002F0003">IOCTL_KS_PROPERTY</a> to access a property. Set <em>InBuffer</em> to point to a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ksproperty-structure">KSPROPERTY</a> structure that specifies the property of the property set to access and whether to retrieve information about the property or set information in the property. To set information in the property, set <em>OutBuffer</em> to point to that information. To retrieve information from the property, set <em>OutBuffer</em> to receive that information.</li>
<li>Set <em>IoControl</em> to <a href="ioctl_ks_method" title="// CTL_CODE(0x002f, 0x003, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define IOCTL_KS_METHOD 0x002F000F">IOCTL_KS_METHOD</a> to execute a method. Set <em>InBuffer</em> to point to a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ksmethod-structure">KSMETHOD</a> structure that specifies the method of the method set to execute and whether to read and/or write data related to the method. To read data, set <em>OutBuffer</em> to point to that data. To write data, set <em>OutBuffer</em> to receive that data.</li>
<li>Set <em>IoControl</em> to <a href="ioctl_ks_enable_event" title="// CTL_CODE(0x002f, 0x001, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define IOCTL_KS_ENABLE_EVENT 0x002F0007">IOCTL_KS_ENABLE_EVENT</a> to request that the KS object specified by <em>Handle</em> notify the application whenever a specific event action occurs. Set <em>InBuffer</em> to point to a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ksevent-structure">KSEVENT</a> structure that specifies the event of the event set about which to notify. Set <em>OutBuffer</em> to point to a <a href="kseventdata" title="typedef struct {&#10;  ULONG NotificationType;&#10;  union {&#10;    struct {&#10;      HANDLE    Event;&#10;      ULONG_PTR Reserved[2];&#10;    } EventHandle;&#10;    struct {&#10;      HANDLE Semaphore;&#10;      ULONG  Reserved;&#10;      LONG   Adjustment;&#10;    } SemaphoreHandle;&#10;    struct {&#10;      PVOID     Event;&#10;      KPRIORITY Increment;&#10;      ULONG_PTR Reserved;&#10;    } EventObject;&#10;    struct {&#10;      PVOID     Semaphore;&#10;      KPRIORITY Increment;&#10;...">KSEVENTDATA</a> structure that describes how the KS object should notify the application when the event occurs. Also see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ks-events">KS Events</a>.</li>
<li>Set <em>IoControl</em> to <a href="ioctl_ks_disable_event" title="// CTL_CODE(0x002f, 0x002, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define IOCTL_KS_DISABLE_EVENT 0x002F000B">IOCTL_KS_DISABLE_EVENT</a> to inform the KS object specified by <em>Handle</em> to stop notifying the application whenever a specific event action occurs. Set <em>InBuffer</em> to point to the <a href="kseventdata" title="typedef struct {&#10;  ULONG NotificationType;&#10;  union {&#10;    struct {&#10;      HANDLE    Event;&#10;      ULONG_PTR Reserved[2];&#10;    } EventHandle;&#10;    struct {&#10;      HANDLE Semaphore;&#10;      ULONG  Reserved;&#10;      LONG   Adjustment;&#10;    } SemaphoreHandle;&#10;    struct {&#10;      PVOID     Event;&#10;      KPRIORITY Increment;&#10;      ULONG_PTR Reserved;&#10;    } EventObject;&#10;    struct {&#10;      PVOID     Semaphore;&#10;      KPRIORITY Increment;&#10;...">KSEVENTDATA</a> structure that was previously used in the event-notification request.</li>
</ul>

<p>To retrieve a list of all properties, events, or methods supported by a filter, an application can set <em>IoControl</em> to <a href="ioctl_ks_property" title="// CTL_CODE(0x002f, 0x000, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define IOCTL_KS_PROPERTY 0x002F0003">IOCTL_KS_PROPERTY</a>, <a href="ioctl_ks_enable_event" title="// CTL_CODE(0x002f, 0x001, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define IOCTL_KS_ENABLE_EVENT 0x002F0007">IOCTL_KS_ENABLE_EVENT</a>, or <a href="ioctl_ks_method" title="// CTL_CODE(0x002f, 0x003, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define IOCTL_KS_METHOD 0x002F000F">IOCTL_KS_METHOD</a>. For the KSPROPERTY, KSEVENT, or KSMETHOD structure to which *InBuffer* points, set the *Set* member to <a href="guid_null" title="DEFINE_GUID(GUID_NULL, 0x00000000L, 0x0000, 0x0000, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00);">GUID_NULL</a> and set the <em>Flags</em> member to KSPROPERTY_TYPE_SETSUPPORT.</p>

<p>After the call to <strong>KsSynchronousDeviceControl</strong>, <em>OutBuffer</em> will contain an array of set GUIDs supported by the object specified by <em>Handle</em>.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ksproxy/nf-ksproxy-iksobject-ksgetobjecthandle">IKsObject::KsGetObjectHandle</a></p>

<p><a href="ioctl_ks_disable_event" title="// CTL_CODE(0x002f, 0x002, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define IOCTL_KS_DISABLE_EVENT 0x002F000B">IOCTL_KS_DISABLE_EVENT</a></p>

<p><a href="ioctl_ks_enable_event" title="// CTL_CODE(0x002f, 0x001, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define IOCTL_KS_ENABLE_EVENT 0x002F0007">IOCTL_KS_ENABLE_EVENT</a></p>

<p><a href="ioctl_ks_method" title="// CTL_CODE(0x002f, 0x003, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define IOCTL_KS_METHOD 0x002F000F">IOCTL_KS_METHOD</a></p>

<p><a href="ioctl_ks_property" title="// CTL_CODE(0x002f, 0x000, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define IOCTL_KS_PROPERTY 0x002F0003">IOCTL_KS_PROPERTY</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ksevent-structure">KSEVENT</a></p>

<p><a href="kseventdata" title="typedef struct {&#10;  ULONG NotificationType;&#10;  union {&#10;    struct {&#10;      HANDLE    Event;&#10;      ULONG_PTR Reserved[2];&#10;    } EventHandle;&#10;    struct {&#10;      HANDLE Semaphore;&#10;      ULONG  Reserved;&#10;      LONG   Adjustment;&#10;    } SemaphoreHandle;&#10;    struct {&#10;      PVOID     Event;&#10;      KPRIORITY Increment;&#10;      ULONG_PTR Reserved;&#10;    } EventObject;&#10;    struct {&#10;      PVOID     Semaphore;&#10;      KPRIORITY Increment;&#10;...">KSEVENTDATA</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ksmethod-structure">KSMETHOD</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ksproperty-structure">KSPROPERTY</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ksproxy/nf-ksproxy-kssynchronousdevicecontrol">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ksproxy/nf-ksproxy-kssynchronousdevicecontrol.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
