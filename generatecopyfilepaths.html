<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="GenerateCopyFilePaths - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>GenerateCopyFilePaths - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            GenerateCopyFilePaths - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// winsplp.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="dword" title="typedef unsigned long DWORD;">DWORD</a> GenerateCopyFilePaths(
  [in]      LPCWSTR pszPrinterName,
  [in]      LPCWSTR pszDirectory,
  [in]      LPBYTE  pSplClientInfo,
  [in]      <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>   dwLevel,
  [in, out] LPWSTR  pszSourceDir,
  [in, out] LPDWORD pcchSourceDirSize,
  [in, out] LPWSTR  pszTargetDir,
  [in, out] LPDWORD pcchTargetDirSize,
  [in]      <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>   dwFlags
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winsplp/nf-winsplp-generatecopyfilepaths">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/generatecopyfilepaths.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-winsplp-generatecopyfilepaths)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="generatecopyfilepaths-function">GenerateCopyFilePaths function</h1>

<h2 id="description">Description</h2>

<p>A Point and Print DLL's <strong>GenerateCopyFilePaths</strong> function is used for modifying the source and destination paths used by print spoolers when they copy print queue-associated files to a print client.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="pszprintername-in"><code>pszPrinterName</code> [in]</h3>

<p>Caller-supplied pointer to a string representing the name of the print queue.</p>

<h3 id="pszdirectory-in"><code>pszDirectory</code> [in]</h3>

<p>Caller-supplied pointer to a string representing the value supplied for the server's <strong>Directory</strong> entry in the registry. For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/supporting-point-and-print-during-printer-installations">Supporting Point and Print During Printer Installations</a>.</p>

<h3 id="psplclientinfo-in"><code>pSplClientInfo</code> [in]</h3>

<p>Caller-supplied pointer to an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winsplp/ns-winsplp-_splclient_info_1">SPLCLIENT_INFO_1</a> structure.</p>

<h3 id="dwlevel-in"><code>dwLevel</code> [in]</h3>

<p>Caller-supplied value indicating the level number of the structure pointed to by <em>pSplClientInfo</em>. Must be 1.</p>

<h3 id="pszsourcedir-in-out"><code>pszSourceDir</code> [in, out]</h3>

<p>For input, receives a caller-supplied pointer to a string representing the complete server directory path (including server name) from which files are to be copied.</p>

<p>For output, the function can modify this string.</p>

<h3 id="pcchsourcedirsize-in-out"><code>pcchSourceDirSize</code> [in, out]</h3>

<p>Caller-supplied address containing the length of the buffer pointed to by <em>pszSourceDir</em>. (Note that this is the buffer length, not the string length.)</p>

<h3 id="psztargetdir-in-out"><code>pszTargetDir</code> [in, out]</h3>

<p>For input, receives a caller-supplied pointer to a string representing the client directory path to which files are to be copied. The following rules apply:</p>

<ul>
<li>When the function is called on the server, this path is relative to PRINT$.</li>
<li>When the function is called on the client, the string contains a complete path.</li>
</ul>

<p>For output, the function can modify this string.</p>

<h3 id="pcchtargetdirsize-in-out"><code>pcchTargetDirSize</code> [in, out]</h3>

<p>Caller-supplied address containing the length of the buffer pointed to by <em>pszTargetDir</em>. (Note that this is the buffer length, not the string length.)</p>

<h3 id="dwflags-in"><code>dwFlags</code> [in]</h3>

<p>Caller-supplied flag. Can be one of the following:</p>

<h4 id="copyfile_flag_client_spooler">COPYFILE_FLAG_CLIENT_SPOOLER</h4>

<p>Indicates the function is being called by the client's spooler.</p>

<h4 id="copyfile_flag_server_spooler">COPYFILE_FLAG_SERVER_SPOOLER</h4>

<p>Indicates the function is being called by the server's spooler.</p>

<h2 id="return-value">Return value</h2>

<p>If the operation succeeds, the function should return <strong>ERROR_SUCCESS</strong>. Otherwise, it should return an error code defined in winerror.h.</p>

<h2 id="remarks">Remarks</h2>

<p>All <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/point-and-print-dlls">Point and Print DLLs</a> must export a <strong>GenerateCopyFilePaths</strong> function, which is called by the print spooler. Its purpose is to allow a Point and Print DLL to modify the source or destination directory path, or both, before the print spooler copies print queue-associated files from a server to a client. (The files are copied when a client connects to a print server. For a complete description of the steps involved in creating a Point and Print connection, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/supporting-point-and-print">Supporting Point and Print</a>.)</p>

<p>A Point and Print DLL executes on both the server and the client. The <strong>GenerateCopyFilePaths</strong> function should check the <em>dwFlags</em> argument to determine where it is executing.</p>

<p>Typically, this function is used to provide compatibility when different versions of the operating system are executing on the client and server. For example if the function, when executing on the server, determines (by reading the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winsplp/ns-winsplp-_splclient_info_1">SPLCLIENT_INFO_1</a> structure) that its operating system is newer than the client's, it can modify the source and destination paths to be compatible with the client's older OS. On the other hand, if the function determines that the client's operating system is newer than the client's, it should probably do nothing on the server and perform modifications, if necessary, when executing on the client.</p>

<p>Arguments for the <em>pszSourceDir</em> and <em>pszTargetDir</em> parameters point to buffers containing strings that represent the current source and destination directory paths. If modifications to either of these strings is necessary, the function should make modifications in the supplied buffers. The maximum allowable string lengths are pointed to by the <em>pcchSourceDirSize</em> and <em>pcchTargetDirSize</em> arguments.</p>

<p>If no modifications to the source or destination directories are needed, the function should just return <strong>ERROR_SUCCESS</strong>.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winsplp/nf-winsplp-spoolercopyfileevent">SpoolerCopyFileEvent</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winsplp/nf-winsplp-generatecopyfilepaths">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/winsplp/nf-winsplp-generatecopyfilepaths.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
