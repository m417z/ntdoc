<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="ChangerSetAccess - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ChangerSetAccess - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            ChangerSetAccess - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// mcd.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> ChangerSetAccess(
  [in] <a href="device_object" title="typedef struct _DEVICE_OBJECT {&#10;  CSHORT                   Type;&#10;  USHORT                   Size;&#10;  LONG                     ReferenceCount;&#10;  struct _DRIVER_OBJECT    *DriverObject;&#10;  struct _DEVICE_OBJECT    *NextDevice;&#10;  struct _DEVICE_OBJECT    *AttachedDevice;&#10;  struct _IRP              *CurrentIrp;&#10;  PIO_TIMER                Timer;&#10;  ULONG                    Flags;&#10;  ULONG                    Characteristics;&#10;  __volatile PVPB          Vpb;&#10;  PVOID                    DeviceExtension;&#10;  DEVICE_TYPE              DeviceType;&#10;  CCHAR                    StackSize;&#10;  union {&#10;    LIST_ENTRY         ListEntry;&#10;    WAIT_CONTEXT_BLOCK Wcb;&#10;  } Queue;&#10;  ULONG                    AlignmentRequirement;&#10;...">PDEVICE_OBJECT</a> DeviceObject,
  [in] PIRP           Irp
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/mcd/nf-mcd-changersetaccess">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/changersetaccess.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-mcd-changersetaccess)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="changersetaccess-function">ChangerSetAccess function</h1>

<h2 id="description">Description</h2>

<p><strong>ChangerSetAccess</strong> handles the device-specific aspects of a device-control <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a> with the IOCTL code <a href="ioctl_changer_set_access" title="// CTL_CODE(0x0030, 0x004, METHOD_BUFFERED, FILE_READ_ACCESS | FILE_WRITE_ACCESS)&#10;#define IOCTL_CHANGER_SET_ACCESS 0x0030C010">IOCTL_CHANGER_SET_ACCESS</a>.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="deviceobject-in"><code>DeviceObject</code> [in]</h3>

<p>Pointer to the device object that represents the changer.</p>

<h3 id="irp-in"><code>Irp</code> [in]</h3>

<p>Pointer to the <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a>.</p>

<h2 id="return-value">Return value</h2>

<p>If the changer supports setting access, <strong>ChangerSetAccess</strong> returns the STATUS_<em>XXX</em> value returned by the system port driver or one of the following values:</p>

<p><a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a></p>

<p>STATUS_INSUFFICIENT_RESOURCES</p>

<p>STATUS_INVALID_PARAMETER</p>

<p>If the changer does not support setting access, ChangerSetAccess returns STATUS_INVALID_DEVICE_REQUEST.</p>

<h2 id="remarks">Remarks</h2>

<p>This routine is required.</p>

<p><strong>ChangerSetAccess</strong> locks or unlocks a changer's IEport, door, or keypad, and extends or retracts an IEport.</p>

<p>The changer class driver checks the input buffer length in the I/O stack location before calling <strong>ChangerSetAccess</strong>. <em>Irp<strong></em>->SystemBuffer</strong> points to a <a href="changer_set_access" title="typedef struct _CHANGER_SET_ACCESS {&#10;  CHANGER_ELEMENT Element;&#10;  ULONG           Control;&#10;} CHANGER_SET_ACCESS, *PCHANGER_SET_ACCESS;">CHANGER_SET_ACCESS</a> structure as an input parameter that indicates the element to set and the operation to perform.</p>

<p><strong>ChangerSetAccess</strong> first checks for unsupported elements and operations, and returns the appropriate status code for those it doesn't support.</p>

<p>Next, <strong>ChangerSetAccess</strong> translates the zero-based element address passed by the system to the device-specific element address required by the changer.</p>

<p>Finally, <strong>ChangerSetAccess</strong> builds an SRB with a CDB for the given operation on the given element and sends it to the system port driver. The command to use depends on the changer. For example, the Exabyte miniclass driver uses the SCSI command PREVENT ALLOW MEDIUM REMOVAL to lock or unlock a changer door and MOVE MEDIUM to extend or retract an IEport.</p>

<h2 id="see-also">See also</h2>

<p><a href="changer_set_access" title="typedef struct _CHANGER_SET_ACCESS {&#10;  CHANGER_ELEMENT Element;&#10;  ULONG           Control;&#10;} CHANGER_SET_ACCESS, *PCHANGER_SET_ACCESS;">CHANGER_SET_ACCESS</a></p>

<p><a href="get_changer_parameters" title="typedef struct _GET_CHANGER_PARAMETERS {&#10;  ULONG  Size;&#10;  USHORT NumberTransportElements;&#10;  USHORT NumberStorageElements;&#10;  USHORT NumberCleanerSlots;&#10;  USHORT NumberIEElements;&#10;  USHORT NumberDataTransferElements;&#10;  USHORT NumberOfDoors;&#10;  USHORT FirstSlotNumber;&#10;  USHORT FirstDriveNumber;&#10;  USHORT FirstTransportNumber;&#10;  USHORT FirstIEPortNumber;&#10;  USHORT FirstCleanerSlotAddress;&#10;  USHORT MagazineSize;&#10;  ULONG  DriveCleanTimeout;&#10;  ULONG  Features0;&#10;  ULONG  Features1;&#10;  UCHAR  MoveFromTransport;&#10;  UCHAR  MoveFromSlot;&#10;  UCHAR  MoveFromIePort;&#10;...">GET_CHANGER_PARAMETERS</a></p>

<p><a href="ioctl_changer_set_access" title="// CTL_CODE(0x0030, 0x004, METHOD_BUFFERED, FILE_READ_ACCESS | FILE_WRITE_ACCESS)&#10;#define IOCTL_CHANGER_SET_ACCESS 0x0030C010">IOCTL_CHANGER_SET_ACCESS</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/mcd/nf-mcd-changersetaccess">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/mcd/nf-mcd-changersetaccess.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
