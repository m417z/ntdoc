<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="ExWaitForRundownProtectionReleaseCacheAware - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ExWaitForRundownProtectionReleaseCacheAware - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            ExWaitForRundownProtectionReleaseCacheAware - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">VOID ExWaitForRundownProtectionReleaseCacheAware(
  [in, out] PEX_RUNDOWN_REF_CACHE_AWARE RunRef
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-exwaitforrundownprotectionreleasecacheaware">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/exwaitforrundownprotectionreleasecacheaware.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-wdm-exwaitforrundownprotectionreleasecacheaware)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2 id="description">Description</h2>

<p>The <strong>ExWaitForRundownProtectionReleaseCacheAware</strong> routine waits until all drivers that have already been granted cache-aware run-down protection complete their accesses of the shared object.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="runref-in-out"><code>RunRef</code> [in, out]</h3>

<p>A pointer to a <strong>EX_RUNDOWN_REF_CACHE_AWARE</strong> structure that was initialized by a previous call to <strong><a href="exallocatecacheawarerundownprotection" title="PEX_RUNDOWN_REF_CACHE_AWARE ExAllocateCacheAwareRundownProtection(&#10;  [in] __drv_strictTypeMatch(__drv_typeExpr)POOL_TYPE PoolType,&#10;  [in] ULONG                                          PoolTag&#10;);">ExAllocateCacheAwareRundownProtection</a></strong> or <strong><a href="exinitializerundownprotectioncacheaware" title="VOID ExInitializeRundownProtectionCacheAware(&#10;  [out] PEX_RUNDOWN_REF_CACHE_AWARE RunRefCacheAware,&#10;  [in]  SIZE_T                      RunRefSize&#10;);">ExInitializeRundownProtectionCacheAware</a></strong>. The cache-aware run-down protection routines use this structure to track the run-down status of the associated shared object. This structure is opaque to drivers.</p>

<h2 id="remarks">Remarks</h2>

<p>This routine is called by the driver that owns an object that resides in shared memory and that is accessed by other drivers. Before deleting this object, the owning driver must call this routine to wait for any outstanding accesses of the object to complete. After <strong>ExWaitForRundownProtectionReleaseCacheAware</strong> returns, the owning driver can safely delete the object.</p>

<p>After <strong>ExWaitForRundownProtectionReleaseCacheAware</strong> is called, the <strong><a href="exacquirerundownprotectioncacheaware" title="BOOLEAN ExAcquireRundownProtectionCacheAware(&#10;  [in, out] PEX_RUNDOWN_REF_CACHE_AWARE RunRefCacheAware&#10;);">ExAcquireRundownProtectionCacheAware</a></strong> routine grants no further requests for cache-aware run-down protection from drivers that are trying to access the shared object.</p>

<p>The routine waits to return until all drivers that were previously granted cache-aware run-down protection finish accessing the object. As each driver finishes, it calls the <strong><a href="exreleaserundownprotectioncacheaware" title="VOID ExReleaseRundownProtectionCacheAware(&#10;  [in, out] PEX_RUNDOWN_REF_CACHE_AWARE RunRefCacheAware&#10;);">ExReleaseRundownProtectionCacheAware</a></strong> routine to release the previously acquired cache-aware run-down protection. When all outstanding accesses are completed, <strong>ExWaitForRundownProtectionReleaseCacheAware</strong> returns and the object can be safely deleted.</p>

<p>If <strong>ExWaitForRundownProtectionReleaseCacheAware</strong> is called when all drivers that were previously granted run-down protection have already finished accessing the shared object, the routine changes the object status to <em>run down</em>, and returns immediately, without waiting.</p>

<p>If <strong>ExWaitForRundownProtectionReleaseCacheAware</strong> is called to run down a shared object, but the <em>RunRef</em> parameter indicates that this object is already run down, the call has no effect but is not treated as an error.</p>

<p>For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/run-down-protection#cache-aware-run-down-protection">Cache-aware run-down protection</a>.</p>

<h2 id="see-also">See also</h2>

<p><strong><a href="exacquirerundownprotectioncacheaware" title="BOOLEAN ExAcquireRundownProtectionCacheAware(&#10;  [in, out] PEX_RUNDOWN_REF_CACHE_AWARE RunRefCacheAware&#10;);">ExAcquireRundownProtectionCacheAware</a></strong></p>

<p><strong><a href="exacquirerundownprotectioncacheawareex" title="BOOLEAN ExAcquireRundownProtectionCacheAwareEx(&#10;  [in, out] PEX_RUNDOWN_REF_CACHE_AWARE RunRefCacheAware,&#10;  [in]      ULONG                       Count&#10;);">ExAcquireRundownProtectionCacheAwareEx</a></strong></p>

<p><strong><a href="exallocatecacheawarerundownprotection" title="PEX_RUNDOWN_REF_CACHE_AWARE ExAllocateCacheAwareRundownProtection(&#10;  [in] __drv_strictTypeMatch(__drv_typeExpr)POOL_TYPE PoolType,&#10;  [in] ULONG                                          PoolTag&#10;);">ExAllocateCacheAwareRundownProtection</a></strong></p>

<p><strong><a href="exfreecacheawarerundownprotection" title="VOID ExFreeCacheAwareRundownProtection(&#10;  [in, out] PEX_RUNDOWN_REF_CACHE_AWARE RunRefCacheAware&#10;);">ExFreeCacheAwareRundownProtection</a></strong></p>

<p><strong><a href="exinitializerundownprotectioncacheaware" title="VOID ExInitializeRundownProtectionCacheAware(&#10;  [out] PEX_RUNDOWN_REF_CACHE_AWARE RunRefCacheAware,&#10;  [in]  SIZE_T                      RunRefSize&#10;);">ExInitializeRundownProtectionCacheAware</a></strong></p>

<p><strong><a href="exreinitializerundownprotectioncacheaware" title="VOID ExReInitializeRundownProtectionCacheAware(&#10;  [in, out] PEX_RUNDOWN_REF_CACHE_AWARE RunRefCacheAware&#10;);">ExReInitializeRundownProtectionCacheAware</a></strong></p>

<p><strong><a href="exreleaserundownprotectioncacheaware" title="VOID ExReleaseRundownProtectionCacheAware(&#10;  [in, out] PEX_RUNDOWN_REF_CACHE_AWARE RunRefCacheAware&#10;);">ExReleaseRundownProtectionCacheAware</a></strong></p>

<p><strong><a href="exreleaserundownprotectioncacheawareex" title="VOID ExReleaseRundownProtectionCacheAwareEx(&#10;  [in, out] PEX_RUNDOWN_REF_CACHE_AWARE RunRef,&#10;  [in]      ULONG                       Count&#10;);">ExReleaseRundownProtectionCacheAwareEx</a></strong></p>

<p><strong><a href="exrundowncompletedcacheaware" title="VOID ExRundownCompletedCacheAware(&#10;  [in, out] PEX_RUNDOWN_REF_CACHE_AWARE RunRefCacheAware&#10;);">ExRundownCompletedCacheAware</a></strong></p>

<p><strong><a href="exsizeofrundownprotectioncacheaware" title="SIZE_T ExSizeOfRundownProtectionCacheAware();">ExSizeOfRundownProtectionCacheAware</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-exwaitforrundownprotectionreleasecacheaware">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/nf-wdm-exwaitforrundownprotectionreleasecacheaware.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
