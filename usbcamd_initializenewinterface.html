<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="USBCAMD_InitializeNewInterface - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>USBCAMD_InitializeNewInterface - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            USBCAMD_InitializeNewInterface - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// usbcamdi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> USBCAMD_InitializeNewInterface(
  [in] PVOID DeviceContext,
  [in] PVOID DeviceData,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Version,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> CamControlFlag
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/usbcamdi/nf-usbcamdi-usbcamd_initializenewinterface">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/usbcamd_initializenewinterface.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-usbcamdi-usbcamd_initializenewinterface)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2 id="description">Description</h2>

<p>The <strong>USBCAMD_InitializeNewInterface</strong> function provides USBCAMD with all the necessary information to configure the camera minidriver to work correctly with the stream class driver and the USB bus driver.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="devicecontext-in"><code>DeviceContext</code> [in]</h3>

<p>Pointer to device-specific context.</p>

<h3 id="devicedata-in"><code>DeviceData</code> [in]</h3>

<p>Pointer to a <strong><a href="usbcamd_device_data2" title="typedef struct _USBCAMD_DEVICE_DATA2 {&#10;  ULONG                             Sig;&#10;  PCAM_INITIALIZE_ROUTINE           CamInitialize;&#10;  PCAM_INITIALIZE_ROUTINE           CamUnInitialize;&#10;  PCAM_PROCESS_PACKET_ROUTINE_EX    CamProcessUSBPacketEx;&#10;  PCAM_NEW_FRAME_ROUTINE_EX         CamNewVideoFrameEx;&#10;  PCAM_PROCESS_RAW_FRAME_ROUTINE_EX CamProcessRawVideoFrameEx;&#10;  PCAM_START_CAPTURE_ROUTINE_EX     CamStartCaptureEx;&#10;  PCAM_STOP_CAPTURE_ROUTINE_EX      CamStopCaptureEx;&#10;  PCAM_CONFIGURE_ROUTINE_EX         CamConfigureEx;&#10;  PCAM_STATE_ROUTINE                CamSaveState;&#10;  PCAM_STATE_ROUTINE                CamRestoreState;&#10;  PCAM_ALLOCATE_BW_ROUTINE_EX       CamAllocateBandwidthEx;&#10;  PCAM_FREE_BW_ROUTINE_EX           CamFreeBandwidthEx;&#10;} USBCAMD_DEVICE_DATA2, *PUSBCAMD_DEVICE_DATA2;">USBCAMD_DEVICE_DATA2</a></strong> structure.</p>

<h3 id="version-in"><code>Version</code> [in]</h3>

<p>Specifies the version information. This value should be set to the value USBCAMD_VERSION_200 for use with USBCAMD version 2.0.</p>

<h3 id="camcontrolflag-in"><code>CamControlFlag</code> [in]</h3>

<p>Specifies how USBCAMD and the camera minidriver should interact. The camera minidriver should set this value to one or more of the following:</p>

<table>
<thead>
<tr>
  <th>Flag</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>USBCAMD_CamControlFlag_NoVideoRawProcessing</td>
  <td>If the camera minidriver does not need to operate on video, it should set the USBCAMD_CamControlFlag_NoVideoRawProcessing. This eliminates one buffer copy.</td>
</tr>
<tr>
  <td>USBCAMD_CamControlFlag_NoStillRawProcessing</td>
  <td>If the camera minidriver does not need to operate on the still image raw frame, it should set the USBCAMD_CamControlFlag_NoStillRawProcessing bit to eliminate one buffer copy.</td>
</tr>
<tr>
  <td>USBCAMD_CamControlFlag_AssociatedFormat</td>
  <td>The USBCAMD_CamControlFlag_AssociatedFormat bit should be set if the camera minidriver uses the same format for video as it does on the virtual still pin. After this flag is set, USBCAMD does not permit the virtual still pin to be opened in a format different from the video pin. The USBCAMD_CamControlFlag_AssociatedFormat bit should be set only when the virtual still pin produces frames of the same format as the video frames.</td>
</tr>
<tr>
  <td>USBCAMD_CamControlFlag_EnableDeviceEvents</td>
  <td>Setting the USBCAMD_CamControlFlag_EnableDeviceEvents exposes a device event to the stream class driver and Microsoft DirectShow. This enables an STI monitor to launch a still image application if the still button is pressed on the camera. USBCAMD sends a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ksevent-vidcaptosti-ext-trigger">KSEVENT_VIDCAPTOSTI_EXT_TRIGGER</a> event if this bit is set and the camera's still button is pressed.</td>
</tr>
</tbody>
</table>

<h2 id="return-value">Return value</h2>

<p><strong>USBCAMD_InitializeNewInterface</strong> returns the value USBCAMD_VERSION_200.</p>

<h2 id="remarks">Remarks</h2>

<p>This function is only called by USBCAMD version 2.0.</p>

<p>The <strong>USBCAMD_InitializeNewInterface</strong> function must be called by the camera minidriver upon receiving an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/srb-initialize-device">SRB_INITIALIZE_DEVICE</a> request.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/srb-initialize-device">SRB_INITIALIZE_DEVICE</a></p>

<p><strong><a href="usbcamd_device_data2" title="typedef struct _USBCAMD_DEVICE_DATA2 {&#10;  ULONG                             Sig;&#10;  PCAM_INITIALIZE_ROUTINE           CamInitialize;&#10;  PCAM_INITIALIZE_ROUTINE           CamUnInitialize;&#10;  PCAM_PROCESS_PACKET_ROUTINE_EX    CamProcessUSBPacketEx;&#10;  PCAM_NEW_FRAME_ROUTINE_EX         CamNewVideoFrameEx;&#10;  PCAM_PROCESS_RAW_FRAME_ROUTINE_EX CamProcessRawVideoFrameEx;&#10;  PCAM_START_CAPTURE_ROUTINE_EX     CamStartCaptureEx;&#10;  PCAM_STOP_CAPTURE_ROUTINE_EX      CamStopCaptureEx;&#10;  PCAM_CONFIGURE_ROUTINE_EX         CamConfigureEx;&#10;  PCAM_STATE_ROUTINE                CamSaveState;&#10;  PCAM_STATE_ROUTINE                CamRestoreState;&#10;  PCAM_ALLOCATE_BW_ROUTINE_EX       CamAllocateBandwidthEx;&#10;  PCAM_FREE_BW_ROUTINE_EX           CamFreeBandwidthEx;&#10;} USBCAMD_DEVICE_DATA2, *PUSBCAMD_DEVICE_DATA2;">USBCAMD_DEVICE_DATA2</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/usbcamdi/nf-usbcamdi-usbcamd_initializenewinterface">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/usbcamdi/nf-usbcamdi-usbcamd_initializenewinterface.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
