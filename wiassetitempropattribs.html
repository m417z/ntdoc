<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="wiasSetItemPropAttribs - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>wiasSetItemPropAttribs - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            wiasSetItemPropAttribs - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wiamdef.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">HRESULT wiasSetItemPropAttribs(
  [in] <a href="byte" title="typedef unsigned char BYTE;">BYTE</a>               *pWiasContext,
       <a href="long" title="typedef long LONG;">LONG</a>               cPropSpec,
  [in] PROPSPEC           *pPropSpec,
  [in] <a href="wia_property_info" title="typedef struct _WIA_PROPERTY_INFO {&#10;  ULONG   lAccessFlags;&#10;  VARTYPE vt;&#10;  union {&#10;    struct {&#10;      LONG Min;&#10;      LONG Nom;&#10;      LONG Max;&#10;      LONG Inc;&#10;    } Range;&#10;    struct {&#10;      DOUBLE Min;&#10;      DOUBLE Nom;&#10;      DOUBLE Max;&#10;      DOUBLE Inc;&#10;    } RangeFloat;&#10;    struct {&#10;      LONG cNumList;&#10;      LONG Nom;&#10;      BYTE *pList;&#10;...">PWIA_PROPERTY_INFO</a> pwpi
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wiamdef/nf-wiamdef-wiassetitempropattribs">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/wiassetitempropattribs.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-wiamdef-wiassetitempropattribs)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2>Description</h2>

<p>The <em>wiasSetItemPropAttribs</em> function sets the access flags and valid values for an item's set of properties.</p>

<h2>Parameters</h2>

<h3><code>pWiasContext</code> [in]</h3>

<p>Pointer to a WIA item context.</p>

<h3><code>cPropSpec</code></h3>

<p>Specifies the number of properties.</p>

<h3><code>pPropSpec</code> [in]</h3>

<p>Pointer to the first element of an array of PROPSPEC structures (defined in the Microsoft Windows SDK documentation) indicating the properties for which to set valid values and access flags.</p>

<h3><code>pwpi</code> [in]</h3>

<p>Pointer to the first element of an array of <strong><a href="wia_property_info" title="typedef struct _WIA_PROPERTY_INFO {&#10;  ULONG   lAccessFlags;&#10;  VARTYPE vt;&#10;  union {&#10;    struct {&#10;      LONG Min;&#10;      LONG Nom;&#10;      LONG Max;&#10;      LONG Inc;&#10;    } Range;&#10;    struct {&#10;      DOUBLE Min;&#10;      DOUBLE Nom;&#10;      DOUBLE Max;&#10;      DOUBLE Inc;&#10;    } RangeFloat;&#10;    struct {&#10;      LONG cNumList;&#10;      LONG Nom;&#10;      BYTE *pList;&#10;...">WIA_PROPERTY_INFO</a></strong> structures that contain the property values to be written.</p>

<h2>Return value</h2>

<p>On success, the function returns S_OK. If the function fails, it returns a standard COM error or one of the WIA_ERROR_XXX errors (described in the Windows SDK documentation).</p>

<h2>Remarks</h2>

<p>Minidrivers should use this function to initialize groups of simple properties. The groups of properties can be bitsets, ranges of values, or lists of values. The supported simple types, grouped by attribute are as follows.</p>

<table>
<thead>
<tr>
  <th>Attributes</th>
  <th>Supported Types</th>
</tr>
</thead>
<tbody>
<tr>
  <td>WIA_PROP_FLAG</td>
  <td>VT_UI1, VT_UI2, VT_UI4, VT_UI8, VT_I1, VT_I2, VT_I4, VT_I8</td>
</tr>
<tr>
  <td>WIA_PROP_RANGE</td>
  <td>VT_UI1, VT_UI2, VT_UI4, VT_UI8, VT_I1, VT_I2, VT_I4, ,VT_I8, VT_R4, VT_R8</td>
</tr>
<tr>
  <td>WIA_PROP_LIST</td>
  <td>VT_UI1, VT_UI2, VT_UI4, VT_UI8, VT_I1, VT_I2, VT_I4, ,VT_I8, VT_R4, VT_R8, VT_BSTR</td>
</tr>
</tbody>
</table>

<p>Minidrivers should initialize complex properties using the <a href="wiassetpropertyattributes" title="HRESULT wiasSetPropertyAttributes(&#10;  [in]  BYTE        *pWiasContext,&#10;        LONG        cPropSpec,&#10;  [in]  PROPSPEC    *pPropSpec,&#10;  [in]  ULONG       *pulAccessFlags,&#10;  [out] PROPVARIANT *pPropVar&#10;);">wiasSetPropertyAttributes</a> function.</p>

<p>The minidriver can set the WIA_PROP_CACHEABLE flag on a property that does not change over time. By setting this flag on a property, the minidriver indicates that the WIA service can cache the property value. See the Windows SDK documentation for a list of all property attributes.</p>

<p>It is important to remember that <strong>wiasSetItemPropAttribs</strong> returns an HRESULT, not a BOOLEAN. For example, if <strong>wiasSetItemPropAttribs</strong> returns 0, this value must be interpreted as S_OK rather than <strong>FALSE</strong>, and indicates that everything worked as expected. If <strong>wiasSetItemPropAttribs</strong> returns the HRESULT S_FALSE, this indicates that one of the properties you are trying to set probably does not exist in the property stream.</p>

<p>To get a wiadebug log of this error, open the registry and turn on WIA logging for Warnings and Errors. The registry key for this is: <strong>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\StillImage\Debug\wiaservc.dll</strong></p>

<p>Set the value of "DebugFlags." to 0x00000003</p>

<p>Reboot the system and repeat the steps necessary to produce this error. There will now be a file named "wiadebug.log" in %windir% directory.</p>

<h2>See also</h2>

<p><strong><a href="wia_property_info" title="typedef struct _WIA_PROPERTY_INFO {&#10;  ULONG   lAccessFlags;&#10;  VARTYPE vt;&#10;  union {&#10;    struct {&#10;      LONG Min;&#10;      LONG Nom;&#10;      LONG Max;&#10;      LONG Inc;&#10;    } Range;&#10;    struct {&#10;      DOUBLE Min;&#10;      DOUBLE Nom;&#10;      DOUBLE Max;&#10;      DOUBLE Inc;&#10;    } RangeFloat;&#10;    struct {&#10;      LONG cNumList;&#10;      LONG Nom;&#10;      BYTE *pList;&#10;...">WIA_PROPERTY_INFO</a></strong></p>

<p><a href="wiassetitempropnames" title="HRESULT wiasSetItemPropNames(&#10;  [in]      BYTE     *pWiasContext,&#10;            LONG     cItemProps,&#10;  [in, out] PROPID   *ppId,&#10;  [in, out] LPOLESTR *ppszNames&#10;);">wiasSetItemPropNames</a></p>

<p><a href="wiassetpropertyattributes" title="HRESULT wiasSetPropertyAttributes(&#10;  [in]  BYTE        *pWiasContext,&#10;        LONG        cPropSpec,&#10;  [in]  PROPSPEC    *pPropSpec,&#10;  [in]  ULONG       *pulAccessFlags,&#10;  [out] PROPVARIANT *pPropVar&#10;);">wiasSetPropertyAttributes</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wiamdef/nf-wiamdef-wiassetitempropattribs">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wiamdef/nf-wiamdef-wiassetitempropattribs.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
