<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="KSPROPERTY_ITEM - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>KSPROPERTY_ITEM - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            KSPROPERTY_ITEM - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ks.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct {
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   PropertyId;
  union {
    <a href="pfnkshandler" title="PFNKSHANDLER Pfnkshandler;&#10;&#10;NTSTATUS Pfnkshandler(&#10;  [in]      PIRP Irp,&#10;  [in]      PKSIDENTIFIER Request,&#10;  [in, out] PVOID Data&#10;)&#10;{...}">PFNKSHANDLER</a> GetPropertyHandler;
    BOOLEAN      GetSupported;
  };
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   MinProperty;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   MinData;
  union {
    <a href="pfnkshandler" title="PFNKSHANDLER Pfnkshandler;&#10;&#10;NTSTATUS Pfnkshandler(&#10;  [in]      PIRP Irp,&#10;  [in]      PKSIDENTIFIER Request,&#10;  [in, out] PVOID Data&#10;)&#10;{...}">PFNKSHANDLER</a> SetPropertyHandler;
    BOOLEAN      SetSupported;
  };
  const <a href="ksproperty_values" title="typedef struct {&#10;  KSIDENTIFIER                 PropTypeSet;&#10;  ULONG                        MembersListCount;&#10;  const KSPROPERTY_MEMBERSLIST *MembersList;&#10;} KSPROPERTY_VALUES, *PKSPROPERTY_VALUES;">KSPROPERTY_VALUES</a> *Values;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   RelationsCount;
  const <a href="ksproperty" title="struct KSPROPERTY {&#10;  GUID Set;&#10;  ULONG Id;&#10;  ULONG Flags;&#10;};">KSPROPERTY</a>        *Relations;
  <a href="pfnkshandler" title="PFNKSHANDLER Pfnkshandler;&#10;&#10;NTSTATUS Pfnkshandler(&#10;  [in]      PIRP Irp,&#10;  [in]      PKSIDENTIFIER Request,&#10;  [in, out] PVOID Data&#10;)&#10;{...}">PFNKSHANDLER</a>            SupportHandler;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   SerializedSize;
} KSPROPERTY_ITEM, *PKSPROPERTY_ITEM;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/ns-ks-ksproperty_item">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ksproperty_item.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ks-ksproperty_item)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2>Description</h2>
<p>Drivers use the KSPROPERTY_ITEM structure to describe how they support a property in a property set.</p>
<h2>Members</h2>
<h3><code>PropertyId</code></h3>
<p>Specifies the ID of the property being described.</p>
<h3><code>GetPropertyHandler</code></h3>
<p>Pointer to a minidriver-supplied <a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/ff567177(v=vs.85)">KStrGetPropertyHandler</a>. If <strong>NULL</strong>, the property cannot be read. This member is used only by drivers that use the AVStream or Stream class interfaces.</p>
<h3><code>GetSupported</code></h3>
<p>Set to <strong>TRUE</strong> if this property supports get requests, <strong>FALSE</strong> if it does not. (The class driver fulfills the request through the SRB_GET_DEVICE_PROPERTY or SRB_GET_STREAM_PROPERTY requests.) This member is used only by minidrivers running under stream class.</p>
<h3><code>MinProperty</code></h3>
<p>Specifies the minimum buffer length to hold the property identifier. This must be at least <strong>sizeof</strong>(<strong><a href="ksproperty" title="struct KSPROPERTY {&#10;  GUID Set;&#10;  ULONG Id;&#10;  ULONG Flags;&#10;};">KSPROPERTY</a></strong>).</p>
<h3><code>MinData</code></h3>
<p>Specifies the minimum buffer length to hold the data read from or written to this property.</p>
<h3><code>SetPropertyHandler</code></h3>
<p>Pointer to a minidriver-supplied <a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/ff567200(v=vs.85)">KStrSetPropertyHandler</a>. If <strong>NULL</strong>, the property cannot be set. This member is used only by drivers that use the AVStream or Stream class interfaces.</p>
<h3><code>SetSupported</code></h3>
<p>Set to <strong>TRUE</strong> if this property supports set requests, <strong>FALSE</strong> if it does not. (The class driver fulfills the request through the SRB_SET_DEVICE_PROPERTY or SRB_SET_STREAM_PROPERTY requests.)</p>
<h3><code>Values</code></h3>
<p>Pointer to a structure of type <strong><a href="ksproperty_values" title="typedef struct {&#10;  KSIDENTIFIER                 PropTypeSet;&#10;  ULONG                        MembersListCount;&#10;  const KSPROPERTY_MEMBERSLIST *MembersList;&#10;} KSPROPERTY_VALUES, *PKSPROPERTY_VALUES;">KSPROPERTY_VALUES</a></strong>. Specifies the acceptable and/or default values for the property. These are the same as the values reported by a driver in response to an <a href="ioctl_ks_property" title="// CTL_CODE(0x002f, 0x000, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define IOCTL_KS_PROPERTY 0x002F0003">IOCTL_KS_PROPERTY</a> request with the KSPROPERTY_TYPE_BASICSUPPORT and KSPROPERTY_TYPE_DEFAULTVALUES flags set.</p>
<h3><code>RelationsCount</code></h3>
<p>Specifies the number of entries in the array pointed to by the <strong>Relations</strong> member.</p>
<h3><code>Relations</code></h3>
<p>Points to an array of <strong><a href="ksproperty" title="struct KSPROPERTY {&#10;  GUID Set;&#10;  ULONG Id;&#10;  ULONG Flags;&#10;};">KSPROPERTY</a></strong> structures representing properties related to this one. Two properties are considered related if changing one property may affect the value of the other property. The <strong>Flags</strong> member of each entry is unused.</p>
<h3><code>SupportHandler</code></h3>
<p>Provide this member only if implementing your own format for raw serialization or raw unserialization. Basic support queries, range queries, and relations queries are automatically handled by AVStream, which returns the relevant values from other members of this KSPROPERTY_ITEM structure.</p>
<h3><code>SerializedSize</code></h3>
<p>Specifies the size of the property when serialized in a KSPROPERTY_TYPE_SERIALIZESET request. This should be zero if the property cannot be serialized. See <a href="ksproperty" title="struct KSPROPERTY {&#10;  GUID Set;&#10;  ULONG Id;&#10;  ULONG Flags;&#10;};">KSPROPERTY</a> for more information.</p>
<h2>Remarks</h2>
<p>Stream class minidrivers use KSPROPERTY_ITEM to describe to the client how to fulfill property requests on each property within a set. Handling for the property set as a whole is specified in the <a href="ksproperty_set" title="typedef struct {&#10;  const GUID                *Set;&#10;  ULONG                     PropertiesCount;&#10;  const KSPROPERTY_ITEM     *PropertyItem;&#10;  ULONG                     FastIoCount;&#10;  const KSFASTPROPERTY_ITEM *FastIoTable;&#10;} KSPROPERTY_SET, *PKSPROPERTY_SET;">KSPROPERTY_SET</a> structure, which contains pointers to arrays of KSPROPERTY_ITEM structures.</p>
<p>The stream class driver handles property requests on behalf of the minidriver. When the stream class driver requires more information from the minidriver, it passes an SRB_XXX request to one of the minidriver's <strong>StrMiniReceiveXXXRequest</strong> routines. The stream class driver handles the different request types as listed in the following table.</p>
<table>
<thead>
<tr>
<th>Property request flags value</th>
<th>Response</th>
</tr>
</thead>
<tbody>
<tr>
<td>KSPROPERTY_TYPE_GET</td>
<td>If <strong>GetSupported</strong> is <strong>TRUE</strong>, the stream class driver submits an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/srb-get-device-property"><strong>SRB_GET_DEVICE_PROPERTY</strong></a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/srb-get-stream-property"><strong>SRB_GET_STREAM_PROPERTY</strong></a> request to the appropriate minidriver <strong>StrMiniReceiveXXXRequest</strong> routine.</td>
</tr>
<tr>
<td>KSPROPERTY_TYPE_SET</td>
<td>If <strong>SetSupported</strong> is <strong>TRUE</strong>, the stream class driver submits an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/srb-set-device-property"><strong>SRB_SET_DEVICE_PROPERTY</strong></a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/srb-set-stream-property"><strong>SRB_SET_STREAM_PROPERTY</strong></a> request to the appropriate minidriver <strong>StrMiniReceiveXXXRequest</strong> routine.</td>
</tr>
<tr>
<td>KSPROPERTY_TYPE_BASICSUPPORT</td>
<td>The stream class driver uses KSPROPERTY_ITEM to obtain the information necessary to fulfill this request. For example, to specify the data type and permitted ranges of the property data, they each use the <strong>Values</strong> member of this structure.</td>
</tr>
<tr>
<td>KSPROPERTY_TYPE_SETSUPPORT</td>
<td>The stream class driver completes the property request <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a> as <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> only if the driver supplies an entry for the property set within its <strong><a href="ksproperty_set" title="typedef struct {&#10;  const GUID                *Set;&#10;  ULONG                     PropertiesCount;&#10;  const KSPROPERTY_ITEM     *PropertyItem;&#10;  ULONG                     FastIoCount;&#10;  const KSFASTPROPERTY_ITEM *FastIoTable;&#10;} KSPROPERTY_SET, *PKSPROPERTY_SET;">KSPROPERTY_SET</a></strong> structure.</td>
</tr>
<tr>
<td>KSPROPERTY_TYPE_DEFAULTVALUES</td>
<td>The stream class driver uses the <strong>Values</strong> member of this structure to determine the default values for the property data.</td>
</tr>
<tr>
<td>KSPROPERTY_TYPE_RELATIONS</td>
<td>The stream class driver uses the <strong>Relations</strong> member to determine what properties are related to this property.</td>
</tr>
</tbody>
</table>
<p>If the client specifies KSPROPERTY_TYPE_DEFAULTVALUES, the driver uses the data buffer to return a description of its value type, including possibly its allowed range and default value. This flag is similar in result to KSPROPERTY_TYPE_BASICSUPPORT, except that any values returned are those that have been marked with KSPROPERTY_MEMBER_FLAG_DEFAULT in the <strong>Flags</strong> member of the structure <strong><a href="ksproperty_membersheader" title="typedef struct {&#10;  ULONG MembersFlags;&#10;  ULONG MembersSize;&#10;  ULONG MembersCount;&#10;  ULONG Flags;&#10;} KSPROPERTY_MEMBERSHEADER, *PKSPROPERTY_MEMBERSHEADER;">KSPROPERTY_MEMBERSHEADER</a></strong>.</p>
<p>For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/ks-properties">KS Properties</a>.</p>
<h2>See also</h2>
<p><strong><a href="ksproperty" title="struct KSPROPERTY {&#10;  GUID Set;&#10;  ULONG Id;&#10;  ULONG Flags;&#10;};">KSPROPERTY</a></strong></p>
<p><strong><a href="ksproperty_set" title="typedef struct {&#10;  const GUID                *Set;&#10;  ULONG                     PropertiesCount;&#10;  const KSPROPERTY_ITEM     *PropertyItem;&#10;  ULONG                     FastIoCount;&#10;  const KSFASTPROPERTY_ITEM *FastIoTable;&#10;} KSPROPERTY_SET, *PKSPROPERTY_SET;">KSPROPERTY_SET</a></strong></p>
<p><strong><a href="ksproperty_values" title="typedef struct {&#10;  KSIDENTIFIER                 PropTypeSet;&#10;  ULONG                        MembersListCount;&#10;  const KSPROPERTY_MEMBERSLIST *MembersList;&#10;} KSPROPERTY_VALUES, *PKSPROPERTY_VALUES;">KSPROPERTY_VALUES</a></strong></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/srb-get-device-property"><strong>SRB_GET_DEVICE_PROPERTY</strong></a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/srb-get-stream-property"><strong>SRB_GET_STREAM_PROPERTY</strong></a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/srb-set-device-property"><strong>SRB_SET_DEVICE_PROPERTY</strong></a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/srb-set-stream-property"><strong>SRB_SET_STREAM_PROPERTY</strong></a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/ns-ks-ksproperty_item">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ks/ns-ks-ksproperty_item.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
