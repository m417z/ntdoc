<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="SeSetSecurityDescriptorInfo - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>SeSetSecurityDescriptorInfo - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            SeSetSecurityDescriptorInfo - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntifs.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> SeSetSecurityDescriptorInfo(
  [in, optional] PVOID                 Object,
  [in]           PSECURITY_INFORMATION SecurityInformation,
                 PSECURITY_DESCRIPTOR  ModificationDescriptor,
  [in, out]      PSECURITY_DESCRIPTOR  *ObjectsSecurityDescriptor,
  [in]           <a href="pool_type" title="typedef enum _POOL_TYPE {&#10;    NonPagedPool,&#10;    NonPagedPoolExecute = NonPagedPool,&#10;    PagedPool,&#10;    NonPagedPoolMustSucceed = NonPagedPool + 2,&#10;    DontUseThisType,&#10;    NonPagedPoolCacheAligned = NonPagedPool + 4,&#10;    PagedPoolCacheAligned,&#10;    NonPagedPoolCacheAlignedMustS = NonPagedPool + 6,&#10;    MaxPoolType,&#10;    NonPagedPoolBase = 0,&#10;    NonPagedPoolBaseMustSucceed = NonPagedPoolBase + 2,&#10;    NonPagedPoolBaseCacheAligned = NonPagedPoolBase + 4,&#10;    NonPagedPoolBaseCacheAlignedMustS = NonPagedPoolBase + 6,&#10;    NonPagedPoolSession = 32,&#10;    PagedPoolSession = NonPagedPoolSession + 1,&#10;    NonPagedPoolMustSucceedSession = PagedPoolSession + 1,&#10;    DontUseThisTypeSession = NonPagedPoolMustSucceedSession + 1,&#10;    NonPagedPoolCacheAlignedSession = DontUseThisTypeSession + 1,&#10;    PagedPoolCacheAlignedSession = NonPagedPoolCacheAlignedSession + 1,&#10;...">POOL_TYPE</a>             PoolType,
  [in]           PGENERIC_MAPPING      GenericMapping
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-sesetsecuritydescriptorinfo">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/sesetsecuritydescriptorinfo.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ntifs-sesetsecuritydescriptorinfo)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>SeSetSecurityDescriptorInfo function</h1>
<h2>Description</h2>
<p>The <strong>SeSetSecurityDescriptorInfo</strong> routine sets an object's security descriptor.</p>
<h2>Parameters</h2>
<h3><code>Object</code> [in, optional]</h3>
<p>Pointer to the object whose security descriptor is to be set. This is used to update security quota information.</p>
<h3><code>SecurityInformation</code> [in]</h3>
<p>Pointer to a bitmask specifying which security information is to be applied to the object. Can be a combination of one or more of the following values.</p>
<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>DACL_SECURITY_INFORMATION</td>
  <td>Indicates the discretionary access control list (DACL) of the object is being set. Requires WRITE_DAC access.</td>
</tr>
<tr>
  <td>GROUP_SECURITY_INFORMATION</td>
  <td>Indicates the primary group identifier of the object is being set. Requires WRITE_OWNER access.</td>
</tr>
<tr>
  <td>OWNER_SECURITY_INFORMATION</td>
  <td>Indicates the owner identifier of the object is being set. Requires WRITE_OWNER access.</td>
</tr>
<tr>
  <td>SACL_SECURITY_INFORMATION</td>
  <td>Indicates the system <a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a> (SACL) of the object is being set. Requires ACCESS_SYSTEM_SECURITY access.</td>
</tr>
</tbody>
</table>
<h3><code>ModificationDescriptor</code></h3>
<p>The input security descriptor to be applied to the object. The caller of this routine is expected to probe and capture the passed security descriptor before calling <strong>SeSetSecurityDescriptorInfo</strong>, and to release it afterward.</p>
<h3><code>ObjectsSecurityDescriptor</code> [in, out]</h3>
<p>Pointer to a pointer to the object's security descriptor. The security descriptor must be in self-relative format. The caller is responsible for freeing this structure when it is no longer needed.</p>
<h3><code>PoolType</code> [in]</h3>
<p>Specifies the pool type to use when allocating a new security descriptor, which can be one of the following:</p>
<ul>
<li><strong>NonPagedPool</strong></li>
<li><strong>PagedPool</strong></li>
<li><strong>NonPagedPoolCacheAligned</strong></li>
<li><strong>PagedPoolCacheAligned</strong></li>
</ul>
<p>Usually, a caller specifies <strong>PagedPool</strong>, or else <strong>NonPagedPool</strong> if the buffer will be accessed at IRQL &gt;= DISPATCH_LEVEL or in an arbitrary thread context.</p>
<p>The <strong>NonPagedPoolMustSucceed</strong> and <strong>NonPagedPoolCacheAlignedMustS</strong> pool types are obsolete and should no longer be used.</p>
<h3><code>GenericMapping</code> [in]</h3>
<p>Pointer to a <a href="generic_mapping" title="typedef struct _GENERIC_MAPPING {&#10;  ACCESS_MASK GenericRead;&#10;  ACCESS_MASK GenericWrite;&#10;  ACCESS_MASK GenericExecute;&#10;  ACCESS_MASK GenericAll;&#10;} GENERIC_MAPPING;">GENERIC_MAPPING</a> structure that specifies the mapping of generic to specific and standard access types for the object being accessed. This mapping structure is expected to be safe to access (that is, captured if necessary) prior to be passed to this routine.</p>
<h2>Return value</h2>
<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a></td>
  <td>The object's security descriptor was successfully modified.</td>
</tr>
<tr>
  <td>STATUS_BAD_DESCRIPTOR_FORMAT</td>
  <td>The provided object's security descriptor was not in self-relative format.</td>
</tr>
<tr>
  <td>STATUS_NO_SECURITY_ON_OBJECT</td>
  <td>The object does not have a security descriptor.</td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p><strong>SeSetSecurityDescriptorInfo</strong> modifies an object's existing security descriptor. If the object does not have a security descriptor, the call to <strong>SeSetSecurityDescriptorInfo</strong> will fail.</p>
<p>To specify whether the object supports automatic inheritance of access control entries (ACE), use <strong><a href="sesetsecuritydescriptorinfoex" title="NTSTATUS SeSetSecurityDescriptorInfoEx(&#10;  [in, optional] PVOID                 Object,&#10;  [in]           PSECURITY_INFORMATION SecurityInformation,&#10;                 PSECURITY_DESCRIPTOR  ModificationDescriptor,&#10;  [in, out]      PSECURITY_DESCRIPTOR  *ObjectsSecurityDescriptor,&#10;  [in]           ULONG                 AutoInheritFlags,&#10;  [in]           POOL_TYPE             PoolType,&#10;  [in]           PGENERIC_MAPPING      GenericMapping&#10;);">SeSetSecurityDescriptorInfoEx</a></strong>.</p>
<p>A security descriptor can be in absolute or self-relative form. In self-relative form, all members of the structure are located contiguously in memory. In absolute form, the structure only contains pointers to the members.</p>
<p>For more information about security and access control, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/driversecurity/windows-security-model">Windows security model for driver developers</a> and the documentation on these topics in the Windows SDK.</p>
<h2>See also</h2>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ifs/ace"><strong>ACE</strong></a></p>
<p><strong><a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a></strong></p>
<p><strong><a href="generic_mapping" title="typedef struct _GENERIC_MAPPING {&#10;  ACCESS_MASK GenericRead;&#10;  ACCESS_MASK GenericWrite;&#10;  ACCESS_MASK GenericExecute;&#10;  ACCESS_MASK GenericAll;&#10;} GENERIC_MAPPING;">GENERIC_MAPPING</a></strong></p>
<p><strong><a href="rtlcreatesecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlCreateSecurityDescriptor(&#10;    _Out_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_ ULONG Revision&#10;    );">RtlCreateSecurityDescriptor</a></strong></p>
<p><strong><a href="rtlcreatesecuritydescriptorrelative" title="NTSYSAPI NTSTATUS RtlCreateSecurityDescriptorRelative(&#10;  [out] PISECURITY_DESCRIPTOR_RELATIVE SecurityDescriptor,&#10;  [in]  ULONG                          Revision&#10;);">RtlCreateSecurityDescriptorRelative</a></strong></p>
<p><strong><a href="rtllengthsecuritydescriptor" title="NTSYSAPI&#10;ULONG&#10;NTAPI&#10;RtlLengthSecurityDescriptor(&#10;    _In_ PSECURITY_DESCRIPTOR SecurityDescriptor&#10;    );">RtlLengthSecurityDescriptor</a></strong></p>
<p><strong><a href="rtlsetdaclsecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlSetDaclSecurityDescriptor(&#10;    _Inout_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_ BOOLEAN DaclPresent,&#10;    _In_opt_ PACL Dacl,&#10;    _In_ BOOLEAN DaclDefaulted&#10;    );">RtlSetDaclSecurityDescriptor</a></strong></p>
<p><strong><a href="rtlsetownersecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlSetOwnerSecurityDescriptor(&#10;    _Inout_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_opt_ PSID Owner,&#10;    _In_ BOOLEAN OwnerDefaulted&#10;    );">RtlSetOwnerSecurityDescriptor</a></strong></p>
<p><strong><a href="rtlvalidsecuritydescriptor" title="_Check_return_&#10;NTSYSAPI&#10;BOOLEAN&#10;NTAPI&#10;RtlValidSecurityDescriptor(&#10;    _In_ PSECURITY_DESCRIPTOR SecurityDescriptor&#10;    );">RtlValidSecurityDescriptor</a></strong></p>
<p><strong><a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a></strong></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ifs/security-information"><strong>SECURITY_INFORMATION</strong></a></p>
<p><strong><a href="sequerysecuritydescriptorinfo" title="NTSTATUS SeQuerySecurityDescriptorInfo(&#10;  [in]      PSECURITY_INFORMATION SecurityInformation,&#10;  [out]     PSECURITY_DESCRIPTOR  SecurityDescriptor,&#10;  [in, out] PULONG                Length,&#10;  [in, out] PSECURITY_DESCRIPTOR  *ObjectsSecurityDescriptor&#10;);">SeQuerySecurityDescriptorInfo</a></strong></p>
<p><strong><a href="sesetaccessstategenericmapping" title="VOID SeSetAccessStateGenericMapping(&#10;  [in, out] PACCESS_STATE    AccessState,&#10;  [in]      PGENERIC_MAPPING GenericMapping&#10;);">SeSetAccessStateGenericMapping</a></strong></p>
<p><strong><a href="sesetsecuritydescriptorinfoex" title="NTSTATUS SeSetSecurityDescriptorInfoEx(&#10;  [in, optional] PVOID                 Object,&#10;  [in]           PSECURITY_INFORMATION SecurityInformation,&#10;                 PSECURITY_DESCRIPTOR  ModificationDescriptor,&#10;  [in, out]      PSECURITY_DESCRIPTOR  *ObjectsSecurityDescriptor,&#10;  [in]           ULONG                 AutoInheritFlags,&#10;  [in]           POOL_TYPE             PoolType,&#10;  [in]           PGENERIC_MAPPING      GenericMapping&#10;);">SeSetSecurityDescriptorInfoEx</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-sesetsecuritydescriptorinfo">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntifs/nf-ntifs-sesetsecuritydescriptorinfo.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
