<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="SECURITY_IMPERSONATION_LEVEL - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>SECURITY_IMPERSONATION_LEVEL - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            SECURITY_IMPERSONATION_LEVEL - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef enum _SECURITY_IMPERSONATION_LEVEL {
  SecurityAnonymous,
  SecurityIdentification,
  SecurityImpersonation,
  SecurityDelegation
} SECURITY_IMPERSONATION_LEVEL, *PSECURITY_IMPERSONATION_LEVEL;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ne-wdm-_security_impersonation_level">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wudfddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef enum _SECURITY_IMPERSONATION_LEVEL {
  SecurityAnonymous,
  SecurityIdentification,
  SecurityImpersonation,
  SecurityDelegation
} SECURITY_IMPERSONATION_LEVEL;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wudfddi/ne-wudfddi-_security_impersonation_level">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/security_impersonation_level.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ne-wdm-_security_impersonation_level)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>_SECURITY_IMPERSONATION_LEVEL enumeration (wdm.h)</h1>
<h2>Description</h2>
<p>The <strong>SECURITY_IMPERSONATION_LEVEL</strong> enumeration type contains values that specify security impersonation levels. Security impersonation levels govern the degree to which a server process can act on behalf of a client process.</p>
<h2>Constants</h2>
<h3><code>SecurityAnonymous</code></h3>
<p>The server process cannot obtain identification information about the client and it cannot impersonate the client. It is defined with no value given, and thus, by ANSI C rules, defaults to a value of zero.</p>
<h3><code>SecurityIdentification</code></h3>
<p>The server process can obtain information about the client, such as security identifiers and privileges, but it cannot impersonate the client. This is useful for servers that export their own objects, for example, database products that export tables and views. Using the retrieved client-security information, the server can make access-validation decisions without being able to utilize other services using the client's security context.</p>
<h3><code>SecurityImpersonation</code></h3>
<p>The server process can impersonate the client's security context on its local system. The server cannot impersonate the client on remote systems.</p>
<h3><code>SecurityDelegation</code></h3>
<p>The server process can impersonate the client's security context on remote systems.</p>
<h2>Remarks</h2>
<p>Impersonation is the ability of a process to take on the security attributes of another process.</p>
<p>Be aware of the following derived types:</p>
<pre><code>#define DEFAULT_IMPERSONATION_LEVEL SecurityImpersonation
#define SECURITY_MAX_IMPERSONATION_LEVEL SecurityDelegation
#define SECURITY_MIN_IMPERSONATION_LEVEL SecurityAnonymous
</code></pre>
<h2>See also</h2>
<p><a href="luid" title="typedef struct _LUID {&#10;  DWORD LowPart;&#10;  LONG  HighPart;&#10;} LUID, *PLUID;">LUID</a></p>
<p><a href="luid_and_attributes" title="typedef struct _LUID_AND_ATTRIBUTES {&#10;  LUID  Luid;&#10;  ULONG Attributes;&#10;} LUID_AND_ATTRIBUTES, *PLUID_AND_ATTRIBUTES;">LUID_AND_ATTRIBUTES</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/hardware/drivers/ff551860(v=vs.85)">PRIVILEGE_SET</a></p>
<p><a href="psimpersonateclient" title="NTSTATUS PsImpersonateClient(&#10;  [in, out] PETHREAD                     Thread,&#10;  [in]      PACCESS_TOKEN                Token,&#10;  [in]      BOOLEAN                      CopyOnOpen,&#10;  [in]      BOOLEAN                      EffectiveOnly,&#10;  [in]      SECURITY_IMPERSONATION_LEVEL ImpersonationLevel&#10;);">PsImpersonateClient</a></p>
<p><a href="psreferenceimpersonationtoken" title="PACCESS_TOKEN PsReferenceImpersonationToken(&#10;  [in, out] PETHREAD                      Thread,&#10;  [out]     PBOOLEAN                      CopyOnOpen,&#10;  [out]     PBOOLEAN                      EffectiveOnly,&#10;  [out]     PSECURITY_IMPERSONATION_LEVEL ImpersonationLevel&#10;);">PsReferenceImpersonationToken</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/eprocess">SECURITY_SUBJECT_CONTEXT</a></p>
<p><a href="sid_and_attributes" title="typedef struct _SID_AND_ATTRIBUTES {&#10;#if ...&#10;  PISID Sid;&#10;#else&#10;  PSID  Sid;&#10;#endif&#10;  ULONG Attributes;&#10;} SID_AND_ATTRIBUTES, *PSID_AND_ATTRIBUTES;">SID_AND_ATTRIBUTES</a></p>
<p><a href="seaccesscheck" title="BOOLEAN SeAccessCheck(&#10;  [in]  PSECURITY_DESCRIPTOR      SecurityDescriptor,&#10;  [in]  PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,&#10;  [in]  BOOLEAN                   SubjectContextLocked,&#10;  [in]  ACCESS_MASK               DesiredAccess,&#10;  [in]  ACCESS_MASK               PreviouslyGrantedAccess,&#10;  [out] PPRIVILEGE_SET            *Privileges,&#10;  [in]  PGENERIC_MAPPING          GenericMapping,&#10;  [in]  KPROCESSOR_MODE           AccessMode,&#10;  [out] PACCESS_MASK              GrantedAccess,&#10;  [out] PNTSTATUS                 AccessStatus&#10;);">SeAccessCheck</a></p>
<p><a href="sequeryinformationtoken" title="NTSTATUS SeQueryInformationToken(&#10;  [in]  PACCESS_TOKEN           Token,&#10;  [in]  TOKEN_INFORMATION_CLASS TokenInformationClass,&#10;  [out] PVOID                   *TokenInformation&#10;);">SeQueryInformationToken</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/ff567055(v=vs.85)">ZwQueryInformationToken</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ne-wdm-_security_impersonation_level">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/ne-wdm-_security_impersonation_level.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ne-wudfddi-_security_impersonation_level)</h1>
</div>
<div class="ntdoc-description">
<h1>_SECURITY_IMPERSONATION_LEVEL enumeration (wudfddi.h)</h1>
<h2>Description</h2>
<p>[Applies to UMDF only]</p>
<p>The <strong>SECURITY_IMPERSONATION_LEVEL</strong> enumeration contains values that identify security impersonation levels.</p>
<h2>Constants</h2>
<h3><code>SecurityAnonymous</code></h3>
<p>The driver cannot impersonate or identify the client.</p>
<h3><code>SecurityIdentification</code></h3>
<p>The driver can obtain the identity and privileges of the client but cannot impersonate the client.</p>
<h3><code>SecurityImpersonation</code></h3>
<p>The driver can impersonate the client's security context on the local system.</p>
<h3><code>SecurityDelegation</code></h3>
<p>The driver can impersonate the client's security context on remote systems.</p>
<h2>Remarks</h2>
<p>For more information about impersonation in the UMDF, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/wdf/handling-client-impersonation-in-umdf-drivers">Handling Client Impersonation</a>.</p>
<p>A UMDF driver supplies one of the values of <strong>SECURITY_IMPERSONATION_LEVEL</strong> to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wudfddi/nf-wudfddi-iwdfiorequest-impersonate">IWDFIoRequest::Impersonate</a> method to set the security impersonation level.</p>
<p>For more information about the security impersonation levels, see the <strong>SECURITY_IMPERSONATION_LEVEL</strong> enumeration type in the Microsoft Windows SDK documentation.</p>
<h2>See also</h2>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wudfddi/nf-wudfddi-iwdfiorequest-impersonate">IWDFIoRequest::Impersonate</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wudfddi/ne-wudfddi-_security_impersonation_level">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wudfddi/ne-wudfddi-_security_impersonation_level.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
