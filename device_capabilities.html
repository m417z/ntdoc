<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="DEVICE_CAPABILITIES - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>DEVICE_CAPABILITIES - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            DEVICE_CAPABILITIES - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _DEVICE_CAPABILITIES {
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>             Size;
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>             Version;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              DeviceD1 : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              DeviceD2 : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              LockSupported : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              EjectSupported : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              Removable : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              DockDevice : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              UniqueID : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              SilentInstall : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              RawDeviceOK : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              SurpriseRemovalOK : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              WakeFromD0 : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              WakeFromD1 : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              WakeFromD2 : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              WakeFromD3 : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              HardwareDisabled : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              NonDynamic : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              WarmEjectSupported : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              NoDisplayInUI : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              Reserved1 : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              WakeFromInterrupt : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              SecureDevice : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              ChildOfVgaEnabledBridge : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              DecodeIoOnBoot : 1;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              Reserved : 9;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              Address;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              UINumber;
  <a href="device_power_state" title="typedef enum _DEVICE_POWER_STATE {&#10;  PowerDeviceUnspecified,&#10;  PowerDeviceD0,&#10;  PowerDeviceD1,&#10;  PowerDeviceD2,&#10;  PowerDeviceD3,&#10;  PowerDeviceMaximum&#10;} DEVICE_POWER_STATE, *PDEVICE_POWER_STATE;">DEVICE_POWER_STATE</a> DeviceState[POWER_SYSTEM_MAXIMUM];
  <a href="system_power_state" title="typedef enum _SYSTEM_POWER_STATE {&#10;  PowerSystemUnspecified,&#10;  PowerSystemWorking,&#10;  PowerSystemSleeping1,&#10;  PowerSystemSleeping2,&#10;  PowerSystemSleeping3,&#10;  PowerSystemHibernate,&#10;  PowerSystemShutdown,&#10;  PowerSystemMaximum&#10;} SYSTEM_POWER_STATE, *PSYSTEM_POWER_STATE;">SYSTEM_POWER_STATE</a> SystemWake;
  <a href="device_power_state" title="typedef enum _DEVICE_POWER_STATE {&#10;  PowerDeviceUnspecified,&#10;  PowerDeviceD0,&#10;  PowerDeviceD1,&#10;  PowerDeviceD2,&#10;  PowerDeviceD3,&#10;  PowerDeviceMaximum&#10;} DEVICE_POWER_STATE, *PDEVICE_POWER_STATE;">DEVICE_POWER_STATE</a> DeviceWake;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              D1Latency;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              D2Latency;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              D3Latency;
} DEVICE_CAPABILITIES, *PDEVICE_CAPABILITIES;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_device_capabilities">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/device_capabilities.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-wdm-_device_capabilities)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2>Description</h2>
<p>A <strong>DEVICE_CAPABILITIES</strong> structure describes PnP and power capabilities of a device. This structure is returned in response to an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/irp-mn-query-capabilities">IRP_MN_QUERY_CAPABILITIES</a> <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a>.</p>
<h2>Members</h2>
<h3><code>Size</code></h3>
<p>Specifies the size of the structure, in bytes. This field is set by the component that sends the <strong><a href="irp_mn_query_capabilities" title="#define IRP_MN_QUERY_CAPABILITIES 0x09">IRP_MN_QUERY_CAPABILITIES</a></strong> request.</p>
<h3><code>Version</code></h3>
<p>Specifies the version of the structure, currently version 1. This field is set by the component that sends the <strong><a href="irp_mn_query_capabilities" title="#define IRP_MN_QUERY_CAPABILITIES 0x09">IRP_MN_QUERY_CAPABILITIES</a></strong> request.</p>
<h3><code>DeviceD1</code></h3>
<p>Specifies whether the device hardware supports the D1 power state. Drivers should not change this value.</p>
<h3><code>DeviceD2</code></h3>
<p>Specifies whether the device hardware supports the D2 power state. Drivers should not change this value.</p>
<h3><code>LockSupported</code></h3>
<p>Specifies whether the device supports physical-device locking that prevents device ejection. This member pertains to ejecting the device from its slot, rather than ejecting a piece of removable media from the device.</p>
<h3><code>EjectSupported</code></h3>
<p>Specifies whether the device supports software-controlled device ejection while the system is in the <strong>PowerSystemWorking</strong> state. This member pertains to ejecting the device from its slot, rather than ejecting a piece of removable media from the device.</p>
<h3><code>Removable</code></h3>
<p>Specifies whether the device can be dynamically removed from its immediate parent. If <strong>Removable</strong> is set to <strong>TRUE</strong>, the device does not belong to the same physical object as its parent.</p>
<p>For example, if <strong>Removable</strong> is set to <strong>TRUE</strong> for a USB composite device inside a multifunction printer, the composite device does not belong to the physical object of its immediate parent, such as a USB hub inside a notebook PC.</p>
<p>In most cases the bus driver, not the function driver, should determine the value of the <strong>Removable</strong> parameter of the device. For USB devices, the USB hub driver sets the <strong>Removable</strong> parameter. It should not be modified by the function driver.</p>
<p>If <strong>Removable</strong> is set to <strong>TRUE</strong>, the device is displayed in the <strong>Unplug or Eject Hardware</strong> program, unless <strong>SurpriseRemovalOK</strong> is also set to <strong>TRUE</strong>.</p>
<h3><code>DockDevice</code></h3>
<p>Specifies whether the device is a docking peripheral.</p>
<h3><code>UniqueID</code></h3>
<p>Specifies whether the device's instance ID is unique system-wide. This bit is clear if the instance ID is unique only within the scope of the bus. For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/install/device-identification-strings">Device Identification Strings</a>.</p>
<h3><code>SilentInstall</code></h3>
<p>Specifies whether Device Manager should suppress all installation dialog boxes; except required dialog boxes such as &quot;no compatible drivers found.&quot;</p>
<h3><code>RawDeviceOK</code></h3>
<p>Specifies whether the driver for the underlying bus can drive the device if there is no function driver (for example, SCSI devices in pass-through mode). This mode of operation is called <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/">raw mode</a>.</p>
<h3><code>SurpriseRemovalOK</code></h3>
<p>Specifies whether the function driver for the device can handle the case where the device is removed before Windows can send <strong><a href="irp_mn_query_remove_device" title="#define IRP_MN_QUERY_REMOVE_DEVICE 0x01">IRP_MN_QUERY_REMOVE_DEVICE</a></strong> to it. If <strong>SurpriseRemovalOK</strong> is set to <strong>TRUE</strong>, the device can be safely removed from its immediate parent regardless of the state that its driver is in.</p>
<p>For example, a standard USB mouse does not maintain any state in its hardware and thus can be safely removed at any time. However, an external hard disk whose driver caches writes in memory cannot be safely removed without first letting the driver flush its cache to the hardware.</p>
<p>Drivers for USB devices that support surprise removal must set this to <strong>TRUE</strong> only when the <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a> is being passed back up the driver stack.</p>
<h3><code>WakeFromD0</code></h3>
<p>Specifies whether the device can respond to an external wake signal while in the D0 state. Drivers should not change this value.</p>
<h3><code>WakeFromD1</code></h3>
<p>Specifies whether the device can respond to an external wake signal while in the D1 state. Drivers should not change this value.</p>
<h3><code>WakeFromD2</code></h3>
<p>Specifies whether the device can respond to an external wake signal while in the D2 state. Drivers should not change this value.</p>
<h3><code>WakeFromD3</code></h3>
<p>Specifies whether the device can respond to an external wake signal while in the D3 state. Drivers should not change this value.</p>
<h3><code>HardwareDisabled</code></h3>
<p>When set, this flag specifies that the device's hardware is disabled.</p>
<p>A device's parent bus driver or a bus filter driver sets this flag when such a driver determines that the device hardware is disabled.</p>
<p>The PnP manager sends one <strong><a href="irp_mn_query_capabilities" title="#define IRP_MN_QUERY_CAPABILITIES 0x09">IRP_MN_QUERY_CAPABILITIES</a></strong> <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a> right after a device is enumerated and sends another after the device has been started. The PnP manager only checks this bit right after the device is enumerated. Once the device is started, this bit is ignored.</p>
<h3><code>NonDynamic</code></h3>
<p>Reserved for future use.</p>
<h3><code>WarmEjectSupported</code></h3>
<p>Reserved for future use.</p>
<h3><code>NoDisplayInUI</code></h3>
<p>Do not display the device in the user interface. If this bit is set, the device is never displayed in the user interface, even if the device is present but fails to start. Only bus drivers and associated bus filter drivers should set this bit. (Also see the <strong>PNP_DEVICE_DONT_DISPLAY_IN_UI</strong> flag in the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/handling-an-irp-mn-surprise-removal-request#about-pnp_device_state">PNP_DEVICE_STATE</a> structure.)</p>
<h3><code>Reserved1</code></h3>
<p>Reserved for system use.</p>
<h3><code>WakeFromInterrupt</code></h3>
<p>Indicates whether the driver or ACPI is responsible for handling the wake event. If set, the driver is responsible for handling the wake event. ACPI arms the device when it receives an <a href="irp_mn_wait_wake" title="#define IRP_MN_WAIT_WAKE 0x00">IRP_MN_WAIT_WAKE</a> <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a>, but does not connect the interrupt, complete the <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a> to notify the device stack of a wake event.</p>
<h3><code>SecureDevice</code></h3>
<p>Indicates whether the device is a secure device.</p>
<h3><code>ChildOfVgaEnabledBridge</code></h3>
<p>For a VGA device, indicates whether the parent bridge has the VGA decoding bit set.</p>
<h3><code>DecodeIoOnBoot</code></h3>
<p>Indicates whether the device has IO decode enabled on boot.</p>
<h3><code>Reserved</code></h3>
<p>Reserved for system use.</p>
<h3><code>Address</code></h3>
<p>Specifies an address indicating where the device is located on its underlying bus.</p>
<p>The interpretation of this number is bus-specific. If the address is unknown or the bus driver does not support an address, the bus driver leaves this member at its default value of 0xFFFFFFFF.</p>
<p>The following list describes the information certain bus drivers store in the <strong>Address</strong> field for their child devices:</p>
<table>
<thead>
<tr>
<th>Bus</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1394</td>
<td>Does not supply an address because the addresses are volatile. Defaults to 0xFFFFFFFF.</td>
</tr>
<tr>
<td>EISA</td>
<td>Slot Number (0-F).</td>
</tr>
<tr>
<td>IDE</td>
<td>For an IDE device, the address contains the target ID and LUN. For an IDE channel, the address is zero or one (0 = primary channel and 1 = secondary channel).</td>
</tr>
<tr>
<td>ISApnp</td>
<td>Does not supply an address. Defaults to 0xFFFFFFFF.</td>
</tr>
<tr>
<td>PC Card (PCMCIA)</td>
<td>The socket number (typically 0x00 or 0x40).</td>
</tr>
<tr>
<td>PCI</td>
<td>The device number in the high word and the function number in the low word.</td>
</tr>
<tr>
<td>SCSI</td>
<td>The target ID.</td>
</tr>
<tr>
<td>USB</td>
<td>The port number.</td>
</tr>
</tbody>
</table>
<h3><code>UINumber</code></h3>
<p>Specifies a number associated with the device that can be displayed in the user interface.</p>
<p>This number is typically a user-perceived slot number, such as a number printed next to the slot on the board, or some other number that makes locating the physical device easier for the user. For buses with no such convention, or when the <strong>UINumber</strong> is unknown, the bus driver leaves this member at its default value of 0xFFFFFFFF.</p>
<h3><code>DeviceState</code></h3>
<p>An array of values indicating the most-powered device power state that the device can maintain for each system power state. The <strong>DeviceState[PowerSystemWorking]</strong> element of the array corresponds to the S0 system state. The entry for <strong>PowerSystemUnspecified</strong> is reserved for system use.</p>
<p>The entries in this array are based on the capabilities of the parent devnode. As a general rule, a driver should not change these values. However, if necessary, a driver can lower the value, for example, from <strong>PowerDeviceD1</strong> to <strong>PowerDeviceD2</strong>.</p>
<p>If the bus driver is unable to determine the appropriate device power state for a root-enumerated device, it sets <strong>DeviceState[PowerSystemWorking]</strong> to <strong>PowerDeviceD0</strong> and all other entries to <strong>PowerDeviceD3</strong>.</p>
<h3><code>SystemWake</code></h3>
<p>Specifies the least-powered system power state from which the device can signal a wake event. A value of <strong>PowerSystemUnspecified</strong> indicates that the device cannot wake the system.</p>
<p>A bus driver can get this information from its parent devnode.</p>
<p>In general, a driver should not change this value. If necessary, however, a driver can raise the power state, for example, from <strong>PowerSystemHibernate</strong> to <strong>PowerSystemS1</strong>, to indicate that its device cannot wake the system from a hibernation state but can from a higher-powered sleep state.</p>
<h3><code>DeviceWake</code></h3>
<p>Specifies the least-powered device power state from which the device can signal a wake event. A value of <strong>PowerDeviceUnspecified</strong> indicates that the device cannot signal a wake event.</p>
<h3><code>D1Latency</code></h3>
<p>Specifies the device's approximate worst-case latency, in 100-microsecond units, for returning the device to the <strong>PowerDeviceD0</strong> state from the <strong>PowerDeviceD1</strong> state. Set to zero if the device does not support the D1 state.</p>
<h3><code>D2Latency</code></h3>
<p>Specifies the device's approximate worst-case latency, in 100-microsecond units, for returning the device to the <strong>PowerDeviceD0</strong> state from the <strong>PowerDeviceD2</strong> state. Set to zero if the device does not support the D2 state.</p>
<h3><code>D3Latency</code></h3>
<p>Specifies the device's approximate worst-case latency, in 100-microsecond units, for returning the device to the <strong>PowerDeviceD0</strong> state from the <strong>PowerDeviceD3</strong> state. Set to zero if the device does not support the D3 state.</p>
<h2>Remarks</h2>
<p>Bus drivers set the appropriate values in this structure in response to an <strong><a href="irp_mn_query_capabilities" title="#define IRP_MN_QUERY_CAPABILITIES 0x09">IRP_MN_QUERY_CAPABILITIES</a></strong> <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a>. Bus filter drivers, function drivers, and filter drivers might alter the capabilities set by the bus driver.</p>
<p>Drivers that send an <strong><a href="irp_mn_query_capabilities" title="#define IRP_MN_QUERY_CAPABILITIES 0x09">IRP_MN_QUERY_CAPABILITIES</a></strong> request must initialize the <strong>Size</strong>, <strong>Version</strong>, <strong>Address</strong>, and <strong>UINumber</strong> members of this structure before sending the <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a>.</p>
<p>For more information about using the <strong>DEVICE_CAPABILITIES</strong> structure to describe a device's power capabilities, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/reporting-device-power-capabilities">Reporting Device Power Capabilities</a>.</p>
<h2>See also</h2>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/irp-mn-query-capabilities">IRP_MN_QUERY_CAPABILITIES</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/handling-an-irp-mn-surprise-removal-request#about-pnp_device_state">PNP_DEVICE_STATE</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_device_capabilities">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/ns-wdm-_device_capabilities.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
