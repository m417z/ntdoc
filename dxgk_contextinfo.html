<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="DXGK_CONTEXTINFO - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>DXGK_CONTEXTINFO - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            DXGK_CONTEXTINFO - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dkmddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _DXGK_CONTEXTINFO {
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                  DmaBufferSize;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                  DmaBufferSegmentSet;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                  DmaBufferPrivateDataSize;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                  AllocationListSize;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                  PatchLocationListSize;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                  Reserved;
  <a href="dxgk_contextinfo_caps" title="typedef struct _DXGK_CONTEXTINFO_CAPS {&#10;  union {&#10;    struct {&#10;      UINT NoPatchingRequired : 1;&#10;      UINT DriverManagesResidency : 1;&#10;      UINT UseIoMmu : 1;&#10;      UINT Reserved : 29;&#10;    };&#10;    UINT Value;&#10;  };&#10;} DXGK_CONTEXTINFO_CAPS;">DXGK_CONTEXTINFO_CAPS</a> Caps;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                 PagingCompanionNodeId;
} DXGK_CONTEXTINFO;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/ns-d3dkmddi-_dxgk_contextinfo">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/dxgk_contextinfo.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-d3dkmddi-_dxgk_contextinfo)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_dxgk_contextinfo-structure">_DXGK_CONTEXTINFO structure</h1>

<h2 id="description">Description</h2>

<p>The DXGK_CONTEXTINFO structure describes a device context.</p>

<h2 id="members">Members</h2>

<h3 id="dmabuffersize"><code>DmaBufferSize</code></h3>

<p>The size, in bytes, of the buffer of hardware commands that is sent through direct memory access (DMA) to the graphics processing unit (GPU).</p>

<p>The DMA buffer can grow and shrink after the context is created; however, the DMA buffer can never shrink smaller than the starting size that <strong>DmaBufferSize</strong> specifies.</p>

<h3 id="dmabuffersegmentset"><code>DmaBufferSegmentSet</code></h3>

<p>The identifiers of the segments where the DMA buffer should be made accessible to the GPU.</p>

<h3 id="dmabufferprivatedatasize"><code>DmaBufferPrivateDataSize</code></h3>

<p>The size, in bytes, of the driver-resident private data structure that is associated with each DMA buffer. Memory for this private data structure is allocated from nonpaged pool. If the driver specifies zero in <strong>DmaBufferPrivateDataSize</strong>, no memory is allocated for the private data structure.</p>

<p>The private data structure that is associated with a DMA buffer is initialized to zero when the DMA buffer is created. During the lifetime of the DMA buffer, the video memory manager never accesses the private data structure that is associated with the DMA buffer.</p>

<h3 id="allocationlistsize"><code>AllocationListSize</code></h3>

<p>The starting number of elements in an array of allocations (that is, an array of <a href="dxgk_allocationlist" title="typedef struct _DXGK_ALLOCATIONLIST&#10;{&#10;    HANDLE              hDeviceSpecificAllocation;&#10;    struct&#10;    {&#10;        UINT            WriteOperation  : 1;    // 0x00000001&#10;        UINT            SegmentId       : 5;    // 0x0000002E&#10;        UINT            Reserved        : 26;   // 0xFFFFFFC0&#10;    };&#10;#if (DXGKDDI_INTERFACE_VERSION &gt;= DXGKDDI_INTERFACE_VERSION_WDDM2_0)&#10;    union&#10;    {&#10;        PHYSICAL_ADDRESS        PhysicalAddress;&#10;        D3DGPU_VIRTUAL_ADDRESS  VirtualAddress;&#10;    };&#10;#else // (DXGKDDI_INTERFACE_VERSION &lt; DXGKDDI_INTERFACE_VERSION_WDDM2_0)&#10;    PHYSICAL_ADDRESS    PhysicalAddress;&#10;#endif // (DXGKDDI_INTERFACE_VERSION &gt;= DXGKDDI_INTERFACE_VERSION_WDDM2_0)&#10;} DXGK_ALLOCATIONLIST;">DXGK_ALLOCATIONLIST</a> structures). This number is the starting number of allocations that the driver requests to be in the <strong>pAllocationList</strong> members of the <a href="dxgkarg_present" title="typedef struct _DXGKARG_PRESENT {&#10;  [out]    VOID                     *pDmaBuffer;&#10;  [in]     UINT                     DmaSize;&#10;  [in]     VOID                     *pDmaBufferPrivateData;&#10;  [in]     UINT                     DmaBufferPrivateDataSize;&#10;  union {&#10;    [in]     DXGK_ALLOCATIONLIST               *pAllocationList;&#10;    [in]     DXGK_PRESENTALLOCATIONINFO        *pAllocationInfo;&#10;    [in]     DXGK_PRESENTMULTIPLANEOVERLAYINFO *pPresentMultiPlaneOverlayInfo;&#10;  };&#10;#if ...&#10;  [in/out] D3DDDI_PATCHLOCATIONLIST *pPatchLocationListOut;&#10;#if ...&#10;  [in]     UINT                     PatchLocationListOutSize;&#10;  [in]     DXGK_ALLOCATIONLIST      *pAllocationList;&#10;#else&#10;  [in/out] D3DDDI_PATCHLOCATIONLIST *pPatchLocationListOut;&#10;#endif&#10;#else&#10;  [in]     UINT                     PatchLocationListOutSize;&#10;...">DXGKARG_PRESENT</a> and <a href="dxgkarg_render" title="typedef struct _DXGKARG_RENDER {&#10;  [in]     const VOID               *pCommand;&#10;  [in]     UINT                     CommandLength;&#10;  [out]    VOID                     *pDmaBuffer;&#10;  [in]     UINT                     DmaSize;&#10;  [in]     VOID                     *pDmaBufferPrivateData;&#10;  [in]     UINT                     DmaBufferPrivateDataSize;&#10;  [in]     DXGK_ALLOCATIONLIST      *pAllocationList;&#10;  [in]     UINT                     AllocationListSize;&#10;  [in]     D3DDDI_PATCHLOCATIONLIST *pPatchLocationListIn;&#10;  [in]     UINT                     PatchLocationListInSize;&#10;  [in/out] D3DDDI_PATCHLOCATIONLIST *pPatchLocationListOut;&#10;  [in]     UINT                     PatchLocationListOutSize;&#10;  [in/out] UINT                     MultipassOffset;&#10;  [in]     UINT                     DmaBufferSegmentId;&#10;  [in]     PHYSICAL_ADDRESS         DmaBufferPhysicalAddress;&#10;} DXGKARG_RENDER;">DXGKARG_RENDER</a> structures in calls to the driver's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_present">DxgkDdiPresent</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_render">DxgkDdiRender</a> functions, respectively.</p>

<p>The allocation list can grow and shrink after the context is created; however, the allocation list can never shrink smaller than the starting size that <strong>AllocationListSize</strong> specifies.</p>

<p><strong>Note</strong> If <a href="dxgk_createcontextflags" title="typedef struct _DXGK_CREATECONTEXTFLAGS {&#10;  union {&#10;    struct {&#10;      UINT SystemContext : 1;&#10;      UINT GdiContext : 1;&#10;      UINT VirtualAddressing : 1;&#10;      UINT SystemProtectedContext : 1;&#10;      UINT HwQueueSupported : 1;&#10;      UINT TestContext : 1;&#10;#if ...&#10;      UINT Reserved : 26;&#10;#elif&#10;      UINT Reserved : 27;&#10;#elif&#10;      UINT Reserved : 28;&#10;#elif&#10;      UINT Reserved : 29;&#10;#else&#10;      UINT Reserved : 30;&#10;#endif&#10;...">DXGK_CREATECONTEXTFLAGS</a>.<strong>GdiContext</strong> is set to 1, meaning that the context is created as a GDI-specific context, <strong>AllocationListSize</strong> must be set to a value of 256.</p>

<h3 id="patchlocationlistsize"><code>PatchLocationListSize</code></h3>

<p>The starting number of elements in an array of patch locations (that is, an array of <a href="d3dddi_patchlocationlist" title="typedef struct _D3DDDI_PATCHLOCATIONLIST {&#10;  [in]     UINT  AllocationIndex;&#10;  union {&#10;    struct {&#10;      UINT SlotId : 24;&#10;      UINT Reserved : 8;&#10;    };&#10;    [in]     UINT Value;&#10;  };&#10;  [in/out] UINT  DriverId;&#10;  [in/out] UINT  AllocationOffset;&#10;  [in/out] UINT  PatchOffset;&#10;  [in/out] UINT  SplitOffset;&#10;} D3DDDI_PATCHLOCATIONLIST;">D3DDDI_PATCHLOCATIONLIST</a> structures) for the device in user mode and kernel mode. This number is the starting number of patch locations that the driver requests to be in the <strong>pPatchLocationListIn</strong> members of the <a href="dxgkarg_render" title="typedef struct _DXGKARG_RENDER {&#10;  [in]     const VOID               *pCommand;&#10;  [in]     UINT                     CommandLength;&#10;  [out]    VOID                     *pDmaBuffer;&#10;  [in]     UINT                     DmaSize;&#10;  [in]     VOID                     *pDmaBufferPrivateData;&#10;  [in]     UINT                     DmaBufferPrivateDataSize;&#10;  [in]     DXGK_ALLOCATIONLIST      *pAllocationList;&#10;  [in]     UINT                     AllocationListSize;&#10;  [in]     D3DDDI_PATCHLOCATIONLIST *pPatchLocationListIn;&#10;  [in]     UINT                     PatchLocationListInSize;&#10;  [in/out] D3DDDI_PATCHLOCATIONLIST *pPatchLocationListOut;&#10;  [in]     UINT                     PatchLocationListOutSize;&#10;  [in/out] UINT                     MultipassOffset;&#10;  [in]     UINT                     DmaBufferSegmentId;&#10;  [in]     PHYSICAL_ADDRESS         DmaBufferPhysicalAddress;&#10;} DXGKARG_RENDER;">DXGKARG_RENDER</a> structures in calls to its <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_render">DxgkDdiRender</a> function.</p>

<p>The patch-location list can grow and shrink after the context is created; however, the patch-location list can never shrink smaller than the starting size that <strong>PatchLocationListSize</strong> specifies.</p>

<h3 id="reserved"><code>Reserved</code></h3>

<p>This member is reserved and should be set to zero.</p>

<p>This member is available beginning with Windows 7.</p>

<h3 id="caps"><code>Caps</code></h3>

<p>Describes optional features supported by the context.</p>

<p>Supported starting with Windows 10.</p>

<h3 id="pagingcompanionnodeid"><code>PagingCompanionNodeId</code></h3>

<p>Specifies the zero-based engine identifier of the engine to use for this context paging companion.</p>

<p>Supported starting with Windows 10.</p>

<h2 id="remarks">Remarks</h2>

<p>A display miniport driver specifies values for the <strong>DmaBufferSize</strong> and <strong>AllocationListSize</strong> members to guarantee that:</p>

<ul>
<li>The Microsoft DirectX graphics subsystem can use only one direct memory access (DMA) buffer to display (by using the display miniport driver's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_present">DxgkDdiPresent</a> function) at least one <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/windef/ns-windef-rect">RECT</a> structure for all scenarios.</li>
<li>The sizes of DMA and allocation-list buffers are large enough to hold at least one command that cannot be split across multiple buffers.</li>
<li>The sizes of DMA and allocation-list buffers are large enough to avoid setup and DMA overhead.</li>
</ul>

<p>The display miniport driver can specify only aperture segments in the <strong>DmaBufferSegmentSet</strong> member; if the driver specifies a memory segment, a context-creation failure occurs.</p>

<p>If the driver sets <strong>DmaBufferSegmentSet</strong> to 0, the video memory manager allocates contiguous paged-locked memory, which is mapped write-combined memory, for the DMA buffers. Therefore, the GPU must access DMA buffers by using PCI cycles on computers where AGP transfers that occur outside the AGP aperture are not permitted.</p>

<h2 id="see-also">See also</h2>

<p><a href="d3dddi_patchlocationlist" title="typedef struct _D3DDDI_PATCHLOCATIONLIST {&#10;  [in]     UINT  AllocationIndex;&#10;  union {&#10;    struct {&#10;      UINT SlotId : 24;&#10;      UINT Reserved : 8;&#10;    };&#10;    [in]     UINT Value;&#10;  };&#10;  [in/out] UINT  DriverId;&#10;  [in/out] UINT  AllocationOffset;&#10;  [in/out] UINT  PatchOffset;&#10;  [in/out] UINT  SplitOffset;&#10;} D3DDDI_PATCHLOCATIONLIST;">D3DDDI_PATCHLOCATIONLIST</a></p>

<p><a href="dxgkarg_createcontext" title="typedef struct _DXGKARG_CREATECONTEXT {&#10;  [out] HANDLE                  hContext;&#10;  [in]  UINT                    NodeOrdinal;&#10;  [in]  UINT                    EngineAffinity;&#10;  [in]  DXGK_CREATECONTEXTFLAGS Flags;&#10;  [in]  VOID                    *pPrivateDriverData;&#10;  [in]  UINT                    PrivateDriverDataSize;&#10;  [out] DXGK_CONTEXTINFO        ContextInfo;&#10;} DXGKARG_CREATECONTEXT;">DXGKARG_CREATECONTEXT</a></p>

<p><a href="dxgkarg_present" title="typedef struct _DXGKARG_PRESENT {&#10;  [out]    VOID                     *pDmaBuffer;&#10;  [in]     UINT                     DmaSize;&#10;  [in]     VOID                     *pDmaBufferPrivateData;&#10;  [in]     UINT                     DmaBufferPrivateDataSize;&#10;  union {&#10;    [in]     DXGK_ALLOCATIONLIST               *pAllocationList;&#10;    [in]     DXGK_PRESENTALLOCATIONINFO        *pAllocationInfo;&#10;    [in]     DXGK_PRESENTMULTIPLANEOVERLAYINFO *pPresentMultiPlaneOverlayInfo;&#10;  };&#10;#if ...&#10;  [in/out] D3DDDI_PATCHLOCATIONLIST *pPatchLocationListOut;&#10;#if ...&#10;  [in]     UINT                     PatchLocationListOutSize;&#10;  [in]     DXGK_ALLOCATIONLIST      *pAllocationList;&#10;#else&#10;  [in/out] D3DDDI_PATCHLOCATIONLIST *pPatchLocationListOut;&#10;#endif&#10;#else&#10;  [in]     UINT                     PatchLocationListOutSize;&#10;...">DXGKARG_PRESENT</a></p>

<p><a href="dxgkarg_render" title="typedef struct _DXGKARG_RENDER {&#10;  [in]     const VOID               *pCommand;&#10;  [in]     UINT                     CommandLength;&#10;  [out]    VOID                     *pDmaBuffer;&#10;  [in]     UINT                     DmaSize;&#10;  [in]     VOID                     *pDmaBufferPrivateData;&#10;  [in]     UINT                     DmaBufferPrivateDataSize;&#10;  [in]     DXGK_ALLOCATIONLIST      *pAllocationList;&#10;  [in]     UINT                     AllocationListSize;&#10;  [in]     D3DDDI_PATCHLOCATIONLIST *pPatchLocationListIn;&#10;  [in]     UINT                     PatchLocationListInSize;&#10;  [in/out] D3DDDI_PATCHLOCATIONLIST *pPatchLocationListOut;&#10;  [in]     UINT                     PatchLocationListOutSize;&#10;  [in/out] UINT                     MultipassOffset;&#10;  [in]     UINT                     DmaBufferSegmentId;&#10;  [in]     PHYSICAL_ADDRESS         DmaBufferPhysicalAddress;&#10;} DXGKARG_RENDER;">DXGKARG_RENDER</a></p>

<p><a href="dxgk_allocationlist" title="typedef struct _DXGK_ALLOCATIONLIST&#10;{&#10;    HANDLE              hDeviceSpecificAllocation;&#10;    struct&#10;    {&#10;        UINT            WriteOperation  : 1;    // 0x00000001&#10;        UINT            SegmentId       : 5;    // 0x0000002E&#10;        UINT            Reserved        : 26;   // 0xFFFFFFC0&#10;    };&#10;#if (DXGKDDI_INTERFACE_VERSION &gt;= DXGKDDI_INTERFACE_VERSION_WDDM2_0)&#10;    union&#10;    {&#10;        PHYSICAL_ADDRESS        PhysicalAddress;&#10;        D3DGPU_VIRTUAL_ADDRESS  VirtualAddress;&#10;    };&#10;#else // (DXGKDDI_INTERFACE_VERSION &lt; DXGKDDI_INTERFACE_VERSION_WDDM2_0)&#10;    PHYSICAL_ADDRESS    PhysicalAddress;&#10;#endif // (DXGKDDI_INTERFACE_VERSION &gt;= DXGKDDI_INTERFACE_VERSION_WDDM2_0)&#10;} DXGK_ALLOCATIONLIST;">DXGK_ALLOCATIONLIST</a></p>

<p><a href="dxgk_createcontextflags" title="typedef struct _DXGK_CREATECONTEXTFLAGS {&#10;  union {&#10;    struct {&#10;      UINT SystemContext : 1;&#10;      UINT GdiContext : 1;&#10;      UINT VirtualAddressing : 1;&#10;      UINT SystemProtectedContext : 1;&#10;      UINT HwQueueSupported : 1;&#10;      UINT TestContext : 1;&#10;#if ...&#10;      UINT Reserved : 26;&#10;#elif&#10;      UINT Reserved : 27;&#10;#elif&#10;      UINT Reserved : 28;&#10;#elif&#10;      UINT Reserved : 29;&#10;#else&#10;      UINT Reserved : 30;&#10;#endif&#10;...">DXGK_CREATECONTEXTFLAGS</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_present">DxgkDdiPresent</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_render">DxgkDdiRender</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/windef/ns-windef-rect">RECT</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/ns-d3dkmddi-_dxgk_contextinfo">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dkmddi/ns-d3dkmddi-_dxgk_contextinfo.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
