<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// usbioctl.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">// <a href="ctl_code" title="void CTL_CODE(&#10;  DeviceType,&#10;  Function,&#10;  Method,&#10;  Access&#10;);">CTL_CODE</a>(0x0022, 0x116, METHOD_BUFFERED, FILE_ANY_ACCESS)
#define IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES 0x00220458</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/usbioctl/ni-usbioctl-ioctl_usb_get_port_connector_properties">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ioctl_usb_get_port_connector_properties.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ni-usbioctl-ioctl_usb_get_port_connector_properties)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="ioctl_usb_get_port_connector_properties-ioctl">IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES IOCTL</h1>

<h2 id="description">Description</h2>

<p>The <strong>IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES</strong> I/O control request is sent by an application to retrieve information about a specific port on a USB hub.</p>

<p><strong>IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES</strong> is a user-mode I/O control request. This request targets the Universal Serial Bus (USB) hub device (GUID_DEVINTERFACE_USB_HUB).</p>

<h2 id="parameters">Parameters</h2>

<h3 id="major-code">Major code</h3>

<h3 id="input-buffer">Input buffer</h3>

<p><strong>AssociatedIrp.SystemBuffer</strong> points to a caller-allocated <a href="usb_port_connector_properties" title="typedef struct _USB_PORT_CONNECTOR_PROPERTIES {&#10;  ULONG               ConnectionIndex;&#10;  ULONG               ActualLength;&#10;  USB_PORT_PROPERTIES UsbPortProperties;&#10;  USHORT              CompanionIndex;&#10;  USHORT              CompanionPortNumber;&#10;  WCHAR               CompanionHubSymbolicLinkName[1];&#10;} USB_PORT_CONNECTOR_PROPERTIES, *PUSB_PORT_CONNECTOR_PROPERTIES;">USB_PORT_CONNECTOR_PROPERTIES</a> structure. The caller must set the structure members as follows:</p>

<ul>
<li>The caller must specify the port number of the port being queried in the <strong>ConnectionIndex</strong> member. <strong>ConnectionIndex</strong> must be a value in the range of 1 to <em>n</em>, where <em>n</em> is the highest port number retrieved in a previous <a href="ioctl_usb_get_hub_information_ex" title="// CTL_CODE(0x0022, 0x115, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_USB_GET_HUB_INFORMATION_EX 0x00220454">IOCTL_USB_GET_HUB_INFORMATION_EX</a> I/O control request.</li>
<li><p>The caller must specify the <strong>CompanionIndex</strong> member. For a SuperSpeed hub, the caller must set the <strong>CompanionIndex</strong> member to 0.</p>

<p>The caller can use <strong>CompanionIndex</strong> to get port numbers associated with the port being queried. If more than one companion port is associated with the port, to get all port numbers, the application can send the request in a loop. Start with <strong>CompanionIndex</strong> set to 0 and increment the <strong>CompanionIndex</strong> value in each iteration until the request completes with <strong>CompanionPortNumber</strong> set to 0 and <strong>CompanionHubSymbolicLinkName</strong> is NULL.</p></li>
</ul>

<h3 id="input-buffer-length">Input buffer length</h3>

<p>The <strong>Parameters.DeviceIoControl.InputBufferLength</strong> member indicates the size, in bytes, of the caller-allocated buffer pointed to by <strong>AssociatedIrp.SystemBuffer</strong>. For more information see Remarks.</p>

<h3 id="output-buffer">Output buffer</h3>

<p>On output, <a href="usb_port_connector_properties" title="typedef struct _USB_PORT_CONNECTOR_PROPERTIES {&#10;  ULONG               ConnectionIndex;&#10;  ULONG               ActualLength;&#10;  USB_PORT_PROPERTIES UsbPortProperties;&#10;  USHORT              CompanionIndex;&#10;  USHORT              CompanionPortNumber;&#10;  WCHAR               CompanionHubSymbolicLinkName[1];&#10;} USB_PORT_CONNECTOR_PROPERTIES, *PUSB_PORT_CONNECTOR_PROPERTIES;">USB_PORT_CONNECTOR_PROPERTIES</a>, pointed to by <strong>AssociatedIrp.SystemBuffer</strong>, is filled with information about the physical connector associated with the port.</p>

<h3 id="output-buffer-length">Output buffer length</h3>

<p>The <strong>Parameters.DeviceIoControl.OutputBufferLength</strong> member indicates the size, in bytes, of the output buffer <strong>SystemBuffer</strong>.</p>

<h3 id="inputoutput-buffer">Input/output buffer</h3>

<h3 id="inputoutput-buffer-length">Input/output buffer length</h3>

<h3 id="status-block">Status block</h3>

<p>The USB stack sets <strong>Irp->IoStatus.Status</strong> to <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the request is successful. Otherwise, the USB stack sets **Status** to the appropriate error condition, such as STATUS_INVALID_PARAMETER or STATUS_INSUFFICIENT_RESOURCES. If the hub has not been started or is not functional, the request returns STATUS_UNSUCCESSFUL.</p>

<h2 id="remarks">Remarks</h2>

<p>The caller must supply a buffer that is large enough to hold a <a href="usb_port_connector_properties" title="typedef struct _USB_PORT_CONNECTOR_PROPERTIES {&#10;  ULONG               ConnectionIndex;&#10;  ULONG               ActualLength;&#10;  USB_PORT_PROPERTIES UsbPortProperties;&#10;  USHORT              CompanionIndex;&#10;  USHORT              CompanionPortNumber;&#10;  WCHAR               CompanionHubSymbolicLinkName[1];&#10;} USB_PORT_CONNECTOR_PROPERTIES, *PUSB_PORT_CONNECTOR_PROPERTIES;">USB_PORT_CONNECTOR_PROPERTIES</a> structure and the symbolic link name of a companion hub, if such a hub is associated with the specified port. To obtain the size of the buffer to allocate, the caller must send a <strong>IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES</strong> request. In the request, <strong>AssociatedIrp.SystemBuffer</strong> must be a caller-allocated <strong><a href="usb_port_connector_properties" title="typedef struct _USB_PORT_CONNECTOR_PROPERTIES {&#10;  ULONG               ConnectionIndex;&#10;  ULONG               ActualLength;&#10;  USB_PORT_PROPERTIES UsbPortProperties;&#10;  USHORT              CompanionIndex;&#10;  USHORT              CompanionPortNumber;&#10;  WCHAR               CompanionHubSymbolicLinkName[1];&#10;} USB_PORT_CONNECTOR_PROPERTIES, *PUSB_PORT_CONNECTOR_PROPERTIES;">USB_PORT_CONNECTOR_PROPERTIES</a></strong> structure and <strong>Parameters.DeviceIoControl.InputBufferLength</strong> must be <code>sizeof(<a href="usb_port_connector_properties" title="typedef struct _USB_PORT_CONNECTOR_PROPERTIES {&#10;  ULONG               ConnectionIndex;&#10;  ULONG               ActualLength;&#10;  USB_PORT_PROPERTIES UsbPortProperties;&#10;  USHORT              CompanionIndex;&#10;  USHORT              CompanionPortNumber;&#10;  WCHAR               CompanionHubSymbolicLinkName[1];&#10;} USB_PORT_CONNECTOR_PROPERTIES, *PUSB_PORT_CONNECTOR_PROPERTIES;">USB_PORT_CONNECTOR_PROPERTIES</a>)</code>. Upon successful completion, the <strong>ActualLength</strong> member of <strong><a href="usb_port_connector_properties" title="typedef struct _USB_PORT_CONNECTOR_PROPERTIES {&#10;  ULONG               ConnectionIndex;&#10;  ULONG               ActualLength;&#10;  USB_PORT_PROPERTIES UsbPortProperties;&#10;  USHORT              CompanionIndex;&#10;  USHORT              CompanionPortNumber;&#10;  WCHAR               CompanionHubSymbolicLinkName[1];&#10;} USB_PORT_CONNECTOR_PROPERTIES, *PUSB_PORT_CONNECTOR_PROPERTIES;">USB_PORT_CONNECTOR_PROPERTIES</a></strong> indicates the actual size of the buffer. If a symbolic link name exists, the received value includes the size of the string that stores the link name.</p>

<p>Based on the <strong>ActualLength</strong> value, the caller can then allocate a buffer and send the <strong>IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES</strong> request again. After the request completes, the buffer is filled with port information and the <strong>CompanionHubSymbolicLinkName</strong> member is a Unicode string that contains the symbolic link name of the companion hub.</p>

<h2 id="see-also">See also</h2>

<p>IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES</p>

<p><a href="usb_hub_information_ex" title="typedef struct _USB_HUB_INFORMATION_EX {&#10;  USB_HUB_TYPE HubType;&#10;  USHORT       HighestPortNumber;&#10;  union {&#10;    USB_HUB_DESCRIPTOR    UsbHubDescriptor;&#10;    USB_30_HUB_DESCRIPTOR Usb30HubDescriptor;&#10;  } u;&#10;} USB_HUB_INFORMATION_EX, *PUSB_HUB_INFORMATION_EX;">USB_HUB_INFORMATION_EX</a></p>

<p><a href="usb_port_connector_properties" title="typedef struct _USB_PORT_CONNECTOR_PROPERTIES {&#10;  ULONG               ConnectionIndex;&#10;  ULONG               ActualLength;&#10;  USB_PORT_PROPERTIES UsbPortProperties;&#10;  USHORT              CompanionIndex;&#10;  USHORT              CompanionPortNumber;&#10;  WCHAR               CompanionHubSymbolicLinkName[1];&#10;} USB_PORT_CONNECTOR_PROPERTIES, *PUSB_PORT_CONNECTOR_PROPERTIES;">USB_PORT_CONNECTOR_PROPERTIES</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/usbioctl/ni-usbioctl-ioctl_usb_get_port_connector_properties">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/usbioctl/ni-usbioctl-ioctl_usb_get_port_connector_properties.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
