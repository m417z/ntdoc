<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NdisClOpenAddressFamilyEx - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NdisClOpenAddressFamilyEx - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NdisClOpenAddressFamilyEx - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NDIS_STATUS NdisClOpenAddressFamilyEx(
  [in]  NDIS_HANDLE        NdisBindingHandle,
  [in]  PCO_ADDRESS_FAMILY AddressFamily,
  [in]  NDIS_HANDLE        ClientAfContext,
  [out] PNDIS_HANDLE       NdisAfHandle
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndisclopenaddressfamilyex">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndisclopenaddressfamilyex.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ndis-ndisclopenaddressfamilyex)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="ndisclopenaddressfamilyex-function">NdisClOpenAddressFamilyEx function</h1>

<h2 id="description">Description</h2>

<p>The
<strong>NdisClOpenAddressFamilyEx</strong> function registers an address family (AF) that is associated with a call
manager for a connection-oriented client.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="ndisbindinghandle-in"><code>NdisBindingHandle</code> [in]</h3>

<p>The handle that
<a rel="noopener" target="_blank" href="ndisopenadapterex">NdisOpenAdapterEx</a> returns and that
identifies the target network interface card (NIC) or the virtual adapter of the next-lower driver that
the caller is bound to.</p>

<h3 id="addressfamily-in"><code>AddressFamily</code> [in]</h3>

<p>A pointer to a
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/hardware/network/ff545368(v=vs.85)">CO_ADDRESS_FAMILY</a> structure that describes
the call manager and AF to be opened.</p>

<p>This pointer is an input parameter to the client's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_af_register_notify">ProtocolCoAfRegisterNotify</a> function, which calls
<strong>NdisClOpenAddressFamilyEx</strong>.</p>

<h3 id="clientafcontext-in"><code>ClientAfContext</code> [in]</h3>

<p>The handle to a caller-supplied resident context area in which the client maintains state for this
AF after the AF has been opened. NDIS passes this handle back to the client in all subsequent calls
concerning this AF if the call to
<strong>NdisClOpenAddressFamilyEx</strong> succeeds.</p>

<h3 id="ndisafhandle-out"><code>NdisAfHandle</code> [out]</h3>

<p>A pointer to a caller-supplied variable in which
<strong>NdisClOpenAddressFamilyEx</strong> returns a handle that represents the newly opened address family.</p>

<h2 id="return-value">Return value</h2>

<p>When
<strong>NdisClOpenAddressFamilyEx</strong> returns anything other than NDIS_STATUS_PENDING, the client should make
an internal call to its
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cl_open_af_complete_ex">ProtocolClOpenAfCompleteEx</a> function. Otherwise, NDIS calls the client's
<em>ProtocolClOpenAfCompleteEx</em> function when this operation is completed.</p>

<h2 id="remarks">Remarks</h2>

<p>A CoNDIS client calls
<strong>NdisClOpenAddressFamilyEx</strong> from its
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_af_register_notify">ProtocolCoAfRegisterNotify</a> function, after the client checks the input buffer that is pointed to by
the
<em>AddressFamily</em> parameter to determine whether the client recognizes the call manager and registered
addresses. NDIS forwards the client's call of
<strong>NdisClOpenAddressFamilyEx</strong> to the call manager's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cm_open_af">ProtocolCmOpenAf</a> function, which
ensures that the client has passed in a valid AF structure.</p>

<p>A successful call to
<strong>NdisClOpenAddressFamilyEx</strong> sets up communication from the client to a call manager. The client can
then prepare to receive incoming calls by calling the
<a rel="noopener" target="_blank" href="ndisclregistersap">NdisClRegisterSap</a> function. The client
can also set up a virtual connection (VC) by calling the
<a rel="noopener" target="_blank" href="ndiscocreatevc">NdisCoCreateVc</a> function so it can make an
outgoing call by calling the
<a rel="noopener" target="_blank" href="ndisclmakecall">NdisClMakeCall</a> function.</p>

<p>If the client's call to
<strong>NdisClOpenAddressFamilyEx</strong> fails, the client should call the
<a rel="noopener" target="_blank" href="ndisunbindadapter">NdisUnbindAdapter</a> function to request
NDIS to release its binding to the underlying miniport adapter. Otherwise, the client must save the
handle that is returned at the
<em>NdisAfHandle</em> parameter. This handle identifies the call manager to which subsequent requests concerning the given address
family are directed. The client must treat this returned handle as an opaque variable, passing it
unmodified and uninterpreted in subsequent
<strong>Ndis<em>Xxx</em></strong> function calls.</p>

<p>NDIS passes the pointer from the
<em>ClientAfContext</em> parameter to the client's registered
<em>ProtocolClXxx</em> functions in all subsequent calls that concern the AF until the client calls
<strong><a href="ndisclcloseaddressfamily" title="NDIS_STATUS NdisClCloseAddressFamily(&#10;  [in] NDIS_HANDLE NdisAfHandle&#10;);">NdisClCloseAddressFamily</a></strong> with the same
<em>NdisAfHandle</em> . After the AF is closed, the client can release or reuse the storage that it
allocated at
<em>ClientAfContext</em> .</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/hardware/network/ff545368(v=vs.85)">CO_ADDRESS_FAMILY</a></p>

<p><a rel="noopener" target="_blank" href="ndisallocatefromnpagedlookasidelist">NdisAllocateFromNPagedLookasideList</a></p>

<p><a rel="noopener" target="_blank" href="ndisclcloseaddressfamily">NdisClCloseAddressFamily</a></p>

<p><a rel="noopener" target="_blank" href="ndisclmakecall">NdisClMakeCall</a></p>

<p><a rel="noopener" target="_blank" href="ndisclregistersap">NdisClRegisterSap</a></p>

<p><a rel="noopener" target="_blank" href="ndiscocreatevc">NdisCoCreateVc</a></p>

<p><a rel="noopener" target="_blank" href="ndisopenadapterex">NdisOpenAdapterEx</a></p>

<p><a rel="noopener" target="_blank" href="ndisunbindadapter">NdisUnbindAdapter</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cl_open_af_complete_ex">ProtocolClOpenAfCompleteEx</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cm_open_af">ProtocolCmOpenAf</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_co_af_register_notify">ProtocolCoAfRegisterNotify</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndisclopenaddressfamilyex">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ndis/nf-ndis-ndisclopenaddressfamilyex.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
