<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="StorPortLogSystemEvent - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>StorPortLogSystemEvent - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            StorPortLogSystemEvent - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// storport.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> StorPortLogSystemEvent(
  [in]      PVOID                   HwDeviceExtension,
  [in, out] <a href="stor_log_event_details" title="typedef struct _STOR_LOG_EVENT_DETAILS {&#10;  ULONG                       InterfaceRevision;&#10;  ULONG                       Size;&#10;  ULONG                       Flags;&#10;  STOR_EVENT_ASSOCIATION_ENUM EventAssociation;&#10;  ULONG                       PathId;&#10;  ULONG                       TargetId;&#10;  ULONG                       LunId;&#10;  BOOLEAN                     StorportSpecificErrorCode;&#10;  ULONG                       ErrorCode;&#10;  ULONG                       UniqueId;&#10;  ULONG                       DumpDataSize;&#10;  PVOID                       DumpData;&#10;  ULONG                       StringCount;&#10;  PWSTR                       *StringList;&#10;} STOR_LOG_EVENT_DETAILS, *PSTOR_LOG_EVENT_DETAILS;">PSTOR_LOG_EVENT_DETAILS</a> LogDetails,
  [in, out] PULONG                  MaximumSize
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/storport/nf-storport-storportlogsystemevent">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/storportlogsystemevent.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-storport-storportlogsystemevent)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="storportlogsystemevent-function">StorPortLogSystemEvent function</h1>

<h2 id="description">Description</h2>

<p>The StorPortLogSystemEvent routine gives miniport drivers full access to the capabilities of the Windows kernel event facility, enabling miniport drivers to create event log entries that are truly useful in troubleshooting storage issues. It provides a better alternative to the existing miniport driver event logging function, <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/storport/nf-storport-storportlogerror">StorPortLogError</a>.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="hwdeviceextension-in"><code>HwDeviceExtension</code> [in]</h3>

<p>A pointer to the hardware device extension. This is a per HBA storage area that the port driver allocates and initializes on behalf of the miniport driver. Miniport drivers usually store HBA-specific information in this extension, such as the state of the HBA and the mapped access ranges for the HBA. This area is available to the miniport immediately after the miniport driver calls <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/storport/nf-storport-storportinitialize">StorPortInitialize</a>. The port driver frees this memory when it removes the device.</p>

<h3 id="logdetails-in-out"><code>LogDetails</code> [in, out]</h3>

<p>A <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/storport/ns-storport-_stor_log_event_details">STOR_LOG_EVENT_DETAILS</a> structure that contains information to appear in the system event log entry.</p>

<h3 id="maximumsize-in-out"><code>MaximumSize</code> [in, out]</h3>

<p>Variable to receive maximum combined size of miniport's dump data and strings. Only returned if the function fails and returns a STOR_STATUS_INVALID_BUFFER_SIZE value. This parameter is optional.</p>

<h2 id="return-value">Return value</h2>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>STOR_STATUS_NOT_IMPLEMENTED</strong></td>
  <td>This function is not implemented on the active operating system.</td>
</tr>
<tr>
  <td><strong>STOR_STATUS_INVALID_PARAMETER</strong></td>
  <td>An invalid parameter was passed in.</td>
</tr>
<tr>
  <td><strong>STOR_STATUS_INVALID_IRQL</strong></td>
  <td>The call was made at IRQL &gt; DISPATCH_LEVEL.</td>
</tr>
<tr>
  <td><strong>STOR_STATUS_INSUFFICIENT_RESOURCES</strong></td>
  <td>There were insufficient system resources to complete the request.</td>
</tr>
<tr>
  <td><strong>STOR_STATUS_UNSUPPORTED_VERSION:</strong></td>
  <td>An unsupported (for example, more current) version of the <a href="stor_log_event_details" title="typedef struct _STOR_LOG_EVENT_DETAILS {&#10;  ULONG                       InterfaceRevision;&#10;  ULONG                       Size;&#10;  ULONG                       Flags;&#10;  STOR_EVENT_ASSOCIATION_ENUM EventAssociation;&#10;  ULONG                       PathId;&#10;  ULONG                       TargetId;&#10;  ULONG                       LunId;&#10;  BOOLEAN                     StorportSpecificErrorCode;&#10;  ULONG                       ErrorCode;&#10;  ULONG                       UniqueId;&#10;  ULONG                       DumpDataSize;&#10;  PVOID                       DumpData;&#10;  ULONG                       StringCount;&#10;  PWSTR                       *StringList;&#10;} STOR_LOG_EVENT_DETAILS, *PSTOR_LOG_EVENT_DETAILS;">STOR_LOG_EVENT_DETAILS</a> structure was specified. When this is returned, LogDetails->InterfaceRevision is set to the latest supported version.</td>
</tr>
<tr>
  <td><strong>STOR_STATUS_INVALID_BUFFER_SIZE</strong></td>
  <td>The buffers passed to the function were too large. When this value is returned, MaximumSize is set to the maximum combined size of the miniport's dump data and strings.</td>
</tr>
<tr>
  <td><strong>STOR_STATUS_SUCCESS</strong></td>
  <td>The log operation completed successfully.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>To understand how you may use custom error codes to best advantage, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/storage/storport-event-log-extensions">Storport Error Log Extensions</a>. The StorPortLogSystemEvent routine must be called at IRQL &lt;= DISPATCH_LEVEL. If you pass in a more recent version of <a href="stor_log_event_details" title="typedef struct _STOR_LOG_EVENT_DETAILS {&#10;  ULONG                       InterfaceRevision;&#10;  ULONG                       Size;&#10;  ULONG                       Flags;&#10;  STOR_EVENT_ASSOCIATION_ENUM EventAssociation;&#10;  ULONG                       PathId;&#10;  ULONG                       TargetId;&#10;  ULONG                       LunId;&#10;  BOOLEAN                     StorportSpecificErrorCode;&#10;  ULONG                       ErrorCode;&#10;  ULONG                       UniqueId;&#10;  ULONG                       DumpDataSize;&#10;  PVOID                       DumpData;&#10;  ULONG                       StringCount;&#10;  PWSTR                       *StringList;&#10;} STOR_LOG_EVENT_DETAILS, *PSTOR_LOG_EVENT_DETAILS;">STOR_LOG_EVENT_DETAILS</a> than that supported by this build, this function changes the InterfaceRevision field to the latest supported version and returns STOR_STATUS_UNSUPPORTED_VERSION. The InterfaceRevision field of <a href="stor_log_event_details" title="typedef struct _STOR_LOG_EVENT_DETAILS {&#10;  ULONG                       InterfaceRevision;&#10;  ULONG                       Size;&#10;  ULONG                       Flags;&#10;  STOR_EVENT_ASSOCIATION_ENUM EventAssociation;&#10;  ULONG                       PathId;&#10;  ULONG                       TargetId;&#10;  ULONG                       LunId;&#10;  BOOLEAN                     StorportSpecificErrorCode;&#10;  ULONG                       ErrorCode;&#10;  ULONG                       UniqueId;&#10;  ULONG                       DumpDataSize;&#10;  PVOID                       DumpData;&#10;  ULONG                       StringCount;&#10;  PWSTR                       *StringList;&#10;} STOR_LOG_EVENT_DETAILS, *PSTOR_LOG_EVENT_DETAILS;">STOR_LOG_EVENT_DETAILS</a> is a 32-bit value. However, only the three most-significant bytes are used for validation. The low byte is reserved to distinguish between compatible, minor variations of a particular version. For instance, a revision 0x00000101 structure is compatible with a Storport that implements revision 0x00000100 of the interface, although it is possible that some minor, noncritical functionality may be lost. If you specify a combined size of dump data and strings that exceeds the maximum allowed event log entry size, the integer pointed to by MaximumSize is set to the maximum allowed size of miniport dump data and strings, and STOR_INVALID_BUFFER_SIZE is returned. Although this function accepts <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> values for the path, target, and LUN address specifiers, the values are truncated to <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> values because Storport internally only supports 8-bit values for these specifiers.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/storport/nf-storport-storportlogerror">StorPortLogError</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/storport/nf-storport-storportlogsystemevent">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/storport/nf-storport-storportlogsystemevent.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
