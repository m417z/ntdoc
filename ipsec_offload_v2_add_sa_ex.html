<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="IPSEC_OFFLOAD_V2_ADD_SA_EX - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>IPSEC_OFFLOAD_V2_ADD_SA_EX - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            IPSEC_OFFLOAD_V2_ADD_SA_EX - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _IPSEC_OFFLOAD_V2_ADD_SA_EX {
  <a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a>                    Header;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                                 NumExtHdrs;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                                 Flags;
  union {
    struct {
      IPAddr SrcAddr;
      IPAddr DestAddr;
    } IPv4Endpoints;
    struct {
      <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> SrcAddr[16];
      <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> DestAddr[16];
    } IPv6Endpoints;
  };
  NDIS_HANDLE                           OffloadHandle;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                                 UdpEspEncapsulation;
  <a href="ipsec_offload_v2_security_association" title="typedef struct _IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION {&#10;  ULONG                           Flags;&#10;  IPSEC_OFFLOAD_V2_OPERATION      Operation;&#10;  IPSEC_OFFLOAD_V2_SPI_TYPE       Spi;&#10;  IPSEC_OFFLOAD_V2_ALGORITHM_INFO AuthenticationAlgorithm;&#10;  IPSEC_OFFLOAD_V2_ALGORITHM_INFO EncryptionAlgorithm;&#10;  ULONG                           SequenceNumberHighOrder;&#10;} IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION, *PIPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION;">IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION</a> SecAssoc[IPSEC_OFFLOAD_V2_MAX_EXTENSION_HEADERS];
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                                 KeyLength;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                                 KeyOffset;
  NDIS_SWITCH_PORT_ID                   SourceSwitchPortId;
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>                                VlanId;
} IPSEC_OFFLOAD_V2_ADD_SA_EX, *PIPSEC_OFFLOAD_V2_ADD_SA_EX;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/ns-ndis-_ipsec_offload_v2_add_sa_ex">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ipsec_offload_v2_add_sa_ex.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ndis-_ipsec_offload_v2_add_sa_ex)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>_IPSEC_OFFLOAD_V2_ADD_SA_EX structure</h1>

<h2>Description</h2>

<p>[The IPsec Task Offload feature is deprecated and should not be used.]</p>

<p>The IPSEC_OFFLOAD_V2_ADD_SA_EX structure defines information about a security association (SA) that a
miniport driver should add to a NIC.</p>

<h2>Members</h2>

<h3><code>Header</code></h3>

<p>The
<a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a> structure for the
IPSEC_OFFLOAD_V2_ADD_SA_EX structure. Set the
<strong>Type</strong> member of the structure that
<strong>Header</strong> specifies to NDIS_OBJECT_TYPE_DEFAULT, the
<strong>Revision</strong> member to NDIS_IPSEC_OFFLOAD_V2_ADD_SA_EX_REVISION_1, and the
<strong>Size</strong> member to NDIS_SIZEOF_IPSEC_OFFLOAD_V2_ADD_SA_EX_REVISION_1.</p>

<h3><code>NumExtHdrs</code></h3>

<p>The number of IPsec extension headers. This member can be one of the following values.</p>

<table>
<thead>
<tr>
  <th>Type of security</th>
  <th>Extension headers</th>
</tr>
</thead>
<tbody>
<tr>
  <td>AH authentication only</td>
  <td>1</td>
</tr>
<tr>
  <td>ESP authentication only</td>
  <td>1</td>
</tr>
<tr>
  <td>ESP encryption only</td>
  <td>1</td>
</tr>
<tr>
  <td>ESP authentication plus encryption</td>
  <td>1</td>
</tr>
<tr>
  <td>AH plus ESP authentication plus encryption</td>
  <td>2</td>
</tr>
<tr>
  <td>UDP ESP</td>
  <td>1</td>
</tr>
</tbody>
</table>

<h3><code>Flags</code></h3>

<p>A bitmask that indicates whether the SA that is being added is an inbound or outbound SA as
follows:</p>

<h4>IPSEC_OFFLOAD_V2_IPv6</h4>

<p>If this flag is set, the addresses are IPv6. Otherwise, the addresses are IPv4</p>

<h4>IPSEC_OFFLOAD_V2_INBOUND</h4>

<p>If this flag is set, the SA is inbound. Otherwise, the SA is outbound.</p>

<h3><code>IPv4Endpoints</code></h3>

<p>The IPv4 endpoint addresses. This structure contains the following members:</p>

<h3><code>IPv4Endpoints.SrcAddr</code></h3>

<p>The IPv4 address of the source host (the host that is sending the packets).</p>

<h3><code>IPv4Endpoints.DestAddr</code></h3>

<p>The IPv4 address of the destination host (the host that is receiving the packets).</p>

<h3><code>IPv6Endpoints</code></h3>

<p>The IPv6 endpoint addresses. This structure contains the following members:</p>

<h3><code>IPv6Endpoints.SrcAddr</code></h3>

<p>The IPv6 address of the source host (the host that is sending the packets).</p>

<h3><code>IPv6Endpoints.DestAddr</code></h3>

<p>The IPv6 address of the destination host (the host that is receiving the packets).</p>

<h3><code>OffloadHandle</code></h3>

<p>The handle to the newly created SA. The miniport driver supplies this handle before completing the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp-task-ipsec-offload-v2-add-sa-ex">OID_TCP_TASK_IPSEC_OFFLOAD_V2_ADD_SA_EX</a> request. The TCP/IP transport must specify this handle in the
<a href="ndis_ipsec_offload_v2_net_buffer_list_info" title="typedef struct _NDIS_IPSEC_OFFLOAD_V2_NET_BUFFER_LIST_INFO {&#10;  union {&#10;    struct {&#10;      PVOID OffloadHandle;&#10;    } Transmit;&#10;    struct {&#10;      ULONG SaDeleteReq : 1;&#10;      ULONG CryptoDone : 1;&#10;      ULONG NextCryptoDone : 1;&#10;      ULONG Reserved : 13;&#10;      ULONG CryptoStatus : 16;&#10;    } Receive;&#10;  };&#10;} NDIS_IPSEC_OFFLOAD_V2_NET_BUFFER_LIST_INFO, *PNDIS_IPSEC_OFFLOAD_V2_NET_BUFFER_LIST_INFO;">NDIS_IPSEC_OFFLOAD_V2_NET_BUFFER_LIST_INFO</a> or
<a href="ndis_ipsec_offload_v2_tunnel_net_buffer_list_info" title="typedef struct _NDIS_IPSEC_OFFLOAD_V2_TUNNEL_NET_BUFFER_LIST_INFO {&#10;  struct {&#10;    NDIS_HANDLE TunnelHandle;&#10;  } Transmit;&#10;} NDIS_IPSEC_OFFLOAD_V2_TUNNEL_NET_BUFFER_LIST_INFO, *PNDIS_IPSEC_OFFLOAD_V2_TUNNEL_NET_BUFFER_LIST_INFO;">NDIS_IPSEC_OFFLOAD_V2_TUNNEL_NET_BUFFER_LIST_INFO</a> structure before passing a send packet to the
miniport driver. The TCP/IP transport must also specify this handle when deleting the SA with an
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp-task-ipsec-offload-v2-delete-sa">OID_TCP_TASK_IPSEC_OFFLOAD_V2_DELETE_SA</a> request.</p>

<h3><code>UdpEspEncapsulation</code></h3>

<p>The UDP ESP encapsulation type. This member can be one or more of the following flags:</p>

<h4>IPSEC_OFFLOAD_V2_UDP_ESP_ENCAPSULATION_NONE</h4>

<p>No UDP encapsulation is used.</p>

<h4>IPSEC_OFFLOAD_V2_UDP_ESP_ENCAPSULATION_TRANSPORT</h4>

<p>An ESP-encapsulated transport-mode packet is encapsulated by UDP.</p>

<h4>IPSEC_OFFLOAD_V2_UDP_ESP_ENCAPSULATION_TUNNEL</h4>

<p>The tunnel-mode portion of a packet is UDP-encapsulated. The transport-mode portion of the
packet is not UDP-encapsulated and is not ESP-protected.</p>

<h4>IPSEC_OFFLOAD_V2_TRANSPORT_OVER_UDP_ESP_ENCAPSULATION_TUNNEL</h4>

<p>The tunnel-mode portion of a packet is UDP-encapsulated. The transport-mode portion of a packet
is not UDP-encapsulated but is ESP-protected.</p>

<h4>IPSEC_OFFLOAD_V2_UDP_ESP_ENCAPSULATION_TRANSPORT_OVER_TUNNEL</h4>

<p>The tunnel-mode portion of a packet is not UDP-encapsulated. The transport-mode portion of a
packet is UDP-encapsulated and ESP-protected.</p>

<h3><code>SecAssoc</code></h3>

<p>An array with two elements that contain the information about the IPsec operations (AH, ESP, or
both) for the SA. The number of provided elements is specified in the
<strong>NumExtHdrs</strong> member. The information for each IPsec operations is formatted as an
<a href="ipsec_offload_v2_security_association" title="typedef struct _IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION {&#10;  ULONG                           Flags;&#10;  IPSEC_OFFLOAD_V2_OPERATION      Operation;&#10;  IPSEC_OFFLOAD_V2_SPI_TYPE       Spi;&#10;  IPSEC_OFFLOAD_V2_ALGORITHM_INFO AuthenticationAlgorithm;&#10;  IPSEC_OFFLOAD_V2_ALGORITHM_INFO EncryptionAlgorithm;&#10;  ULONG                           SequenceNumberHighOrder;&#10;} IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION, *PIPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION;">IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION</a> structure, which is described below.</p>

<p>The TCP/IP transport specifies one or two <a href="ipsec_offload_v2_security_association" title="typedef struct _IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION {&#10;  ULONG                           Flags;&#10;  IPSEC_OFFLOAD_V2_OPERATION      Operation;&#10;  IPSEC_OFFLOAD_V2_SPI_TYPE       Spi;&#10;  IPSEC_OFFLOAD_V2_ALGORITHM_INFO AuthenticationAlgorithm;&#10;  IPSEC_OFFLOAD_V2_ALGORITHM_INFO EncryptionAlgorithm;&#10;  ULONG                           SequenceNumberHighOrder;&#10;} IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION, *PIPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION;">IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION</a> structures in the
buffer at
<strong>SecAssoc</strong> . Each <a href="ipsec_offload_v2_security_association" title="typedef struct _IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION {&#10;  ULONG                           Flags;&#10;  IPSEC_OFFLOAD_V2_OPERATION      Operation;&#10;  IPSEC_OFFLOAD_V2_SPI_TYPE       Spi;&#10;  IPSEC_OFFLOAD_V2_ALGORITHM_INFO AuthenticationAlgorithm;&#10;  IPSEC_OFFLOAD_V2_ALGORITHM_INFO EncryptionAlgorithm;&#10;  ULONG                           SequenceNumberHighOrder;&#10;} IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION, *PIPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION;">IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION</a> structure indicates the type of
operation--authentication or encryption/decryption--for which the SA specified in the structure is to be
used. The order of the <a href="ipsec_offload_v2_security_association" title="typedef struct _IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION {&#10;  ULONG                           Flags;&#10;  IPSEC_OFFLOAD_V2_OPERATION      Operation;&#10;  IPSEC_OFFLOAD_V2_SPI_TYPE       Spi;&#10;  IPSEC_OFFLOAD_V2_ALGORITHM_INFO AuthenticationAlgorithm;&#10;  IPSEC_OFFLOAD_V2_ALGORITHM_INFO EncryptionAlgorithm;&#10;  ULONG                           SequenceNumberHighOrder;&#10;} IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION, *PIPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION;">IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION</a> structures in the array indicates the order
in which the miniport driver should perform the operations for each SA. Only one combination of
operations is supported: encryption/decryption (ESP) followed by authentication (AH).</p>

<h3><code>KeyLength</code></h3>

<p>The length, in bytes, of the buffer at
<strong>KeyOffset</strong>.</p>

<h3><code>KeyOffset</code></h3>

<p>The offset, in bytes, from the beginning of the IPSEC_OFFLOAD_V2_ADD_SA_EX structure to the beginning of a variable-length array that contains keys for the SA that is specified at
<strong>SecAssoc</strong>. If both an encryption algorithm and an authentication algorithm are specified by the
<strong>EncryptionAlgorithm</strong> and
<strong>AuthenticationAlgorithm</strong> members of an
<a href="ipsec_offload_v2_security_association" title="typedef struct _IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION {&#10;  ULONG                           Flags;&#10;  IPSEC_OFFLOAD_V2_OPERATION      Operation;&#10;  IPSEC_OFFLOAD_V2_SPI_TYPE       Spi;&#10;  IPSEC_OFFLOAD_V2_ALGORITHM_INFO AuthenticationAlgorithm;&#10;  IPSEC_OFFLOAD_V2_ALGORITHM_INFO EncryptionAlgorithm;&#10;  ULONG                           SequenceNumberHighOrder;&#10;} IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION, *PIPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION;">IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION</a> structure, the buffer at
<strong>KeyOffset</strong> contains key information for one followed by the other. The beginning and the length of
the key are specified by the
<a href="ipsec_offload_v2_algorithm_info" title="typedef struct _IPSEC_OFFLOAD_V2_ALGORITHM_INFO {&#10;  ULONG Identifier;&#10;  ULONG KeyLength;&#10;  ULONG KeyOffsetBytes;&#10;  ULONG AdditionalInfo;&#10;} IPSEC_OFFLOAD_V2_ALGORITHM_INFO, *PIPSEC_OFFLOAD_V2_ALGORITHM_INFO;">IPSEC_OFFLOAD_V2_ALGORITHM_INFO</a> structure's <strong>KeyOffsetBytes</strong> and
<strong>KeyLength</strong> members, respectively.</p>

<h3><code>SourceSwitchPortId</code></h3>

<p>Reserved.</p>

<h3><code>VlanId</code></h3>

<p>Reserved.</p>

<h2>Remarks</h2>

<p>The IPSEC_OFFLOAD_V2_ADD_SA_EX structure specifies a security SA that should be added. The IPSEC_OFFLOAD_V2_ADD_SA_EX structure is
used with the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp-task-ipsec-offload-v2-add-sa-ex">OID_TCP_TASK_IPSEC_OFFLOAD_V2_ADD_SA_EX</a> OID.</p>

<p>The IPSEC_OFFLOAD_V2_ADD_SA_EX structure specifies the source and destination, as well as the IP
protocols, to which the SA applies. This filter pertains to a transport-mode connection--that is, an
end-to-end connection between two hosts. If the specified connection is made through a tunnel, the source
and destination addresses of the tunnel are specified.</p>

<p>If a member is set to zero, that parameter is not used to filter packets for the specified SA. For
example, if
<strong>SrcAddr</strong> is set to zero, the specified SA can apply to a packet that contains any source address.
If all of the filter parameters are set to zero, the specified SA applies to any source host that is
sending any type of packet to any destination host.</p>

<p>This structure is nearly identical to the previous version,
<a href="ipsec_offload_v2_add_sa" title="typedef struct _IPSEC_OFFLOAD_V2_ADD_SA {&#10;  NDIS_OBJECT_HEADER                    Header;&#10;  PIPSEC_OFFLOAD_V2_ADD_SA              Next;&#10;  ULONG                                 NumExtHdrs;&#10;  ULONG                                 Flags;&#10;  union {&#10;    struct {&#10;      IPAddr SrcAddr;&#10;      IPAddr DestAddr;&#10;    } IPv4Endpoints;&#10;    struct {&#10;      UCHAR SrcAddr[16];&#10;      UCHAR DestAddr[16];&#10;    } IPv6Endpoints;&#10;  };&#10;  NDIS_HANDLE                           OffloadHandle;&#10;  ULONG                                 UdpEspEncapsulation;&#10;  IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION SecAssoc[IPSEC_OFFLOAD_V2_MAX_EXTENSION_HEADERS];&#10;  ULONG                                 KeyLength;&#10;  UCHAR                                 KeyData[1];&#10;...">IPSEC_OFFLOAD_V2_ADD_SA</a>. The <strong>Next</strong> and <strong>KeyData</strong> members have been removed. The <strong>KeyOffset</strong>, <strong>SourceSwitchPortId</strong> and <strong>VlanId</strong> members have been added.</p>

<h2>See also</h2>

<p><a href="ipsec_offload_v2_add_sa" title="typedef struct _IPSEC_OFFLOAD_V2_ADD_SA {&#10;  NDIS_OBJECT_HEADER                    Header;&#10;  PIPSEC_OFFLOAD_V2_ADD_SA              Next;&#10;  ULONG                                 NumExtHdrs;&#10;  ULONG                                 Flags;&#10;  union {&#10;    struct {&#10;      IPAddr SrcAddr;&#10;      IPAddr DestAddr;&#10;    } IPv4Endpoints;&#10;    struct {&#10;      UCHAR SrcAddr[16];&#10;      UCHAR DestAddr[16];&#10;    } IPv6Endpoints;&#10;  };&#10;  NDIS_HANDLE                           OffloadHandle;&#10;  ULONG                                 UdpEspEncapsulation;&#10;  IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION SecAssoc[IPSEC_OFFLOAD_V2_MAX_EXTENSION_HEADERS];&#10;  ULONG                                 KeyLength;&#10;  UCHAR                                 KeyData[1];&#10;...">IPSEC_OFFLOAD_V2_ADD_SA</a></p>

<p><a href="ipsec_offload_v2_algorithm_info" title="typedef struct _IPSEC_OFFLOAD_V2_ALGORITHM_INFO {&#10;  ULONG Identifier;&#10;  ULONG KeyLength;&#10;  ULONG KeyOffsetBytes;&#10;  ULONG AdditionalInfo;&#10;} IPSEC_OFFLOAD_V2_ALGORITHM_INFO, *PIPSEC_OFFLOAD_V2_ALGORITHM_INFO;">IPSEC_OFFLOAD_V2_ALGORITHM_INFO</a></p>

<p><a href="ipsec_offload_v2_security_association" title="typedef struct _IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION {&#10;  ULONG                           Flags;&#10;  IPSEC_OFFLOAD_V2_OPERATION      Operation;&#10;  IPSEC_OFFLOAD_V2_SPI_TYPE       Spi;&#10;  IPSEC_OFFLOAD_V2_ALGORITHM_INFO AuthenticationAlgorithm;&#10;  IPSEC_OFFLOAD_V2_ALGORITHM_INFO EncryptionAlgorithm;&#10;  ULONG                           SequenceNumberHighOrder;&#10;} IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION, *PIPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION;">IPSEC_OFFLOAD_V2_SECURITY_ASSOCIATION</a></p>

<p><a href="ndis_ipsec_offload_v2_net_buffer_list_info" title="typedef struct _NDIS_IPSEC_OFFLOAD_V2_NET_BUFFER_LIST_INFO {&#10;  union {&#10;    struct {&#10;      PVOID OffloadHandle;&#10;    } Transmit;&#10;    struct {&#10;      ULONG SaDeleteReq : 1;&#10;      ULONG CryptoDone : 1;&#10;      ULONG NextCryptoDone : 1;&#10;      ULONG Reserved : 13;&#10;      ULONG CryptoStatus : 16;&#10;    } Receive;&#10;  };&#10;} NDIS_IPSEC_OFFLOAD_V2_NET_BUFFER_LIST_INFO, *PNDIS_IPSEC_OFFLOAD_V2_NET_BUFFER_LIST_INFO;">NDIS_IPSEC_OFFLOAD_V2_NET_BUFFER_LIST_INFO</a></p>

<p><a href="ndis_ipsec_offload_v2_tunnel_net_buffer_list_info" title="typedef struct _NDIS_IPSEC_OFFLOAD_V2_TUNNEL_NET_BUFFER_LIST_INFO {&#10;  struct {&#10;    NDIS_HANDLE TunnelHandle;&#10;  } Transmit;&#10;} NDIS_IPSEC_OFFLOAD_V2_TUNNEL_NET_BUFFER_LIST_INFO, *PNDIS_IPSEC_OFFLOAD_V2_TUNNEL_NET_BUFFER_LIST_INFO;">NDIS_IPSEC_OFFLOAD_V2_TUNNEL_NET_BUFFER_LIST_INFO</a></p>

<p><a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp-task-ipsec-offload-v2-add-sa">OID_TCP_TASK_IPSEC_OFFLOAD_V2_ADD_SA_EX</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-tcp-task-ipsec-offload-v2-delete-sa">OID_TCP_TASK_IPSEC_OFFLOAD_V2_DELETE_SA</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/ns-ndis-_ipsec_offload_v2_add_sa_ex">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ndis/ns-ndis-_ipsec_offload_v2_add_sa_ex.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
