<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="REG_CREATE_KEY_INFORMATION_V1 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>REG_CREATE_KEY_INFORMATION_V1 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            REG_CREATE_KEY_INFORMATION_V1 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _REG_CREATE_KEY_INFORMATION_V1 {
  <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">PUNICODE_STRING</a> CompleteName;
  PVOID           RootObject;
  PVOID           ObjectType;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>           Options;
  <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">PUNICODE_STRING</a> Class;
  PVOID           SecurityDescriptor;
  PVOID           SecurityQualityOfService;
  ACCESS_MASK     DesiredAccess;
  ACCESS_MASK     GrantedAccess;
  PULONG          Disposition;
  PVOID           *ResultObject;
  PVOID           CallContext;
  PVOID           RootObjectContext;
  PVOID           Transaction;
  <a href="ulong_ptr" title="typedef [public] unsigned __int3264 ULONG_PTR;">ULONG_PTR</a>       Version;
  <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">PUNICODE_STRING</a> RemainingName;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>           Wow64Flags;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>           Attributes;
  KPROCESSOR_MODE CheckAccessMode;
} REG_CREATE_KEY_INFORMATION_V1, REG_OPEN_KEY_INFORMATION_V1, *PREG_CREATE_KEY_INFORMATION_V1, *PREG_OPEN_KEY_INFORMATION_V1;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_reg_create_key_information_v1">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/reg_create_key_information_v1.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-wdm-_reg_create_key_information_v1)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>_REG_CREATE_KEY_INFORMATION_V1 structure</h1>
<h2>Description</h2>
<p>The <strong>REG_CREATE_KEY_INFORMATION_V1</strong> structure contains information that a filter driver's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-ex_callback_function">RegistryCallback</a> routine can use when a registry key is being created.</p>
<h2>Members</h2>
<h3><code>CompleteName</code></h3>
<p>A pointer to a <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a> structure that contains the path of the new registry key. The path can be absolute or relative. If the path is absolute, this structure contains a fully qualified path that starts with the &quot;\&quot; character. For an absolute path, the <strong>RootObject</strong> member specifies the <strong>\REGISTRY</strong> key, which is the root directory of the registry tree. If the path is relative, the path starts with a character other than &quot;\&quot;, and is relative to the key that is specified by the <strong>RootObject</strong> member.</p>
<h3><code>RootObject</code></h3>
<p>A pointer to a registry key object that represents the root registry key for the path that is specified by the <strong>CompleteName</strong> member.</p>
<h3><code>ObjectType</code></h3>
<p>This member is reserved for use by the operating system. Drivers must not access this member.</p>
<h3><code>Options</code></h3>
<p>Specifies the options for the key-create routine to use to create or open the new key. For more information, see the description of the <em>CreateOptions</em> parameter of the <a href="ntcreatekey" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateKey(&#10;    _Out_ PHANDLE KeyHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _Reserved_ ULONG TitleIndex,&#10;    _In_opt_ PCUNICODE_STRING Class,&#10;    _In_ ULONG CreateOptions,&#10;    _Out_opt_ PULONG Disposition&#10;    );">ZwCreateKey</a> routine and the description of the <em>OpenOptions</em> parameter of the <a href="ntopenkeyex" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtOpenKeyEx(&#10;    _Out_ PHANDLE KeyHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ ULONG OpenOptions&#10;    );">ZwOpenKeyEx</a> routine.</p>
<h3><code>Class</code></h3>
<p>A pointer to a <strong><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></strong> structure that identifies the object class of the new key. For more information about this member, see the <em>Class</em> parameter of the <strong><a href="ntcreatekey" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateKey(&#10;    _Out_ PHANDLE KeyHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _Reserved_ ULONG TitleIndex,&#10;    _In_opt_ PCUNICODE_STRING Class,&#10;    _In_ ULONG CreateOptions,&#10;    _Out_opt_ PULONG Disposition&#10;    );">ZwCreateKey</a></strong> routine. This pointer value can be <strong>NULL</strong>.</p>
<h3><code>SecurityDescriptor</code></h3>
<p>A pointer to a <a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a> structure that contains security information for the key object. This pointer was obtained from the <strong>SecurityDescriptor</strong> member of the <a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PSECURITY_DESCRIPTOR SecurityDescriptor;&#10;    PSECURITY_QUALITY_OF_SERVICE SecurityQualityOfService;&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">OBJECT_ATTRIBUTES</a> structure that was passed as an input parameter in the call to create the new registry key.</p>
<h3><code>SecurityQualityOfService</code></h3>
<p>A pointer to a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winnt/ns-winnt-security_quality_of_service">SECURITY_QUALITY_OF_SERVICE</a> structure. This structure indicates whether a server can impersonate the client that is trying to create the registry key, and, if impersonation is permitted, the extent to which it is permitted.</p>
<h3><code>DesiredAccess</code></h3>
<p>The access mask that was specified by the thread that is trying to create the registry key. For more information about this access mask, see the description of the <em>DesiredAccess</em> parameter of the <strong><a href="ntcreatekey" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateKey(&#10;    _Out_ PHANDLE KeyHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _Reserved_ ULONG TitleIndex,&#10;    _In_opt_ PCUNICODE_STRING Class,&#10;    _In_ ULONG CreateOptions,&#10;    _Out_opt_ PULONG Disposition&#10;    );">ZwCreateKey</a></strong> routine.</p>
<h3><code>GrantedAccess</code></h3>
<p>An access mask that indicates the access rights that were granted to the thread that is trying to create the registry key. For more information about this member, see the following Remarks section.</p>
<h3><code>Disposition</code></h3>
<p>A value that indicates whether the requested registry operation will create a new key or open an existing one. For more information about this member, see the description of the <em>Disposition</em> parameter of the <strong><a href="ntcreatekey" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateKey(&#10;    _Out_ PHANDLE KeyHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _Reserved_ ULONG TitleIndex,&#10;    _In_opt_ PCUNICODE_STRING Class,&#10;    _In_ ULONG CreateOptions,&#10;    _Out_opt_ PULONG Disposition&#10;    );">ZwCreateKey</a></strong> routine and the following Remarks section.</p>
<h3><code>ResultObject</code></h3>
<p>A pointer to a location that receives the address of the key object that represents the created registry key.</p>
<h3><code>CallContext</code></h3>
<p>Optional driver-defined context information that the driver's <em>RegistryCallback</em> routine can supply.</p>
<h3><code>RootObjectContext</code></h3>
<p>A pointer to driver-defined context information that the driver has associated with the root of the path of the registry object by calling the <a href="cmsetcallbackobjectcontext" title="NTSTATUS CmSetCallbackObjectContext(&#10;  [in, out]       PVOID          Object,&#10;  [in]            PLARGE_INTEGER Cookie,&#10;  [in]            PVOID          NewContext,&#10;  [out, optional] PVOID          *OldContext&#10;);">CmSetCallbackObjectContext</a> routine.</p>
<h3><code>Transaction</code></h3>
<p>A pointer to a transaction object for the registry operation. You can supply this pointer to the <a href="obopenobjectbypointer" title="NTSTATUS ObOpenObjectByPointer(&#10;  [in]           PVOID           Object,&#10;  [in]           ULONG           HandleAttributes,&#10;  [in, optional] PACCESS_STATE   PassedAccessState,&#10;  [in]           ACCESS_MASK     DesiredAccess,&#10;  [in, optional] POBJECT_TYPE    ObjectType,&#10;  [in]           KPROCESSOR_MODE AccessMode,&#10;  [out]          PHANDLE         Handle&#10;);">ObOpenObjectByPointer</a> routine to obtain the corresponding transaction handle. If this member is <strong>NULL</strong>, the operation is being performed in non-transactional context.</p>
<h3><code>Version</code></h3>
<p>The structure version number. This member distinguishes the <a href="reg_create_key_information" title="typedef struct _REG_CREATE_KEY_INFORMATION {&#10;  PUNICODE_STRING CompleteName;&#10;  PVOID           RootObject;&#10;  PVOID           ObjectType;&#10;  ULONG           CreateOptions;&#10;  PUNICODE_STRING Class;&#10;  PVOID           SecurityDescriptor;&#10;  PVOID           SecurityQualityOfService;&#10;  ACCESS_MASK     DesiredAccess;&#10;  ACCESS_MASK     GrantedAccess;&#10;  PULONG          Disposition;&#10;  PVOID           *ResultObject;&#10;  PVOID           CallContext;&#10;  PVOID           RootObjectContext;&#10;  PVOID           Transaction;&#10;  PVOID           Reserved;&#10;} REG_CREATE_KEY_INFORMATION, REG_OPEN_KEY_INFORMATION, *PREG_CREATE_KEY_INFORMATION, *PREG_OPEN_KEY_INFORMATION;">REG_CREATE_KEY_INFORMATION</a> structure in Windows Vista from the <strong>REG_CREATE_KEY_INFORMATION_V1</strong> structure in Windows 7 and later versions of Windows. The following version numbers are currently defined.</p>
<table>
<thead>
<tr>
<th>Version number</th>
<th>Version of structure</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td><strong><a href="reg_create_key_information" title="typedef struct _REG_CREATE_KEY_INFORMATION {&#10;  PUNICODE_STRING CompleteName;&#10;  PVOID           RootObject;&#10;  PVOID           ObjectType;&#10;  ULONG           CreateOptions;&#10;  PUNICODE_STRING Class;&#10;  PVOID           SecurityDescriptor;&#10;  PVOID           SecurityQualityOfService;&#10;  ACCESS_MASK     DesiredAccess;&#10;  ACCESS_MASK     GrantedAccess;&#10;  PULONG          Disposition;&#10;  PVOID           *ResultObject;&#10;  PVOID           CallContext;&#10;  PVOID           RootObjectContext;&#10;  PVOID           Transaction;&#10;  PVOID           Reserved;&#10;} REG_CREATE_KEY_INFORMATION, REG_OPEN_KEY_INFORMATION, *PREG_CREATE_KEY_INFORMATION, *PREG_OPEN_KEY_INFORMATION;">REG_CREATE_KEY_INFORMATION</a></strong></td>
</tr>
<tr>
<td>1</td>
<td><strong>REG_CREATE_KEY_INFORMATION_V1</strong></td>
</tr>
</tbody>
</table>
<p>Future versions of this structure might add new members but will not change the members that are already defined in existing versions of the structure. This member is defined in the <strong>REG_CREATE_KEY_INFORMATION_V1</strong> structure that is supported in Windows 7 and later versions of the Windows operating systems. In the <strong><a href="reg_create_key_information" title="typedef struct _REG_CREATE_KEY_INFORMATION {&#10;  PUNICODE_STRING CompleteName;&#10;  PVOID           RootObject;&#10;  PVOID           ObjectType;&#10;  ULONG           CreateOptions;&#10;  PUNICODE_STRING Class;&#10;  PVOID           SecurityDescriptor;&#10;  PVOID           SecurityQualityOfService;&#10;  ACCESS_MASK     DesiredAccess;&#10;  ACCESS_MASK     GrantedAccess;&#10;  PULONG          Disposition;&#10;  PVOID           *ResultObject;&#10;  PVOID           CallContext;&#10;  PVOID           RootObjectContext;&#10;  PVOID           Transaction;&#10;  PVOID           Reserved;&#10;} REG_CREATE_KEY_INFORMATION, REG_OPEN_KEY_INFORMATION, *PREG_CREATE_KEY_INFORMATION, *PREG_OPEN_KEY_INFORMATION;">REG_CREATE_KEY_INFORMATION</a></strong> structure that Windows Vista supports, this member is named <strong>Reserved</strong> and is set to zero. Filter drivers should rely on the version number and not the operating system version to determine which version of the structure they are using.</p>
<h3><code>RemainingName</code></h3>
<p>A pointer to a <strong><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></strong> structure that contains the relative path of the new registry key. This member always expresses the path of the new key relative to the path of the key that is specified by the <strong>RootObject</strong> member. In contrast, the <strong>CompleteName</strong> member can contain an absolute path if the <strong>RootObject</strong> member specifies the <strong>\REGISTRY</strong> key.</p>
<h3><code>Wow64Flags</code></h3>
<p>Contains the Wow64 flags from the access mask that was passed as an input parameter in the call to create the new registry key. This member indicates whether a 32-bit client program that is running on a 64-bit version of Windows is trying to create a registry key. This member is set to zero or to one of the following flag bits:</p>
<ul>
<li>KEY_WOW64_32KEY</li>
<li>KEY_WOW64_64KEY</li>
</ul>
<p>These flag bits are defined in the Wdm.h and Winnt.h header files. For more information about these flags, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/sysinfo/registry-key-security-and-access-rights">Registry Key Security and Access Rights</a>.</p>
<h3><code>Attributes</code></h3>
<p>Contains the object-attribute flags from the <strong>Attributes</strong> member of the <strong><a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PSECURITY_DESCRIPTOR SecurityDescriptor;&#10;    PSECURITY_QUALITY_OF_SERVICE SecurityQualityOfService;&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">OBJECT_ATTRIBUTES</a></strong> structure that was passed as an input parameter in the call to create the new registry key. This member might contain one or more of the following flag bits:</p>
<ul>
<li><a href="obj_kernel_handle" title="#define OBJ_KERNEL_HANDLE 0x00000200L">OBJ_KERNEL_HANDLE</a></li>
<li><a href="obj_force_access_check" title="#define OBJ_FORCE_ACCESS_CHECK 0x00000400L">OBJ_FORCE_ACCESS_CHECK</a></li>
<li><a href="obj_openlink" title="#define OBJ_OPENLINK 0x00000100L">OBJ_OPENLINK</a></li>
</ul>
<p>For more information about these flags, see <a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PSECURITY_DESCRIPTOR SecurityDescriptor;&#10;    PSECURITY_QUALITY_OF_SERVICE SecurityQualityOfService;&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">OBJECT_ATTRIBUTES</a>.</p>
<h3><code>CheckAccessMode</code></h3>
<p>Indicates how the configuration manager performs the security access check for the call to create the new key. This member contains one of the following MODE enumeration values from the Wdm.h header file:</p>
<ul>
<li><strong>KernelMode</strong></li>
<li><strong>UserMode</strong></li>
</ul>
<p>This security check is similar to that performed by the <a href="seaccesscheck" title="BOOLEAN SeAccessCheck(&#10;  [in]  PSECURITY_DESCRIPTOR      SecurityDescriptor,&#10;  [in]  PSECURITY_SUBJECT_CONTEXT SubjectSecurityContext,&#10;  [in]  BOOLEAN                   SubjectContextLocked,&#10;  [in]  ACCESS_MASK               DesiredAccess,&#10;  [in]  ACCESS_MASK               PreviouslyGrantedAccess,&#10;  [out] PPRIVILEGE_SET            *Privileges,&#10;  [in]  PGENERIC_MAPPING          GenericMapping,&#10;  [in]  KPROCESSOR_MODE           AccessMode,&#10;  [out] PACCESS_MASK              GrantedAccess,&#10;  [out] PNTSTATUS                 AccessStatus&#10;);">SeAccessCheck</a> routine, which has an <em>AccessMode</em> parameter that can be set to either <strong>UserMode</strong> or <strong>KernelMode</strong>. If <strong>CheckAccessMode</strong> is set to <strong>UserMode</strong>, the configuration manager performs a full security access check regardless of whether the call originated in user mode or kernel mode. For more information about how to force user-mode security access checks on a call that originates in kernel mode, see the description of the <a href="obj_force_access_check" title="#define OBJ_FORCE_ACCESS_CHECK 0x00000400L">OBJ_FORCE_ACCESS_CHECK</a> flag in the <strong>Attributes</strong> member of the <strong><a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PSECURITY_DESCRIPTOR SecurityDescriptor;&#10;    PSECURITY_QUALITY_OF_SERVICE SecurityQualityOfService;&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">OBJECT_ATTRIBUTES</a></strong> structure.</p>
<h2>Remarks</h2>
<p>The configuration manager passes this structure to the <em>RegistryCallback</em> routine every time that a thread tries to create a keyâ€”for example, when a user-mode thread calls <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winreg/nf-winreg-regcreatekeya">RegCreateKey</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winreg/nf-winreg-regcreatekeyexa">RegCreateKeyEx</a>, or when a kernel-mode driver calls <a href="ntcreatekey" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateKey(&#10;    _Out_ PHANDLE KeyHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _Reserved_ ULONG TitleIndex,&#10;    _In_opt_ PCUNICODE_STRING Class,&#10;    _In_ ULONG CreateOptions,&#10;    _Out_opt_ PULONG Disposition&#10;    );">ZwCreateKey</a>.</p>
<p>This structure is an extended version of the <a href="reg_create_key_information" title="typedef struct _REG_CREATE_KEY_INFORMATION {&#10;  PUNICODE_STRING CompleteName;&#10;  PVOID           RootObject;&#10;  PVOID           ObjectType;&#10;  ULONG           CreateOptions;&#10;  PUNICODE_STRING Class;&#10;  PVOID           SecurityDescriptor;&#10;  PVOID           SecurityQualityOfService;&#10;  ACCESS_MASK     DesiredAccess;&#10;  ACCESS_MASK     GrantedAccess;&#10;  PULONG          Disposition;&#10;  PVOID           *ResultObject;&#10;  PVOID           CallContext;&#10;  PVOID           RootObjectContext;&#10;  PVOID           Transaction;&#10;  PVOID           Reserved;&#10;} REG_CREATE_KEY_INFORMATION, REG_OPEN_KEY_INFORMATION, *PREG_CREATE_KEY_INFORMATION, *PREG_OPEN_KEY_INFORMATION;">REG_CREATE_KEY_INFORMATION</a> structure that Windows Vista supports. The first 14 members, <strong>CompleteName</strong> through <strong>Transaction</strong>, are identical in the two structures. The last five members of the <strong>REG_CREATE_KEY_INFORMATION_V1</strong> structure, <strong>Version</strong> through <strong>CheckAccessMode</strong>, are not part of the <strong><a href="reg_create_key_information" title="typedef struct _REG_CREATE_KEY_INFORMATION {&#10;  PUNICODE_STRING CompleteName;&#10;  PVOID           RootObject;&#10;  PVOID           ObjectType;&#10;  ULONG           CreateOptions;&#10;  PUNICODE_STRING Class;&#10;  PVOID           SecurityDescriptor;&#10;  PVOID           SecurityQualityOfService;&#10;  ACCESS_MASK     DesiredAccess;&#10;  ACCESS_MASK     GrantedAccess;&#10;  PULONG          Disposition;&#10;  PVOID           *ResultObject;&#10;  PVOID           CallContext;&#10;  PVOID           RootObjectContext;&#10;  PVOID           Transaction;&#10;  PVOID           Reserved;&#10;} REG_CREATE_KEY_INFORMATION, REG_OPEN_KEY_INFORMATION, *PREG_CREATE_KEY_INFORMATION, *PREG_OPEN_KEY_INFORMATION;">REG_CREATE_KEY_INFORMATION</a></strong> structure.</p>
<p>If the driver's <em>RegistryCallback</em> routine returns STATUS_CALLBACK_BYPASS for a <strong>RegNtPreCreateKeyEx</strong> notification, the driver must supply the values for the <strong>GrantedAccess</strong>, <strong>Disposition</strong>, and <strong>ResultObject</strong> members.</p>
<p>The <strong>REG_CREATE_KEY_INFORMATION_V1</strong> structure is one of a number of structures that a filter driver can receive through its <em>RegistryCallback</em> routine. For more information about registry filtering operations, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/filtering-registry-calls">Filtering Registry Calls</a>.</p>
<h2>See also</h2>
<p><a href="cmsetcallbackobjectcontext" title="NTSTATUS CmSetCallbackObjectContext(&#10;  [in, out]       PVOID          Object,&#10;  [in]            PLARGE_INTEGER Cookie,&#10;  [in]            PVOID          NewContext,&#10;  [out, optional] PVOID          *OldContext&#10;);">CmSetCallbackObjectContext</a></p>
<p><a href="object_attributes" title="typedef struct _OBJECT_ATTRIBUTES&#10;{&#10;    ULONG Length;&#10;    HANDLE RootDirectory;&#10;    PCUNICODE_STRING ObjectName;&#10;    ULONG Attributes;&#10;    PSECURITY_DESCRIPTOR SecurityDescriptor;&#10;    PSECURITY_QUALITY_OF_SERVICE SecurityQualityOfService;&#10;} OBJECT_ATTRIBUTES, *POBJECT_ATTRIBUTES;">OBJECT_ATTRIBUTES</a></p>
<p><a href="obopenobjectbypointer" title="NTSTATUS ObOpenObjectByPointer(&#10;  [in]           PVOID           Object,&#10;  [in]           ULONG           HandleAttributes,&#10;  [in, optional] PACCESS_STATE   PassedAccessState,&#10;  [in]           ACCESS_MASK     DesiredAccess,&#10;  [in, optional] POBJECT_TYPE    ObjectType,&#10;  [in]           KPROCESSOR_MODE AccessMode,&#10;  [out]          PHANDLE         Handle&#10;);">ObOpenObjectByPointer</a></p>
<p><a href="reg_create_key_information" title="typedef struct _REG_CREATE_KEY_INFORMATION {&#10;  PUNICODE_STRING CompleteName;&#10;  PVOID           RootObject;&#10;  PVOID           ObjectType;&#10;  ULONG           CreateOptions;&#10;  PUNICODE_STRING Class;&#10;  PVOID           SecurityDescriptor;&#10;  PVOID           SecurityQualityOfService;&#10;  ACCESS_MASK     DesiredAccess;&#10;  ACCESS_MASK     GrantedAccess;&#10;  PULONG          Disposition;&#10;  PVOID           *ResultObject;&#10;  PVOID           CallContext;&#10;  PVOID           RootObjectContext;&#10;  PVOID           Transaction;&#10;  PVOID           Reserved;&#10;} REG_CREATE_KEY_INFORMATION, REG_OPEN_KEY_INFORMATION, *PREG_CREATE_KEY_INFORMATION, *PREG_OPEN_KEY_INFORMATION;">REG_CREATE_KEY_INFORMATION</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winreg/nf-winreg-regcreatekeya">RegCreateKey</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winreg/nf-winreg-regcreatekeyexa">RegCreateKeyEx</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-ex_callback_function">RegistryCallback</a></p>
<p><a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winnt/ns-winnt-security_quality_of_service">SECURITY_QUALITY_OF_SERVICE</a></p>
<p><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></p>
<p><a href="ntcreatekey" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateKey(&#10;    _Out_ PHANDLE KeyHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _Reserved_ ULONG TitleIndex,&#10;    _In_opt_ PCUNICODE_STRING Class,&#10;    _In_ ULONG CreateOptions,&#10;    _Out_opt_ PULONG Disposition&#10;    );">ZwCreateKey</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_reg_create_key_information_v1">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/ns-wdm-_reg_create_key_information_v1.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
