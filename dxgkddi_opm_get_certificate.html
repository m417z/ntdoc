<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="DXGKDDI_OPM_GET_CERTIFICATE - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>DXGKDDI_OPM_GET_CERTIFICATE - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            DXGKDDI_OPM_GET_CERTIFICATE - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// dispmprt.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">DXGKDDI_OPM_GET_CERTIFICATE DxgkddiOpmGetCertificate;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> DxgkddiOpmGetCertificate(
  [in]  PVOID MiniportDeviceContext,
  [in]  <a href="dxgkmdt_certificate_type" title="typedef enum _DXGKMDT_CERTIFICATE_TYPE {&#10;  DXGKMDT_OPM_CERTIFICATE,&#10;  DXGKMDT_COPP_CERTIFICATE,&#10;  DXGKMDT_UAB_CERTIFICATE,&#10;  DXGKMDT_INDIRECT_DISPLAY_CERTIFICATE,&#10;  DXGKMDT_FORCE_ULONG&#10;} DXGKMDT_CERTIFICATE_TYPE;">DXGKMDT_CERTIFICATE_TYPE</a> CertificateType,
  [in]  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> CertificateSize,
  [out] PVOID CertificateBuffer
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dispmprt/nc-dispmprt-dxgkddi_opm_get_certificate">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/dxgkddi_opm_get_certificate.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-dispmprt-dxgkddi_opm_get_certificate)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="dxgkddi_opm_get_certificate-callback-function">DXGKDDI_OPM_GET_CERTIFICATE callback function</h1>

<h2 id="description">Description</h2>

<p>The <strong>DxgkDdiOPMGetCertificate</strong> function retrieves a certificate of the given type and size.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="miniportdevicecontext-in"><code>MiniportDeviceContext</code> [in]</h3>

<p>A handle to a context block associated with a display adapter. Previously, the display miniport driver's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dispmprt/nc-dispmprt-dxgkddi_add_device"><strong>DxgkDdiAddDevice</strong></a> function provided this handle to the DirectX graphics kernel subsystem.</p>

<h3 id="certificatetype-in"><code>CertificateType</code> [in]</h3>

<p>A <strong><a href="dxgkmdt_certificate_type" title="typedef enum _DXGKMDT_CERTIFICATE_TYPE {&#10;  DXGKMDT_OPM_CERTIFICATE,&#10;  DXGKMDT_COPP_CERTIFICATE,&#10;  DXGKMDT_UAB_CERTIFICATE,&#10;  DXGKMDT_INDIRECT_DISPLAY_CERTIFICATE,&#10;  DXGKMDT_FORCE_ULONG&#10;} DXGKMDT_CERTIFICATE_TYPE;">DXGKMDT_CERTIFICATE_TYPE</a></strong>-typed value that identifies the type of certificate to retrieve.</p>

<h3 id="certificatesize-in"><code>CertificateSize</code> [in]</h3>

<p>The size, in bytes, of the certificate to retrieve. This size was returned by a call to the display miniport driver's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dispmprt/nc-dispmprt-dxgkddi_opm_get_certificate_size"><strong>DxgkDdiOPMGetCertificateSize</strong></a> function.</p>

<h3 id="certificatebuffer-out"><code>CertificateBuffer</code> [out]</h3>

<p>A pointer to a buffer that receives the requested certificate if <strong>DxgkDdiOPMGetCertificate</strong> returns successfully. If <strong>DxgkDdiOPMGetCertificate</strong> fails, the contents of the buffer are unchanged.</p>

<h2 id="return-value">Return value</h2>

<p><strong>DxgkDdiOPMGetCertificate</strong> returns one of the following values.</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a></td>
  <td>The function successfully retrieved the certificate size.</td>
</tr>
<tr>
  <td>STATUS_GRAPHICS_OPM_NOT_SUPPORTED</td>
  <td>The display miniport driver does not support OPM either because the hardware vendor never signed the OPM license agreement or the miniport driver's graphics hardware does not comply with OPM rules. DxgkDdiOPMGetCertificate can also return this value if the display miniport driver detected tampering.</td>
</tr>
<tr>
  <td>STATUS_GRAPHICS_COPP_NOT_SUPPORTED</td>
  <td>The display miniport driver does not support COPP either because the hardware vendor never signed the COPP license agreement or the miniport driver's graphics hardware does not comply with COPP rules. DxgkDdiOPMGetCertificate can also return this value if the display miniport driver detected tampering.</td>
</tr>
<tr>
  <td>STATUS_GRAPHICS_UAB_NOT_SUPPORTED</td>
  <td>The display miniport driver does not support UAB either because the hardware vendor never signed the UAB license agreement or the miniport driver's graphics hardware does not comply with UAB rules. DxgkDdiOPMGetCertificate can also return this value if the display miniport driver detected tampering.</td>
</tr>
<tr>
  <td>STATUS_GRAPHICS_PVP_HFS_FAILED</td>
  <td>The display miniport driver's hardware functionality scan (HFS) failed or the display miniport driver detected tampering. A display miniport driver can optionally return this value. If DxgkDdiOPMGetCertificate does not return this value for tampering, it can return one of the previous error codes instead.</td>
</tr>
</tbody>
</table>

<p>This function might also return other error codes that are defined in <em>Ntstatus.h</em>.</p>

<h2 id="remarks">Remarks</h2>

<p><strong>DxgkDdiOPMGetCertificate</strong> can retrieve the display miniport driver's OPM certificate, User Accessible Bus (UAB) certificate, or Certified Output Protection Protocol (COPP) certificate. For information about these certificates, download the <a rel="noopener" target="_blank" href="https://view.officeapps.live.com/op/view.aspx?src=https%3A%2F%2Fdownload.microsoft.com%2Fdownload%2F5%2FD%2F6%2F5D6EAF2B-7DDF-476B-93DC-7CF0072878E6%2Foutput_protect.doc%3Fwww.dailytech.com&wdOrigin=BROWSELINK">Output Content Protection and Windows Vista</a> document.</p>

<p><strong>DxgkDdiOPMGetCertificate</strong> should be made pageable.</p>

<h2 id="see-also">See also</h2>

<p><strong><a href="dxgkmdt_certificate_type" title="typedef enum _DXGKMDT_CERTIFICATE_TYPE {&#10;  DXGKMDT_OPM_CERTIFICATE,&#10;  DXGKMDT_COPP_CERTIFICATE,&#10;  DXGKMDT_UAB_CERTIFICATE,&#10;  DXGKMDT_INDIRECT_DISPLAY_CERTIFICATE,&#10;  DXGKMDT_FORCE_ULONG&#10;} DXGKMDT_CERTIFICATE_TYPE;">DXGKMDT_CERTIFICATE_TYPE</a></strong></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dispmprt/nc-dispmprt-dxgkddi_add_device"><strong>DxgkDdiAddDevice</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dispmprt/nc-dispmprt-dxgkddi_opm_get_certificate_size"><strong>DxgkDdiOPMGetCertificateSize</strong></a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dispmprt/nc-dispmprt-dxgkddi_opm_get_certificate">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/dispmprt/nc-dispmprt-dxgkddi_opm_get_certificate.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
