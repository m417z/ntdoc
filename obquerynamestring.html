<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="ObQueryNameString - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ObQueryNameString - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            ObQueryNameString - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntifs.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> ObQueryNameString(
  [in]            PVOID                    Object,
  [out, optional] <a href="object_name_information" title="typedef struct _OBJECT_NAME_INFORMATION&#10;{&#10;    UNICODE_STRING Name; // The object name (when present) includes a NULL-terminator and all path separators &quot;\&quot; in the name.&#10;} OBJECT_NAME_INFORMATION, *POBJECT_NAME_INFORMATION;">POBJECT_NAME_INFORMATION</a> ObjectNameInfo,
  [in]            <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                    Length,
  [out]           PULONG                   ReturnLength
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-obquerynamestring">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/obquerynamestring.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ntifs-obquerynamestring)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="obquerynamestring-function">ObQueryNameString function</h1>

<h2 id="description">Description</h2>

<p>The <strong>ObQueryNameString</strong> routine supplies the name, if there is one, of a given object to which the caller has a pointer.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="object-in"><code>Object</code> [in]</h3>

<p>A pointer to the object for which the name is requested. This parameter is required and cannot be <strong>NULL</strong>.</p>

<h3 id="objectnameinfo-out-optional"><code>ObjectNameInfo</code> [out, optional]</h3>

<p>A pointer to a caller-allocated buffer, of the following type, that receives the object name information:</p>

<pre><code>typedef <a href="object_name_information" title="typedef struct _OBJECT_NAME_INFORMATION&#10;{&#10;    UNICODE_STRING Name; // The object name (when present) includes a NULL-terminator and all path separators &quot;\&quot; in the name.&#10;} OBJECT_NAME_INFORMATION, *POBJECT_NAME_INFORMATION;">struct _OBJECT_NAME_INFORMATION</a> {
  <a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a> Name;
} <a href="object_name_information" title="typedef struct _OBJECT_NAME_INFORMATION&#10;{&#10;    UNICODE_STRING Name; // The object name (when present) includes a NULL-terminator and all path separators &quot;\&quot; in the name.&#10;} OBJECT_NAME_INFORMATION, *POBJECT_NAME_INFORMATION;">OBJECT_NAME_INFORMATION</a>, *<a href="object_name_information" title="typedef struct _OBJECT_NAME_INFORMATION&#10;{&#10;    UNICODE_STRING Name; // The object name (when present) includes a NULL-terminator and all path separators &quot;\&quot; in the name.&#10;} OBJECT_NAME_INFORMATION, *POBJECT_NAME_INFORMATION;">POBJECT_NAME_INFORMATION</a>;
</code></pre>

<p>This parameter is optional and can be <strong>NULL</strong>. If <em>ObjectNameInfo</em> is <strong>NULL</strong>, <em>Length</em> must be zero.</p>

<h3 id="length-in"><code>Length</code> [in]</h3>

<p>The size, in bytes, of the buffer that is pointed to by <em>ObjectNameInfo</em>. This parameter is optional and can be zero. If <em>Length</em> is zero, <em>ReturnLength</em> receives the size, in bytes, of the buffer that is needed to hold the object name information. A reasonable size for the buffer to accommodate most object names is 1024 bytes. If <em>Length</em> is zero, <em>ObjectNameInfo</em> can be <strong>NULL</strong>.</p>

<h3 id="returnlength-out"><code>ReturnLength</code> [out]</h3>

<p>A pointer to a caller-allocated variable that receives the size, in bytes, of the returned object name information. The object name (when present) includes a NULL-terminator and all path separators "\" in the name. If <strong>ObQueryNameString</strong> returns <strong>STATUS_INFO_LENGTH_MISMATCH</strong>, it sets this parameter to the required buffer length.</p>

<h2 id="return-value">Return value</h2>

<p><strong>ObQueryNameString</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> or an <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> value such as the following:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>STATUS_INFO_LENGTH_MISMATCH</strong></td>
  <td>The buffer that is pointed to by <em>ObjectNameInfo</em> is too small to hold the requested object name information. <em>ReturnLength</em> points to the required buffer size. In this case, no object name information is returned. This is an error code. Be aware that if <em>Length</em> is set to zero, <strong>STATUS_INFO_LENGTH_MISMATCH</strong> is returned.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>If the given object is named and the object name was successfully acquired, the returned string is the name of the given object including as much of the object's full path as possible. In this case, <strong>ObQueryNameString</strong> sets <strong>Name.Buffer</strong> to the address of the NULL-terminated name of the specified object. The value of <strong>Name.MaximumLength</strong> is the length of the object name including the <strong>NULL</strong> termination. The value of <strong>Name.Length</strong> is length of the only the object name.</p>

<p>If the given object is unnamed, or if the object name was not successfully acquired, <strong>ObQueryNameString</strong> sets <strong>Name.Buffer</strong> to <strong>NULL</strong> and sets <strong>Name.Length</strong> and <strong>Name.MaximumLength</strong> to zero.</p>

<p>The storage for <em>ObjectNameInfo</em> can be allocated from paged or nonpaged pool.</p>

<h2 id="see-also">See also</h2>

<p><a href="unicode_string" title="typedef struct _UNICODE_STRING&#10;{&#10;    USHORT Length;&#10;    USHORT MaximumLength;&#10;    _Field_size_bytes_part_opt_(MaximumLength, Length) PWCH Buffer;&#10;} UNICODE_STRING, *PUNICODE_STRING;">UNICODE_STRING</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-obquerynamestring">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntifs/nf-ntifs-obquerynamestring.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
