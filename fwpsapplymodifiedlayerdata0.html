<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FwpsApplyModifiedLayerData0 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FwpsApplyModifiedLayerData0 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FwpsApplyModifiedLayerData0 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// fwpsk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">void FwpsApplyModifiedLayerData0(
  [in] <a href="uint64" title="typedef unsigned __int64 UINT64;">UINT64</a> classifyHandle,
  [in] PVOID  modifiedLayerData,
  [in] <a href="uint32" title="typedef unsigned int UINT32;">UINT32</a> flags
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nf-fwpsk-fwpsapplymodifiedlayerdata0">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/fwpsapplymodifiedlayerdata0.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-fwpsk-fwpsapplymodifiedlayerdata0)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>FwpsApplyModifiedLayerData0 function</h1>
<h2>Description</h2>
<p>The <strong>FwpsApplyModifiedLayerData0</strong> function applies changes to layer-specific data made after a call to <a href="fwpsacquirewritablelayerdatapointer0" title="NTSTATUS FwpsAcquireWritableLayerDataPointer0(&#10;  [in]      UINT64             classifyHandle,&#10;  [in]      UINT64             filterId,&#10;  [in]      UINT32             flags,&#10;  [out]     PVOID              *writableLayerData,&#10;  [in, out] FWPS_CLASSIFY_OUT0 *classifyOut&#10;);">FwpsAcquireWritableLayerDataPointer0</a>.</p>
<blockquote>
<p>[!Note]
<strong>FwpsApplyModifiedLayerData0</strong> is a specific version of <strong>FwpsApplyModifiedLayerData</strong>. See <a href="https://learn.microsoft.com/windows/desktop/FWP/wfp-version-independent-names-and-targeting-specific-versions-of-windows">WFP Version-Independent Names and Targeting Specific Versions of Windows</a> for more information.</p>
</blockquote>
<h2>Parameters</h2>
<h3><code>classifyHandle</code> [in]</h3>
<p>The classification handle that identifies the callout driver's processing at the current layer.
This handle is obtained by calling <a href="fwpsacquireclassifyhandle0" title="NTSTATUS FwpsAcquireClassifyHandle0(&#10;  [in]  void   *classifyContext,&#10;  [in]  UINT32 flags,&#10;  [out] UINT64 *classifyHandle&#10;);">FwpsAcquireClassifyHandle0</a>.</p>
<h3><code>modifiedLayerData</code> [in]</h3>
<p>The data buffer obtained by calling <a href="fwpsacquirewritablelayerdatapointer0" title="NTSTATUS FwpsAcquireWritableLayerDataPointer0(&#10;  [in]      UINT64             classifyHandle,&#10;  [in]      UINT64             filterId,&#10;  [in]      UINT32             flags,&#10;  [out]     PVOID              *writableLayerData,&#10;  [in, out] FWPS_CLASSIFY_OUT0 *classifyOut&#10;);">FwpsAcquireWritableLayerDataPointer0</a> with members modified by the callout driver. Supported data types are defined as structures.</p>
<h3><code>flags</code> [in]</h3>
<p>The options to use with this function call. This flag can have the following value.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>FWPS_CLASSIFY_FLAG_REAUTHORIZE_IF_MODIFIED_BY_OTHERS</strong></td>
<td>When set, this flag specifies that data at the layer of the pended classify action should be reauthorized if another callout driver modifies the data before the classification is completed. Use this flag only with pended classify and not inline classify, as its use with inline classify can lead to indeterminate results. If you do call this API for inline classify, set flags to zero.</td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p><strong>FwpsApplyModifiedLayerData0</strong> should be called once for every call made toFwpsAcquireWritableLayerDataPointer0, even if the callout driver didn't modify any data.</p>
<h2>See also</h2>
<p><a href="fwps_bind_request0" title="typedef struct _FWPS_BIND_REQUEST0 {&#10;  SOCKADDR_STORAGE           localAddressAndPort;&#10;  UINT64                     portReservationToken;&#10;  struct _FWPS_BIND_REQUEST0 *previousVersion;&#10;  UINT64                     modifierFilterId;&#10;} FWPS_BIND_REQUEST0;">FWPS_BIND_REQUEST0</a></p>
<p><a href="fwps_connect_request0" title="typedef struct _FWPS_CONNECT_REQUEST0 {&#10;  SOCKADDR_STORAGE              localAddressAndPort;&#10;  SOCKADDR_STORAGE              remoteAddressAndPort;&#10;  UINT64                        portReservationToken;&#10;  DWORD                         localRedirectTargetPID;&#10;  struct _FWPS_CONNECT_REQUEST0 *previousVersion;&#10;  UINT64                        modifierFilterId;&#10;  HANDLE                        localRedirectHandle;&#10;  void                          *localRedirectContext;&#10;  SIZE_T                        localRedirectContextSize;&#10;} FWPS_CONNECT_REQUEST0;">FWPS_CONNECT_REQUEST0</a></p>
<p><a href="https://learn.microsoft.com/windows/win32/api/fwpstypes/ns-fwpstypes-fwps_filter1">FWPS_FILTER1</a></p>
<p><a href="fwpsacquireclassifyhandle0" title="NTSTATUS FwpsAcquireClassifyHandle0(&#10;  [in]  void   *classifyContext,&#10;  [in]  UINT32 flags,&#10;  [out] UINT64 *classifyHandle&#10;);">FwpsAcquireClassifyHandle0</a></p>
<p><a href="fwpsacquirewritablelayerdatapointer0" title="NTSTATUS FwpsAcquireWritableLayerDataPointer0(&#10;  [in]      UINT64             classifyHandle,&#10;  [in]      UINT64             filterId,&#10;  [in]      UINT32             flags,&#10;  [out]     PVOID              *writableLayerData,&#10;  [in, out] FWPS_CLASSIFY_OUT0 *classifyOut&#10;);">FwpsAcquireWritableLayerDataPointer0</a></p>
<p><a href="fwpsreleaseclassifyhandle0" title="void FwpsReleaseClassifyHandle0(&#10;  [in] UINT64 classifyHandle&#10;);">FwpsReleaseClassifyHandle0</a></p>
<p><a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_netvista/">classifyFn</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/nf-fwpsk-fwpsapplymodifiedlayerdata0">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/fwpsk/nf-fwpsk-fwpsapplymodifiedlayerdata0.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
