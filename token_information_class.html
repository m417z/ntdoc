<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="TOKEN_INFORMATION_CLASS - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>TOKEN_INFORMATION_CLASS - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github.ntdoc.min.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github-dark-dimmed.ntdoc.min.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            TOKEN_INFORMATION_CLASS - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header language-cpp">#ifndef _NTSEAPI_H
//
// Authz
//
// begin_rev
#if (PHNT_MODE == PHNT_MODE_KERNEL)

</span><span class="ntdoc-code-intro language-cpp">/**
 * The TOKEN_INFORMATION_CLASS enumeration contains values that specify the type of information
 * being assigned to or retrieved from an access token.
 *
 * \sa <a target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/winnt/ne-winnt-token_information_class">https://learn.microsoft.com/en-us/windows/win32/api/winnt/ne-winnt-token_information_class</a>
 */
</span><span class="ntdoc-code-body language-cpp">typedef enum _TOKEN_INFORMATION_CLASS
{
    TokenUser = 1,                        // q: <a href="token_user" title="typedef struct _TOKEN_USER&#10;{&#10;    SID_AND_ATTRIBUTES User;&#10;} TOKEN_USER, *PTOKEN_USER;">TOKEN_USER</a>, <a href="se_token_user" title="typedef struct _SE_TOKEN_USER&#10;{&#10;    union&#10;    {&#10;        TOKEN_USER TokenUser;&#10;        SID_AND_ATTRIBUTES User;&#10;    } DUMMYUNIONNAME;&#10;    union&#10;    {&#10;        SID Sid;&#10;        BYTE Buffer[SECURITY_MAX_SID_SIZE];&#10;    } DUMMYUNIONNAME2;&#10;} SE_TOKEN_USER, PSE_TOKEN_USER;">SE_TOKEN_USER</a>
    TokenGroups,                          // q: <a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a>
    TokenPrivileges,                      // q: <a href="token_privileges" title="typedef struct _TOKEN_PRIVILEGES&#10;{&#10;    ULONG PrivilegeCount;&#10;    LUID_AND_ATTRIBUTES Privileges[ANYSIZE_ARRAY];&#10;} TOKEN_PRIVILEGES, *PTOKEN_PRIVILEGES;">TOKEN_PRIVILEGES</a>
    TokenOwner,                           // qs: <a href="token_owner" title="typedef struct _TOKEN_OWNER&#10;{&#10;    PSID Owner;&#10;} TOKEN_OWNER, *PTOKEN_OWNER;">TOKEN_OWNER</a>
    TokenPrimaryGroup,                    // qs: <a href="token_primary_group" title="typedef struct _TOKEN_PRIMARY_GROUP&#10;{&#10;    PSID PrimaryGroup;&#10;} TOKEN_PRIMARY_GROUP, *PTOKEN_PRIMARY_GROUP;">TOKEN_PRIMARY_GROUP</a>
    TokenDefaultDacl,                     // qs: <a href="token_default_dacl" title="typedef struct _TOKEN_DEFAULT_DACL&#10;{&#10;    PACL DefaultDacl;&#10;} TOKEN_DEFAULT_DACL, *PTOKEN_DEFAULT_DACL;">TOKEN_DEFAULT_DACL</a>
    TokenSource,                          // q: <a href="token_source" title="typedef struct _TOKEN_SOURCE&#10;{&#10;    CHAR SourceName[TOKEN_SOURCE_LENGTH];&#10;    LUID SourceIdentifier;&#10;} TOKEN_SOURCE, *PTOKEN_SOURCE;">TOKEN_SOURCE</a>
    TokenType,                            // q: <a href="token_type" title="typedef enum _TOKEN_TYPE&#10;{&#10;    TokenPrimary = 1,&#10;    TokenImpersonation&#10;} TOKEN_TYPE;">TOKEN_TYPE</a>
    TokenImpersonationLevel,              // q: <a href="security_impersonation_level" title="typedef enum _SECURITY_IMPERSONATION_LEVEL {&#10;  SecurityAnonymous,&#10;  SecurityIdentification,&#10;  SecurityImpersonation,&#10;  SecurityDelegation&#10;} SECURITY_IMPERSONATION_LEVEL, *PSECURITY_IMPERSONATION_LEVEL;">SECURITY_IMPERSONATION_LEVEL</a>
    TokenStatistics,                      // q: <a href="token_statistics" title="typedef struct _TOKEN_STATISTICS {&#10;  LUID                         TokenId;&#10;  LUID                         AuthenticationId;&#10;  LARGE_INTEGER                ExpirationTime;&#10;  TOKEN_TYPE                   TokenType;&#10;  SECURITY_IMPERSONATION_LEVEL ImpersonationLevel;&#10;  ULONG                        DynamicCharged;&#10;  ULONG                        DynamicAvailable;&#10;  ULONG                        GroupCount;&#10;  ULONG                        PrivilegeCount;&#10;  LUID                         ModifiedId;&#10;} TOKEN_STATISTICS, *PTOKEN_STATISTICS;">TOKEN_STATISTICS</a> // 10
    TokenRestrictedSids,                  // q: <a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a>
    TokenSessionId,                       // qs: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> (requires SeTcbPrivilege)
    TokenGroupsAndPrivileges,             // q: <a href="token_groups_and_privileges" title="typedef struct _TOKEN_GROUPS_AND_PRIVILEGES&#10;{&#10;    ULONG SidCount;&#10;    ULONG SidLength;&#10;    PSID_AND_ATTRIBUTES Sids;&#10;    ULONG RestrictedSidCount;&#10;    ULONG RestrictedSidLength;&#10;    PSID_AND_ATTRIBUTES RestrictedSids;&#10;    ULONG PrivilegeCount;&#10;    ULONG PrivilegeLength;&#10;    PLUID_AND_ATTRIBUTES Privileges;&#10;    LUID AuthenticationId;&#10;} TOKEN_GROUPS_AND_PRIVILEGES, *PTOKEN_GROUPS_AND_PRIVILEGES;">TOKEN_GROUPS_AND_PRIVILEGES</a>
    TokenSessionReference,                // s: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> (requires SeTcbPrivilege)
    TokenSandBoxInert,                    // q: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>
    TokenAuditPolicy,                     // qs: TOKEN_AUDIT_POLICY (requires SeSecurityPrivilege/SeTcbPrivilege)
    TokenOrigin,                          // qs: <a href="token_origin" title="typedef struct _TOKEN_ORIGIN {&#10;  LUID OriginatingLogonSession;&#10;} TOKEN_ORIGIN, *PTOKEN_ORIGIN;">TOKEN_ORIGIN</a> (requires SeTcbPrivilege)
    TokenElevationType,                   // q: TOKEN_ELEVATION_TYPE
    TokenLinkedToken,                     // qs: <a href="token_linked_token" title="typedef struct _TOKEN_LINKED_TOKEN&#10;{&#10;    HANDLE LinkedToken;&#10;} TOKEN_LINKED_TOKEN, *PTOKEN_LINKED_TOKEN;">TOKEN_LINKED_TOKEN</a> (requires SeCreateTokenPrivilege)
    TokenElevation,                       // q: <a href="token_elevation" title="typedef struct _TOKEN_ELEVATION&#10;{&#10;    ULONG TokenIsElevated;&#10;} TOKEN_ELEVATION, *PTOKEN_ELEVATION;">TOKEN_ELEVATION</a> // 20
    TokenHasRestrictions,                 // q: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>
    TokenAccessInformation,               // q: <a href="token_access_information" title="typedef struct _TOKEN_ACCESS_INFORMATION&#10;{&#10;    PSID_AND_ATTRIBUTES_HASH SidHash;&#10;    PSID_AND_ATTRIBUTES_HASH RestrictedSidHash;&#10;    PTOKEN_PRIVILEGES Privileges;&#10;    LUID AuthenticationId;&#10;    TOKEN_TYPE TokenType;&#10;    SECURITY_IMPERSONATION_LEVEL ImpersonationLevel;&#10;    TOKEN_MANDATORY_POLICY MandatoryPolicy;&#10;    ULONG Flags;&#10;    ULONG AppContainerNumber;&#10;    PSID PackageSid;&#10;    PSID_AND_ATTRIBUTES_HASH CapabilitiesHash;&#10;    PSID TrustLevelSid;&#10;    PSECURITY_ATTRIBUTES_OPAQUE SecurityAttributes;&#10;} TOKEN_ACCESS_INFORMATION, *PTOKEN_ACCESS_INFORMATION;">TOKEN_ACCESS_INFORMATION</a>
    TokenVirtualizationAllowed,           // qs: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> (requires SeCreateTokenPrivilege)
    TokenVirtualizationEnabled,           // qs: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>
    TokenIntegrityLevel,                  // qs: <a href="token_mandatory_label" title="typedef struct _TOKEN_MANDATORY_LABEL&#10;{&#10;    SID_AND_ATTRIBUTES Label;&#10;} TOKEN_MANDATORY_LABEL, *PTOKEN_MANDATORY_LABEL;">TOKEN_MANDATORY_LABEL</a>
    TokenUIAccess,                        // qs: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> (requires SeTcbPrivilege)
    TokenMandatoryPolicy,                 // qs: <a href="token_mandatory_policy" title="typedef struct _TOKEN_MANDATORY_POLICY&#10;{&#10;    ULONG Policy;&#10;} TOKEN_MANDATORY_POLICY, *PTOKEN_MANDATORY_POLICY;">TOKEN_MANDATORY_POLICY</a> (requires SeTcbPrivilege)
    TokenLogonSid,                        // q: <a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a>
    TokenIsAppContainer,                  // q: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> // since WIN8
    TokenCapabilities,                    // q: <a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a> // 30
    TokenAppContainerSid,                 // q: TOKEN_APPCONTAINER_INFORMATION
    TokenAppContainerNumber,              // q: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>
    TokenUserClaimAttributes,             // q: CLAIM_SECURITY_ATTRIBUTES_INFORMATION
    TokenDeviceClaimAttributes,           // q: CLAIM_SECURITY_ATTRIBUTES_INFORMATION
    TokenRestrictedUserClaimAttributes,   // q: CLAIM_SECURITY_ATTRIBUTES_INFORMATION
    TokenRestrictedDeviceClaimAttributes, // q: CLAIM_SECURITY_ATTRIBUTES_INFORMATION
    TokenDeviceGroups,                    // q: <a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a>
    TokenRestrictedDeviceGroups,          // q: <a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a>
    TokenSecurityAttributes,              // qs: TOKEN_SECURITY_ATTRIBUTES_[AND_OPERATION_]INFORMATION (requires SeTcbPrivilege)
    TokenIsRestricted,                    // q: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> // 40
    TokenProcessTrustLevel,               // q: <a href="token_process_trust_level" title="typedef struct _TOKEN_PROCESS_TRUST_LEVEL&#10;{&#10;    PSID TrustLevelSid;&#10;} TOKEN_PROCESS_TRUST_LEVEL, *PTOKEN_PROCESS_TRUST_LEVEL;">TOKEN_PROCESS_TRUST_LEVEL</a> // since WINBLUE
    TokenPrivateNameSpace,                // qs: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> (requires SeTcbPrivilege) // since THRESHOLD
    TokenSingletonAttributes,             // q: <a href="token_security_attributes_information" title="typedef struct _TOKEN_SECURITY_ATTRIBUTES_INFORMATION&#10;{&#10;    USHORT Version;&#10;    USHORT Reserved;&#10;    ULONG AttributeCount;&#10;    union&#10;    {&#10;        PTOKEN_SECURITY_ATTRIBUTE_V1 AttributeV1;&#10;    };&#10;} TOKEN_SECURITY_ATTRIBUTES_INFORMATION, *PTOKEN_SECURITY_ATTRIBUTES_INFORMATION;">TOKEN_SECURITY_ATTRIBUTES_INFORMATION</a> // since REDSTONE
    TokenBnoIsolation,                    // q: TOKEN_BNO_ISOLATION_INFORMATION // since REDSTONE2
    TokenChildProcessFlags,               // s: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  (requires SeTcbPrivilege) // since REDSTONE3
    TokenIsLessPrivilegedAppContainer,    // q: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> // since REDSTONE5
    TokenIsSandboxed,                     // q: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> // since 19H1
    TokenIsAppSilo,                       // q: <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> // since WIN11 22H2 // previously TokenOriginatingProcessTrustLevel // q: <a href="token_process_trust_level" title="typedef struct _TOKEN_PROCESS_TRUST_LEVEL&#10;{&#10;    PSID TrustLevelSid;&#10;} TOKEN_PROCESS_TRUST_LEVEL, *PTOKEN_PROCESS_TRUST_LEVEL;">TOKEN_PROCESS_TRUST_LEVEL</a>
    TokenLoggingInformation,              // q: <a href="token_logging_information" title="typedef struct _TOKEN_LOGGING_INFORMATION&#10;{&#10;    TOKEN_TYPE TokenType;&#10;    TOKEN_ELEVATION TokenElevation;&#10;    TOKEN_ELEVATION_TYPE TokenElevationType;&#10;    SECURITY_IMPERSONATION_LEVEL ImpersonationLevel;&#10;    ULONG IntegrityLevel;&#10;    SID_AND_ATTRIBUTES User;&#10;    PSID TrustLevelSid;&#10;    ULONG SessionId;&#10;    ULONG AppContainerNumber;&#10;    LUID AuthenticationId;&#10;    ULONG GroupCount;&#10;    ULONG GroupsLength;&#10;    PSID_AND_ATTRIBUTES Groups;&#10;} TOKEN_LOGGING_INFORMATION, *PTOKEN_LOGGING_INFORMATION;">TOKEN_LOGGING_INFORMATION</a> // since 24H2
    TokenLearningMode,                    // q: // since 25H2
    MaxTokenInfoClass
} TOKEN_INFORMATION_CLASS, *PTOKEN_INFORMATION_CLASS;
</span><span class="ntdoc-code-footer language-cpp">
#endif
// end_rev
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/163d205482d654b16259e736b1d199685b2cc090/phnt/include/ntseapi.h#L65">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header language-cpp">// ntifs.h

</span><span class="ntdoc-code-intro language-cpp"></span><span class="ntdoc-code-body language-cpp">typedef enum _TOKEN_INFORMATION_CLASS {
  TokenUser,
  TokenGroups,
  TokenPrivileges,
  TokenOwner,
  TokenPrimaryGroup,
  TokenDefaultDacl,
  TokenSource,
  TokenType,
  TokenImpersonationLevel,
  TokenStatistics,
  TokenRestrictedSids,
  TokenSessionId,
  TokenGroupsAndPrivileges,
  TokenSessionReference,
  TokenSandBoxInert,
  TokenAuditPolicy,
  TokenOrigin,
  TokenElevationType,
  TokenLinkedToken,
  TokenElevation,
  TokenHasRestrictions,
  TokenAccessInformation,
  TokenVirtualizationAllowed,
  TokenVirtualizationEnabled,
  TokenIntegrityLevel,
  TokenUIAccess,
  TokenMandatoryPolicy,
  TokenLogonSid,
  TokenIsAppContainer,
  TokenCapabilities,
  TokenAppContainerSid,
  TokenAppContainerNumber,
  TokenUserClaimAttributes,
  TokenDeviceClaimAttributes,
  TokenRestrictedUserClaimAttributes,
  TokenRestrictedDeviceClaimAttributes,
  TokenDeviceGroups,
  TokenRestrictedDeviceGroups,
  TokenSecurityAttributes,
  TokenIsRestricted,
  TokenProcessTrustLevel,
  TokenPrivateNameSpace,
  TokenSingletonAttributes,
  TokenBnoIsolation,
  TokenChildProcessFlags,
  TokenIsLessPrivilegedAppContainer,
  TokenIsSandboxed,
  TokenIsAppSilo,
  TokenLoggingInformation,
  TokenLearningMode,
  MaxTokenInfoClass
} TOKEN_INFORMATION_CLASS, *PTOKEN_INFORMATION_CLASS;</span><span class="ntdoc-code-footer language-cpp"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/ne-ntifs-_token_information_class">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<p>This enumeration defines types of information that can be queried or set for tokens. The enumeration is partially documented <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/ne-ntifs-_token_information_class">in Windows Driver Kit</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/winnt/ne-winnt-token_information_class">in Windows SDK</a>.</p>
<h1>Applicable to</h1>
<ul>
<li><code><a href="ntqueryinformationthread" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQueryInformationThread(&#10;    _In_ HANDLE ThreadHandle,&#10;    _In_ THREADINFOCLASS ThreadInformationClass,&#10;    _Out_writes_bytes_(ThreadInformationLength) PVOID ThreadInformation,&#10;    _In_ ULONG ThreadInformationLength,&#10;    _Out_opt_ PULONG ReturnLength&#10;    );">NtQueryInformationThread</a></code></li>
<li><code><a href="ntsetinformationthread" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationThread(&#10;    _In_ HANDLE ThreadHandle,&#10;    _In_ THREADINFOCLASS ThreadInformationClass,&#10;    _In_reads_bytes_(ThreadInformationLength) PVOID ThreadInformation,&#10;    _In_ ULONG ThreadInformationLength&#10;    );">NtSetInformationThread</a></code></li>
</ul>
<h1>Members</h1>
<h2>TokenUser (1)</h2>
<p>Retrieves the user <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> associated with the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_user" title="typedef struct _TOKEN_USER&#10;{&#10;    SID_AND_ATTRIBUTES User;&#10;} TOKEN_USER, *PTOKEN_USER;">TOKEN_USER</a></code> or <code><a href="se_token_user" title="typedef struct _SE_TOKEN_USER&#10;{&#10;    union&#10;    {&#10;        TOKEN_USER TokenUser;&#10;        SID_AND_ATTRIBUTES User;&#10;    } DUMMYUNIONNAME;&#10;    union&#10;    {&#10;        SID Sid;&#10;        BYTE Buffer[SECURITY_MAX_SID_SIZE];&#10;    } DUMMYUNIONNAME2;&#10;} SE_TOKEN_USER, PSE_TOKEN_USER;">SE_TOKEN_USER</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>The user <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> is considered enabled for granting access checks when its attributes don't include the <code>SE_GROUP_USE_FOR_DENY_ONLY</code> flag. Note that this behavior differs from token groups which explicitly require <code>SE_GROUP_ENABLED</code> flag to be set. In other words, an enabled user has attributes set to zero; a filtered/disabled user (see <code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code>) has attributes set to <code>SE_GROUP_USE_FOR_DENY_ONLY</code>.</p>
<h2>TokenGroups (2)</h2>
<p>Retrieves the list of SIDs (group membership) associated with the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>A group <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> is considered enabled for granting access checks when its attributes include <code>SE_GROUP_ENABLED</code>. A group <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> is considered enabled for denying access checks when its attributes include either <code>SE_GROUP_ENABLED</code> or <code>SE_GROUP_USE_FOR_DENY_ONLY</code>.</p>
<h3>See also</h3>
<ul>
<li><code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code></li>
<li><code><a href="ntadjustgroupstoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtAdjustGroupsToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_ BOOLEAN ResetToDefault,&#10;    _In_opt_ PTOKEN_GROUPS NewState,&#10;    _In_opt_ ULONG BufferLength,&#10;    _Out_writes_bytes_to_opt_(BufferLength, *ReturnLength) PTOKEN_GROUPS PreviousState,&#10;    _Out_opt_ PULONG ReturnLength&#10;    );">NtAdjustGroupsToken</a></code></li>
</ul>
<h2>TokenPrivileges (3)</h2>
<p>Retrieves the list of privileges present in the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_privileges" title="typedef struct _TOKEN_PRIVILEGES&#10;{&#10;    ULONG PrivilegeCount;&#10;    LUID_AND_ATTRIBUTES Privileges[ANYSIZE_ARRAY];&#10;} TOKEN_PRIVILEGES, *PTOKEN_PRIVILEGES;">TOKEN_PRIVILEGES</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>A privilege is considered enabled for access checks when its attributes include <code>SE_PRIVILEGE_ENABLED</code>.</p>
<h3>See also</h3>
<ul>
<li><code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code></li>
<li><code><a href="ntadjustprivilegestoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtAdjustPrivilegesToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_ BOOLEAN DisableAllPrivileges,&#10;    _In_opt_ PTOKEN_PRIVILEGES NewState,&#10;    _In_ ULONG BufferLength,&#10;    _Out_writes_bytes_to_opt_(BufferLength, *ReturnLength) PTOKEN_PRIVILEGES PreviousState,&#10;    _Out_opt_ PULONG ReturnLength&#10;    );">NtAdjustPrivilegesToken</a></code></li>
</ul>
<h2>TokenOwner (4)</h2>
<p>Retrieves or sets the default owner <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> for newly created objects.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_owner" title="typedef struct _TOKEN_OWNER&#10;{&#10;    PSID Owner;&#10;} TOKEN_OWNER, *PTOKEN_OWNER;">TOKEN_OWNER</a></code></td>
<td><code><a href="token_owner" title="typedef struct _TOKEN_OWNER&#10;{&#10;    PSID Owner;&#10;} TOKEN_OWNER, *PTOKEN_OWNER;">TOKEN_OWNER</a></code></td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>When changing the value, the provided <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> must be either the user of the token or one of the groups that have the <code>SE_GROUP_OWNER</code> flag. Otherwise, the request fails with <code>STATUS_INVALID_OWNER</code>.</p>
<h3>See also</h3>
<ul>
<li><code><a href="rtlgetownersecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlGetOwnerSecurityDescriptor(&#10;    _In_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _Outptr_result_maybenull_ PSID *Owner,&#10;    _Out_ PBOOLEAN OwnerDefaulted&#10;    );">RtlGetOwnerSecurityDescriptor</a></code></li>
<li><code><a href="rtlsetownersecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlSetOwnerSecurityDescriptor(&#10;    _Inout_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_opt_ PSID Owner,&#10;    _In_ BOOLEAN OwnerDefaulted&#10;    );">RtlSetOwnerSecurityDescriptor</a></code></li>
</ul>
<h2>TokenPrimaryGroup (5)</h2>
<p>Retrieves or sets the default primary group <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> for newly created objects.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_primary_group" title="typedef struct _TOKEN_PRIMARY_GROUP&#10;{&#10;    PSID PrimaryGroup;&#10;} TOKEN_PRIMARY_GROUP, *PTOKEN_PRIMARY_GROUP;">TOKEN_PRIMARY_GROUP</a></code></td>
<td><code><a href="token_primary_group" title="typedef struct _TOKEN_PRIMARY_GROUP&#10;{&#10;    PSID PrimaryGroup;&#10;} TOKEN_PRIMARY_GROUP, *PTOKEN_PRIMARY_GROUP;">TOKEN_PRIMARY_GROUP</a></code></td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>When changing the value, the provided <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> must be either the user or one of the groups of the token. Otherwise, the request fails with <code>STATUS_INVALID_PRIMARY_GROUP</code>.</p>
<h3>See also</h3>
<ul>
<li><code><a href="rtlgetgroupsecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlGetGroupSecurityDescriptor(&#10;    _In_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _Outptr_result_maybenull_ PSID *Group,&#10;    _Out_ PBOOLEAN GroupDefaulted&#10;    );">RtlGetGroupSecurityDescriptor</a></code></li>
<li><code><a href="rtlsetgroupsecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlSetGroupSecurityDescriptor(&#10;    _Inout_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_opt_ PSID Group,&#10;    _In_ BOOLEAN GroupDefaulted&#10;    );">RtlSetGroupSecurityDescriptor</a></code></li>
</ul>
<h2>TokenDefaultDacl (6)</h2>
<p>Retrieves or sets the default discretionary <a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a> (DACL) for newly created objects.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_default_dacl" title="typedef struct _TOKEN_DEFAULT_DACL&#10;{&#10;    PACL DefaultDacl;&#10;} TOKEN_DEFAULT_DACL, *PTOKEN_DEFAULT_DACL;">TOKEN_DEFAULT_DACL</a></code></td>
<td><code><a href="token_default_dacl" title="typedef struct _TOKEN_DEFAULT_DACL&#10;{&#10;    PACL DefaultDacl;&#10;} TOKEN_DEFAULT_DACL, *PTOKEN_DEFAULT_DACL;">TOKEN_DEFAULT_DACL</a></code></td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="rtlgetdaclsecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlGetDaclSecurityDescriptor(&#10;    _In_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _Out_ PBOOLEAN DaclPresent,&#10;    _Outptr_result_maybenull_ PACL *Dacl,&#10;    _Out_ PBOOLEAN DaclDefaulted&#10;    );">RtlGetDaclSecurityDescriptor</a></code></li>
<li><code><a href="rtlsetdaclsecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlSetDaclSecurityDescriptor(&#10;    _Inout_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_ BOOLEAN DaclPresent,&#10;    _In_opt_ PACL Dacl,&#10;    _In_ BOOLEAN DaclDefaulted&#10;    );">RtlSetDaclSecurityDescriptor</a></code></li>
</ul>
<h2>TokenSource (7)</h2>
<p>Retrieves the string and <a href="luid" title="typedef struct _LUID {&#10;  DWORD LowPart;&#10;  LONG  HighPart;&#10;} LUID, *PLUID;">LUID</a> that identify the source of the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_source" title="typedef struct _TOKEN_SOURCE&#10;{&#10;    CHAR SourceName[TOKEN_SOURCE_LENGTH];&#10;    LUID SourceIdentifier;&#10;} TOKEN_SOURCE, *PTOKEN_SOURCE;">TOKEN_SOURCE</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY_SOURCE</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntcreatetoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateToken(&#10;    _Out_ PHANDLE TokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ TOKEN_TYPE Type,&#10;    _In_ PLUID AuthenticationId,&#10;    _In_ PLARGE_INTEGER ExpirationTime,&#10;    _In_ PTOKEN_USER User,&#10;    _In_ PTOKEN_GROUPS Groups,&#10;    _In_ PTOKEN_PRIVILEGES Privileges,&#10;    _In_opt_ PTOKEN_OWNER Owner,&#10;    _In_ PTOKEN_PRIMARY_GROUP PrimaryGroup,&#10;    _In_opt_ PTOKEN_DEFAULT_DACL DefaultDacl,&#10;    _In_ PTOKEN_SOURCE Source&#10;    );">NtCreateToken</a></code></li>
</ul>
<h2>TokenType (8)</h2>
<p>Determines whether the token is a primary token or an impersonation token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_type" title="typedef enum _TOKEN_TYPE&#10;{&#10;    TokenPrimary = 1,&#10;    TokenImpersonation&#10;} TOKEN_TYPE;">TOKEN_TYPE</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntduplicatetoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtDuplicateToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ BOOLEAN EffectiveOnly,&#10;    _In_ TOKEN_TYPE Type,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtDuplicateToken</a></code></li>
</ul>
<h2>TokenImpersonationLevel (9)</h2>
<p>Retrieves the level of impersonation for impersonation-type tokens.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="security_impersonation_level" title="typedef enum _SECURITY_IMPERSONATION_LEVEL {&#10;  SecurityAnonymous,&#10;  SecurityIdentification,&#10;  SecurityImpersonation,&#10;  SecurityDelegation&#10;} SECURITY_IMPERSONATION_LEVEL, *PSECURITY_IMPERSONATION_LEVEL;">SECURITY_IMPERSONATION_LEVEL</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntduplicatetoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtDuplicateToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ BOOLEAN EffectiveOnly,&#10;    _In_ TOKEN_TYPE Type,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtDuplicateToken</a></code></li>
</ul>
<h2>TokenStatistics (10)</h2>
<p>Retrieves various statistics information for the token such its type, the number of groups and privileges, and the associated logon session <a href="luid" title="typedef struct _LUID {&#10;  DWORD LowPart;&#10;  LONG  HighPart;&#10;} LUID, *PLUID;">LUID</a>.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_statistics" title="typedef struct _TOKEN_STATISTICS {&#10;  LUID                         TokenId;&#10;  LUID                         AuthenticationId;&#10;  LARGE_INTEGER                ExpirationTime;&#10;  TOKEN_TYPE                   TokenType;&#10;  SECURITY_IMPERSONATION_LEVEL ImpersonationLevel;&#10;  ULONG                        DynamicCharged;&#10;  ULONG                        DynamicAvailable;&#10;  ULONG                        GroupCount;&#10;  ULONG                        PrivilegeCount;&#10;  LUID                         ModifiedId;&#10;} TOKEN_STATISTICS, *PTOKEN_STATISTICS;">TOKEN_STATISTICS</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h2>TokenRestrictedSids (11)</h2>
<p>Retrieves the list of restricting groups for the secondary access check added via <code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code>.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code></li>
</ul>
<h2>TokenSessionId (12)</h2>
<p>Retrieves or sets the session ID of the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code></td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code></td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td><code>TOKEN_ADJUST_DEFAULT | TOKEN_ADJUST_SESSIONID</code></td>
</tr>
<tr>
<td>Required privilege</td>
<td>None</td>
<td><code>SeTcbPrivilege</code></td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>Attempting to change the session ID of a token that is assigned as a primary process token results in <code>STATUS_TOKEN_ALREADY_IN_USE</code>.</p>
<h2>TokenGroupsAndPrivileges (13)</h2>
<p>Retrieves the list of SIDs, restricting SIDs, and privileges present in the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_groups_and_privileges" title="typedef struct _TOKEN_GROUPS_AND_PRIVILEGES&#10;{&#10;    ULONG SidCount;&#10;    ULONG SidLength;&#10;    PSID_AND_ATTRIBUTES Sids;&#10;    ULONG RestrictedSidCount;&#10;    ULONG RestrictedSidLength;&#10;    PSID_AND_ATTRIBUTES RestrictedSids;&#10;    ULONG PrivilegeCount;&#10;    ULONG PrivilegeLength;&#10;    PLUID_AND_ATTRIBUTES Privileges;&#10;    LUID AuthenticationId;&#10;} TOKEN_GROUPS_AND_PRIVILEGES, *PTOKEN_GROUPS_AND_PRIVILEGES;">TOKEN_GROUPS_AND_PRIVILEGES</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code></li>
<li><code><a href="ntadjustprivilegestoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtAdjustPrivilegesToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_ BOOLEAN DisableAllPrivileges,&#10;    _In_opt_ PTOKEN_PRIVILEGES NewState,&#10;    _In_ ULONG BufferLength,&#10;    _Out_writes_bytes_to_opt_(BufferLength, *ReturnLength) PTOKEN_PRIVILEGES PreviousState,&#10;    _Out_opt_ PULONG ReturnLength&#10;    );">NtAdjustPrivilegesToken</a></code></li>
<li><code><a href="ntadjustgroupstoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtAdjustGroupsToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_ BOOLEAN ResetToDefault,&#10;    _In_opt_ PTOKEN_GROUPS NewState,&#10;    _In_opt_ ULONG BufferLength,&#10;    _Out_writes_bytes_to_opt_(BufferLength, *ReturnLength) PTOKEN_GROUPS PreviousState,&#10;    _Out_opt_ PULONG ReturnLength&#10;    );">NtAdjustGroupsToken</a></code></li>
</ul>
<h2>TokenSessionReference (14)</h2>
<p>Allows releasing token's reference to the associated logon session.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td>N/A</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> (<code>0</code>) or <code>BOOL</code> (<code>FALSE</code>)</td>
</tr>
<tr>
<td>Required access</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>Required privilege</td>
<td>None</td>
<td><code>SeTcbPrivilege</code></td>
</tr>
</tbody>
</table>
<h2>TokenSandBoxInert (15)</h2>
<p>Retrieves whether the token allows bypassing Software Restriction Policies and AppLocker rules. This info class checks for the <code>TOKEN_SANDBOX_INERT</code> token flag.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code></li>
</ul>
<h2>TokenAuditPolicy (16)</h2>
<p>Retrieves and sets the per-user audit policy overrides for the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code>TOKEN_AUDIT_POLICY</code></td>
<td><code>TOKEN_AUDIT_POLICY</code></td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
<td>Required privilege</td>
<td><code>SeSecurityPrivilege</code></td>
<td><code>SeTcbPrivilege</code></td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>Audit policy overrides can only be set once per token. Subsequent attempts to modify this information result in <code>STATUS_INVALID_PARAMETER</code>.</p>
<h2>TokenOrigin (17)</h2>
<p>Retrieves and adjusts the <a href="luid" title="typedef struct _LUID {&#10;  DWORD LowPart;&#10;  LONG  HighPart;&#10;} LUID, *PLUID;">LUID</a> of the originating logon session for the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_origin" title="typedef struct _TOKEN_ORIGIN {&#10;  LUID OriginatingLogonSession;&#10;} TOKEN_ORIGIN, *PTOKEN_ORIGIN;">TOKEN_ORIGIN</a></code></td>
<td><code><a href="token_origin" title="typedef struct _TOKEN_ORIGIN {&#10;  LUID OriginatingLogonSession;&#10;} TOKEN_ORIGIN, *PTOKEN_ORIGIN;">TOKEN_ORIGIN</a></code></td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
<td>Required privilege</td>
<td>None</td>
<td><code>SeTcbPrivilege</code></td>
</tr>
</tbody>
</table>
<h3>Related Win32 API</h3>
<ul>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/ntsecapi/nf-ntsecapi-lsalogonuser"><code>LsaLogonUser</code></a></li>
</ul>
<h2>TokenElevationType (18)</h2>
<p>Determines the elevation type of the logon session associated with the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code>TOKEN_ELEVATION_TYPE</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>This information is not per se a property of the token but rather its logon session.</p>
<h2>TokenLinkedToken (19)</h2>
<p>Opens a copy of a token from the linked logon session or links logon sessions of the two tokens.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_linked_token" title="typedef struct _TOKEN_LINKED_TOKEN&#10;{&#10;    HANDLE LinkedToken;&#10;} TOKEN_LINKED_TOKEN, *PTOKEN_LINKED_TOKEN;">TOKEN_LINKED_TOKEN</a></code></td>
<td><code><a href="token_linked_token" title="typedef struct _TOKEN_LINKED_TOKEN&#10;{&#10;    HANDLE LinkedToken;&#10;} TOKEN_LINKED_TOKEN, *PTOKEN_LINKED_TOKEN;">TOKEN_LINKED_TOKEN</a></code></td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td><code>TOKEN_ADJUST_DEFAULT | TOKEN_QUERY</code> (on both handles)</td>
</tr>
<tr>
<td>Required privilege</td>
<td>None</td>
<td><code>SeCreateTokenPrivilege</code></td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>Querying this information class returns a primary token when the caller has <code>SeTcbPrivilege</code> enabled and an identification-level token otherwise.</p>
<p>Settings linked token requires both tokens to be primary and belong to logon sessions that are not already linked. The token passed in the first parameter to <code><a href="ntsetinformationtoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_ TOKEN_INFORMATION_CLASS TokenInformationClass,&#10;    _In_reads_bytes_(TokenInformationLength) PVOID TokenInformation,&#10;    _In_ ULONG TokenInformationLength&#10;    );">NtSetInformationToken</a></code> provides the logon session to be marked as elevated while the token passed via the buffer becomes the limited logon session.</p>
<h2>TokenElevation (20)</h2>
<p>Determines whether the token is elevated by checking if it contains any sensitive groups (see <code><a href="rtliselevatedrid" title="NTSYSAPI&#10;BOOLEAN&#10;NTAPI&#10;RtlIsElevatedRid(&#10;    _In_ PSID_AND_ATTRIBUTES SidAttr&#10;    );">RtlIsElevatedRid</a></code>) or privileges.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_elevation" title="typedef struct _TOKEN_ELEVATION&#10;{&#10;    ULONG TokenIsElevated;&#10;} TOKEN_ELEVATION, *PTOKEN_ELEVATION;">TOKEN_ELEVATION</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h2>TokenHasRestrictions (21)</h2>
<p>Determines whether the token has been filtered via <code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code>. This info class checks token flags for <code>TOKEN_IS_RESTRICTED | TOKEN_IS_FILTERED</code>.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code></li>
</ul>
<h2>TokenAccessInformation (22)</h2>
<p>Retrieves various access-related information such as the <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> hashes, privileges, and token flags.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_access_information" title="typedef struct _TOKEN_ACCESS_INFORMATION&#10;{&#10;    PSID_AND_ATTRIBUTES_HASH SidHash;&#10;    PSID_AND_ATTRIBUTES_HASH RestrictedSidHash;&#10;    PTOKEN_PRIVILEGES Privileges;&#10;    LUID AuthenticationId;&#10;    TOKEN_TYPE TokenType;&#10;    SECURITY_IMPERSONATION_LEVEL ImpersonationLevel;&#10;    TOKEN_MANDATORY_POLICY MandatoryPolicy;&#10;    ULONG Flags;&#10;    ULONG AppContainerNumber;&#10;    PSID PackageSid;&#10;    PSID_AND_ATTRIBUTES_HASH CapabilitiesHash;&#10;    PSID TrustLevelSid;&#10;    PSECURITY_ATTRIBUTES_OPAQUE SecurityAttributes;&#10;} TOKEN_ACCESS_INFORMATION, *PTOKEN_ACCESS_INFORMATION;">TOKEN_ACCESS_INFORMATION</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h2>TokenVirtualizationAllowed (23)</h2>
<p>Retrieves or sets whether the token allows enabling UAC filesystem and registry virtualization. This info class accesses the <code>TOKEN_VIRTUALIZE_ALLOWED</code> token flag.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
<td>Required privilege</td>
<td>None</td>
<td><code>SeCreateTokenPrivilege</code></td>
</tr>
</tbody>
</table>
<h2>TokenVirtualizationEnabled (24)</h2>
<p>Retrieves or sets whether UAC filesystem and registry virtualization is enabled for the token. This info class accesses the <code>TOKEN_VIRTUALIZE_ENABLED</code> token flag.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
</tbody>
</table>
<h2>TokenIntegrityLevel (25)</h2>
<p>Retrieves or changes the integrity level of the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_mandatory_label" title="typedef struct _TOKEN_MANDATORY_LABEL&#10;{&#10;    SID_AND_ATTRIBUTES Label;&#10;} TOKEN_MANDATORY_LABEL, *PTOKEN_MANDATORY_LABEL;">TOKEN_MANDATORY_LABEL</a></code></td>
<td><code><a href="token_mandatory_label" title="typedef struct _TOKEN_MANDATORY_LABEL&#10;{&#10;    SID_AND_ATTRIBUTES Label;&#10;} TOKEN_MANDATORY_LABEL, *PTOKEN_MANDATORY_LABEL;">TOKEN_MANDATORY_LABEL</a></code></td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
<td>Required privilege</td>
<td>None</td>
<td>None to lower; <code>SeTcbPrivilege</code> to raise</td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>Attempting to raise integrity level of a token that is assigned as a primary process token results in <code>STATUS_TOKEN_ALREADY_IN_USE</code>.</p>
<p>Lowering integrity automatically disables incompatible privileges and prevents them from being enabled.</p>
<h2>TokenUIAccess (26)</h2>
<p>Retrieves or sets whether the token allows bypassing User Interface Privilege Isolation (UIPI). This info class accesses the <code>TOKEN_UIACCESS</code> token flag.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
<td>Required privilege</td>
<td>None</td>
<td>None to disable; <code>SeTcbPrivilege</code> to enable</td>
</tr>
</tbody>
</table>
<h2>TokenMandatoryPolicy (27)</h2>
<p>Retrieves or sets mandatory policy for the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_mandatory_policy" title="typedef struct _TOKEN_MANDATORY_POLICY&#10;{&#10;    ULONG Policy;&#10;} TOKEN_MANDATORY_POLICY, *PTOKEN_MANDATORY_POLICY;">TOKEN_MANDATORY_POLICY</a></code></td>
<td><code><a href="token_mandatory_policy" title="typedef struct _TOKEN_MANDATORY_POLICY&#10;{&#10;    ULONG Policy;&#10;} TOKEN_MANDATORY_POLICY, *PTOKEN_MANDATORY_POLICY;">TOKEN_MANDATORY_POLICY</a></code></td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
<td>Required privilege</td>
<td>None</td>
<td><code>SeTcbPrivilege</code></td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>Attempting to change mandatory policy of a token that is assigned as a primary process token results in <code>STATUS_TOKEN_ALREADY_IN_USE</code>.</p>
<h2>TokenLogonSid (28)</h2>
<p>Finds (the first) logon <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> (a group with <code>SE_GROUP_LOGON_ID</code> flag) in the list of token groups.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h2>TokenIsAppContainer (29)</h2>
<p>Determines whether the token is an AppContainer/LowBox token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 8</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>AppContainer tokens perform an additional access check against the corresponding AppContainer <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a>, <code>ALL APPLICATION PACKAGES</code> <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> (<code>S-1-15-2-1</code>), and the list of provided capabilities.</p>
<h3>See also</h3>
<ul>
<li><code><a href="ntcreatelowboxtoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateLowBoxToken(&#10;    _Out_ PHANDLE TokenHandle,&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ PSID PackageSid,&#10;    _In_ ULONG CapabilityCount,&#10;    _In_reads_opt_(CapabilityCount) PSID_AND_ATTRIBUTES Capabilities,&#10;    _In_ ULONG HandleCount,&#10;    _In_reads_opt_(HandleCount) HANDLE *Handles&#10;    );">NtCreateLowBoxToken</a></code></li>
</ul>
<h2>TokenCapabilities (30)</h2>
<p>Retrieves the list of capability SIDs associated with the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 8</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntcreatelowboxtoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateLowBoxToken(&#10;    _Out_ PHANDLE TokenHandle,&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ PSID PackageSid,&#10;    _In_ ULONG CapabilityCount,&#10;    _In_reads_opt_(CapabilityCount) PSID_AND_ATTRIBUTES Capabilities,&#10;    _In_ ULONG HandleCount,&#10;    _In_reads_opt_(HandleCount) HANDLE *Handles&#10;    );">NtCreateLowBoxToken</a></code></li>
</ul>
<h2>TokenAppContainerSid (31)</h2>
<p>Retrieves the AppContainer/Package <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> associated with a LowBox token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code>TOKEN_APPCONTAINER_INFORMATION</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 8</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>AppContainer tokens perform an additional access check against the AppContainer <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a>, <code>ALL APPLICATION PACKAGES</code> <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> (<code>S-1-15-2-1</code>), and the list of provided capabilities.</p>
<h3>See also</h3>
<ul>
<li><code><a href="ntcreatelowboxtoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateLowBoxToken(&#10;    _Out_ PHANDLE TokenHandle,&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ PSID PackageSid,&#10;    _In_ ULONG CapabilityCount,&#10;    _In_reads_opt_(CapabilityCount) PSID_AND_ATTRIBUTES Capabilities,&#10;    _In_ ULONG HandleCount,&#10;    _In_reads_opt_(HandleCount) HANDLE *Handles&#10;    );">NtCreateLowBoxToken</a></code></li>
</ul>
<h2>TokenAppContainerNumber (32)</h2>
<p>Retrieves the token AppContainer/LowBox number.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 8</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h2>TokenUserClaimAttributes (33)</h2>
<p>Retrieves the list of user claim attributes associated with the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code>CLAIM_SECURITY_ATTRIBUTES_INFORMATION</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 8</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntcreatetokenex" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateTokenEx(&#10;    _Out_ PHANDLE TokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ TOKEN_TYPE Type,&#10;    _In_ PLUID AuthenticationId,&#10;    _In_ PLARGE_INTEGER ExpirationTime,&#10;    _In_ PTOKEN_USER User,&#10;    _In_ PTOKEN_GROUPS Groups,&#10;    _In_ PTOKEN_PRIVILEGES Privileges,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION UserAttributes,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION DeviceAttributes,&#10;    _In_opt_ PTOKEN_GROUPS DeviceGroups,&#10;    _In_opt_ PTOKEN_MANDATORY_POLICY MandatoryPolicy,&#10;    _In_opt_ PTOKEN_OWNER Owner,&#10;    _In_ PTOKEN_PRIMARY_GROUP PrimaryGroup,&#10;    _In_opt_ PTOKEN_DEFAULT_DACL DefaultDacl,&#10;...">NtCreateTokenEx</a></code></li>
</ul>
<h2>TokenDeviceClaimAttributes (34)</h2>
<p>Retrieves the list of device claim attributes associated with the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code>CLAIM_SECURITY_ATTRIBUTES_INFORMATION</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 8</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntcreatetokenex" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateTokenEx(&#10;    _Out_ PHANDLE TokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ TOKEN_TYPE Type,&#10;    _In_ PLUID AuthenticationId,&#10;    _In_ PLARGE_INTEGER ExpirationTime,&#10;    _In_ PTOKEN_USER User,&#10;    _In_ PTOKEN_GROUPS Groups,&#10;    _In_ PTOKEN_PRIVILEGES Privileges,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION UserAttributes,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION DeviceAttributes,&#10;    _In_opt_ PTOKEN_GROUPS DeviceGroups,&#10;    _In_opt_ PTOKEN_MANDATORY_POLICY MandatoryPolicy,&#10;    _In_opt_ PTOKEN_OWNER Owner,&#10;    _In_ PTOKEN_PRIMARY_GROUP PrimaryGroup,&#10;    _In_opt_ PTOKEN_DEFAULT_DACL DefaultDacl,&#10;...">NtCreateTokenEx</a></code></li>
</ul>
<h2>TokenRestrictedUserClaimAttributes (35)</h2>
<p>Retrieves the list of restricted user claim attributes associated with the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code>CLAIM_SECURITY_ATTRIBUTES_INFORMATION</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 8</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntfiltertokenex" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterTokenEx(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _In_ ULONG DisableUserClaimsCount,&#10;    _In_opt_ PCUNICODE_STRING UserClaimsToDisable,&#10;    _In_ ULONG DisableDeviceClaimsCount,&#10;    _In_opt_ PCUNICODE_STRING DeviceClaimsToDisable,&#10;    _In_opt_ PTOKEN_GROUPS DeviceGroupsToDisable,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION RestrictedUserAttributes,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION RestrictedDeviceAttributes,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedDeviceGroups,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterTokenEx</a></code></li>
</ul>
<h2>TokenRestrictedDeviceClaimAttributes (36)</h2>
<p>Retrieves the list of restricted device claim attributes associated with the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code>CLAIM_SECURITY_ATTRIBUTES_INFORMATION</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 8</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntfiltertokenex" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterTokenEx(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _In_ ULONG DisableUserClaimsCount,&#10;    _In_opt_ PCUNICODE_STRING UserClaimsToDisable,&#10;    _In_ ULONG DisableDeviceClaimsCount,&#10;    _In_opt_ PCUNICODE_STRING DeviceClaimsToDisable,&#10;    _In_opt_ PTOKEN_GROUPS DeviceGroupsToDisable,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION RestrictedUserAttributes,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION RestrictedDeviceAttributes,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedDeviceGroups,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterTokenEx</a></code></li>
</ul>
<h2>TokenDeviceGroups (37)</h2>
<p>Retrieves the list of device group SIDs device claim attributes associated with the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 8</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntcreatetokenex" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateTokenEx(&#10;    _Out_ PHANDLE TokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ TOKEN_TYPE Type,&#10;    _In_ PLUID AuthenticationId,&#10;    _In_ PLARGE_INTEGER ExpirationTime,&#10;    _In_ PTOKEN_USER User,&#10;    _In_ PTOKEN_GROUPS Groups,&#10;    _In_ PTOKEN_PRIVILEGES Privileges,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION UserAttributes,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION DeviceAttributes,&#10;    _In_opt_ PTOKEN_GROUPS DeviceGroups,&#10;    _In_opt_ PTOKEN_MANDATORY_POLICY MandatoryPolicy,&#10;    _In_opt_ PTOKEN_OWNER Owner,&#10;    _In_ PTOKEN_PRIMARY_GROUP PrimaryGroup,&#10;    _In_opt_ PTOKEN_DEFAULT_DACL DefaultDacl,&#10;...">NtCreateTokenEx</a></code></li>
</ul>
<h2>TokenRestrictedDeviceGroups (38)</h2>
<p>Retrieves the list of restricted device group SIDs device claim attributes associated with the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 8</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntfiltertokenex" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterTokenEx(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _In_ ULONG DisableUserClaimsCount,&#10;    _In_opt_ PCUNICODE_STRING UserClaimsToDisable,&#10;    _In_ ULONG DisableDeviceClaimsCount,&#10;    _In_opt_ PCUNICODE_STRING DeviceClaimsToDisable,&#10;    _In_opt_ PTOKEN_GROUPS DeviceGroupsToDisable,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION RestrictedUserAttributes,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION RestrictedDeviceAttributes,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedDeviceGroups,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterTokenEx</a></code></li>
</ul>
<h2>TokenSecurityAttributes (39)</h2>
<p>Retrieves or modifies the list of security attributes associated with the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_security_attributes_information" title="typedef struct _TOKEN_SECURITY_ATTRIBUTES_INFORMATION&#10;{&#10;    USHORT Version;&#10;    USHORT Reserved;&#10;    ULONG AttributeCount;&#10;    union&#10;    {&#10;        PTOKEN_SECURITY_ATTRIBUTE_V1 AttributeV1;&#10;    };&#10;} TOKEN_SECURITY_ATTRIBUTES_INFORMATION, *PTOKEN_SECURITY_ATTRIBUTES_INFORMATION;">TOKEN_SECURITY_ATTRIBUTES_INFORMATION</a></code></td>
<td><code><a href="token_security_attributes_and_operation_information" title="typedef struct _TOKEN_SECURITY_ATTRIBUTES_AND_OPERATION_INFORMATION&#10;{&#10;    PTOKEN_SECURITY_ATTRIBUTES_INFORMATION Attributes;&#10;    PTOKEN_SECURITY_ATTRIBUTE_OPERATION Operations;&#10;} TOKEN_SECURITY_ATTRIBUTES_AND_OPERATION_INFORMATION, *PTOKEN_SECURITY_ATTRIBUTES_AND_OPERATION_INFORMATION;">TOKEN_SECURITY_ATTRIBUTES_AND_OPERATION_INFORMATION</a></code></td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
<td>Required privilege</td>
<td>None</td>
<td><code>SeTcbPrivilege</code></td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 8</td>
<td>Windows 8</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntquerysecurityattributestoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQuerySecurityAttributesToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_reads_opt_(NumberOfAttributes) PCUNICODE_STRING Attributes,&#10;    _In_ ULONG NumberOfAttributes,&#10;    _Out_writes_bytes_(Length) PVOID Buffer, // PTOKEN_SECURITY_ATTRIBUTES_INFORMATION&#10;    _In_ ULONG Length,&#10;    _Out_ PULONG ReturnLength&#10;    );">NtQuerySecurityAttributesToken</a></code></li>
</ul>
<h2>TokenIsRestricted (40)</h2>
<p>Determines if the token is restricted (i.e., requires a secondary access check against the list of restricting SIDs). This info class checks token flags for <code>TOKEN_IS_RESTRICTED | TOKEN_WRITE_RESTRICTED</code>.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 8</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code></li>
</ul>
<h2>TokenProcessTrustLevel (41)</h2>
<p>Retrieves the process trust level (protection/PPL) <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> associated with the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_process_trust_level" title="typedef struct _TOKEN_PROCESS_TRUST_LEVEL&#10;{&#10;    PSID TrustLevelSid;&#10;} TOKEN_PROCESS_TRUST_LEVEL, *PTOKEN_PROCESS_TRUST_LEVEL;">TOKEN_PROCESS_TRUST_LEVEL</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 8.1</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="ps_attribute_protection_level" title="#define PS_ATTRIBUTE_PROTECTION_LEVEL \&#10;    PsAttributeValue(PsAttributeProtectionLevel, FALSE, TRUE, TRUE)">PS_ATTRIBUTE_PROTECTION_LEVEL</a></code></li>
</ul>
<h2>TokenPrivateNameSpace (42)</h2>
<p>This info class accesses the <code>TOKEN_PRIVATE_NAMESPACE</code> token flag.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
<td>Required privilege</td>
<td>None</td>
<td><code>SeTcbPrivilege</code></td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 10 TH1 (1507)</td>
<td>Windows 10 TH1 (1507)</td>
</tr>
</tbody>
</table>
<h2>TokenSingletonAttributes (43)</h2>
<p>Retrieves the list of singleton attributes associated with the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_security_attributes_information" title="typedef struct _TOKEN_SECURITY_ATTRIBUTES_INFORMATION&#10;{&#10;    USHORT Version;&#10;    USHORT Reserved;&#10;    ULONG AttributeCount;&#10;    union&#10;    {&#10;        PTOKEN_SECURITY_ATTRIBUTE_V1 AttributeV1;&#10;    };&#10;} TOKEN_SECURITY_ATTRIBUTES_INFORMATION, *PTOKEN_SECURITY_ATTRIBUTES_INFORMATION;">TOKEN_SECURITY_ATTRIBUTES_INFORMATION</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 10 RS1 (1607)</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h2>TokenBnoIsolation (44)</h2>
<p>Retrieves the Base Named Object Isolation rules for the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code>TOKEN_BNO_ISOLATION_INFORMATION</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 10 RS2 (1703)</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="proc_thread_attribute_bno_isolation" title="#define PROC_THREAD_ATTRIBUTE_BNO_ISOLATION \&#10;    ProcThreadAttributeValue(ProcThreadAttributeBnoIsolation, FALSE, TRUE, FALSE)">PROC_THREAD_ATTRIBUTE_BNO_ISOLATION</a></code></li>
</ul>
<h2>TokenChildProcessFlags (45)</h2>
<p>Removes the child process creation restriction from the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td>N/A</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> (<code>0</code>) or <code>BOOL</code> (<code>FALSE</code>)</td>
</tr>
<tr>
<td>Required access</td>
<td>N/A</td>
<td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
<td>Minimal version</td>
<td>N/A</td>
<td>Windows 10 RS3 (1709)</td>
</tr>
<tr>
<td>Required privilege</td>
<td>N/A</td>
<td><code>SeTcbPrivilege</code></td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>To check the existing child process creation restrictions, query token flags and test them for <code>TOKEN_NO_CHILD_PROCESS</code>, <code>TOKEN_NO_CHILD_PROCESS_UNLESS_SECURE</code>, and <code>TOKEN_AUDIT_NO_CHILD_PROCESS</code>.</p>
<h2>See also</h2>
<ul>
<li><code><a href="ntqueryinformationprocess" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQueryInformationProcess(&#10;    _In_ HANDLE ProcessHandle,&#10;    _In_ PROCESSINFOCLASS ProcessInformationClass,&#10;    _Out_writes_bytes_(ProcessInformationLength) PVOID ProcessInformation,&#10;    _In_ ULONG ProcessInformationLength,&#10;    _Out_opt_ PULONG ReturnLength&#10;    );">NtQueryInformationProcess</a></code> with <code><a href="processinfoclass" title="typedef enum _PROCESSINFOCLASS&#10;{&#10;    ProcessBasicInformation,                        // q: PROCESS_BASIC_INFORMATION, PROCESS_EXTENDED_BASIC_INFORMATION&#10;    ProcessQuotaLimits,                             // qs: QUOTA_LIMITS, QUOTA_LIMITS_EX&#10;    ProcessIoCounters,                              // q: IO_COUNTERS&#10;    ProcessVmCounters,                              // q: VM_COUNTERS, VM_COUNTERS_EX, VM_COUNTERS_EX2&#10;    ProcessTimes,                                   // q: KERNEL_USER_TIMES&#10;    ProcessBasePriority,                            // s: KPRIORITY&#10;    ProcessRaisePriority,                           // s: ULONG&#10;    ProcessDebugPort,                               // q: HANDLE&#10;    ProcessExceptionPort,                           // s: PROCESS_EXCEPTION_PORT (requires SeTcbPrivilege)&#10;    ProcessAccessToken,                             // s: PROCESS_ACCESS_TOKEN&#10;    ProcessLdtInformation,                          // qs: PROCESS_LDT_INFORMATION // 10&#10;    ProcessLdtSize,                                 // s: PROCESS_LDT_SIZE&#10;    ProcessDefaultHardErrorMode,                    // qs: ULONG&#10;    ProcessIoPortHandlers,                          // s: PROCESS_IO_PORT_HANDLER_INFORMATION // (kernel-mode only)&#10;    ProcessPooledUsageAndLimits,                    // q: POOLED_USAGE_AND_LIMITS&#10;    ProcessWorkingSetWatch,                         // q: PROCESS_WS_WATCH_INFORMATION[]; s: void&#10;    ProcessUserModeIOPL,                            // qs: ULONG (requires SeTcbPrivilege)&#10;    ProcessEnableAlignmentFaultFixup,               // s: BOOLEAN&#10;...">PROCESSINFOCLASS</a></code> value of <code>ProcessChildProcessInformation</code> (73)</li>
<li><code><a href="ps_attribute_child_process_policy" title="#define PS_ATTRIBUTE_CHILD_PROCESS_POLICY \&#10;    PsAttributeValue(PsAttributeChildProcessPolicy, FALSE, TRUE, FALSE)">PS_ATTRIBUTE_CHILD_PROCESS_POLICY</a></code></li>
</ul>
<h2>TokenIsLessPrivilegedAppContainer (46)</h2>
<p>Determines if the token is a Less Privileged AppContainer (LPAC) token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 10 RS5 (1809)</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>The LPAC flag replaces a regular AppContainer access check against <code>ALL APPLICATION PACKAGES</code> (<code>S-1-15-2-1</code>) with a check against <code>ALL RESTRICTED APPLICATION PACKAGES</code> (<code>S-1-15-2-2</code>).</p>
<p>Alternatively, you can query the <code>WIN://NOALLAPPPKG</code> attribute via the <code><a href="ntquerysecurityattributestoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQuerySecurityAttributesToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_reads_opt_(NumberOfAttributes) PCUNICODE_STRING Attributes,&#10;    _In_ ULONG NumberOfAttributes,&#10;    _Out_writes_bytes_(Length) PVOID Buffer, // PTOKEN_SECURITY_ATTRIBUTES_INFORMATION&#10;    _In_ ULONG Length,&#10;    _Out_ PULONG ReturnLength&#10;    );">NtQuerySecurityAttributesToken</a></code> function or the <code>TokenSecurityAttributes</code> info class and test for a non-zero value.</p>
<h3>See also</h3>
<ul>
<li><code><a href="ps_attribute_all_application_packages_policy" title="#define PS_ATTRIBUTE_ALL_APPLICATION_PACKAGES_POLICY \&#10;    PsAttributeValue(PsAttributeAllApplicationPackagesPolicy, FALSE, TRUE, FALSE)">PS_ATTRIBUTE_ALL_APPLICATION_PACKAGES_POLICY</a></code></li>
</ul>
<h2>TokenIsSandboxed (47)</h2>
<p>Determines if the token is considered sandboxed (i.e., has integrity level below medium).</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 10 19H1 (1903)</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>See also</h3>
<ul>
<li><code><a href="rtlchecksandboxedtoken" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlCheckSandboxedToken(&#10;    _In_opt_ HANDLE TokenHandle,&#10;    _Out_ PBOOLEAN IsSandboxed&#10;    );">RtlCheckSandboxedToken</a></code></li>
</ul>
<h2>TokenIsAppSilo (48)</h2>
<p>Determines if the token has the AppSilo capability (<code>S-1-15-3-65536</code>).</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></code> or <code>BOOL</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 11 22H2</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3>Remarks</h3>
<p>This info class value was previously known as <code>TokenOriginatingProcessTrustLevel</code>.</p>
<h3>See also</h3>
<ul>
<li><code><a href="rtliscapabilitysid" title="NTSYSAPI&#10;BOOLEAN&#10;NTAPI&#10;RtlIsCapabilitySid(&#10;    _In_ PSID Sid&#10;    );">RtlIsCapabilitySid</a></code></li>
<li><code><a href="rtlderivecapabilitysidsfromname" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlDeriveCapabilitySidsFromName(&#10;    _Inout_ PUNICODE_STRING UnicodeString,&#10;    _Out_ PSID CapabilityGroupSid,&#10;    _Out_ PSID CapabilitySid&#10;    );">RtlDeriveCapabilitySidsFromName</a></code></li>
</ul>
<h2>TokenLoggingInformation (49)</h2>
<p>Returns logging information associated with the token.</p>
<table>
<thead>
<tr>
<th></th>
<th>Query</th>
<th>Set</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td><code><a href="token_logging_information" title="typedef struct _TOKEN_LOGGING_INFORMATION&#10;{&#10;    TOKEN_TYPE TokenType;&#10;    TOKEN_ELEVATION TokenElevation;&#10;    TOKEN_ELEVATION_TYPE TokenElevationType;&#10;    SECURITY_IMPERSONATION_LEVEL ImpersonationLevel;&#10;    ULONG IntegrityLevel;&#10;    SID_AND_ATTRIBUTES User;&#10;    PSID TrustLevelSid;&#10;    ULONG SessionId;&#10;    ULONG AppContainerNumber;&#10;    LUID AuthenticationId;&#10;    ULONG GroupCount;&#10;    ULONG GroupsLength;&#10;    PSID_AND_ATTRIBUTES Groups;&#10;} TOKEN_LOGGING_INFORMATION, *PTOKEN_LOGGING_INFORMATION;">TOKEN_LOGGING_INFORMATION</a></code></td>
<td>N/A</td>
</tr>
<tr>
<td>Required access</td>
<td><code>TOKEN_QUERY</code></td>
<td>N/A</td>
</tr>
<tr>
<td>Minimal version</td>
<td>Windows 11 24H2</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/token_information_class.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ne-ntifs-_token_information_class)</h1>
</div>
<div class="ntdoc-description">
<h1>TOKEN_INFORMATION_CLASS enumeration</h1>
<h2>Description</h2>
<p>The <strong>TOKEN_INFORMATION_CLASS</strong> enumeration type contains values that specify the type of information being assigned to or retrieved from an access token.</p>
<p><strong><a href="sequeryinformationtoken" title="NTSTATUS SeQueryInformationToken(&#10;  [in]  PACCESS_TOKEN           Token,&#10;  [in]  TOKEN_INFORMATION_CLASS TokenInformationClass,&#10;  [out] PVOID                   *TokenInformation&#10;);">SeQueryInformationToken</a></strong> and <strong><a href="ntqueryinformationtoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQueryInformationToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_ TOKEN_INFORMATION_CLASS TokenInformationClass,&#10;    _Out_writes_bytes_to_opt_(TokenInformationLength, *ReturnLength) PVOID TokenInformation,&#10;    _In_ ULONG TokenInformationLength,&#10;    _Out_ PULONG ReturnLength&#10;    );">ZwQueryInformationToken</a></strong> use <strong>TOKEN_INFORMATION_CLASS</strong> values to indicate the type of token information to retrieve.</p>
<h2>Constants</h2>
<h3><code>TokenUser</code></h3>
<p>The buffer receives a <strong><a href="token_user" title="typedef struct _TOKEN_USER&#10;{&#10;    SID_AND_ATTRIBUTES User;&#10;} TOKEN_USER, *PTOKEN_USER;">TOKEN_USER</a></strong> structure containing the token's user account.</p>
<h3><code>TokenGroups</code></h3>
<p>The buffer receives a <strong><a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a></strong> structure containing the group accounts associated with the token.</p>
<h3><code>TokenPrivileges</code></h3>
<p>The buffer receives a <strong><a href="token_privileges" title="typedef struct _TOKEN_PRIVILEGES&#10;{&#10;    ULONG PrivilegeCount;&#10;    LUID_AND_ATTRIBUTES Privileges[ANYSIZE_ARRAY];&#10;} TOKEN_PRIVILEGES, *PTOKEN_PRIVILEGES;">TOKEN_PRIVILEGES</a></strong> structure containing the token's privileges.</p>
<h3><code>TokenOwner</code></h3>
<p>The buffer receives a <strong><a href="token_owner" title="typedef struct _TOKEN_OWNER&#10;{&#10;    PSID Owner;&#10;} TOKEN_OWNER, *PTOKEN_OWNER;">TOKEN_OWNER</a></strong> structure containing the default owner <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> for newly created objects.</p>
<h3><code>TokenPrimaryGroup</code></h3>
<p>The buffer receives a <strong><a href="token_primary_group" title="typedef struct _TOKEN_PRIMARY_GROUP&#10;{&#10;    PSID PrimaryGroup;&#10;} TOKEN_PRIMARY_GROUP, *PTOKEN_PRIMARY_GROUP;">TOKEN_PRIMARY_GROUP</a></strong> structure containing the default primary group <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a> for newly created objects.</p>
<h3><code>TokenDefaultDacl</code></h3>
<p>The buffer receives a <strong><a href="token_default_dacl" title="typedef struct _TOKEN_DEFAULT_DACL&#10;{&#10;    PACL DefaultDacl;&#10;} TOKEN_DEFAULT_DACL, *PTOKEN_DEFAULT_DACL;">TOKEN_DEFAULT_DACL</a></strong> structure containing the default discretionary <a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a> (DACL) for newly created objects.</p>
<h3><code>TokenSource</code></h3>
<p>The buffer receives a <strong><a href="token_source" title="typedef struct _TOKEN_SOURCE&#10;{&#10;    CHAR SourceName[TOKEN_SOURCE_LENGTH];&#10;    LUID SourceIdentifier;&#10;} TOKEN_SOURCE, *PTOKEN_SOURCE;">TOKEN_SOURCE</a></strong> structure containing the source of the token. TOKEN_QUERY_SOURCE access is needed to retrieve this information.</p>
<h3><code>TokenType</code></h3>
<p>The buffer receives a <strong><a href="token_type" title="typedef enum _TOKEN_TYPE&#10;{&#10;    TokenPrimary = 1,&#10;    TokenImpersonation&#10;} TOKEN_TYPE;">TOKEN_TYPE</a></strong> value indicating whether the token is a primary or impersonation token.</p>
<h3><code>TokenImpersonationLevel</code></h3>
<p>The buffer receives a <strong><a href="security_impersonation_level" title="typedef enum _SECURITY_IMPERSONATION_LEVEL {&#10;  SecurityAnonymous,&#10;  SecurityIdentification,&#10;  SecurityImpersonation,&#10;  SecurityDelegation&#10;} SECURITY_IMPERSONATION_LEVEL, *PSECURITY_IMPERSONATION_LEVEL;">SECURITY_IMPERSONATION_LEVEL</a></strong> value indicating the impersonation level of the token. If the access token is not an impersonation token, the call to <strong><a href="sequeryinformationtoken" title="NTSTATUS SeQueryInformationToken(&#10;  [in]  PACCESS_TOKEN           Token,&#10;  [in]  TOKEN_INFORMATION_CLASS TokenInformationClass,&#10;  [out] PVOID                   *TokenInformation&#10;);">SeQueryInformationToken</a></strong> or <strong><a href="ntqueryinformationtoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQueryInformationToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_ TOKEN_INFORMATION_CLASS TokenInformationClass,&#10;    _Out_writes_bytes_to_opt_(TokenInformationLength, *ReturnLength) PVOID TokenInformation,&#10;    _In_ ULONG TokenInformationLength,&#10;    _Out_ PULONG ReturnLength&#10;    );">ZwQueryInformationToken</a></strong> fails.</p>
<h3><code>TokenStatistics</code></h3>
<p>The buffer receives a <strong><a href="token_statistics" title="typedef struct _TOKEN_STATISTICS {&#10;  LUID                         TokenId;&#10;  LUID                         AuthenticationId;&#10;  LARGE_INTEGER                ExpirationTime;&#10;  TOKEN_TYPE                   TokenType;&#10;  SECURITY_IMPERSONATION_LEVEL ImpersonationLevel;&#10;  ULONG                        DynamicCharged;&#10;  ULONG                        DynamicAvailable;&#10;  ULONG                        GroupCount;&#10;  ULONG                        PrivilegeCount;&#10;  LUID                         ModifiedId;&#10;} TOKEN_STATISTICS, *PTOKEN_STATISTICS;">TOKEN_STATISTICS</a></strong> structure containing various token statistics.</p>
<h3><code>TokenRestrictedSids</code></h3>
<p>The buffer receives a <strong><a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a></strong> structure containing the list of restricting SIDs in a restricted token. This value is valid starting with Windows Vista.</p>
<h3><code>TokenSessionId</code></h3>
<p>The buffer receives a <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> value that indicates the Terminal Services session identifier associated with the token. If the token is associated with the Terminal Server console session, the session identifier is zero. A nonzero session identifier indicates a Terminal Services client session. In a non-Terminal Services environment, the session identifier is zero. This value is valid starting with Windows Vista.</p>
<h3><code>TokenGroupsAndPrivileges</code></h3>
<p>The buffer receives a <strong><a href="token_groups_and_privileges" title="typedef struct _TOKEN_GROUPS_AND_PRIVILEGES&#10;{&#10;    ULONG SidCount;&#10;    ULONG SidLength;&#10;    PSID_AND_ATTRIBUTES Sids;&#10;    ULONG RestrictedSidCount;&#10;    ULONG RestrictedSidLength;&#10;    PSID_AND_ATTRIBUTES RestrictedSids;&#10;    ULONG PrivilegeCount;&#10;    ULONG PrivilegeLength;&#10;    PLUID_AND_ATTRIBUTES Privileges;&#10;    LUID AuthenticationId;&#10;} TOKEN_GROUPS_AND_PRIVILEGES, *PTOKEN_GROUPS_AND_PRIVILEGES;">TOKEN_GROUPS_AND_PRIVILEGES</a></strong> structure that contains the user <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a>, the group accounts, the restricted SIDs, and the authentication ID associated with the token. This value is valid starting with Windows Vista.</p>
<h3><code>TokenSessionReference</code></h3>
<p>Reserved for system use.</p>
<h3><code>TokenSandBoxInert</code></h3>
<p>The buffer receives a <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> value that is nonzero if the token includes the <a href="sandbox_inert" title="#define SANDBOX_INERT 0x2 // Stores the TOKEN_SANDBOX_INERT flag in the token.">SANDBOX_INERT</a> flag. This value is valid starting with Windows Vista.</p>
<h3><code>TokenAuditPolicy</code></h3>
<p>Reserved for system use.</p>
<h3><code>TokenOrigin</code></h3>
<p>The buffer receives a <strong><a href="token_origin" title="typedef struct _TOKEN_ORIGIN {&#10;  LUID OriginatingLogonSession;&#10;} TOKEN_ORIGIN, *PTOKEN_ORIGIN;">TOKEN_ORIGIN</a></strong> value.</p>
<p>If the token resulted from a logon that used explicit credentials, such as passing a name, domain, and password to the user-mode <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winbase/nf-winbase-logonusera"><strong>LogonUser</strong></a> function, then the <strong><a href="token_origin" title="typedef struct _TOKEN_ORIGIN {&#10;  LUID OriginatingLogonSession;&#10;} TOKEN_ORIGIN, *PTOKEN_ORIGIN;">TOKEN_ORIGIN</a></strong> structure will contain the ID of the logon session that created it.</p>
<p>If the token resulted from network authentication, such as a call to user-mode <strong>AcceptSecurityContext</strong> function or a call to user-mode <strong>LogonUser</strong> function with dwLogonType set to LOGON32_LOGON_NETWORK or LOGON32_LOGON_NETWORK_CLEARTEXT, then this value will be zero.</p>
<p>This value is valid starting with Windows Server 2003.</p>
<h3><code>TokenElevationType</code></h3>
<h3><code>TokenLinkedToken</code></h3>
<p>The buffer receives a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winnt/ns-winnt-token_linked_token"><strong>TOKEN_LINKED_TOKEN</strong></a> structure that contains a handle to another token that is linked to this token. This value is valid starting with Windows Vista.</p>
<h3><code>TokenElevation</code></h3>
<p>The buffer receives a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winnt/ns-winnt-token_elevation"><strong>TOKEN_ELEVATION</strong></a> structure that specifies whether the token is elevated. This value is valid starting with Windows Vista.</p>
<h3><code>TokenHasRestrictions</code></h3>
<p>The buffer receives a <strong><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></strong> value that is nonzero if the token has ever been filtered. This value is valid starting with Windows Vista.</p>
<h3><code>TokenAccessInformation</code></h3>
<p>The buffer receives a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winnt/ns-winnt-token_access_information"><strong>TOKEN_ACCESS_INFORMATION</strong></a> structure that specifies security information contained in the token. This value is valid starting with Windows Vista.</p>
<h3><code>TokenVirtualizationAllowed</code></h3>
<p>The buffer receives a <strong><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></strong> value that is nonzero if <a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/hardware/design/dn614617(v=vs.85)"><strong>virtualization</strong></a> is allowed for the token. This value is valid starting with Windows Vista.</p>
<h3><code>TokenVirtualizationEnabled</code></h3>
<p>The buffer receives a <strong><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></strong> value that is nonzero if <a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/hardware/design/dn614617(v=vs.85)"><strong>virtualization</strong></a> is enabled for the token. This value is valid starting with Windows Vista.</p>
<h3><code>TokenIntegrityLevel</code></h3>
<p>The buffer receives a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winnt/ns-winnt-token_mandatory_label"><strong>TOKEN_MANDATORY_LABEL</strong></a> structure that specifies the token's integrity level. This value is valid starting with Windows Vista. For <strong><a href="sequeryinformationtoken" title="NTSTATUS SeQueryInformationToken(&#10;  [in]  PACCESS_TOKEN           Token,&#10;  [in]  TOKEN_INFORMATION_CLASS TokenInformationClass,&#10;  [out] PVOID                   *TokenInformation&#10;);">SeQueryInformationToken</a></strong> the output is the actual integrity level (<strong><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></strong>).</p>
<h3><code>TokenUIAccess</code></h3>
<p>The buffer receives a <strong><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></strong> value that is nonzero if the token has the UIAccess flag set. This value is valid starting with Windows Vista.</p>
<h3><code>TokenMandatoryPolicy</code></h3>
<p>The buffer receives a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winnt/ns-winnt-token_mandatory_policy"><strong>TOKEN_MANDATORY_POLICY</strong></a> structure that specifies the token's mandatory integrity policy. This value is valid starting with Windows Vista.</p>
<h3><code>TokenLogonSid</code></h3>
<p>The buffer receives a <strong><a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a></strong> structure that specifies the token's logon <a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a>. This value is valid starting with Windows Vista.</p>
<h3><code>TokenIsAppContainer</code></h3>
<p>The buffer receives a <strong><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></strong> value that is nonzero if the token has the application container flag set. This value is valid starting with Windows 8.</p>
<h3><code>TokenCapabilities</code></h3>
<p>The buffer receives a <strong><a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a></strong> structure and an array of <strong><a href="sid_and_attributes" title="typedef struct _SID_AND_ATTRIBUTES {&#10;#if ...&#10;  PISID Sid;&#10;#else&#10;  PSID  Sid;&#10;#endif&#10;  ULONG Attributes;&#10;} SID_AND_ATTRIBUTES, *PSID_AND_ATTRIBUTES;">SID_AND_ATTRIBUTES</a></strong> structures for each token capability. This value is valid starting with Windows 8.</p>
<h3><code>TokenAppContainerSid</code></h3>
<p>The buffer receives a <strong>TOKEN_APPCONTAINER_INFORMATION</strong> structure that contains the AppContainerSid associated with the token. If the token is not associated with an app container, the TokenAppContainer member of the <strong>TOKEN_APPCONTAINER_INFORMATION</strong> structure points to NULL. This value is valid starting with Windows 8.</p>
<h3><code>TokenAppContainerNumber</code></h3>
<p>The buffer receives a <strong><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></strong> value that is the application container number. This value is valid starting with Windows 8.</p>
<h3><code>TokenUserClaimAttributes</code></h3>
<p>The buffer receives a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winnt/ns-winnt-token_mandatory_policy"><strong>CLAIM_SECURITY_ATTRIBUTES_INFORMATION</strong></a> structure that specifies the user's claim attributes. This value is valid starting with Windows 8.</p>
<h3><code>TokenDeviceClaimAttributes</code></h3>
<p>The buffer receives a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winnt/ns-winnt-token_mandatory_policy"><strong>CLAIM_SECURITY_ATTRIBUTES_INFORMATION</strong></a> structure that specifies the device's claim attributes. This value is valid starting with Windows 8.</p>
<h3><code>TokenRestrictedUserClaimAttributes</code></h3>
<p>Reserved for system use.</p>
<h3><code>TokenRestrictedDeviceClaimAttributes</code></h3>
<p>Reserved for system use.</p>
<h3><code>TokenDeviceGroups</code></h3>
<p>The buffer receives a <strong><a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a></strong> structure and an array of <strong><a href="sid_and_attributes" title="typedef struct _SID_AND_ATTRIBUTES {&#10;#if ...&#10;  PISID Sid;&#10;#else&#10;  PSID  Sid;&#10;#endif&#10;  ULONG Attributes;&#10;} SID_AND_ATTRIBUTES, *PSID_AND_ATTRIBUTES;">SID_AND_ATTRIBUTES</a></strong> structures for each device group. This value is valid starting with Windows 8.</p>
<h3><code>TokenRestrictedDeviceGroups</code></h3>
<p>Reserved for system use.</p>
<h3><code>TokenSecurityAttributes</code></h3>
<p>Reserved for system use.</p>
<h3><code>TokenIsRestricted</code></h3>
<p>Reserved for system use.</p>
<h3><code>TokenProcessTrustLevel</code></h3>
<p>Reserved for system use.</p>
<h3><code>TokenPrivateNameSpace</code></h3>
<p>Reserved for system use.</p>
<h3><code>TokenSingletonAttributes</code></h3>
<p>Reserved for system use.</p>
<h3><code>TokenBnoIsolation</code></h3>
<p>Reserved for system use.</p>
<h3><code>TokenChildProcessFlags</code></h3>
<p>Reserved for system use.</p>
<h3><code>TokenIsLessPrivilegedAppContainer</code></h3>
<p>Returns a <strong><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></strong> value that is nonzero if the token is for a less privileged app container.</p>
<h3><code>TokenIsSandboxed</code></h3>
<p>Returns a <strong><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></strong> value that is nonzero if the token is for a sandboxed process or app.</p>
<h3><code>TokenIsAppSilo</code></h3>
<p>Returns a <strong><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></strong> value that is nonzero if the token is associated with an app silo.</p>
<h3><code>TokenLoggingInformation</code></h3>
<p>The buffer receives a <strong><a href="token_logging_information" title="typedef struct _TOKEN_LOGGING_INFORMATION&#10;{&#10;    TOKEN_TYPE TokenType;&#10;    TOKEN_ELEVATION TokenElevation;&#10;    TOKEN_ELEVATION_TYPE TokenElevationType;&#10;    SECURITY_IMPERSONATION_LEVEL ImpersonationLevel;&#10;    ULONG IntegrityLevel;&#10;    SID_AND_ATTRIBUTES User;&#10;    PSID TrustLevelSid;&#10;    ULONG SessionId;&#10;    ULONG AppContainerNumber;&#10;    LUID AuthenticationId;&#10;    ULONG GroupCount;&#10;    ULONG GroupsLength;&#10;    PSID_AND_ATTRIBUTES Groups;&#10;} TOKEN_LOGGING_INFORMATION, *PTOKEN_LOGGING_INFORMATION;">TOKEN_LOGGING_INFORMATION</a></strong> structure with logging information associated with the token.</p>
<h3><code>MaxTokenInfoClass</code></h3>
<p>The maximum value for this enumeration.</p>
<h2>See also</h2>
<p><strong><a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a></strong></p>
<p><strong><a href="security_impersonation_level" title="typedef enum _SECURITY_IMPERSONATION_LEVEL {&#10;  SecurityAnonymous,&#10;  SecurityIdentification,&#10;  SecurityImpersonation,&#10;  SecurityDelegation&#10;} SECURITY_IMPERSONATION_LEVEL, *PSECURITY_IMPERSONATION_LEVEL;">SECURITY_IMPERSONATION_LEVEL</a></strong></p>
<p><strong><a href="pisid" title="typedef struct _SID {&#10;  UCHAR                    Revision;&#10;  UCHAR                    SubAuthorityCount;&#10;  SID_IDENTIFIER_AUTHORITY IdentifierAuthority;&#10;#if ...&#10;  ULONG                    *SubAuthority[];&#10;#else&#10;  ULONG                    SubAuthority[ANYSIZE_ARRAY];&#10;#endif&#10;} SID, *PISID;">SID</a></strong></p>
<p><strong><a href="sefiltertoken" title="NTSTATUS SeFilterToken(&#10;  [in]           PACCESS_TOKEN     ExistingToken,&#10;  [in]           ULONG             Flags,&#10;  [in, optional] PTOKEN_GROUPS     SidsToDisable,&#10;  [in, optional] PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;  [in, optional] PTOKEN_GROUPS     RestrictedSids,&#10;                 PACCESS_TOKEN     *FilteredToken&#10;);">SeFilterToken</a></strong></p>
<p><strong><a href="sequeryinformationtoken" title="NTSTATUS SeQueryInformationToken(&#10;  [in]  PACCESS_TOKEN           Token,&#10;  [in]  TOKEN_INFORMATION_CLASS TokenInformationClass,&#10;  [out] PVOID                   *TokenInformation&#10;);">SeQueryInformationToken</a></strong></p>
<p><strong><a href="setokenisrestricted" title="BOOLEAN SeTokenIsRestricted(&#10;  [in] PACCESS_TOKEN Token&#10;);">SeTokenIsRestricted</a></strong></p>
<p><strong><a href="token_default_dacl" title="typedef struct _TOKEN_DEFAULT_DACL&#10;{&#10;    PACL DefaultDacl;&#10;} TOKEN_DEFAULT_DACL, *PTOKEN_DEFAULT_DACL;">TOKEN_DEFAULT_DACL</a></strong></p>
<p><strong><a href="token_groups" title="typedef struct _TOKEN_GROUPS&#10;{&#10;    ULONG GroupCount;&#10;    SID_AND_ATTRIBUTES Groups[ANYSIZE_ARRAY];&#10;} TOKEN_GROUPS, *PTOKEN_GROUPS;">TOKEN_GROUPS</a></strong></p>
<p><strong><a href="token_origin" title="typedef struct _TOKEN_ORIGIN {&#10;  LUID OriginatingLogonSession;&#10;} TOKEN_ORIGIN, *PTOKEN_ORIGIN;">TOKEN_ORIGIN</a></strong></p>
<p><strong><a href="token_owner" title="typedef struct _TOKEN_OWNER&#10;{&#10;    PSID Owner;&#10;} TOKEN_OWNER, *PTOKEN_OWNER;">TOKEN_OWNER</a></strong></p>
<p><strong><a href="token_primary_group" title="typedef struct _TOKEN_PRIMARY_GROUP&#10;{&#10;    PSID PrimaryGroup;&#10;} TOKEN_PRIMARY_GROUP, *PTOKEN_PRIMARY_GROUP;">TOKEN_PRIMARY_GROUP</a></strong></p>
<p><strong><a href="token_privileges" title="typedef struct _TOKEN_PRIVILEGES&#10;{&#10;    ULONG PrivilegeCount;&#10;    LUID_AND_ATTRIBUTES Privileges[ANYSIZE_ARRAY];&#10;} TOKEN_PRIVILEGES, *PTOKEN_PRIVILEGES;">TOKEN_PRIVILEGES</a></strong></p>
<p><strong><a href="token_source" title="typedef struct _TOKEN_SOURCE&#10;{&#10;    CHAR SourceName[TOKEN_SOURCE_LENGTH];&#10;    LUID SourceIdentifier;&#10;} TOKEN_SOURCE, *PTOKEN_SOURCE;">TOKEN_SOURCE</a></strong></p>
<p><strong><a href="token_statistics" title="typedef struct _TOKEN_STATISTICS {&#10;  LUID                         TokenId;&#10;  LUID                         AuthenticationId;&#10;  LARGE_INTEGER                ExpirationTime;&#10;  TOKEN_TYPE                   TokenType;&#10;  SECURITY_IMPERSONATION_LEVEL ImpersonationLevel;&#10;  ULONG                        DynamicCharged;&#10;  ULONG                        DynamicAvailable;&#10;  ULONG                        GroupCount;&#10;  ULONG                        PrivilegeCount;&#10;  LUID                         ModifiedId;&#10;} TOKEN_STATISTICS, *PTOKEN_STATISTICS;">TOKEN_STATISTICS</a></strong></p>
<p><strong><a href="token_type" title="typedef enum _TOKEN_TYPE&#10;{&#10;    TokenPrimary = 1,&#10;    TokenImpersonation&#10;} TOKEN_TYPE;">TOKEN_TYPE</a></strong></p>
<p><strong><a href="token_user" title="typedef struct _TOKEN_USER&#10;{&#10;    SID_AND_ATTRIBUTES User;&#10;} TOKEN_USER, *PTOKEN_USER;">TOKEN_USER</a></strong></p>
<p><strong><a href="ntqueryinformationtoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQueryInformationToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_ TOKEN_INFORMATION_CLASS TokenInformationClass,&#10;    _Out_writes_bytes_to_opt_(TokenInformationLength, *ReturnLength) PVOID TokenInformation,&#10;    _In_ ULONG TokenInformationLength,&#10;    _Out_ PULONG ReturnLength&#10;    );">ZwQueryInformationToken</a></strong></p>
<p><strong><a href="ntsetinformationtoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_ TOKEN_INFORMATION_CLASS TokenInformationClass,&#10;    _In_reads_bytes_(TokenInformationLength) PVOID TokenInformation,&#10;    _In_ ULONG TokenInformationLength&#10;    );">ZwSetInformationToken</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/ne-ntifs-_token_information_class">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntifs/ne-ntifs-_token_information_class.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script src="modules/highlight.js/highlight.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
