<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="ATTRIBUTE_INFO_4 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ATTRIBUTE_INFO_4 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github.ntdoc.min.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github-dark-dimmed.ntdoc.min.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            ATTRIBUTE_INFO_4 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header language-cpp">// winddiui.h

</span><span class="ntdoc-code-intro language-cpp"></span><span class="ntdoc-code-body language-cpp">typedef struct _ATTRIBUTE_INFO_4 {
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwJobNumberOfPagesPerSide;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwDrvNumberOfPagesPerSide;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwNupBorderFlags;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwJobPageOrderFlags;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwDrvPageOrderFlags;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwJobNumberOfCopies;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwDrvNumberOfCopies;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwColorOptimization;
  short dmPrintQuality;
  short dmYResolution;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwDuplexFlags;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwNupDirection;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwBookletFlags;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwScalingPercentX;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwScalingPercentY;
} ATTRIBUTE_INFO_4, *PATTRIBUTE_INFO_4;</span><span class="ntdoc-code-footer language-cpp"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winddiui/ns-winddiui-_attribute_info_4">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header language-cpp">// winsplp.h

</span><span class="ntdoc-code-intro language-cpp"></span><span class="ntdoc-code-body language-cpp">typedef struct _ATTRIBUTE_INFO_4 {
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwJobNumberOfPagesPerSide;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwDrvNumberOfPagesPerSide;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwNupBorderFlags;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwJobPageOrderFlags;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwDrvPageOrderFlags;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwJobNumberOfCopies;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwDrvNumberOfCopies;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwColorOptimization;
  short dmPrintQuality;
  short dmYResolution;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwDuplexFlags;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwNupDirection;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwBookletFlags;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwScalingPercentX;
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> dwScalingPercentY;
} ATTRIBUTE_INFO_4, *PATTRIBUTE_INFO_4;</span><span class="ntdoc-code-footer language-cpp"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winsplp/ns-winsplp-_attribute_info_4">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/attribute_info_4.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-winddiui-_attribute_info_4)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2>Description</h2>
<p>The ATTRIBUTE_INFO_4 structure is used as a parameter for a printer interface DLL's <a href="drvqueryjobattributes" title="BOOL DrvQueryJobAttributes(&#10;  [in]  HANDLE   hPrinter,&#10;  [in]  PDEVMODE pDevMode,&#10;  [in]  DWORD    dwLevel,&#10;  [out] LPBYTE   lpAttributeInfo&#10;);">DrvQueryJobAttributes</a> function. All member values are function-supplied. This structure is similar to <a href="attribute_info_3" title="typedef struct _ATTRIBUTE_INFO_3 {&#10;  DWORD dwJobNumberOfPagesPerSide;&#10;  DWORD dwDrvNumberOfPagesPerSide;&#10;  DWORD dwNupBorderFlags;&#10;  DWORD dwJobPageOrderFlags;&#10;  DWORD dwDrvPageOrderFlags;&#10;  DWORD dwJobNumberOfCopies;&#10;  DWORD dwDrvNumberOfCopies;&#10;  DWORD dwColorOptimization;&#10;  short dmPrintQuality;&#10;  short dmYResolution;&#10;} ATTRIBUTE_INFO_3, *PATTRIBUTE_INFO_3;">ATTRIBUTE_INFO_3</a>, but it includes additional members to control N-up, duplex and booklet printing, and scaling.</p>
<h2>Members</h2>
<h3><code>dwJobNumberOfPagesPerSide</code></h3>
<p>Number of document pages to be placed on one side of a physical page, as requested by the user. Allowable values are 1, 2, 4, 6, 9, or 16.</p>
<h3><code>dwDrvNumberOfPagesPerSide</code></h3>
<p>Number of document pages that the printer and driver can place on one side of a physical page. This value must be 1 or the value specified for <strong>dwJobNumberOfPagesPerSide</strong>.</p>
<h3><code>dwNupBorderFlags</code></h3>
<p>One of the following bit flag values:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>BORDER_PRINT</td>
<td>The print processor should draw a border around the page.</td>
</tr>
<tr>
<td>NO_BORDER_PRINT</td>
<td>The print processor should not draw a border around the page.</td>
</tr>
</tbody>
</table>
<h3><code>dwJobPageOrderFlags</code></h3>
<p>One of the following bit flag values:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOKLET_PRINT</td>
<td>Pages should be printed in booklet form, with two document pages printed on one side of a physical page. In landscape mode, the two document pages are printed side-by-side on the paper. In portrait mode, the two document pages are printed top-and-bottom.</td>
</tr>
<tr>
<td>NORMAL_PRINT</td>
<td>Pages should be printed in normal order: page 1, page 2, and so on.</td>
</tr>
<tr>
<td>REVERSE_PRINT</td>
<td>Pages should be printed in reverse order: last page, next-to-last page, and so on.</td>
</tr>
</tbody>
</table>
<h3><code>dwDrvPageOrderFlags</code></h3>
<p>Bit flags indicating which page ordering options are supported by the printer and driver. Uses the same flags as <strong>dwJobPageOrderFlags</strong>.</p>
<h3><code>dwJobNumberOfCopies</code></h3>
<p>Number of copies of the print job, as requested by the user.</p>
<h3><code>dwDrvNumberOfCopies</code></h3>
<p>Maximum number of copies the printer and driver can handle at once, taking into account such job attributes as collating and stapling.</p>
<h3><code>dwColorOptimization</code></h3>
<p>One of the following bit flag values:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>COLOR_OPTIMIZATION</td>
<td>The print processor should use monochrome color optimization.</td>
</tr>
<tr>
<td>NO_COLOR_OPTIMIZATION</td>
<td>The print processor should not use monochrome color optimization.</td>
</tr>
</tbody>
</table>
<h3><code>dmPrintQuality</code></h3>
<p>Value to be used instead of the <strong>dmPrintQuality</strong> member of the print job's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/wingdi/ns-wingdi-devmodew">DEVMODEW</a> structure, if the COLOR_OPTIMIZATION flag is set in <strong>dwColorOptimization</strong>.</p>
<h3><code>dmYResolution</code></h3>
<p>Value to be used instead of the <strong>dmYResolution</strong> member of the print job's DEVMODEW structure, if the COLOR_OPTIMIZATION flag is set in <strong>dwColorOptimization</strong>.</p>
<h3><code>dwDuplexFlags</code></h3>
<p>One of the following bit flag values used in duplex printing:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>DONT_SEND_EXTRA_PAGES_FOR_DUPLEX</td>
<td>The print processor should not send extra blank pages when duplex printing. For example, if you send a three-page job for duplex printing, some printers expect to receive four pages. If you print this job on Microsoft Windows XP or Windows Server 2003, the print processor sends four pages to the printer by default (the fourth page is a blank page). If you print this job on Windows Vista with this flag set, the print processor sends only the three pages of the print job and does not send the extra blank page.</td>
</tr>
<tr>
<td>REVERSE_PAGES_FOR_REVERSE_DUPLEX</td>
<td>The print processor should reverse the order of page pairs when printing in reverse duplex mode. For example, when this flag is set, the print processor should print pages in order 7, 8, 5, 6, 3, 4, 1, 2 instead of 8, 7, 6, 5, 4, 3, 2, 1.</td>
</tr>
</tbody>
</table>
<p>Set to 0 if your driver does not require any of these options.</p>
<h3><code>dwNupDirection</code></h3>
<p>One of the following bit flag values used in N-up printing:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>RIGHT_THEN_DOWN</td>
<td>The print processor should provide page images in sequence from left to right, then down the final printed page. Also set to this value if N-up printing is not needed.</td>
</tr>
<tr>
<td>DOWN_THEN_RIGHT</td>
<td>The print processor should provide page images in sequence from top to bottom, then left to right on the final printed page.</td>
</tr>
<tr>
<td>LEFT_THEN_DOWN</td>
<td>The print processor should provide page images in sequence from right to left, then down the final printed page.</td>
</tr>
<tr>
<td>DOWN_THEN_LEFT</td>
<td>The print processor should provide page images in sequence from top to bottom, then right to left on the final printed page.</td>
</tr>
</tbody>
</table>
<p>This flag is considered only if <strong>dwJobNumberOfPagesPerSide</strong> and/or <strong>dwDrvNumberOfPagesPerSide</strong> indicate that N-up printing is active. For more information, see the descriptions above for <strong>dwJobNumberOfPagesPerSide</strong> and <strong>dwDrvNumberOfPagesPerSide</strong>.</p>
<h3><code>dwBookletFlags</code></h3>
<p>If <strong>dwJobPageOrderFlags</strong> is set to BOOKLET_PRINT, one of the following values.</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOKLET_EDGE_LEFT</td>
<td>The print processor should print pages in a left-to-right booklet layout, where the bound edge of the final folded booklet is on the left edge of page one.</td>
</tr>
<tr>
<td>BOOKLET_EDGE_RIGHT</td>
<td>The print processor should print pages in a right-to-left booklet layout, where the bound edge of the final folded booklet is on the right edge of page one.</td>
</tr>
</tbody>
</table>
<p>If <strong>dwJobPageOrderFlags</strong> is not set to BOOKLET_PRINT, <strong>dwBookletFlags</strong> is set to 0.</p>
<p>This flag is considered only if the <strong>dwJobPageOrderFlags</strong> member is set to BOOKLET_PRINT.</p>
<h3><code>dwScalingPercentX</code></h3>
<p>Scaling percentage in the horizontal (x) direction with respect to the normal paper size. Must be in the range of 1 to 1000. Set to 100 if scaling will not be done.</p>
<p>To ensure predictable printing results, <strong>dwScalingPercentX</strong> and <strong>dwScalingPercentY</strong> must have the same value.</p>
<h3><code>dwScalingPercentY</code></h3>
<p>Scaling percentage in the vertical (y) direction with respect to the normal paper size. Must be in the range of 1 to 1000. Set to 100 if scaling will not be done.</p>
<p>To ensure predictable printing results, <strong>dwScalingPercentX</strong> and <strong>dwScalingPercentY</strong> must have the same value.</p>
<h2>Remarks</h2>
<p>If the <strong>dmPrintQuality</strong> member of a print job's DEVMODEW structure is a negative value, such as DMRES_HIGH, and if monochrome color optimization is enabled, then switching between color and monochrome could result in different resolutions being used. This is because DMRES_HIGH might be assigned to different DPI values for color and monochrome rendering. (For Unidrv-supported devices, this assignment occurs in the printer's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/">GPD</a> file.) To ensure a consistent resolution throughout the print job, the driver can specify positive <strong>dmPrintQuality</strong> and <strong>dmYResolution</strong> values (representing a specific DPI resolution) to override the equivalent <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/wingdi/ns-wingdi-devmodew">DEVMODEW</a> values.</p>
<p>The EMF print processor uses the flag specified for <strong>dwColorOptimization</strong> to determine whether to request GDI to perform monochrome color optimization. If monochrome color optimization is enabled, the print job can be switched between monochrome and color rendering as appropriate.</p>
<p>If you are creating a Unidrv rendering plug-in to generate color watermarks, note that when the <strong>dwColorOptimization</strong> member is set to COLOR_OPTIMIZATION, color watermarks are printed in black and white when they are printed on black-and-white documents. To ensure that color watermarks print correctly with color and black-and-white documents, disable color optimization. Color optimization also can be controlled by the Unidrv *<strong>ChangeColorModeOnDoc?</strong> color attribute (see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/color-attributes">Color Attributes</a>), and by the <a href="gdiendpageemf" title="BOOL GdiEndPageEMF(&#10;  HANDLE SpoolFileHandle,&#10;  DWORD  dwOptimization&#10;);">GdiEndPageEMF</a> function.</p>
<p>For a list of default values for ATTRIBUTE_INFO_4 members, see <a href="getjobattributesex" title="BOOL GetJobAttributesEx(&#10;  [in]  LPWSTR     pPrinterName,&#10;  [in]  LPDEVMODEW pDevmode,&#10;  [in]  DWORD      dwLevel,&#10;  [out] LPBYTE     pAttributeInfo,&#10;  [in]  DWORD      nSize,&#10;  [in]  DWORD      dwFlags&#10;);">GetJobAttributesEx</a>.</p>
<h2>See also</h2>
<p><a href="attribute_info_2" title="typedef struct _ATTRIBUTE_INFO_2 {&#10;  DWORD dwJobNumberOfPagesPerSide;&#10;  DWORD dwDrvNumberOfPagesPerSide;&#10;  DWORD dwNupBorderFlags;&#10;  DWORD dwJobPageOrderFlags;&#10;  DWORD dwDrvPageOrderFlags;&#10;  DWORD dwJobNumberOfCopies;&#10;  DWORD dwDrvNumberOfCopies;&#10;  DWORD dwColorOptimization;&#10;} ATTRIBUTE_INFO_2, *PATTRIBUTE_INFO_2;">ATTRIBUTE_INFO_2</a></p>
<p><a href="attribute_info_3" title="typedef struct _ATTRIBUTE_INFO_3 {&#10;  DWORD dwJobNumberOfPagesPerSide;&#10;  DWORD dwDrvNumberOfPagesPerSide;&#10;  DWORD dwNupBorderFlags;&#10;  DWORD dwJobPageOrderFlags;&#10;  DWORD dwDrvPageOrderFlags;&#10;  DWORD dwJobNumberOfCopies;&#10;  DWORD dwDrvNumberOfCopies;&#10;  DWORD dwColorOptimization;&#10;  short dmPrintQuality;&#10;  short dmYResolution;&#10;} ATTRIBUTE_INFO_3, *PATTRIBUTE_INFO_3;">ATTRIBUTE_INFO_3</a></p>
<p><a href="drvqueryjobattributes" title="BOOL DrvQueryJobAttributes(&#10;  [in]  HANDLE   hPrinter,&#10;  [in]  PDEVMODE pDevMode,&#10;  [in]  DWORD    dwLevel,&#10;  [out] LPBYTE   lpAttributeInfo&#10;);">DrvQueryJobAttributes</a></p>
<p><a href="gdiendpageemf" title="BOOL GdiEndPageEMF(&#10;  HANDLE SpoolFileHandle,&#10;  DWORD  dwOptimization&#10;);">GdiEndPageEMF</a></p>
<p><a href="getjobattributesex" title="BOOL GetJobAttributesEx(&#10;  [in]  LPWSTR     pPrinterName,&#10;  [in]  LPDEVMODEW pDevmode,&#10;  [in]  DWORD      dwLevel,&#10;  [out] LPBYTE     pAttributeInfo,&#10;  [in]  DWORD      nSize,&#10;  [in]  DWORD      dwFlags&#10;);">GetJobAttributesEx</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winddiui/ns-winddiui-_attribute_info_4">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/winddiui/ns-winddiui-_attribute_info_4.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-winsplp-_attribute_info_4)</h1>
</div>
<div class="ntdoc-description">
<h2>Description</h2>
<p>The ATTRIBUTE_INFO_4 structure is used as a parameter for a printer interface DLL's <a href="drvqueryjobattributes" title="BOOL DrvQueryJobAttributes(&#10;  [in]  HANDLE   hPrinter,&#10;  [in]  PDEVMODE pDevMode,&#10;  [in]  DWORD    dwLevel,&#10;  [out] LPBYTE   lpAttributeInfo&#10;);">DrvQueryJobAttributes</a> function. All member values are function-supplied. This structure is similar to <strong><a href="attribute_info_3" title="typedef struct _ATTRIBUTE_INFO_3 {&#10;  DWORD dwJobNumberOfPagesPerSide;&#10;  DWORD dwDrvNumberOfPagesPerSide;&#10;  DWORD dwNupBorderFlags;&#10;  DWORD dwJobPageOrderFlags;&#10;  DWORD dwDrvPageOrderFlags;&#10;  DWORD dwJobNumberOfCopies;&#10;  DWORD dwDrvNumberOfCopies;&#10;  DWORD dwColorOptimization;&#10;  short dmPrintQuality;&#10;  short dmYResolution;&#10;} ATTRIBUTE_INFO_3, *PATTRIBUTE_INFO_3;">ATTRIBUTE_INFO_3</a></strong>, but it includes additional members to control N-up, duplex and booklet printing, and scaling.</p>
<h2>Members</h2>
<h3><code>dwJobNumberOfPagesPerSide</code></h3>
<p>Number of document pages to be placed on one side of a physical page, as requested by the user. Allowable values are 1, 2, 4, 6, 9, or 16.</p>
<h3><code>dwDrvNumberOfPagesPerSide</code></h3>
<p>Number of document pages that the printer and driver can place on one side of a physical page. This value must be 1 or the value specified for <strong>dwJobNumberOfPagesPerSide</strong>.</p>
<h3><code>dwNupBorderFlags</code></h3>
<p>One of the following bit flag values:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>BORDER_PRINT</td>
<td>The print processor should draw a border around the page.</td>
</tr>
<tr>
<td>NO_BORDER_PRINT</td>
<td>The print processor should not draw a border around the page.</td>
</tr>
</tbody>
</table>
<h3><code>dwJobPageOrderFlags</code></h3>
<p>One of the following bit flag values:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOKLET_PRINT</td>
<td>Pages should be printed in booklet form, with two document pages printed on one side of a physical page. In landscape mode, the two document pages are printed side-by-side on the paper. In portrait mode, the two document pages are printed top-and-bottom.</td>
</tr>
<tr>
<td>NORMAL_PRINT</td>
<td>Pages should be printed in normal order: page 1, page 2, and so on.</td>
</tr>
<tr>
<td>REVERSE_PRINT</td>
<td>Pages should be printed in reverse order: last page, next-to-last page, and so on.</td>
</tr>
</tbody>
</table>
<h3><code>dwDrvPageOrderFlags</code></h3>
<p>Bit flags indicating which page ordering options are supported by the printer and driver. Uses the same flags as <strong>dwJobPageOrderFlags</strong>.</p>
<h3><code>dwJobNumberOfCopies</code></h3>
<p>Number of copies of the print job, as requested by the user.</p>
<h3><code>dwDrvNumberOfCopies</code></h3>
<p>Maximum number of copies the printer and driver can handle at once, taking into account such job attributes as collating and stapling.</p>
<h3><code>dwColorOptimization</code></h3>
<p>One of the following bit flag values:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>COLOR_OPTIMIZATION</td>
<td>The print processor should use monochrome color optimization.</td>
</tr>
<tr>
<td>NO_COLOR_OPTIMIZATION</td>
<td>The print processor should not use monochrome color optimization.</td>
</tr>
</tbody>
</table>
<h3><code>dmPrintQuality</code></h3>
<p>Value to be used instead of the <strong>dmPrintQuality</strong> member of the print job's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/wingdi/ns-wingdi-devmodew"><strong>DEVMODEW</strong></a> structure, if the COLOR_OPTIMIZATION flag is set in <strong>dwColorOptimization</strong>.</p>
<h3><code>dmYResolution</code></h3>
<p>Value to be used instead of the <strong>dmYResolution</strong> member of the print job's <strong>DEVMODEW</strong> structure, if the COLOR_OPTIMIZATION flag is set in <strong>dwColorOptimization</strong>.</p>
<h3><code>dwDuplexFlags</code></h3>
<p>One of the following bit flag values used in duplex printing:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>DONT_SEND_EXTRA_PAGES_FOR_DUPLEX</td>
<td>The print processor should not send extra blank pages when duplex printing. For example, if you send a three-page job for duplex printing, some printers expect to receive four pages. If you print this job with this flag set, the print processor sends only the three pages of the print job and does not send the extra blank page.</td>
</tr>
<tr>
<td>REVERSE_PAGES_FOR_REVERSE_DUPLEX</td>
<td>The print processor should reverse the order of page pairs when printing in reverse duplex mode. For example, when this flag is set, the print processor should print pages in order 7, 8, 5, 6, 3, 4, 1, 2 instead of 8, 7, 6, 5, 4, 3, 2, 1.</td>
</tr>
</tbody>
</table>
<p>Set to 0 if your driver does not require any of these options.</p>
<h3><code>dwNupDirection</code></h3>
<p>One of the following bit flag values used in N-up printing:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>RIGHT_THEN_DOWN</td>
<td>The print processor should provide page images in sequence from left to right, then down the final printed page. Also set to this value if N-up printing is not needed.</td>
</tr>
<tr>
<td>DOWN_THEN_RIGHT</td>
<td>The print processor should provide page images in sequence from top to bottom, then left to right on the final printed page.</td>
</tr>
<tr>
<td>LEFT_THEN_DOWN</td>
<td>The print processor should provide page images in sequence from right to left, then down the final printed page.</td>
</tr>
<tr>
<td>DOWN_THEN_LEFT</td>
<td>The print processor should provide page images in sequence from top to bottom, then right to left on the final printed page.</td>
</tr>
</tbody>
</table>
<p>This flag is considered only if <strong>dwJobNumberOfPagesPerSide</strong> and/or <strong>dwDrvNumberOfPagesPerSide</strong> indicate that N-up printing is active. For more information, see the descriptions above for <strong>dwJobNumberOfPagesPerSide</strong> and <strong>dwDrvNumberOfPagesPerSide</strong>.</p>
<h3><code>dwBookletFlags</code></h3>
<p>If <strong>dwJobPageOrderFlags</strong> is set to BOOKLET_PRINT, one of the following values:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOOKLET_EDGE_LEFT</td>
<td>The print processor should print pages in a left-to-right booklet layout, where the bound edge of the final folded booklet is on the left edge of page one.</td>
</tr>
<tr>
<td>BOOKLET_EDGE_RIGHT</td>
<td>The print processor should print pages in a right-to-left booklet layout, where the bound edge of the final folded booklet is on the right edge of page one.</td>
</tr>
</tbody>
</table>
<p>If <strong>dwJobPageOrderFlags</strong> is not set to BOOKLET_PRINT, <strong>dwBookletFlags</strong> is set to 0.</p>
<p>This flag is considered only if the <strong>dwJobPageOrderFlags</strong> member is set to BOOKLET_PRINT.</p>
<h3><code>dwScalingPercentX</code></h3>
<p>Scaling percentage in the horizontal (x) direction with respect to the normal paper size. Must be in the range of 1 to 1000. Set to 100 if scaling will not be done.</p>
<p>To ensure predictable printing results, <strong>dwScalingPercentX</strong> and <strong>dwScalingPercentY</strong> must have the same value.</p>
<h3><code>dwScalingPercentY</code></h3>
<p>Scaling percentage in the vertical (y) direction with respect to the normal paper size. Must be in the range of 1 to 1000. Set to 100 if scaling will not be done.</p>
<p>To ensure predictable printing results, <strong>dwScalingPercentX</strong> and <strong>dwScalingPercentY</strong> must have the same value.</p>
<h2>Remarks</h2>
<p>If the <strong>dmPrintQuality</strong> member of a print job's DEVMODEW structure is a negative value, such as DMRES_HIGH, and if monochrome color optimization is enabled, then switching between color and monochrome could result in different resolutions being used. This is because DMRES_HIGH might be assigned to different DPI values for color and monochrome rendering. (For Unidrv-supported devices, this assignment occurs in the printer's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/introduction-to-gpd-files">GPD</a> file.) To ensure a consistent resolution throughout the print job, the driver can specify positive <strong>dmPrintQuality</strong> and <strong>dmYResolution</strong> values (representing a specific DPI resolution) to override the equivalent <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/wingdi/ns-wingdi-devmodew"><strong>DEVMODEW</strong></a> values.</p>
<p>The EMF print processor uses the flag specified for <strong>dwColorOptimization</strong> to determine whether to request GDI to perform monochrome color optimization. If monochrome color optimization is enabled, the print job can be switched between monochrome and color rendering as appropriate.</p>
<p>If you are creating a Unidrv rendering plug-in to generate color watermarks, note that when the <strong>dwColorOptimization</strong> member is set to COLOR_OPTIMIZATION, color watermarks are printed in black and white when they are printed on black-and-white documents. To ensure that color watermarks print correctly with color and black-and-white documents, disable color optimization. Color optimization also can be controlled by the Unidrv *<strong>ChangeColorModeOnDoc?</strong> color attribute (see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/color-attributes">Color Attributes</a>), and by the <a href="gdiendpageemf" title="BOOL GdiEndPageEMF(&#10;  HANDLE SpoolFileHandle,&#10;  DWORD  dwOptimization&#10;);">GdiEndPageEMF</a> function.</p>
<p>For a list of default values for ATTRIBUTE_INFO_4 members, see <a href="getjobattributesex" title="BOOL GetJobAttributesEx(&#10;  [in]  LPWSTR     pPrinterName,&#10;  [in]  LPDEVMODEW pDevmode,&#10;  [in]  DWORD      dwLevel,&#10;  [out] LPBYTE     pAttributeInfo,&#10;  [in]  DWORD      nSize,&#10;  [in]  DWORD      dwFlags&#10;);">GetJobAttributesEx</a>.</p>
<p>This structure is available in Windows Vista.</p>
<h2>See also</h2>
<p><strong><a href="attribute_info_2" title="typedef struct _ATTRIBUTE_INFO_2 {&#10;  DWORD dwJobNumberOfPagesPerSide;&#10;  DWORD dwDrvNumberOfPagesPerSide;&#10;  DWORD dwNupBorderFlags;&#10;  DWORD dwJobPageOrderFlags;&#10;  DWORD dwDrvPageOrderFlags;&#10;  DWORD dwJobNumberOfCopies;&#10;  DWORD dwDrvNumberOfCopies;&#10;  DWORD dwColorOptimization;&#10;} ATTRIBUTE_INFO_2, *PATTRIBUTE_INFO_2;">ATTRIBUTE_INFO_2</a></strong></p>
<p><strong><a href="attribute_info_3" title="typedef struct _ATTRIBUTE_INFO_3 {&#10;  DWORD dwJobNumberOfPagesPerSide;&#10;  DWORD dwDrvNumberOfPagesPerSide;&#10;  DWORD dwNupBorderFlags;&#10;  DWORD dwJobPageOrderFlags;&#10;  DWORD dwDrvPageOrderFlags;&#10;  DWORD dwJobNumberOfCopies;&#10;  DWORD dwDrvNumberOfCopies;&#10;  DWORD dwColorOptimization;&#10;  short dmPrintQuality;&#10;  short dmYResolution;&#10;} ATTRIBUTE_INFO_3, *PATTRIBUTE_INFO_3;">ATTRIBUTE_INFO_3</a></strong></p>
<p><a href="drvqueryjobattributes" title="BOOL DrvQueryJobAttributes(&#10;  [in]  HANDLE   hPrinter,&#10;  [in]  PDEVMODE pDevMode,&#10;  [in]  DWORD    dwLevel,&#10;  [out] LPBYTE   lpAttributeInfo&#10;);">DrvQueryJobAttributes</a></p>
<p><a href="gdiendpageemf" title="BOOL GdiEndPageEMF(&#10;  HANDLE SpoolFileHandle,&#10;  DWORD  dwOptimization&#10;);">GdiEndPageEMF</a></p>
<p><a href="getjobattributesex" title="BOOL GetJobAttributesEx(&#10;  [in]  LPWSTR     pPrinterName,&#10;  [in]  LPDEVMODEW pDevmode,&#10;  [in]  DWORD      dwLevel,&#10;  [out] LPBYTE     pAttributeInfo,&#10;  [in]  DWORD      nSize,&#10;  [in]  DWORD      dwFlags&#10;);">GetJobAttributesEx</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winsplp/ns-winsplp-_attribute_info_4">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/winsplp/ns-winsplp-_attribute_info_4.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script src="modules/highlight.js/highlight.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
