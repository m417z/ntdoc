<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="DXGKDDI_CANCELCOMMAND - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>DXGKDDI_CANCELCOMMAND - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            DXGKDDI_CANCELCOMMAND - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dkmddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">DXGKDDI_CANCELCOMMAND DxgkddiCancelcommand;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> DxgkddiCancelcommand(
  IN_CONST_HANDLE hAdapter,
  IN_CONST_PDXGKARG_CANCELCOMMAND pCancelCommand
)
{...}</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_cancelcommand">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/dxgkddi_cancelcommand.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-d3dkmddi-dxgkddi_cancelcommand)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="dxgkddi_cancelcommand-callback-function">DXGKDDI_CANCELCOMMAND callback function</h1>

<h2 id="description">Description</h2>

<p>Cleans up internal resources associated with a direct memory access (DMA) packet that was in the GPU scheduler's software queue but never reached the hardware queue because the device went into an error state. Such an error state is typically caused by a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/display/timeout-detection-and-recovery">Timeout Detection and Recovery (TDR)</a> event.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="hadapter"><code>hAdapter</code></h3>

<p>A handle to a context block that is associated with a display adapter. The display miniport driver previously provided this handle to the DirectX graphics kernel subsystem in the <em>MiniportDeviceContext</em> output parameter of the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dispmprt/nc-dispmprt-dxgkddi_add_device">DxgkDdiAddDevice</a> function.</p>

<h3 id="pcancelcommand"><code>pCancelCommand</code></h3>

<p>A pointer to a <a href="dxgkarg_cancelcommand" title="typedef struct _DXGKARG_CANCELCOMMAND {&#10;  [in]  HANDLE                         hContext;&#10;  [out] VOID                           *pDmaBuffer;&#10;  [in]  UINT                           DmaBufferSize;&#10;  [in]  UINT                           DmaBufferSubmissionStartOffset;&#10;  [in]  UINT                           DmaBufferSubmissionEndOffset;&#10;  [in]  VOID                           *pDmaBufferPrivateData;&#10;  [in]  UINT                           DmaBufferPrivateDataSize;&#10;  [in]  UINT                           DmaBufferPrivateDataSubmissionStartOffset;&#10;  [in]  UINT                           DmaBufferPrivateDataSubmissionEndOffset;&#10;  [in]  const DXGK_ALLOCATIONLIST      *pAllocationList;&#10;  [in]  UINT                           AllocationListSize;&#10;  [in]  const D3DDDI_PATCHLOCATIONLIST *pPatchLocationList;&#10;  [in]  UINT                           PatchLocationListSize;&#10;  [in]  UINT                           PatchLocationListSubmissionStart;&#10;  [in]  UINT                           PatchLocationListSubmissionLength;&#10;        D3DGPU_VIRTUAL_ADDRESS         DmaBufferVirtualAddress;&#10;        UINT                           DmaBufferUmdPrivateDataSize;&#10;} DXGKARG_CANCELCOMMAND;">DXGKARG_CANCELCOMMAND</a> structure that specifies resources to be cleaned up after a command is removed from the hardware queue.</p>

<h2 id="return-value">Return value</h2>

<p>Returns <strong><a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a></strong> upon successful completion. If the driver instead returns an error code, the operating system causes a system bugcheck to occur. For more information, see the following Remarks section.</p>

<h2 id="remarks">Remarks</h2>

<p><strong>Note</strong> The DirectX graphics kernel subsystem calls this function only if the <a href="dxgk_vidschcaps" title="typedef struct _DXGK_VIDSCHCAPS {&#10;  union {&#10;    struct {&#10;      UINT MultiEngineAware : 1;&#10;      UINT VSyncPowerSaveAware : 1;&#10;      UINT PreemptionAware : 1;&#10;      UINT NoDmaPatching : 1;&#10;      UINT CancelCommandAware : 1;&#10;      UINT No64BitAtomics : 1;&#10;      UINT LowIrqlPreemptCommand : 1;&#10;      UINT HwQueuePacketCap : 4;&#10;      UINT NativeGpuFence : 1;&#10;      UINT OptimizedNativeFenceSignaledInterrupt : 1;&#10;#if ...&#10;      UINT Reserved : 19;&#10;#elif&#10;      UINT Reserved : 21;&#10;#elif&#10;      UINT Reserved : 25;&#10;#elif&#10;...">DXGK_VIDSCHCAPS</a>.<strong>CancelCommandAware</strong> member is set.</p>

<p>If the driver returns an error code, the DirectX graphics kernel subsystem causes a system bugcheck to occur. In a crash dump file, the error is noted by the message <strong>BugCheck 0x119</strong>, which has the following four parameters.</p>

<ol>
<li>0x9</li>
<li>The <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> error code returned from the failed driver call</li>
<li>A pointer to the <a href="dxgkarg_cancelcommand" title="typedef struct _DXGKARG_CANCELCOMMAND {&#10;  [in]  HANDLE                         hContext;&#10;  [out] VOID                           *pDmaBuffer;&#10;  [in]  UINT                           DmaBufferSize;&#10;  [in]  UINT                           DmaBufferSubmissionStartOffset;&#10;  [in]  UINT                           DmaBufferSubmissionEndOffset;&#10;  [in]  VOID                           *pDmaBufferPrivateData;&#10;  [in]  UINT                           DmaBufferPrivateDataSize;&#10;  [in]  UINT                           DmaBufferPrivateDataSubmissionStartOffset;&#10;  [in]  UINT                           DmaBufferPrivateDataSubmissionEndOffset;&#10;  [in]  const DXGK_ALLOCATIONLIST      *pAllocationList;&#10;  [in]  UINT                           AllocationListSize;&#10;  [in]  const D3DDDI_PATCHLOCATIONLIST *pPatchLocationList;&#10;  [in]  UINT                           PatchLocationListSize;&#10;  [in]  UINT                           PatchLocationListSubmissionStart;&#10;  [in]  UINT                           PatchLocationListSubmissionLength;&#10;        D3DGPU_VIRTUAL_ADDRESS         DmaBufferVirtualAddress;&#10;        UINT                           DmaBufferUmdPrivateDataSize;&#10;} DXGKARG_CANCELCOMMAND;">DXGKARG_CANCELCOMMAND</a> structure</li>
<li>A pointer to an internal scheduler data structure</li>
</ol>

<h2 id="see-also">See also</h2>

<p><a href="dxgkarg_cancelcommand" title="typedef struct _DXGKARG_CANCELCOMMAND {&#10;  [in]  HANDLE                         hContext;&#10;  [out] VOID                           *pDmaBuffer;&#10;  [in]  UINT                           DmaBufferSize;&#10;  [in]  UINT                           DmaBufferSubmissionStartOffset;&#10;  [in]  UINT                           DmaBufferSubmissionEndOffset;&#10;  [in]  VOID                           *pDmaBufferPrivateData;&#10;  [in]  UINT                           DmaBufferPrivateDataSize;&#10;  [in]  UINT                           DmaBufferPrivateDataSubmissionStartOffset;&#10;  [in]  UINT                           DmaBufferPrivateDataSubmissionEndOffset;&#10;  [in]  const DXGK_ALLOCATIONLIST      *pAllocationList;&#10;  [in]  UINT                           AllocationListSize;&#10;  [in]  const D3DDDI_PATCHLOCATIONLIST *pPatchLocationList;&#10;  [in]  UINT                           PatchLocationListSize;&#10;  [in]  UINT                           PatchLocationListSubmissionStart;&#10;  [in]  UINT                           PatchLocationListSubmissionLength;&#10;        D3DGPU_VIRTUAL_ADDRESS         DmaBufferVirtualAddress;&#10;        UINT                           DmaBufferUmdPrivateDataSize;&#10;} DXGKARG_CANCELCOMMAND;">DXGKARG_CANCELCOMMAND</a></p>

<p><a href="dxgk_vidschcaps" title="typedef struct _DXGK_VIDSCHCAPS {&#10;  union {&#10;    struct {&#10;      UINT MultiEngineAware : 1;&#10;      UINT VSyncPowerSaveAware : 1;&#10;      UINT PreemptionAware : 1;&#10;      UINT NoDmaPatching : 1;&#10;      UINT CancelCommandAware : 1;&#10;      UINT No64BitAtomics : 1;&#10;      UINT LowIrqlPreemptCommand : 1;&#10;      UINT HwQueuePacketCap : 4;&#10;      UINT NativeGpuFence : 1;&#10;      UINT OptimizedNativeFenceSignaledInterrupt : 1;&#10;#if ...&#10;      UINT Reserved : 19;&#10;#elif&#10;      UINT Reserved : 21;&#10;#elif&#10;      UINT Reserved : 25;&#10;#elif&#10;...">DXGK_VIDSCHCAPS</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dispmprt/nc-dispmprt-dxgkddi_add_device">DxgkDdiAddDevice</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_cancelcommand">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dkmddi/nc-d3dkmddi-dxgkddi_cancelcommand.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
