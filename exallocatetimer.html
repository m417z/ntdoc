<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="ExAllocateTimer - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ExAllocateTimer - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            ExAllocateTimer - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PEX_TIMER ExAllocateTimer(
  [in, optional] PEXT_CALLBACK Callback,
  [in, optional] PVOID         CallbackContext,
  [in]           <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>         Attributes
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-exallocatetimer">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/exallocatetimer.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-wdm-exallocatetimer)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="exallocatetimer-function">ExAllocateTimer function</h1>

<h2 id="description">Description</h2>

<p>The <strong>ExAllocateTimer</strong> routine allocates and initializes a timer object.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="callback-in-optional"><code>Callback</code> [in, optional]</h3>

<p>A pointer to a driver-implemented <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-ext_callback">ExTimerCallback</a> callback routine. The operating system calls this routine when the timer expires. This parameter is optional and can be <strong>NULL</strong> if no callback routine is needed.</p>

<h3 id="callbackcontext-in-optional"><code>CallbackContext</code> [in, optional]</h3>

<p>A context value for the callback routine pointed to by the <em>Callback</em> parameter. The operating system passes this value as a parameter to the <em>ExTimerCallback</em> callback routine, if one is specified. This parameter is typically a pointer to a caller-defined structure that contains context information used by the callback routine. This parameter is optional and can be set to <strong>NULL</strong> if no context information is needed.</p>

<h3 id="attributes-in"><code>Attributes</code> [in]</h3>

<p>The timer attributes. Set this parameter to zero or to the bitwise-OR of one or more of the following timer flag bits.</p>

<table>
<thead>
<tr>
  <th>Timer flag bit</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>EX_TIMER_HIGH_RESOLUTION</td>
  <td>High-resolution timer. Make the timer more precise by using a higher-resolution clock to drive the timer.</td>
</tr>
<tr>
  <td>EX_TIMER_NO_WAKE</td>
  <td>No-wake timer. Make the timer delay waking the processor to expire until the timer's expiration time plus its delay tolerance is exceeded.</td>
</tr>
<tr>
  <td>EX_TIMER_NOTIFICATION</td>
  <td>Notification timer. Make the timer a notification timer instead of a synchronization timer. If this flag is not set, the timer is a synchronization timer.</td>
</tr>
</tbody>
</table>

<p>The EX_TIMER_NOTIFICATION flag bit can be set regardless of what other flag bits are set.</p>

<p>The EX_TIMER_HIGH_RESOLUTION and EX_TIMER_NO_WAKE flag bits are mutually exclusive. If the caller sets both of these flag bits, the routine bug checks.</p>

<p>For more information about timer attributes, see Remarks.</p>

<h2 id="return-value">Return value</h2>

<p>This routine returns a pointer to an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/exxxxtimer-routines-and-ex-timer-objects">EX_TIMER</a> structure, if the call is successful. This structure is the timer object that the routine has allocated and initialized. If the call fails, the routine returns <strong>NULL</strong>.</p>

<h2 id="remarks">Remarks</h2>

<p>This routine returns a pointer to the new timer object. To use the timer, the calling driver supplies this pointer in subsequent calls to the <a href="exsettimer" title="BOOLEAN ExSetTimer(&#10;  [in]           PEX_TIMER           Timer,&#10;  [in]           LONGLONG            DueTime,&#10;  [in]           LONGLONG            Period,&#10;  [in, optional] PEXT_SET_PARAMETERS Parameters&#10;);">ExSetTimer</a>, <a href="excanceltimer" title="BOOLEAN ExCancelTimer(&#10;  [in, out]      PEX_TIMER              Timer,&#10;  [in, optional] PEXT_CANCEL_PARAMETERS Parameters&#10;);">ExCancelTimer</a>, and <a href="exdeletetimer" title="BOOLEAN ExDeleteTimer(&#10;  [in] PEX_TIMER              Timer,&#10;  [in] BOOLEAN                Cancel,&#10;  [in] BOOLEAN                Wait,&#10;  [in] PEXT_DELETE_PARAMETERS Parameters&#10;);">ExDeleteTimer</a> routines. If the driver supplies a pointer to an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-ext_callback">ExTimerCallback</a> callback routine as an input parameter to the <strong>ExAllocateTimer</strong> routine, the operating system passes this timer object as an input parameter to the <em>ExTimerCallback</em> routine.</p>

<p>A timer can be a notification timer or a synchronization timer. When a notification timer is signaled, all waiting threads have their wait satisfied. The state of this timer remains signaled until it is explicitly reset. When a synchronization timer expires, its state is set to signaled until a single waiting thread is released. Then, the timer is reset to the not-signaled state.</p>

<p>If the EX_TIMER_HIGH_RESOLUTION flag bit is set in <em>Attributes</em>, the operating system increases the resolution of the system clock, as necessary, so that the times at which the timer expires more precisely corresponds to the nominal expiration times specified in the <em>DueTime</em> and <em>Period</em> parameters to the <strong><a href="exsettimer" title="BOOLEAN ExSetTimer(&#10;  [in]           PEX_TIMER           Timer,&#10;  [in]           LONGLONG            DueTime,&#10;  [in]           LONGLONG            Period,&#10;  [in, optional] PEXT_SET_PARAMETERS Parameters&#10;);">ExSetTimer</a></strong> routine. For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/high-resolution-timers">High-Resolution Timers</a>.</p>

<p>If the EX_TIMER_NO_WAKE flag bit is set in <em>Attributes</em>, the timer avoids unnecessarily waking the processor from a low-power state. For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/no-wake-timers">No-Wake Timers</a>.</p>

<p><strong>ExAllocateTimer</strong> allocates the storage for the timer object. When this object is no longer needed, the caller is responsible for freeing this object by calling the <strong><a href="exdeletetimer" title="BOOLEAN ExDeleteTimer(&#10;  [in] PEX_TIMER              Timer,&#10;  [in] BOOLEAN                Cancel,&#10;  [in] BOOLEAN                Wait,&#10;  [in] PEXT_DELETE_PARAMETERS Parameters&#10;);">ExDeleteTimer</a></strong> routine.</p>

<p>The <em>Callback</em> parameter is optional. A driver that does not supply an <em>ExTimerCallback</em> routine can instead initiate a wait operation on the timer object. A driver thread can call a routine such as <a href="kewaitforsingleobject" title="NTSTATUS&#10;KeWaitForSingleObject (&#10;    PVOID Object,&#10;    KWAIT_REASON WaitReason,&#10;    KPROCESSOR_MODE WaitMode,&#10;    BOOLEAN Alertable,&#10;    PLARGE_INTEGER Timeout&#10;    );">KeWaitForSingleObject</a> or <a href="kewaitformultipleobjects" title="NTSTATUS&#10;KeWaitForMultipleObjects (&#10;    ULONG Count,&#10;    PVOID Object[],&#10;    WaitType,&#10;    KWAIT_REASON WaitReason,&#10;    KPROCESSOR_MODE WaitMode,&#10;    BOOLEAN Alertable,&#10;    PLARGE_INTEGER Timeout,&#10;    PKWAIT_BLOCK WaitBlockArray&#10;    );">KeWaitForMultipleObjects</a> to wait for the timer to expire. When the timer expires, the timer object is signaled.</p>

<p>For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/exxxxtimer-routines-and-ex-timer-objects">ExXxxTimer Routines and EX_TIMER Objects</a>.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/exxxxtimer-routines-and-ex-timer-objects">EX_TIMER</a></p>

<p><a href="excanceltimer" title="BOOLEAN ExCancelTimer(&#10;  [in, out]      PEX_TIMER              Timer,&#10;  [in, optional] PEXT_CANCEL_PARAMETERS Parameters&#10;);">ExCancelTimer</a></p>

<p><a href="exdeletetimer" title="BOOLEAN ExDeleteTimer(&#10;  [in] PEX_TIMER              Timer,&#10;  [in] BOOLEAN                Cancel,&#10;  [in] BOOLEAN                Wait,&#10;  [in] PEXT_DELETE_PARAMETERS Parameters&#10;);">ExDeleteTimer</a></p>

<p><a href="exsettimer" title="BOOLEAN ExSetTimer(&#10;  [in]           PEX_TIMER           Timer,&#10;  [in]           LONGLONG            DueTime,&#10;  [in]           LONGLONG            Period,&#10;  [in, optional] PEXT_SET_PARAMETERS Parameters&#10;);">ExSetTimer</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-ext_callback">ExTimerCallback</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-exallocatetimer">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/nf-wdm-exallocatetimer.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
