<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="KSPROCESSPIN - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>KSPROCESSPIN - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            KSPROCESSPIN - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ks.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _KSPROCESSPIN {
  <a href="kspin" title="typedef struct _KSPIN {&#10;  const KSPIN_DESCRIPTOR_EX *Descriptor;&#10;  KSOBJECT_BAG              Bag;&#10;  PVOID                     Context;&#10;  ULONG                     Id;&#10;  KSPIN_COMMUNICATION       Communication;&#10;  BOOLEAN                   ConnectionIsExternal;&#10;  KSPIN_INTERFACE           ConnectionInterface;&#10;  KSPIN_MEDIUM              ConnectionMedium;&#10;  KSPRIORITY                ConnectionPriority;&#10;  PKSDATAFORMAT             ConnectionFormat;&#10;  PKSMULTIPLE_ITEM          AttributeList;&#10;  ULONG                     StreamHeaderSize;&#10;  KSPIN_DATAFLOW            DataFlow;&#10;  KSSTATE                   DeviceState;&#10;  KSRESET                   ResetState;&#10;  KSSTATE                   ClientState;&#10;} KSPIN, *PKSPIN;">PKSPIN</a>            Pin;
  <a href="ksstream_pointer" title="typedef struct _KSSTREAM_POINTER {&#10;  PVOID                    Context;&#10;  PKSPIN                   Pin;&#10;  PKSSTREAM_HEADER         StreamHeader;&#10;  PKSSTREAM_POINTER_OFFSET Offset;&#10;  KSSTREAM_POINTER_OFFSET  OffsetIn;&#10;  KSSTREAM_POINTER_OFFSET  OffsetOut;&#10;} KSSTREAM_POINTER, *PKSSTREAM_POINTER;">PKSSTREAM_POINTER</a> StreamPointer;
  PKSPROCESSPIN     InPlaceCounterpart;
  PKSPROCESSPIN     DelegateBranch;
  PKSPROCESSPIN     CopySource;
  PVOID             Data;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>             BytesAvailable;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>             BytesUsed;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>             Flags;
  BOOLEAN           Terminate;
} KSPROCESSPIN, *PKSPROCESSPIN;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/ns-ks-_ksprocesspin">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ksprocesspin.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ks-_ksprocesspin)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_ksprocesspin-structure">_KSPROCESSPIN structure</h1>

<h2 id="description">Description</h2>

<p>The KSPROCESSPIN structure describes the process state of a specific pin.</p>

<h2 id="members">Members</h2>

<h3 id="pin"><code>Pin</code></h3>

<p>A pointer to a <a href="kspin" title="typedef struct _KSPIN {&#10;  const KSPIN_DESCRIPTOR_EX *Descriptor;&#10;  KSOBJECT_BAG              Bag;&#10;  PVOID                     Context;&#10;  ULONG                     Id;&#10;  KSPIN_COMMUNICATION       Communication;&#10;  BOOLEAN                   ConnectionIsExternal;&#10;  KSPIN_INTERFACE           ConnectionInterface;&#10;  KSPIN_MEDIUM              ConnectionMedium;&#10;  KSPRIORITY                ConnectionPriority;&#10;  PKSDATAFORMAT             ConnectionFormat;&#10;  PKSMULTIPLE_ITEM          AttributeList;&#10;  ULONG                     StreamHeaderSize;&#10;  KSPIN_DATAFLOW            DataFlow;&#10;  KSSTATE                   DeviceState;&#10;  KSRESET                   ResetState;&#10;  KSSTATE                   ClientState;&#10;} KSPIN, *PKSPIN;">KSPIN</a> structure that the KSPROCESSPIN structure is describing. Everything in the structure refers to this <a href="kspin" title="typedef struct _KSPIN {&#10;  const KSPIN_DESCRIPTOR_EX *Descriptor;&#10;  KSOBJECT_BAG              Bag;&#10;  PVOID                     Context;&#10;  ULONG                     Id;&#10;  KSPIN_COMMUNICATION       Communication;&#10;  BOOLEAN                   ConnectionIsExternal;&#10;  KSPIN_INTERFACE           ConnectionInterface;&#10;  KSPIN_MEDIUM              ConnectionMedium;&#10;  KSPRIORITY                ConnectionPriority;&#10;  PKSDATAFORMAT             ConnectionFormat;&#10;  PKSMULTIPLE_ITEM          AttributeList;&#10;  ULONG                     StreamHeaderSize;&#10;  KSPIN_DATAFLOW            DataFlow;&#10;  KSSTATE                   DeviceState;&#10;  KSRESET                   ResetState;&#10;  KSSTATE                   ClientState;&#10;} KSPIN, *PKSPIN;">KSPIN</a>.</p>

<h3 id="streampointer"><code>StreamPointer</code></h3>

<p>A pointer to a <a href="ksstream_pointer" title="typedef struct _KSSTREAM_POINTER {&#10;  PVOID                    Context;&#10;  PKSPIN                   Pin;&#10;  PKSSTREAM_HEADER         StreamHeader;&#10;  PKSSTREAM_POINTER_OFFSET Offset;&#10;  KSSTREAM_POINTER_OFFSET  OffsetIn;&#10;  KSSTREAM_POINTER_OFFSET  OffsetOut;&#10;} KSSTREAM_POINTER, *PKSSTREAM_POINTER;">KSSTREAM_POINTER</a> structure that points into the input stream at the current input location or into the output stream at the current output location. This can be used, for example, by output pins to stamp information onto the associated <a href="ksstream_header" title="typedef struct {&#10;  ULONG    Size;&#10;  ULONG    TypeSpecificFlags;&#10;  KSTIME   PresentationTime;&#10;  LONGLONG Duration;&#10;  ULONG    FrameExtent;&#10;  ULONG    DataUsed;&#10;  PVOID    Data;&#10;  ULONG    OptionsFlags;&#10;  ULONG    Reserved;&#10;} KSSTREAM_HEADER, *PKSSTREAM_HEADER;">KSSTREAM_HEADER</a> (ProcessPin->StreamPointer->StreamHeader->Flags=...).</p>

<h3 id="inplacecounterpart"><code>InPlaceCounterpart</code></h3>

<p>A pointer to a KSPROCESSPIN structure. If this KSPROCESSPIN is not part of an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/">inplace</a> transform, AVStream sets <strong>InPlaceCounterpart</strong> to <strong>NULL</strong>. If this KSPROCESSPIN is the input to an inplace transform, <strong>InPlaceCounterpart</strong> points to the output process pin for the transform. If this KSPROCESSPIN is the output of an inplace transform, <strong>InPlaceCounterpart</strong> points to the input process pin for the transform.</p>

<h3 id="delegatebranch"><code>DelegateBranch</code></h3>

<p>A pointer to a KSPROCESSPIN structure. If frames coming out of this KSPROCESSPIN are being split and sent to multiple sink pins, and the split does not cause a data copy (that is, the split sends the frames in a read-only manner and all of the split pin instances are in the same pipe), <strong>DelegateBranch</strong> points to the first instance of the process pin. The splitter automatically handles any process pin that has a non-<strong>NULL</strong><strong>DelegateBranch</strong>.</p>

<h3 id="copysource"><code>CopySource</code></h3>

<p>A pointer to a KSPROCESSPIN structure. If frames coming out of this process pin are being split and sent to multiple sink pins in a manner that causes a data copy (that is, one of the downstream filters is modifying the data frame by using an in-place transform), <strong>CopySource</strong> points to the process pin from which the frame was copied. The splitter automatically handles any process pin that has a non-<strong>NULL</strong><strong>CopySource</strong>.</p>

<h3 id="data"><code>Data</code></h3>

<p>A pointer to a buffer. If the pin described by this process entry is an input pin, <strong>Data</strong> points to the next available byte of data to be input. If the pin described by this process entry is an output pin, <strong>Data</strong> points to an output buffer in which processed data is placed.</p>

<h3 id="bytesavailable"><code>BytesAvailable</code></h3>

<p>This member specifies how many bytes of data are available in <strong>Data</strong>.</p>

<h3 id="bytesused"><code>BytesUsed</code></h3>

<p>This member specifies how many bytes of this data frame have been used by the process function. AVStream drivers should set this member to update how much they have read or written.</p>

<h3 id="flags"><code>Flags</code></h3>

<p>This member contains a copy of the flags from the relevant <a href="ksstream_header" title="typedef struct {&#10;  ULONG    Size;&#10;  ULONG    TypeSpecificFlags;&#10;  KSTIME   PresentationTime;&#10;  LONGLONG Duration;&#10;  ULONG    FrameExtent;&#10;  ULONG    DataUsed;&#10;  PVOID    Data;&#10;  ULONG    OptionsFlags;&#10;  ULONG    Reserved;&#10;} KSSTREAM_HEADER, *PKSSTREAM_HEADER;">KSSTREAM_HEADER</a> structure, if this KSPROCESSPIN is an input pin.</p>

<h3 id="terminate"><code>Terminate</code></h3>

<p>This member indicates whether the current data frame should be sent downstream after the process dispatch finishes. If <strong>TRUE</strong>, the frame is sent downstream even if all data has not been consumed. If <strong>FALSE</strong>, the frame is not released until all data is consumed.</p>

<h2 id="remarks">Remarks</h2>

<p>The KSPROCESSPIN structure is used in the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/filter-centric-processing">filter-centric processing</a> model. You can use this structure to access data on a specific input pin or to write out processed data to an output pin.</p>

<p>Only filter-centric clients use process pins. Further, process pins that have a non-<strong>NULL</strong><strong>DelegateBranch</strong> or a non-<strong>NULL</strong><strong>CopySource</strong> typically are not of concern to the client. The splitter automatically handles process pins with these pointers.</p>

<p>Most clients are concerned with the members <strong>Pin</strong>, <strong>Data</strong>, <strong>BytesAvailable</strong>, <strong>BytesUsed</strong>, <strong>Flags</strong>, and <strong>Terminate</strong>. Data can be read from the stream or written into the stream through the <strong>Data</strong> member; <strong>BytesAvailable</strong> tells the client how many bytes of data are available in the current data frame (buffer) that <strong>Data</strong> points to. As the client minidriver reads from or writes to the stream, <strong>BytesUsed</strong> should be updated to reflect how many bytes of data have been consumed. The <strong>Terminate</strong> flag can be set if the minidriver is done with the current frame despite the fact that <strong>BytesUsed</strong> is not equal to <strong>BytesAvailable</strong>. After the minidriver exits the processing dispatch, pointers are advanced, and frames are completed as appropriate.</p>

<h2 id="see-also">See also</h2>

<p><a href="kspin" title="typedef struct _KSPIN {&#10;  const KSPIN_DESCRIPTOR_EX *Descriptor;&#10;  KSOBJECT_BAG              Bag;&#10;  PVOID                     Context;&#10;  ULONG                     Id;&#10;  KSPIN_COMMUNICATION       Communication;&#10;  BOOLEAN                   ConnectionIsExternal;&#10;  KSPIN_INTERFACE           ConnectionInterface;&#10;  KSPIN_MEDIUM              ConnectionMedium;&#10;  KSPRIORITY                ConnectionPriority;&#10;  PKSDATAFORMAT             ConnectionFormat;&#10;  PKSMULTIPLE_ITEM          AttributeList;&#10;  ULONG                     StreamHeaderSize;&#10;  KSPIN_DATAFLOW            DataFlow;&#10;  KSSTATE                   DeviceState;&#10;  KSRESET                   ResetState;&#10;  KSSTATE                   ClientState;&#10;} KSPIN, *PKSPIN;">KSPIN</a></p>

<p><a href="ksprocesspin_indexentry" title="typedef struct _KSPROCESSPIN_INDEXENTRY {&#10;  PKSPROCESSPIN *Pins;&#10;  ULONG         Count;&#10;} KSPROCESSPIN_INDEXENTRY, *PKSPROCESSPIN_INDEXENTRY;">KSPROCESSPIN_INDEXENTRY</a></p>

<p><a href="ksstream_header" title="typedef struct {&#10;  ULONG    Size;&#10;  ULONG    TypeSpecificFlags;&#10;  KSTIME   PresentationTime;&#10;  LONGLONG Duration;&#10;  ULONG    FrameExtent;&#10;  ULONG    DataUsed;&#10;  PVOID    Data;&#10;  ULONG    OptionsFlags;&#10;  ULONG    Reserved;&#10;} KSSTREAM_HEADER, *PKSSTREAM_HEADER;">KSSTREAM_HEADER</a></p>

<p><a href="ksstream_pointer" title="typedef struct _KSSTREAM_POINTER {&#10;  PVOID                    Context;&#10;  PKSPIN                   Pin;&#10;  PKSSTREAM_HEADER         StreamHeader;&#10;  PKSSTREAM_POINTER_OFFSET Offset;&#10;  KSSTREAM_POINTER_OFFSET  OffsetIn;&#10;  KSSTREAM_POINTER_OFFSET  OffsetOut;&#10;} KSSTREAM_POINTER, *PKSSTREAM_POINTER;">KSSTREAM_POINTER</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/ns-ks-_ksprocesspin">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ks/ns-ks-_ksprocesspin.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
