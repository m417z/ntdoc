<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PFND3DDDI_SETPRIORITYCB - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PFND3DDDI_SETPRIORITYCB - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PFND3DDDI_SETPRIORITYCB - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dumddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PFND3DDDI_SETPRIORITYCB Pfnd3dddiSetprioritycb;

HRESULT Pfnd3dddiSetprioritycb(
  HANDLE hDevice,
  <a href="d3dddicb_setpriority" title="typedef struct _D3DDDICB_SETPRIORITY {&#10;  [in] HANDLE              hResource;&#10;  [in] UINT                NumAllocations;&#10;  [in] const D3DKMT_HANDLE *HandleList;&#10;  [in] const UINT          *pPriorities;&#10;} D3DDDICB_SETPRIORITY;">D3DDDICB_SETPRIORITY</a> *unnamedParam2
)
{...}</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_setprioritycb">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pfnd3dddi_setprioritycb.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-d3dumddi-pfnd3dddi_setprioritycb)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pfnd3dddi_setprioritycb-callback-function">PFND3DDDI_SETPRIORITYCB callback function</h1>

<h2 id="description">Description</h2>

<p>The <em>pfnSetPriorityCb</em> function sets the priority level of a resource or list of allocations.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="hdevice"><code>hDevice</code></h3>

<p>A handle to the display device (graphics context).</p>

<h3 id="unnamedparam2"><code>unnamedParam2</code></h3>

<p><em>pData</em> [in]</p>

<p>A pointer to a <a href="d3dddicb_setpriority" title="typedef struct _D3DDDICB_SETPRIORITY {&#10;  [in] HANDLE              hResource;&#10;  [in] UINT                NumAllocations;&#10;  [in] const D3DKMT_HANDLE *HandleList;&#10;  [in] const UINT          *pPriorities;&#10;} D3DDDICB_SETPRIORITY;">D3DDDICB_SETPRIORITY</a> structure that describes the priority level to set a resource or list of allocations to.</p>

<h2 id="return-value">Return value</h2>

<p><em>pfnSetPriorityCb</em> returns one of the following values:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>S_OK</td>
  <td>The priority level was successfully set.</td>
</tr>
<tr>
  <td>E_INVALIDARG</td>
  <td>Parameters were validated and determined to be incorrect.</td>
</tr>
</tbody>
</table>

<p>This function might also return other HRESULT values.</p>

<h2 id="remarks">Remarks</h2>

<p>The user-mode display driver can call the <em>pfnSetPriorityCb</em> function to set the priority of the underlying resource or list of allocations. If the priority level of a resource is set, all of the allocations that belong to the resource are set to the specified priority level. Typically, the user-mode display driver sets the priority of a resource or list of allocations after the Microsoft Direct3D runtime calls the user-mode display driver's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_setpriority">SetPriority</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dxgiddi/ns-dxgiddi-dxgi_ddi_base_functions">SetResourcePriorityDXGI</a> function to set the eviction-from-memory priority for a resource. However, the user-mode display driver can set the priority of allocations at any time.</p>

<p>After an application requests to set the priority level of a surface, the user-mode display driver should set the appropriate resource or list of allocations to the priority level that is specified by the application.</p>

<p><strong>Note</strong> Priority levels are only a hint to the video memory manager; they can be ignored by the memory manager under various conditions.</p>

<p>An allocation priority defines both the likelihood that the allocation remains resident and the likelihood of how hard the video memory manager will try to respect the driver's preference for the placement of the allocation. The following priority levels are defined in the D3dukmdt.h header file:</p>

<p>The driver can use priority levels other than the preceding defined values when appropriate. For example, marking an allocation with a priority level of 0x78000001 indicates that the allocation is slightly above normal.</p>

<h4 id="examples">Examples</h4>

<p>The following code example shows how to set priority level.</p>

<div class="codehilite">
<pre><span></span><code><span class="n">HRESULT</span><span class="w"> </span><span class="nf">CD3DContext::SetPriority</span><span class="p">(</span><span class="n">CONST</span><span class="w"> </span><span class="n"><a href="d3dddiarg_setpriority" title="typedef struct _D3DDDIARG_SETPRIORITY {&#10;  HANDLE hResource;&#10;  UINT   Priority;&#10;} D3DDDIARG_SETPRIORITY;">D3DDDIARG_SETPRIORITY</a></span><span class="o">*</span><span class="w"> </span><span class="n">pSetPriority</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n"><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></span><span class="w">  </span><span class="n">dwSurfaceHandle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="dword" title="typedef unsigned long DWORD;">DWORD</a></span><span class="p">)(</span><span class="n"><a href="dword_ptr" title="typedef ULONG_PTR DWORD_PTR;">DWORD_PTR</a></span><span class="p">)</span><span class="n">pSetPriority</span><span class="o">-&gt;</span><span class="n">hResource</span><span class="p">;</span>
<span class="w">    </span><span class="n">CResource</span><span class="w">   </span><span class="o">&amp;</span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_RTbl</span><span class="p">[</span><span class="n">dwSurfaceHandle</span><span class="p">];</span>
<span class="w">    </span><span class="n"><a href="d3dddicb_setpriority" title="typedef struct _D3DDDICB_SETPRIORITY {&#10;  [in] HANDLE              hResource;&#10;  [in] UINT                NumAllocations;&#10;  [in] const D3DKMT_HANDLE *HandleList;&#10;  [in] const UINT          *pPriorities;&#10;} D3DDDICB_SETPRIORITY;">D3DDDICB_SETPRIORITY</a></span><span class="w">    </span><span class="n">setPri</span><span class="p">;</span>
<span class="w">    </span><span class="n"><a href="uint" title="typedef unsigned int UINT;">UINT</a></span><span class="w">                    </span><span class="n">priority</span><span class="p">;</span>

<span class="w">    </span><span class="n">priority</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pSetPriority</span><span class="o">-&gt;</span><span class="n">Priority</span><span class="p">;</span>

<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">setPri</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">setPri</span><span class="p">));</span>

<span class="w">    </span><span class="n">setPri</span><span class="p">.</span><span class="n">hResource</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">res</span><span class="p">.</span><span class="n">m_hResRuntime</span><span class="p">;</span>
<span class="w">    </span><span class="n">setPri</span><span class="p">.</span><span class="n">pPriorities</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">priority</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">m_d3dCallbacks</span><span class="p">.</span><span class="n">pfnSetPriorityCb</span><span class="p">(</span><span class="n">m_hD3D</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">setPri</span><span class="p">));</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="see-also">See also</h2>

<p><a href="d3dddicb_setpriority" title="typedef struct _D3DDDICB_SETPRIORITY {&#10;  [in] HANDLE              hResource;&#10;  [in] UINT                NumAllocations;&#10;  [in] const D3DKMT_HANDLE *HandleList;&#10;  [in] const UINT          *pPriorities;&#10;} D3DDDICB_SETPRIORITY;">D3DDDICB_SETPRIORITY</a></p>

<p><a href="d3dddi_devicecallbacks" title="typedef struct _D3DDDI_DEVICECALLBACKS {&#10;  PFND3DDDI_ALLOCATECB                            pfnAllocateCb;&#10;  PFND3DDDI_DEALLOCATECB                          pfnDeallocateCb;&#10;  PFND3DDDI_SETPRIORITYCB                         pfnSetPriorityCb;&#10;  PFND3DDDI_QUERYRESIDENCYCB                      pfnQueryResidencyCb;&#10;  PFND3DDDI_SETDISPLAYMODECB                      pfnSetDisplayModeCb;&#10;  PFND3DDDI_PRESENTCB                             pfnPresentCb;&#10;  PFND3DDDI_RENDERCB                              pfnRenderCb;&#10;  PFND3DDDI_LOCKCB                                pfnLockCb;&#10;  PFND3DDDI_UNLOCKCB                              pfnUnlockCb;&#10;  PFND3DDDI_ESCAPECB                              pfnEscapeCb;&#10;  PFND3DDDI_CREATEOVERLAYCB                       pfnCreateOverlayCb;&#10;  PFND3DDDI_UPDATEOVERLAYCB                       pfnUpdateOverlayCb;&#10;  PFND3DDDI_FLIPOVERLAYCB                         pfnFlipOverlayCb;&#10;  PFND3DDDI_DESTROYOVERLAYCB                      pfnDestroyOverlayCb;&#10;  PFND3DDDI_CREATECONTEXTCB                       pfnCreateContextCb;&#10;  PFND3DDDI_DESTROYCONTEXTCB                      pfnDestroyContextCb;&#10;  PFND3DDDI_CREATESYNCHRONIZATIONOBJECTCB         pfnCreateSynchronizationObjectCb;&#10;  PFND3DDDI_DESTROYSYNCHRONIZATIONOBJECTCB        pfnDestroySynchronizationObjectCb;&#10;  PFND3DDDI_WAITFORSYNCHRONIZATIONOBJECTCB        pfnWaitForSynchronizationObjectCb;&#10;...">D3DDDI_DEVICECALLBACKS</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkcb_createcontextallocation">DxgkCbCreateContextAllocation</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_setpriority">SetPriority</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dxgiddi/ns-dxgiddi-dxgi_ddi_base_functions">SetResourcePriorityDXGI</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_setprioritycb">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dumddi/nc-d3dumddi-pfnd3dddi_setprioritycb.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
