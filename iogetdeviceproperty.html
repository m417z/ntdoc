<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="IoGetDeviceProperty - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>IoGetDeviceProperty - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            IoGetDeviceProperty - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> IoGetDeviceProperty(
  [in]            <a href="device_object" title="typedef struct _DEVICE_OBJECT {&#10;  CSHORT                   Type;&#10;  USHORT                   Size;&#10;  LONG                     ReferenceCount;&#10;  struct _DRIVER_OBJECT    *DriverObject;&#10;  struct _DEVICE_OBJECT    *NextDevice;&#10;  struct _DEVICE_OBJECT    *AttachedDevice;&#10;  struct _IRP              *CurrentIrp;&#10;  PIO_TIMER                Timer;&#10;  ULONG                    Flags;&#10;  ULONG                    Characteristics;&#10;  __volatile PVPB          Vpb;&#10;  PVOID                    DeviceExtension;&#10;  DEVICE_TYPE              DeviceType;&#10;  CCHAR                    StackSize;&#10;  union {&#10;    LIST_ENTRY         ListEntry;&#10;    WAIT_CONTEXT_BLOCK Wcb;&#10;  } Queue;&#10;  ULONG                    AlignmentRequirement;&#10;...">PDEVICE_OBJECT</a>           DeviceObject,
  [in]            <a href="device_registry_property" title="typedef enum {&#10;  DevicePropertyDeviceDescription,&#10;  DevicePropertyHardwareID,&#10;  DevicePropertyCompatibleIDs,&#10;  DevicePropertyBootConfiguration,&#10;  DevicePropertyBootConfigurationTranslated,&#10;  DevicePropertyClassName,&#10;  DevicePropertyClassGuid,&#10;  DevicePropertyDriverKeyName,&#10;  DevicePropertyManufacturer,&#10;  DevicePropertyFriendlyName,&#10;  DevicePropertyLocationInformation,&#10;  DevicePropertyPhysicalDeviceObjectName,&#10;  DevicePropertyBusTypeGuid,&#10;  DevicePropertyLegacyBusType,&#10;  DevicePropertyBusNumber,&#10;  DevicePropertyEnumeratorName,&#10;  DevicePropertyAddress,&#10;  DevicePropertyUINumber,&#10;  DevicePropertyInstallState,&#10;...">DEVICE_REGISTRY_PROPERTY</a> DeviceProperty,
  [in]            <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                    BufferLength,
  [out, optional] PVOID                    PropertyBuffer,
  [out]           PULONG                   ResultLength
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-iogetdeviceproperty">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/iogetdeviceproperty.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-wdm-iogetdeviceproperty)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="iogetdeviceproperty-function">IoGetDeviceProperty function</h1>

<h2 id="description">Description</h2>

<p>The <strong>IoGetDeviceProperty</strong> routine retrieves information about a device such as configuration information and the name of its PDO.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="deviceobject-in"><code>DeviceObject</code> [in]</h3>

<p>Pointer to the physical device object (PDO) for the device being queried.</p>

<h3 id="deviceproperty-in"><code>DeviceProperty</code> [in]</h3>

<p>A <a href="device_registry_property" title="typedef enum {&#10;  DevicePropertyDeviceDescription,&#10;  DevicePropertyHardwareID,&#10;  DevicePropertyCompatibleIDs,&#10;  DevicePropertyBootConfiguration,&#10;  DevicePropertyBootConfigurationTranslated,&#10;  DevicePropertyClassName,&#10;  DevicePropertyClassGuid,&#10;  DevicePropertyDriverKeyName,&#10;  DevicePropertyManufacturer,&#10;  DevicePropertyFriendlyName,&#10;  DevicePropertyLocationInformation,&#10;  DevicePropertyPhysicalDeviceObjectName,&#10;  DevicePropertyBusTypeGuid,&#10;  DevicePropertyLegacyBusType,&#10;  DevicePropertyBusNumber,&#10;  DevicePropertyEnumeratorName,&#10;  DevicePropertyAddress,&#10;  DevicePropertyUINumber,&#10;  DevicePropertyInstallState,&#10;...">DEVICE_REGISTRY_PROPERTY</a>-typed enumerator that identifies the device property to be retrieved.</p>

<h3 id="bufferlength-in"><code>BufferLength</code> [in]</h3>

<p>Specifies the size, in bytes, of the caller-supplied <em>PropertyBuffer</em>.</p>

<h3 id="propertybuffer-out-optional"><code>PropertyBuffer</code> [out, optional]</h3>

<p>Pointer to a caller-supplied buffer to receive the property information. The buffer can be allocated from pageable memory. The type of the buffer is determined by the <em>DeviceProperty</em> (see above).</p>

<h3 id="resultlength-out"><code>ResultLength</code> [out]</h3>

<p>Pointer to a <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> to receive the size of the property information returned at <em>PropertyBuffer</em>. If <strong>IoGetDeviceProperty</strong> returns STATUS_BUFFER_TOO_SMALL, it sets this parameter to the required buffer length.</p>

<h2 id="return-value">Return value</h2>

<p><strong>IoGetDeviceProperty</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the call was successful. Possible error return values include the following.</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>STATUS_BUFFER_TOO_SMALL</strong></td>
  <td>The buffer at <em>PropertyBuffer</em> was too small. <em>ResultLength</em> points to the required buffer length.</td>
</tr>
<tr>
  <td><strong>STATUS_INVALID_PARAMETER_2</strong></td>
  <td>The given <em>DeviceProperty</em> is not one of the properties handled by this routine.</td>
</tr>
<tr>
  <td><strong>STATUS_INVALID_DEVICE_REQUEST</strong></td>
  <td>Possibly indicates that the given <em>DeviceObject</em> was not a valid PDO pointer.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p><strong>IoGetDeviceProperty</strong> retrieves device setup information from the registry. Use this routine, rather than accessing the registry directly, to insulate a driver from differences across platforms and from possible changes in the registry structure.</p>

<p>For many <em>DeviceProperty</em> requests, it can take two or more calls to <strong>IoGetDeviceProperty</strong> to determine the required <em>BufferLength</em>. The first call should use a best-guess value. If the return status is STATUS_BUFFER_TOO_SMALL, the driver should free its current buffer, allocate a buffer of the size returned in <em>ResultLength</em>, and call <strong>IoGetDeviceProperty</strong> again. Because some of the setup properties are dynamic, the data size can change between the time the required size is returned and driver calls this routine again. Therefore, drivers should call <strong>IoGetDeviceProperty</strong> inside a loop that runs until the return status is not STATUS_BUFFER_TOO_SMALL.</p>

<p>Function drivers that support devices on a legacy bus and a PnP bus can use the <strong>DevicePropertyBusNumber</strong>, <strong>DevicePropertyBusTypeGuid</strong>, and <strong>DevicePropertyLegacyBusType</strong> properties to distinguish between the buses.</p>

<h2 id="see-also">See also</h2>

<p><a href="cm_resource_list" title="typedef struct _CM_RESOURCE_LIST {&#10;  ULONG                       Count;&#10;  CM_FULL_RESOURCE_DESCRIPTOR List[1];&#10;} CM_RESOURCE_LIST, *PCM_RESOURCE_LIST;">CM_RESOURCE_LIST</a></p>

<p><a href="device_removal_policy" title="typedef enum _DEVICE_REMOVAL_POLICY {&#10;  RemovalPolicyExpectNoRemoval,&#10;  RemovalPolicyExpectOrderlyRemoval,&#10;  RemovalPolicyExpectSurpriseRemoval&#10;} DEVICE_REMOVAL_POLICY, *PDEVICE_REMOVAL_POLICY;">DEVICE_REMOVAL_POLICY</a></p>

<p><a href="exallocatepoolwithtag" title="PVOID ExAllocatePoolWithTag(&#10;  [in] __drv_strictTypeMatch(__drv_typeExpr)POOL_TYPE PoolType,&#10;  [in] SIZE_T                                         NumberOfBytes,&#10;  [in] ULONG                                          Tag&#10;);">ExAllocatePoolWithTag</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/customize/desktop/unattend/microsoft-windows-shell-setup-notificationarea-promotedicon2-guid">GUID</a></p>

<p><a href="interface_type" title="typedef enum _INTERFACE_TYPE&#10;{&#10;    InterfaceTypeUndefined = -1,&#10;    Internal = 0,&#10;    Isa = 1,&#10;    Eisa = 2,&#10;    MicroChannel = 3,&#10;    TurboChannel = 4,&#10;    PCIBus = 5,&#10;    VMEBus = 6,&#10;    NuBus = 7,&#10;    PCMCIABus = 8,&#10;    CBus = 9,&#10;    MPIBus = 10,&#10;    MPSABus = 11,&#10;    ProcessorInternal = 12,&#10;    InternalPowerBus = 13,&#10;    PNPISABus = 14,&#10;    PNPBus = 15,&#10;    Vmcs = 16,&#10;...">INTERFACE_TYPE</a></p>

<p><a href="io_resource_requirements_list" title="typedef struct _IO_RESOURCE_REQUIREMENTS_LIST {&#10;  ULONG            ListSize;&#10;  INTERFACE_TYPE   InterfaceType;&#10;  ULONG            BusNumber;&#10;  ULONG            SlotNumber;&#10;  ULONG            Reserved[3];&#10;  ULONG            AlternativeLists;&#10;  IO_RESOURCE_LIST List[1];&#10;} IO_RESOURCE_REQUIREMENTS_LIST, *PIO_RESOURCE_REQUIREMENTS_LIST;">IO_RESOURCE_REQUIREMENTS_LIST</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-iogetdeviceproperty">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/nf-wdm-iogetdeviceproperty.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
