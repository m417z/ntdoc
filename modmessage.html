<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="modMessage - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>modMessage - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            modMessage - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// mmddk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body"><a href="dword" title="typedef unsigned long DWORD;">DWORD</a> modMessage(
   <a href="uint" title="typedef unsigned int UINT;">UINT</a>      uDeviceID,
   <a href="uint" title="typedef unsigned int UINT;">UINT</a>      uMsg,
   <a href="dword_ptr" title="typedef ULONG_PTR DWORD_PTR;">DWORD_PTR</a> dwUser,
   <a href="dword_ptr" title="typedef ULONG_PTR DWORD_PTR;">DWORD_PTR</a> dwParam1,
   <a href="dword_ptr" title="typedef ULONG_PTR DWORD_PTR;">DWORD_PTR</a> dwParam2
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/mod-message">View the official Windows hardware development documentation</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/modmessage.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows hardware development documentation (mod-message)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="modmessage-function">modMessage function</h1>

<p>The <strong>modMessage</strong> function is the entry-point function for musical instrument digital interface (MIDI) output drivers and for internal synthesizer drivers. For more information about audio device messages related to MIDI, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/audio-device-messages-for-midi">Audio Device Messages for MIDI</a></p>

<h2 id="parameters">Parameters</h2>

<ul>
<li><p><em>uDeviceID</em>
Specifies the ID of the target device. Device IDs are sequential and have an initial value of zero and a final value equal to one less than the number of devices the driver supports.</p></li>
<li><p><em>uMsg</em>
Specifies the message that WINMM sends to the driver in response to a call from the client application.</p></li>
<li><p><em>dwUser</em>
For the <strong><a href="modm_open" title="DWORD modMessage(&#10;   UINT      uDeviceID,&#10;   UINT      uMsg,&#10;   DWORD_PTR dwUser,&#10;   DWORD_PTR dwParam1,&#10;   DWORD_PTR dwParam2&#10;);">MODM_OPEN</a></strong> message, the driver should fill this location with its instance data. For any other messages, the instance data is returned to the driver. Drivers that support multiple clients can use this instance data to track which client is associated with the message.</p></li>
<li><p><em>dwParam1</em>
Specifies a message-dependent parameter.</p></li>
<li><p><em>dwParam2</em>
Specifies a message-dependent parameter. If there are flags that provide additional information to the driver that works with <strong>modMessage</strong>, WINMM uses this parameter to pass the flags.</p></li>
</ul>

<h2 id="return-value">Return value</h2>

<p>The <strong>modMessage</strong> function returns MMSYSERR_NOERROR if it can successfully process the message it received from MMSYSTEM. Otherwise, it returns one of the following error messages.</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>MMSYSERR_ERROR</strong></td>
  <td>Unspecified error.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_BADDEVICEID</strong></td>
  <td>The specified device ID is out of range.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_NOTENABLED</strong></td>
  <td>The driver failed to load or initialize.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_ALLOCATED</strong></td>
  <td>The specified device is already allocated.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_INVALHANDLE</strong></td>
  <td>The handle of the specified device is invalid.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_NODRIVER</strong></td>
  <td>No device driver is present.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_NOMEM</strong></td>
  <td>Memory allocation error.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_NOTSUPPORTED</strong></td>
  <td>The function requested by the message is not supported.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_BADERRNUM</strong></td>
  <td>Error value is out of range. See Remarks section for more details.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_INVALFLAG</strong></td>
  <td>An invalid flag was passed to <strong>modMessage</strong> (by using <em>dwParam2</em>).</td>
</tr>
<tr>
  <td><strong>MMSYSERR_INVALPARAM</strong></td>
  <td>An invalid parameter was passed to <strong>modMessage</strong>.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_HANDLEBUSY</strong></td>
  <td>The specified handle is being used simultaneously by another thread (for example, a callback thread).</td>
</tr>
<tr>
  <td><strong>MMSYSERR_INVALIDALIAS</strong></td>
  <td>The specified alias was not found.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_BADDB</strong></td>
  <td>Bad registry database.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_KEYNOTFOUND</strong></td>
  <td>The specified registry key was not found.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_READERROR</strong></td>
  <td>Registry read error.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_WRITEERROR</strong></td>
  <td>Registry write error.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_DELETEERROR</strong></td>
  <td>Registry delete error.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_VALNOTFOUND</strong></td>
  <td>The specified registry value was not found.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_NODRIVERCB</strong></td>
  <td>The driver that works with <strong>modMessage</strong> does not call <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/mmiscapi/nf-mmiscapi-drivercallback">DriverCallback</a>.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_MOREDATA</strong></td>
  <td><strong>modMessage</strong> has more data to return.</td>
</tr>
<tr>
  <td><strong>MMSYSERR_LASTERROR</strong></td>
  <td>Indicates that this is the last error in the range of error values. See the Remarks section for more details.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>Audio device messages are system-defined constants. So when <strong>modMessage</strong> receives an audio device message, it uses a switch statement to determine the action to perform, based on the value of the message.</p>

<p>The range of error messages that <strong>modMessage</strong> can return depends on the message that it was processing when the error occurred. The numerical values of the MMSYSERR_ error messages start with zero (for MMSYSERR_NOERROR) and continue with MMSYSERR_BASE + <em>n</em>, where <em>n</em> is an integer from 1 to 21. The value for MMSYSERR_BASE is a defined constant. For more information about MSYSERR_BASE and the MMSYSERR_ error messages, see Mmsystem.h in the Windows SDK and Mmddk.h in the WDK respectively.</p>

<h2 id="requirements">Requirements</h2>

<table>
<thead>
<tr>
  <th></th>
  <th></th>
</tr>
</thead>
<tbody>
<tr>
  <td>Target platform</td>
  <td>Desktop</td>
</tr>
<tr>
  <td>Version</td>
  <td>Available with Windows XP and later Windows operating systems.</td>
</tr>
<tr>
  <td>Header</td>
  <td>Mmddk.h (include Mmddk.h, Mmsystem.h, or Windows.h)</td>
</tr>
</tbody>
</table>

<h2 id="see-also">See also</h2>

<p><strong><a href="modm_open" title="DWORD modMessage(&#10;   UINT      uDeviceID,&#10;   UINT      uMsg,&#10;   DWORD_PTR dwUser,&#10;   DWORD_PTR dwParam1,&#10;   DWORD_PTR dwParam2&#10;);">MODM_OPEN</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/mod-message">View the official Windows hardware development documentation</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs/blob/staging/windows-driver-docs-pr/audio/mod-message.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
