<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NDIS_RECEIVE_FILTER_FIELD_PARAMETERS - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NDIS_RECEIVE_FILTER_FIELD_PARAMETERS - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NDIS_RECEIVE_FILTER_FIELD_PARAMETERS - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _NDIS_RECEIVE_FILTER_FIELD_PARAMETERS {
  <a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a>       Header;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                    Flags;
  <a href="ndis_frame_header" title="typedef enum _NDIS_FRAME_HEADER {&#10;  NdisFrameHeaderUndefined,&#10;  NdisFrameHeaderMac,&#10;  NdisFrameHeaderArp,&#10;  NdisFrameHeaderIPv4,&#10;  NdisFrameHeaderIPv6,&#10;  NdisFrameHeaderUdp,&#10;  NdisFrameHeaderMaximum&#10;} NDIS_FRAME_HEADER, *PNDIS_FRAME_HEADER;">NDIS_FRAME_HEADER</a>        FrameHeader;
  <a href="ndis_receive_filter_test" title="typedef enum _NDIS_RECEIVE_FILTER_TEST {&#10;  NdisReceiveFilterTestUndefined,&#10;  NdisReceiveFilterTestEqual,&#10;  NdisReceiveFilterTestMaskEqual,&#10;  NdisReceiveFilterTestNotEqual,&#10;  NdisReceiveFilterTestMaximum&#10;} NDIS_RECEIVE_FILTER_TEST, *PNDIS_RECEIVE_FILTER_TEST;">NDIS_RECEIVE_FILTER_TEST</a> ReceiveFilterTest;
  union {
    <a href="ndis_mac_header_field" title="typedef enum _NDIS_MAC_HEADER_FIELD {&#10;  NdisMacHeaderFieldUndefined,&#10;  NdisMacHeaderFieldDestinationAddress,&#10;  NdisMacHeaderFieldSourceAddress,&#10;  NdisMacHeaderFieldProtocol,&#10;  NdisMacHeaderFieldVlanId,&#10;  NdisMacHeaderFieldPriority,&#10;  NdisMacHeaderFieldPacketType,&#10;  NdisMacHeaderFieldMaximum&#10;} NDIS_MAC_HEADER_FIELD, *PNDIS_MAC_HEADER_FIELD;">NDIS_MAC_HEADER_FIELD</a>  MacHeaderField;
    <a href="ndis_arp_header_field" title="typedef enum _NDIS_ARP_HEADER_FIELD {&#10;  NdisARPHeaderFieldUndefined,&#10;  NdisARPHeaderFieldOperation,&#10;  NdisARPHeaderFieldSPA,&#10;  NdisARPHeaderFieldTPA,&#10;  NdisARPHeaderFieldMaximum&#10;} NDIS_ARP_HEADER_FIELD, *PNDIS_ARP_HEADER_FIELD;">NDIS_ARP_HEADER_FIELD</a>  ArpHeaderField;
    <a href="ndis_ipv4_header_field" title="typedef enum _NDIS_IPV4_HEADER_FIELD {&#10;  NdisIPv4HeaderFieldUndefined,&#10;  NdisIPv4HeaderFieldProtocol,&#10;  NdisIPv4HeaderFieldMaximum&#10;} NDIS_IPV4_HEADER_FIELD, *PNDIS_IPV4_HEADER_FIELD;">NDIS_IPV4_HEADER_FIELD</a> IPv4HeaderField;
    <a href="ndis_ipv6_header_field" title="typedef enum _NDIS_IPV6_HEADER_FIELD {&#10;  NdisIPv6HeaderFieldUndefined,&#10;  NdisIPv6HeaderFieldProtocol,&#10;  NdisIPv6HeaderFieldMaximum&#10;} NDIS_IPV6_HEADER_FIELD, *PNDIS_IPV6_HEADER_FIELD;">NDIS_IPV6_HEADER_FIELD</a> IPv6HeaderField;
    <a href="ndis_udp_header_field" title="typedef enum _NDIS_UDP_HEADER_FIELD {&#10;  NdisUdpHeaderFieldUndefined,&#10;  NdisUdpHeaderFieldDestinationPort,&#10;  NdisUdpHeaderFieldMaximum&#10;} NDIS_UDP_HEADER_FIELD, *PNDIS_UDP_HEADER_FIELD;">NDIS_UDP_HEADER_FIELD</a>  UdpHeaderField;
  } HeaderField;
  _HEADER_FIELD            _HEADER_FIELD;
  union {
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>   FieldByteValue;
    <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>  FieldShortValue;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>   FieldLongValue;
    <a href="ulong64" title="typedef unsigned __int64 ULONG64;">ULONG64</a> FieldLong64Value;
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>   FieldByteArrayValue[16];
  } FieldValue;
  _FIELD_VALUE             _FIELD_VALUE;
  union {
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>   ResultByteValue;
    <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>  ResultShortValue;
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>   ResultLongValue;
    <a href="ulong64" title="typedef unsigned __int64 ULONG64;">ULONG64</a> ResultLong64Value;
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>   ResultByteArrayValue[16];
  } ResultValue;
  _RESULT_VALUE            _RESULT_VALUE;
} NDIS_RECEIVE_FILTER_FIELD_PARAMETERS, *PNDIS_RECEIVE_FILTER_FIELD_PARAMETERS;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_receive_filter_field_parameters">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndis_receive_filter_field_parameters.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddndis-_ndis_receive_filter_field_parameters)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_ndis_receive_filter_field_parameters-structure">_NDIS_RECEIVE_FILTER_FIELD_PARAMETERS structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>NDIS_RECEIVE_FILTER_FIELD_PARAMETERS</strong> structure specifies the filter test criterion for a field
in a network packet header.</p>

<p>NDIS receive filters are used in the following NDIS interfaces:</p>

<ul>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-packet-coalescing">NDIS Packet Coalescing</a>. For more information about how to use receive filters in this interface, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/managing-packet-coalescing-receive-filters">Managing Packet Coalescing Receive Filters</a>.</li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/single-root-i-o-virtualization--sr-iov-">Single Root I/O Virtualization (SR-IOV)</a>. For more information about how to use receive filters in this interface, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/setting-a-receive-filter-on-a-virtual-port">Setting a Receive Filter on a Virtual Port</a>.</li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/virtual-machine-queue-architecture">Virtual Machine Queue (VMQ)</a>. For more information about how to use receive filters in this interface, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/setting-and-clearing-vmq-filters">Setting and Clearing VMQ Filters</a>.</li>
</ul>

<h2 id="members">Members</h2>

<h3 id="header"><code>Header</code></h3>

<p>The
<a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a> structure for the
<strong>NDIS_RECEIVE_FILTER_FIELD_PARAMETERS</strong> structure. The driver sets the
<strong>Type</strong> member of the structure that
<strong>Header</strong> specifies to NDIS_OBJECT_TYPE_DEFAULT.</p>

<p>To indicate the version of the <strong>NDIS_RECEIVE_FILTER_FIELD_PARAMETERS</strong> structure, the driver sets the
<strong>Revision</strong> member to one of the following values:</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_RECEIVE_FILTER_FIELD_PARAMETERS_REVISION_2</strong>&lt;br&gt;&lt;br&gt;2</td>
  <td>Added additional members to the <strong>HeaderField</strong> union for NDIS 6.30.&lt;br&gt;&lt;br&gt;The driver sets the <strong>Size</strong> member to <strong>NDIS_SIZEOF_RECEIVE_FILTER_FIELD_PARAMETERS_REVISION_2</strong>.</td>
</tr>
<tr>
  <td><strong>NDIS_RECEIVE_FILTER_FIELD_PARAMETERS_REVISION_1</strong>&lt;br&gt;&lt;br&gt;1</td>
  <td>Original version for NDIS 6.20.&lt;br&gt;&lt;br&gt;The driver sets the <strong>Size</strong> member to <strong>NDIS_SIZEOF_RECEIVE_FILTER_FIELD_PARAMETERS_REVISION_1</strong>.</td>
</tr>
</tbody>
</table>

<h3 id="flags"><code>Flags</code></h3>

<p>A bitwise OR of flags. The following flags are valid for the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-set-filter">OID_RECEIVE_FILTER_SET_FILTER</a> OID.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>NDIS_RECEIVE_FILTER_FIELD_MAC_HEADER_VLAN_UNTAGGED_OR_ZERO</strong>&lt;br&gt;&lt;br&gt;0x00000001</td>
  <td>If this flag is set, the network adapter must only indicate received packets that pass the following criteria:&lt;br&gt;&lt;br&gt;* The packet's media access control (MAC) address matches the specified MAC header field test.&lt;br&gt;* The packet either does not contain a VLAN tag or has a VLAN tag with an ID of zero.&lt;br&gt;&lt;br&gt;For more information about this flag, see the Remarks section.&lt;br&gt;&lt;br&gt;<strong>Note</strong> If an overlying driver sets a MAC address filter and a VLAN identifier filter with an OID request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-set-filter">OID_RECEIVE_FILTER_SET_FILTER</a>, it does not set this flag in either of the filter fields. In this case, the miniport driver should indicate packets that match both the specified MAC address and the VLAN identifier. That is, the miniport driver should not indicate packets with a matching MAC address that have a zero VLAN identifier or are untagged packets.</td>
</tr>
</tbody>
</table>

<h3 id="frameheader"><code>FrameHeader</code></h3>

<p>The type of header in the network data frame.</p>

<h3 id="receivefiltertest"><code>ReceiveFilterTest</code></h3>

<p>The type of test to perform for the receive filter.</p>

<h3 id="headerfield"><code>HeaderField</code></h3>

<p>The type of field in a header. The field type (for example,
<a href="ndis_mac_header_field" title="typedef enum _NDIS_MAC_HEADER_FIELD {&#10;  NdisMacHeaderFieldUndefined,&#10;  NdisMacHeaderFieldDestinationAddress,&#10;  NdisMacHeaderFieldSourceAddress,&#10;  NdisMacHeaderFieldProtocol,&#10;  NdisMacHeaderFieldVlanId,&#10;  NdisMacHeaderFieldPriority,&#10;  NdisMacHeaderFieldPacketType,&#10;  NdisMacHeaderFieldMaximum&#10;} NDIS_MAC_HEADER_FIELD, *PNDIS_MAC_HEADER_FIELD;">NDIS_MAC_HEADER_FIELD</a>) corresponds to the type of header that is specified in the
<strong>FrameHeader</strong> member.</p>

<p>This union contains the following members:</p>

<h3 id="headerfieldmacheaderfield"><code>HeaderField.MacHeaderField</code></h3>

<p>The type of field in a MAC header.</p>

<h3 id="headerfieldarpheaderfield"><code>HeaderField.ArpHeaderField</code></h3>

<p>The type of field in an Address Resolution Protocol (ARP) header.</p>

<h3 id="headerfieldipv4headerfield"><code>HeaderField.IPv4HeaderField</code></h3>

<p>An
<a href="ndis_ipv4_header_field" title="typedef enum _NDIS_IPV4_HEADER_FIELD {&#10;  NdisIPv4HeaderFieldUndefined,&#10;  NdisIPv4HeaderFieldProtocol,&#10;  NdisIPv4HeaderFieldMaximum&#10;} NDIS_IPV4_HEADER_FIELD, *PNDIS_IPV4_HEADER_FIELD;">NDIS_IPV4_HEADER_FIELD</a> enumeration
value that specifies the type of field in an IP version 4 (IPv4) header.</p>

<h3 id="headerfieldipv6headerfield"><code>HeaderField.IPv6HeaderField</code></h3>

<p>An
<a href="ndis_ipv6_header_field" title="typedef enum _NDIS_IPV6_HEADER_FIELD {&#10;  NdisIPv6HeaderFieldUndefined,&#10;  NdisIPv6HeaderFieldProtocol,&#10;  NdisIPv6HeaderFieldMaximum&#10;} NDIS_IPV6_HEADER_FIELD, *PNDIS_IPV6_HEADER_FIELD;">NDIS_IPV6_HEADER_FIELD</a> enumeration
value that specifies the type of field in an IP version 6 (IPv6) header.</p>

<h3 id="headerfieldudpheaderfield"><code>HeaderField.UdpHeaderField</code></h3>

<p>The type of field in a User Datagram Protocol
(UDP) header.</p>

<h3 id="_header_field"><code>_HEADER_FIELD</code></h3>

<h3 id="fieldvalue"><code>FieldValue</code></h3>

<p>The value that the miniport adapter compares to the corresponding header field value in incoming packets. The location of the header field value is determined by the field type that is specified in the <strong>HeaderField</strong> member.</p>

<p>For more information, see the Remarks section.</p>

<p>This union contains the following members:</p>

<h3 id="fieldvaluefieldbytevalue"><code>FieldValue.FieldByteValue</code></h3>

<p>A <strong><a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a></strong> value to compare with a field in a network packet.</p>

<p><strong>Note</strong> If the <strong>MacHeaderField</strong> member specifies an <strong>NdisMacHeaderFieldPacketType</strong> enumeration value, this member contains an <a href="ndis_mac_packet_type" title="typedef enum _NDIS_MAC_PACKET_TYPE {&#10;  NdisMacPacketTypeUndefined,&#10;  NdisMacPacketTypeUnicast,&#10;  NdisMacPacketTypeMulticast,&#10;  NdisMacPacketTypeBroadcast,&#10;  NdisMacPacketTypeMaximum&#10;} NDIS_MAC_PACKET_TYPE, *PNDIS_MAC_PACKET_TYPE;">NDIS_MAC_PACKET_TYPE</a> enumeration value.</p>

<h3 id="fieldvaluefieldshortvalue"><code>FieldValue.FieldShortValue</code></h3>

<p>A <strong><a href="ushort" title="typedef unsigned short USHORT;">USHORT</a></strong> value to compare with a field in a network packet.</p>

<h3 id="fieldvaluefieldlongvalue"><code>FieldValue.FieldLongValue</code></h3>

<p>A <strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></strong> value to compare with a field in a network packet.</p>

<h3 id="fieldvaluefieldlong64value"><code>FieldValue.FieldLong64Value</code></h3>

<p>A <strong><a href="ulong64" title="typedef unsigned __int64 ULONG64;">ULONG64</a></strong> value to compare with a field in a network packet.</p>

<h3 id="fieldvaluefieldbytearrayvalue"><code>FieldValue.FieldByteArrayValue</code></h3>

<p>A <strong><a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a></strong> array to compare with a field in a network packet.</p>

<h3 id="_field_value"><code>_FIELD_VALUE</code></h3>

<h3 id="resultvalue"><code>ResultValue</code></h3>

<p>A union that contains a test result value.</p>

<p>If the <strong>ReceiveFilterTest</strong> member is set to <strong>NdisReceiveFilterTestMaskEqual</strong>, the network adapter first calculates a result from the value in the <strong>FieldValue</strong> member and the header field value as specified by the <strong>HeaderField</strong> member. The adapter then compares the calculated result with <strong>ResultValue</strong>.</p>

<p>For more information, see the Remarks section.</p>

<p>This union contains the following members:</p>

<h3 id="resultvalueresultbytevalue"><code>ResultValue.ResultByteValue</code></h3>

<p>A <strong><a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a></strong> value to compare with a test result.</p>

<h3 id="resultvalueresultshortvalue"><code>ResultValue.ResultShortValue</code></h3>

<p>A <strong><a href="ushort" title="typedef unsigned short USHORT;">USHORT</a></strong> value to compare with a test result.</p>

<h3 id="resultvalueresultlongvalue"><code>ResultValue.ResultLongValue</code></h3>

<p>A <strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></strong> value to compare with a test result.</p>

<h3 id="resultvalueresultlong64value"><code>ResultValue.ResultLong64Value</code></h3>

<p>A <strong><a href="ulong64" title="typedef unsigned __int64 ULONG64;">ULONG64</a></strong> value to compare with a test result.</p>

<h3 id="resultvalueresultbytearrayvalue"><code>ResultValue.ResultByteArrayValue</code></h3>

<p>A <strong><a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a></strong> array to compare with a test result.</p>

<h3 id="_result_value"><code>_RESULT_VALUE</code></h3>

<h2 id="remarks">Remarks</h2>

<p>The <strong>NDIS_RECEIVE_FILTER_FIELD_PARAMETERS</strong> structure specifies the filter test criterion for one field
in a possible array of field tests that can be specified with the
<a href="ndis_receive_filter_parameters" title="typedef struct _NDIS_RECEIVE_FILTER_PARAMETERS {&#10;  NDIS_OBJECT_HEADER       Header;&#10;  ULONG                    Flags;&#10;  NDIS_RECEIVE_FILTER_TYPE FilterType;&#10;  NDIS_RECEIVE_QUEUE_ID    QueueId;&#10;  NDIS_RECEIVE_FILTER_ID   FilterId;&#10;  ULONG                    FieldParametersArrayOffset;&#10;  ULONG                    FieldParametersArrayNumElements;&#10;  ULONG                    FieldParametersArrayElementSize;&#10;  ULONG                    RequestedFilterIdBitCount;&#10;  ULONG                    MaxCoalescingDelay;&#10;  NDIS_NIC_SWITCH_VPORT_ID VPortId;&#10;} NDIS_RECEIVE_FILTER_PARAMETERS, *PNDIS_RECEIVE_FILTER_PARAMETERS;">NDIS_RECEIVE_FILTER_PARAMETERS</a> structure.</p>

<p>The following table describes how the network adapter uses the <strong>ReceiveFilterTest</strong>, <strong>FieldValue</strong>, and <strong>ResultValue</strong> members to perform a filter test on the specified header field value of a received packet.</p>

<table>
<thead>
<tr>
  <th><strong>ReceiveFilterTest</strong> value</th>
  <th>Filter test performed by network adapter</th>
</tr>
</thead>
<tbody>
<tr>
  <td>NdisReceiveFilterTestEqual</td>
  <td>(&lt;<em>header field value</em>&gt; == <strong>FieldValue</strong>)</td>
</tr>
<tr>
  <td>NdisReceiveFilterTestMaskEqual</td>
  <td>((&lt;<em>header field value</em>&gt; &amp; <strong>FieldValue</strong>) == <strong>ResultValue</strong>)</td>
</tr>
<tr>
  <td>NdisReceiveFilterTestNotEqual</td>
  <td>(&lt;<em>header field value</em>&gt; != <strong>FieldValue</strong>)</td>
</tr>
</tbody>
</table>

<p><strong>Note</strong> All the multibyte field and result values, such as the <strong>FieldShortValue</strong> and <strong>ResultLong64Value</strong> members, must be specified in network byte order (<em>big-endian</em>) format.</p>

<p>If the <strong>NDIS_RECEIVE_FILTER_FIELD_MAC_HEADER_VLAN_UNTAGGED_OR_ZERO</strong> flag is not set and there is no VLAN identifier filter that was configured by an OID set request of
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-set-filter">OID_RECEIVE_FILTER_SET_FILTER</a>, the miniport driver must do one of the following:</p>

<ul>
<li>For NDIS 6.20, the miniport driver must return a failed status for the
OID request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-set-filter">OID_RECEIVE_FILTER_SET_FILTER</a>.</li>
<li><p>Starting with NDIS 6.30, if the <strong>NDIS_RECEIVE_FILTER_FIELD_MAC_HEADER_VLAN_UNTAGGED_OR_ZERO</strong> flag is not set and there is no VLAN identifier filter configured by the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-set-filter">OID_RECEIVE_FILTER_SET_FILTER</a> method request, the miniport driver must do either one of the following:</p>

<ul>
<li>The miniport driver must return a failed status for the
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-set-filter">OID_RECEIVE_FILTER_SET_FILTER</a> method request.</li>
<li>The miniport driver must configure the network adapter to inspect and filter the specified MAC address fields. If a VLAN tag is present in the received packet, the network adapter must remove it from the packet data. The miniport driver must put the VLAN tag in an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/ns-ndis-_ndis_net_buffer_list_8021q_info">NDIS_NET_BUFFER_LIST_8021Q_INFO</a> that is associated with the packet's <a href="net_buffer_list" title="typedef struct _NET_BUFFER_LIST {&#10;  union {&#10;    struct {&#10;      NET_BUFFER_LIST *Next;&#10;      NET_BUFFER      *FirstNetBuffer;&#10;    };&#10;    SLIST_HEADER           Link;&#10;    NET_BUFFER_LIST_HEADER NetBufferListHeader;&#10;  };&#10;  NET_BUFFER_LIST_CONTEXT *Context;&#10;  NET_BUFFER_LIST         *ParentNetBufferList;&#10;  NDIS_HANDLE             NdisPoolHandle;&#10;  PVOID                   NdisReserved[2];&#10;  PVOID                   ProtocolReserved[4];&#10;  PVOID                   MiniportReserved[2];&#10;  PVOID                   Scratch;&#10;  NDIS_HANDLE             SourceHandle;&#10;  ULONG                   NblFlags;&#10;  LONG                    ChildRefCount;&#10;  ULONG                   Flags;&#10;...">NET_BUFFER_LIST</a> structure.</li>
</ul></li>
</ul>

<p>Starting with NDIS 6.30, if the <strong>NDIS_RECEIVE_FILTER_FIELD_MAC_HEADER_VLAN_UNTAGGED_OR_ZERO</strong> flag is not set and there is a non-zero VLAN identifier filter that was configured by an OID set request of
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-set-filter">OID_RECEIVE_FILTER_SET_FILTER</a>, the miniport driver must do the following:</p>

<ul>
<li><p>The miniport driver must configure the network adapter to inspect and filter the specified MAC address and VLAN identifier fields.</p>

<p>If a VLAN tag is present in the received packet, the network adapter must remove it from the packet data. The miniport driver must put the VLAN tag in an <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/ns-ndis-_ndis_net_buffer_list_8021q_info">NDIS_NET_BUFFER_LIST_8021Q_INFO</a> that is associated with the packet's <a href="net_buffer_list" title="typedef struct _NET_BUFFER_LIST {&#10;  union {&#10;    struct {&#10;      NET_BUFFER_LIST *Next;&#10;      NET_BUFFER      *FirstNetBuffer;&#10;    };&#10;    SLIST_HEADER           Link;&#10;    NET_BUFFER_LIST_HEADER NetBufferListHeader;&#10;  };&#10;  NET_BUFFER_LIST_CONTEXT *Context;&#10;  NET_BUFFER_LIST         *ParentNetBufferList;&#10;  NDIS_HANDLE             NdisPoolHandle;&#10;  PVOID                   NdisReserved[2];&#10;  PVOID                   ProtocolReserved[4];&#10;  PVOID                   MiniportReserved[2];&#10;  PVOID                   Scratch;&#10;  NDIS_HANDLE             SourceHandle;&#10;  ULONG                   NblFlags;&#10;  LONG                    ChildRefCount;&#10;  ULONG                   Flags;&#10;...">NET_BUFFER_LIST</a> structure.</p></li>
</ul>

<h2 id="see-also">See also</h2>

<p><a href="ndis_arp_header_field" title="typedef enum _NDIS_ARP_HEADER_FIELD {&#10;  NdisARPHeaderFieldUndefined,&#10;  NdisARPHeaderFieldOperation,&#10;  NdisARPHeaderFieldSPA,&#10;  NdisARPHeaderFieldTPA,&#10;  NdisARPHeaderFieldMaximum&#10;} NDIS_ARP_HEADER_FIELD, *PNDIS_ARP_HEADER_FIELD;">NDIS_ARP_HEADER_FIELD</a></p>

<p><a href="ndis_frame_header" title="typedef enum _NDIS_FRAME_HEADER {&#10;  NdisFrameHeaderUndefined,&#10;  NdisFrameHeaderMac,&#10;  NdisFrameHeaderArp,&#10;  NdisFrameHeaderIPv4,&#10;  NdisFrameHeaderIPv6,&#10;  NdisFrameHeaderUdp,&#10;  NdisFrameHeaderMaximum&#10;} NDIS_FRAME_HEADER, *PNDIS_FRAME_HEADER;">NDIS_FRAME_HEADER</a></p>

<p><a href="ndis_ipv4_header_field" title="typedef enum _NDIS_IPV4_HEADER_FIELD {&#10;  NdisIPv4HeaderFieldUndefined,&#10;  NdisIPv4HeaderFieldProtocol,&#10;  NdisIPv4HeaderFieldMaximum&#10;} NDIS_IPV4_HEADER_FIELD, *PNDIS_IPV4_HEADER_FIELD;">NDIS_IPV4_HEADER_FIELD</a></p>

<p><a href="ndis_ipv6_header_field" title="typedef enum _NDIS_IPV6_HEADER_FIELD {&#10;  NdisIPv6HeaderFieldUndefined,&#10;  NdisIPv6HeaderFieldProtocol,&#10;  NdisIPv6HeaderFieldMaximum&#10;} NDIS_IPV6_HEADER_FIELD, *PNDIS_IPV6_HEADER_FIELD;">NDIS_IPV6_HEADER_FIELD</a></p>

<p><a href="ndis_mac_header_field" title="typedef enum _NDIS_MAC_HEADER_FIELD {&#10;  NdisMacHeaderFieldUndefined,&#10;  NdisMacHeaderFieldDestinationAddress,&#10;  NdisMacHeaderFieldSourceAddress,&#10;  NdisMacHeaderFieldProtocol,&#10;  NdisMacHeaderFieldVlanId,&#10;  NdisMacHeaderFieldPriority,&#10;  NdisMacHeaderFieldPacketType,&#10;  NdisMacHeaderFieldMaximum&#10;} NDIS_MAC_HEADER_FIELD, *PNDIS_MAC_HEADER_FIELD;">NDIS_MAC_HEADER_FIELD</a></p>

<p><a href="ndis_mac_packet_type" title="typedef enum _NDIS_MAC_PACKET_TYPE {&#10;  NdisMacPacketTypeUndefined,&#10;  NdisMacPacketTypeUnicast,&#10;  NdisMacPacketTypeMulticast,&#10;  NdisMacPacketTypeBroadcast,&#10;  NdisMacPacketTypeMaximum&#10;} NDIS_MAC_PACKET_TYPE, *PNDIS_MAC_PACKET_TYPE;">NDIS_MAC_PACKET_TYPE</a></p>

<p><a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a></p>

<p><a href="ndis_receive_filter_parameters" title="typedef struct _NDIS_RECEIVE_FILTER_PARAMETERS {&#10;  NDIS_OBJECT_HEADER       Header;&#10;  ULONG                    Flags;&#10;  NDIS_RECEIVE_FILTER_TYPE FilterType;&#10;  NDIS_RECEIVE_QUEUE_ID    QueueId;&#10;  NDIS_RECEIVE_FILTER_ID   FilterId;&#10;  ULONG                    FieldParametersArrayOffset;&#10;  ULONG                    FieldParametersArrayNumElements;&#10;  ULONG                    FieldParametersArrayElementSize;&#10;  ULONG                    RequestedFilterIdBitCount;&#10;  ULONG                    MaxCoalescingDelay;&#10;  NDIS_NIC_SWITCH_VPORT_ID VPortId;&#10;} NDIS_RECEIVE_FILTER_PARAMETERS, *PNDIS_RECEIVE_FILTER_PARAMETERS;">NDIS_RECEIVE_FILTER_PARAMETERS</a></p>

<p><a href="ndis_receive_filter_test" title="typedef enum _NDIS_RECEIVE_FILTER_TEST {&#10;  NdisReceiveFilterTestUndefined,&#10;  NdisReceiveFilterTestEqual,&#10;  NdisReceiveFilterTestMaskEqual,&#10;  NdisReceiveFilterTestNotEqual,&#10;  NdisReceiveFilterTestMaximum&#10;} NDIS_RECEIVE_FILTER_TEST, *PNDIS_RECEIVE_FILTER_TEST;">NDIS_RECEIVE_FILTER_TEST</a></p>

<p><a href="ndis_udp_header_field" title="typedef enum _NDIS_UDP_HEADER_FIELD {&#10;  NdisUdpHeaderFieldUndefined,&#10;  NdisUdpHeaderFieldDestinationPort,&#10;  NdisUdpHeaderFieldMaximum&#10;} NDIS_UDP_HEADER_FIELD, *PNDIS_UDP_HEADER_FIELD;">NDIS_UDP_HEADER_FIELD</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-set-filter">OID_RECEIVE_FILTER_SET_FILTER</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_receive_filter_field_parameters">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddndis/ns-ntddndis-_ndis_receive_filter_field_parameters.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
