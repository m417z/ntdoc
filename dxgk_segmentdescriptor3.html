<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="DXGK_SEGMENTDESCRIPTOR3 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>DXGK_SEGMENTDESCRIPTOR3 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            DXGK_SEGMENTDESCRIPTOR3 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dkmddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _DXGK_SEGMENTDESCRIPTOR3 {
  [out] <a href="dxgk_segmentflags" title="typedef struct _DXGK_SEGMENTFLAGS {&#10;  union {&#10;    struct {&#10;      UINT Aperture : 1;&#10;      UINT Agp : 1;&#10;      UINT CpuVisible : 1;&#10;      UINT UseBanking : 1;&#10;      UINT CacheCoherent : 1;&#10;      UINT PitchAlignment : 1;&#10;      UINT PopulatedFromSystemMemory : 1;&#10;      UINT PreservedDuringStandby : 1;&#10;      UINT PreservedDuringHibernate : 1;&#10;      UINT PartiallyPreservedDuringHibernate : 1;&#10;      UINT DirectFlip : 1;&#10;      UINT Use64KBPages : 1;&#10;      UINT ReservedSysMem : 1;&#10;      UINT SupportsCpuHostAperture : 1;&#10;      UINT SupportsCachedCpuHostAperture : 1;&#10;      UINT ApplicationTarget : 1;&#10;      UINT VprSupported : 1;&#10;...">DXGK_SEGMENTFLAGS</a> Flags;
  [out] <a href="physical_address" title="typedef LARGE_INTEGER PHYSICAL_ADDRESS, *PPHYSICAL_ADDRESS;">PHYSICAL_ADDRESS</a>  BaseAddress;
  [out] <a href="physical_address" title="typedef LARGE_INTEGER PHYSICAL_ADDRESS, *PPHYSICAL_ADDRESS;">PHYSICAL_ADDRESS</a>  CpuTranslatedAddress;
  [out] <a href="size_t-2" title="typedef ULONG_PTR SIZE_T;">SIZE_T</a>            Size;
  [out] <a href="uint" title="typedef unsigned int UINT;">UINT</a>              NbOfBanks;
  [out] <a href="size_t-2" title="typedef ULONG_PTR SIZE_T;">SIZE_T</a>            *pBankRangeTable;
  [out] <a href="size_t-2" title="typedef ULONG_PTR SIZE_T;">SIZE_T</a>            CommitLimit;
        <a href="size_t-2" title="typedef ULONG_PTR SIZE_T;">SIZE_T</a>            SystemMemoryEndAddress;
        <a href="size_t-2" title="typedef ULONG_PTR SIZE_T;">SIZE_T</a>            Reserved;
} DXGK_SEGMENTDESCRIPTOR3;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/ns-d3dkmddi-_dxgk_segmentdescriptor3">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/dxgk_segmentdescriptor3.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-d3dkmddi-_dxgk_segmentdescriptor3)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="dxgk_segmentdescriptor3-structure">DXGK_SEGMENTDESCRIPTOR3 structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>DXGK_SEGMENTDESCRIPTOR3</strong> structure contains information about a driver-supported segment that is composed of both BIOS-reserved memory (which is purged during a transition to a low-power state) and driver-reserved memory.</p>

<h2 id="members">Members</h2>

<h3 id="flags-out"><code>Flags</code> [out]</h3>

<p>A <strong><a href="dxgk_segmentflags" title="typedef struct _DXGK_SEGMENTFLAGS {&#10;  union {&#10;    struct {&#10;      UINT Aperture : 1;&#10;      UINT Agp : 1;&#10;      UINT CpuVisible : 1;&#10;      UINT UseBanking : 1;&#10;      UINT CacheCoherent : 1;&#10;      UINT PitchAlignment : 1;&#10;      UINT PopulatedFromSystemMemory : 1;&#10;      UINT PreservedDuringStandby : 1;&#10;      UINT PreservedDuringHibernate : 1;&#10;      UINT PartiallyPreservedDuringHibernate : 1;&#10;      UINT DirectFlip : 1;&#10;      UINT Use64KBPages : 1;&#10;      UINT ReservedSysMem : 1;&#10;      UINT SupportsCpuHostAperture : 1;&#10;      UINT SupportsCachedCpuHostAperture : 1;&#10;      UINT ApplicationTarget : 1;&#10;      UINT VprSupported : 1;&#10;...">DXGK_SEGMENTFLAGS</a></strong> structure that identifies properties, in bit-field flags, for the segment.</p>

<p>Note that for an AGP-type aperture segment, the driver must exclusively set the <strong>Agp</strong> member of the structure in the union that <a href="dxgk_segmentflags" title="typedef struct _DXGK_SEGMENTFLAGS {&#10;  union {&#10;    struct {&#10;      UINT Aperture : 1;&#10;      UINT Agp : 1;&#10;      UINT CpuVisible : 1;&#10;      UINT UseBanking : 1;&#10;      UINT CacheCoherent : 1;&#10;      UINT PitchAlignment : 1;&#10;      UINT PopulatedFromSystemMemory : 1;&#10;      UINT PreservedDuringStandby : 1;&#10;      UINT PreservedDuringHibernate : 1;&#10;      UINT PartiallyPreservedDuringHibernate : 1;&#10;      UINT DirectFlip : 1;&#10;      UINT Use64KBPages : 1;&#10;      UINT ReservedSysMem : 1;&#10;      UINT SupportsCpuHostAperture : 1;&#10;      UINT SupportsCachedCpuHostAperture : 1;&#10;      UINT ApplicationTarget : 1;&#10;      UINT VprSupported : 1;&#10;...">DXGK_SEGMENTFLAGS</a> contains. Although the AGP-type aperture segment is an aperture and is accessible to the CPU, if any other members are set, the adapter fails to initialize.</p>

<h3 id="baseaddress-out"><code>BaseAddress</code> [out]</h3>

<p>The base address of the segment, as determined by the graphics processing unit (GPU). The physical address of an allocation that the video memory manager paged in the segment is assigned a GPU address that is offset from the base address that <strong>BaseAddress</strong> specifies.</p>

<p>The video memory manager ignores the base address of AGP-type aperture segments (where the <strong>Agp</strong> bit-field flag is specified in the <strong>Flags</strong> member) and instead uses the actual physical address of the segment within the AGP aperture, as determined on the bus where the GPU is located. In this situation, the driver can use addresses that the video memory manager generated for allocation directly without requiring translation.</p>

<h3 id="cputranslatedaddress-out"><code>CpuTranslatedAddress</code> [out]</h3>

<p>The base address of the segment, relative to the bus that the GPU is connected on. For example, when the GPU is connected on the PCI bus, <strong>CpuTranslatedAddress</strong> is the base address of the usable range that is specified by a PCI base-address register (BAR). The driver specifies this address only if it specifies a CPU-accessible segment by setting the <strong>CpuVisible</strong> bit-field flag in the <strong>Flags</strong> member.</p>

<p>This member is ignored for aperture segments, including the AGP-type aperture segment. The only exception occurs when the user-mode display driver has not set up an alternate virtual address for a primary allocation (that is, when the driver has not set <strong>UseAlternateVA</strong> in the <strong>Flags</strong> member of the <strong><a href="d3dddicb_lockflags" title="typedef struct _D3DDDICB_LOCKFLAGS {&#10;  union {&#10;    struct {&#10;      UINT ReadOnly : 1;&#10;      UINT WriteOnly : 1;&#10;      UINT DonotWait : 1;&#10;      UINT IgnoreSync : 1;&#10;      UINT LockEntire : 1;&#10;      UINT DonotEvict : 1;&#10;      UINT AcquireAperture : 1;&#10;      UINT Discard : 1;&#10;      UINT NoExistingReference : 1;&#10;      UINT UseAlternateVA : 1;&#10;      UINT IgnoreReadSync : 1;&#10;      UINT Reserved : 21;&#10;    };&#10;    UINT Value;&#10;  };&#10;} D3DDDICB_LOCKFLAGS;">D3DDDICB_LOCKFLAGS</a></strong> structure during a call to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_lockcb"><strong>pfnLockCb</strong></a> function).</p>

<p>Before the video memory manager maps a virtual address to the physical range, the video memory manager translates this physical address based on the CPU view of the bus and informs the driver about the operation so the driver can set up an aperture to access the content of the segment at the specified location.</p>

<h3 id="size-out"><code>Size</code> [out]</h3>

<p>The size, in bytes, of the segment. This size must be a multiple of the native host page size (for example, 4 KB on the x86 architecture).</p>

<p>For AGP-type aperture segments (where the <strong>Agp</strong> bit-field flag is specified in the <strong>Flags</strong> member), the video memory manager allocates as much aperture space as possible, so this member is ignored.</p>

<h3 id="nbofbanks-out"><code>NbOfBanks</code> [out]</h3>

<p>The number of banks in the segment, if banking is used (that is, if the <strong>UseBanking</strong> bit-field flag is set in the <strong>Flags</strong> member).</p>

<h3 id="pbankrangetable-out"><code>pBankRangeTable</code> [out]</h3>

<p>An array of values that indicates the ranges that delimit each bank in the segment. The driver specifies this array only if it also sets the <strong>UseBanking</strong> bit-field flag in the <strong>Flags</strong> member.</p>

<p>The array specifies the end addresses of the first bank through the <em><strong>NbOfBanks</strong></em>th bank (that is, the end offsets into the segment for each bank). Note the following:</p>

<ul>
<li><p>Banks are contiguous.</p></li>
<li><p>The first bank starts at offset zero of the segment.</p></li>
<li><p>The last bank ends at the end of the segment, so the driver is not required to specify the end address of the last bank.</p></li>
</ul>

<h3 id="commitlimit-out"><code>CommitLimit</code> [out]</h3>

<p>The maximum number of bytes that can be committed to the segment. For a memory segment, the commit limit is always the same as the size of the segment, which is specified in the <strong>Size</strong> member. For an aperture segment, the driver can limit the amount of memory that can be committed to the segment on systems with small amounts of physical memory.</p>

<h3 id="systemmemoryendaddress"><code>SystemMemoryEndAddress</code></h3>

<p>For segments that are partially composed of system memory, all allocations that begin after this address are purged in a transition to a hibernate state. Allocations that exist entirely in system memory, where the segment address is less than or equal to <strong>SystemMemoryEndAddress</strong>, are not evicted in this transition.</p>

<p>The display miniport driver should set this member to a non-<strong>NULL</strong> value if the segment is partially preserved in a transition to a hibernate state, in which case the <strong>PartiallyPreservedDuringHibernate</strong> member in the <strong><a href="dxgk_segmentflags" title="typedef struct _DXGK_SEGMENTFLAGS {&#10;  union {&#10;    struct {&#10;      UINT Aperture : 1;&#10;      UINT Agp : 1;&#10;      UINT CpuVisible : 1;&#10;      UINT UseBanking : 1;&#10;      UINT CacheCoherent : 1;&#10;      UINT PitchAlignment : 1;&#10;      UINT PopulatedFromSystemMemory : 1;&#10;      UINT PreservedDuringStandby : 1;&#10;      UINT PreservedDuringHibernate : 1;&#10;      UINT PartiallyPreservedDuringHibernate : 1;&#10;      UINT DirectFlip : 1;&#10;      UINT Use64KBPages : 1;&#10;      UINT ReservedSysMem : 1;&#10;      UINT SupportsCpuHostAperture : 1;&#10;      UINT SupportsCachedCpuHostAperture : 1;&#10;      UINT ApplicationTarget : 1;&#10;      UINT VprSupported : 1;&#10;...">DXGK_SEGMENTFLAGS</a></strong> structure should be set.</p>

<p>Driver-reserved memory runs from segment address 0 through <strong>SystemMemoryEndAddress</strong>, inclusive. BIOS-reserved memory runs from (<strong>SystemMemoryEndAddress</strong>+1) through the end of the segment.</p>

<h3 id="reserved"><code>Reserved</code></h3>

<p>This member is reserved and should be set to zero.</p>

<h2 id="remarks">Remarks</h2>

<p>This structure is used by a WDDM 1.2 or later kernel-mode display miniport drivers to return information about memory segments in response to a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_queryadapterinfo"><strong>DxgkDdiQueryAdapterInfo</strong></a> function call in which the graphics subsystem specifies the <strong>DXGKQAITYPE_QUERYSEGMENT3</strong> value in the <strong>Type</strong> member of the <strong><a href="dxgkarg_queryadapterinfo" title="typedef struct _DXGKARG_QUERYADAPTERINFO {&#10;  [in]  DXGK_QUERYADAPTERINFOTYPE  Type;&#10;  [in]  VOID                       *pInputData;&#10;  [in]  UINT                       InputDataSize;&#10;  [out] VOID                       *pOutputData;&#10;  [in]  UINT                       OutputDataSize;&#10;  [in]  DXGK_QUERYADAPTERINFOFLAGS Flags;&#10;  [in]  HANDLE                     hKmdProcessHandle;&#10;} DXGKARG_QUERYADAPTERINFO;">DXGKARG_QUERYADAPTERINFO</a></strong> structure.</p>

<p>This structure is pointed to by the <strong>pSegmentDescriptor</strong> member of the <strong><a href="dxgk_querysegmentout3" title="typedef struct _DXGK_QUERYSEGMENTOUT3 {&#10;  [out] UINT                    NbSegment;&#10;  [out] DXGK_SEGMENTDESCRIPTOR3 *pSegmentDescriptor;&#10;  [out] UINT                    PagingBufferSegmentId;&#10;  [out] UINT                    PagingBufferSize;&#10;  [out] UINT                    PagingBufferPrivateDataSize;&#10;} DXGK_QUERYSEGMENTOUT3;">DXGK_QUERYSEGMENTOUT3</a></strong> structure.</p>

<h2 id="see-also">See also</h2>

<p><strong><a href="d3dddicb_lockflags" title="typedef struct _D3DDDICB_LOCKFLAGS {&#10;  union {&#10;    struct {&#10;      UINT ReadOnly : 1;&#10;      UINT WriteOnly : 1;&#10;      UINT DonotWait : 1;&#10;      UINT IgnoreSync : 1;&#10;      UINT LockEntire : 1;&#10;      UINT DonotEvict : 1;&#10;      UINT AcquireAperture : 1;&#10;      UINT Discard : 1;&#10;      UINT NoExistingReference : 1;&#10;      UINT UseAlternateVA : 1;&#10;      UINT IgnoreReadSync : 1;&#10;      UINT Reserved : 21;&#10;    };&#10;    UINT Value;&#10;  };&#10;} D3DDDICB_LOCKFLAGS;">D3DDDICB_LOCKFLAGS</a></strong></p>

<p><strong><a href="dxgkarg_queryadapterinfo" title="typedef struct _DXGKARG_QUERYADAPTERINFO {&#10;  [in]  DXGK_QUERYADAPTERINFOTYPE  Type;&#10;  [in]  VOID                       *pInputData;&#10;  [in]  UINT                       InputDataSize;&#10;  [out] VOID                       *pOutputData;&#10;  [in]  UINT                       OutputDataSize;&#10;  [in]  DXGK_QUERYADAPTERINFOFLAGS Flags;&#10;  [in]  HANDLE                     hKmdProcessHandle;&#10;} DXGKARG_QUERYADAPTERINFO;">DXGKARG_QUERYADAPTERINFO</a></strong></p>

<p><strong><a href="dxgk_querysegmentout3" title="typedef struct _DXGK_QUERYSEGMENTOUT3 {&#10;  [out] UINT                    NbSegment;&#10;  [out] DXGK_SEGMENTDESCRIPTOR3 *pSegmentDescriptor;&#10;  [out] UINT                    PagingBufferSegmentId;&#10;  [out] UINT                    PagingBufferSize;&#10;  [out] UINT                    PagingBufferPrivateDataSize;&#10;} DXGK_QUERYSEGMENTOUT3;">DXGK_QUERYSEGMENTOUT3</a></strong></p>

<p><strong><a href="dxgk_segmentflags" title="typedef struct _DXGK_SEGMENTFLAGS {&#10;  union {&#10;    struct {&#10;      UINT Aperture : 1;&#10;      UINT Agp : 1;&#10;      UINT CpuVisible : 1;&#10;      UINT UseBanking : 1;&#10;      UINT CacheCoherent : 1;&#10;      UINT PitchAlignment : 1;&#10;      UINT PopulatedFromSystemMemory : 1;&#10;      UINT PreservedDuringStandby : 1;&#10;      UINT PreservedDuringHibernate : 1;&#10;      UINT PartiallyPreservedDuringHibernate : 1;&#10;      UINT DirectFlip : 1;&#10;      UINT Use64KBPages : 1;&#10;      UINT ReservedSysMem : 1;&#10;      UINT SupportsCpuHostAperture : 1;&#10;      UINT SupportsCachedCpuHostAperture : 1;&#10;      UINT ApplicationTarget : 1;&#10;      UINT VprSupported : 1;&#10;...">DXGK_SEGMENTFLAGS</a></strong></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_queryadapterinfo"><strong>DxgkDdiQueryAdapterInfo</strong></a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/ns-d3dkmddi-_dxgk_segmentdescriptor3">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dkmddi/ns-d3dkmddi-_dxgk_segmentdescriptor3.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
