<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="KSJACK_DESCRIPTION3 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>KSJACK_DESCRIPTION3 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            KSJACK_DESCRIPTION3 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ksmedia.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _tagKSJACK_DESCRIPTION3 {
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> ConfigId;
} KSJACK_DESCRIPTION3, *PKSJACK_DESCRIPTION3;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ksmedia/ns-ksmedia-ksjack_description3">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ksmedia.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _tagKSJACK_DESCRIPTION3
{
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>              ConfigId; 

} KSJACK_DESCRIPTION3, *PKSJACK_DESCRIPTION3;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/ksjack-description3">View the official Windows hardware development documentation</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ksjack_description3.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ksmedia-ksjack_description3)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2 id="description">Description</h2>

<p>This topic describes the <strong>KSJACK_DESCRIPTION3</strong> structure.</p>

<h2 id="members">Members</h2>

<h3 id="configid"><code>ConfigId</code></h3>

<p>Defines the <strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></strong> member <strong>ConfigId</strong>.</p>

<h2 id="remarks">Remarks</h2>

<p>This is a driver defined bitmask or enum describing the current configuration. Changing this value causes audioendpointbuilder to refresh the cache to ensure that the published endpoint matches the current config.</p>

<h2 id="see-also">See also</h2>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ksmedia/ns-ksmedia-ksjack_description3">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ksmedia/ns-ksmedia-ksjack_description3.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows hardware development documentation (ksjack-description3)</h1>
</div>
<div class="ntdoc-description">
<h1>KSJACK_DESCRIPTION3 structure</h1>

<p>In version 22H2 and later Windows operating systems, the <code>KSJACK_DESCRIPTION3</code> structure can be used to specify and change the current configuration of the jack.</p>

<h2>Members</h2>

<p><strong>ConfigId</strong></p>

<p>Driver defined bitmask or enum describing the current configuration, changing this value causes
audioendpointbuilder to refresh the cache to ensure that the published endpoint matches the current config.</p>

<h2>Remarks</h2>

<h3>Using KSJACK_DESCRIPTION3 to communicate audio device changes</h3>

<p>The Windows audio system caches audio device capabilities during audio endpoint creation. These cached values are for capabilities such as the presence of a HW audio engine, format support, container ID, buffer size characteristics, etc. These cached values are retained for the life of the windows installation. They are refreshed only when the audio driver is updated or during an OS upgrade.</p>

<p>With <strong>KSJACK_DESCRIPTION3</strong>, the Windows audio system provides a mechanism for the audio driver to request all cached values be discarded and refreshed. The request can be triggered by changes in the audio device capabilities such as resource constraints.</p>

<p>Whenever the driver changes the contents of <strong>KSJACK_DESCRIPTION3</strong> at runtime, the driver will trigger the existing <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/ksproperty-jack-description3">KSEVENT_PINCAPS_JACKINFOCHANGE</a> event.</p>

<p>The Windows audio system maintains the last reported <em>ConfigId</em> value cached on the audio endpoint. The <em>ConfigId</em> value is retrieved in response to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/ksproperty-jack-description3">KSEVENT_PINCAPS_JACKINFOCHANGE</a> event and during normal processing of the audio endpoint at system boot, Audio Endpoint Builder service restart, audio driver update, or interface state changes for the endpoint.</p>

<p>If the retrieved <em>ConfigId</em> value differs from the previously stored value, the Windows audio system will discard all previously cached endpoint capabilities and refresh them.</p>

<p>The recommended usage is to define multiple audio endpoint configurations within the driver that is controlled by the <em>ConfigId</em> (bitmask or enum) value. For example, <em>ConfigId</em> of 1 may indicate the presence of an audio engine node, whereas <em>ConfigId</em> 2 would not report an audio engine node. The <em>ConfigId</em> in use by the driver is shared with the Windows audio system through <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/ksproperty-jack-description3"><strong>KSPROPERTY_JACK_DESCRIPTION3</strong></a> and acts to synchronize the endpoint with the capabilities cached by the Windows audio system.</p>

<p>The value of the <em>ConfigId</em> is opaque to Windows. The audio driver could use a timestamp or incrementing value chosen at run time in place of a bitmask or enum as suggested above. This strategy is not recommended as it may result in unnecessary endpoint refreshes during boot up or interface changes to synchronize the last stored <em>ConfigId</em> value to the newly reported value, even when the endpoint capabilities are unchanged. This approach may also increase the chances of the driver and Windows becoming out of sync, which can result in audio playback failures.</p>

<p>The mechanism used to refresh the cached values on the endpoint when the <em>ConfigId</em> changes is the same as used for Operating System Upgrades and Driver Updates. A new endpoint with a different ID is created which will contain the refreshed cached values that match the new <em>ConfigId</em> settings for the endpoint, user settings are then copied from the old endpoint to the new endpoint, and finally the old endpoint is deleted. For more information, on the audio endpoint migration process in OS upgrades, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/operating-system-upgrades">Operating System Upgrades</a>.</p>

<h2>Requirements</h2>

<table>
<thead>
<tr>
  <th></th>
  <th></th>
</tr>
</thead>
<tbody>
<tr>
  <td>Version</td>
  <td>Available in version 22H2 and later Windows operating systems.</td>
</tr>
<tr>
  <td>Header</td>
  <td>Ksmedia.h (include Ksmedia.h)</td>
</tr>
</tbody>
</table>

<h2>See also</h2>

<p><strong><a href="ksjack_description" title="typedef struct {&#10;  DWORD              ChannelMapping;&#10;  DWORD              Color;&#10;  EPcxConnectionType ConnectionType;&#10;  EPcxGeoLocation    GeoLocation;&#10;  EPcxGenLocation    GenLocation;&#10;  EPxcPortConnection PortConnection;&#10;  BOOL               IsConnected;&#10;} KSJACK_DESCRIPTION, *PKSJACK_DESCRIPTION;">KSJACK_DESCRIPTION</a></strong></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/ksproperty-jack-description3"><strong>KSPROPERTY_JACK_DESCRIPTION3</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/devicetopology/nf-devicetopology-iksjackdescription2-getjackdescription2"><strong>IKsJackDescription2::GetJackDescription2</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/dynamic-format-change">Dynamic Format Change</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/operating-system-upgrades">Operating System Upgrades</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/audio/ksjack-description3">View the official Windows hardware development documentation</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs/blob/staging/windows-driver-docs-pr/audio/ksjack-description3.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
