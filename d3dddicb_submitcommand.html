<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="D3DDDICB_SUBMITCOMMAND - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>D3DDDICB_SUBMITCOMMAND - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            D3DDDICB_SUBMITCOMMAND - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dumddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _D3DDDICB_SUBMITCOMMAND {
  D3DGPU_VIRTUAL_ADDRESS      Commands;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                        CommandLength;
  <a href="d3dddicb_submitcommandflags" title="typedef struct _D3DDDICB_SUBMITCOMMANDFLAGS {&#10;  union {&#10;    struct {&#10;      UINT NullRendering : 1;&#10;      UINT Reserved : 31;&#10;    };&#10;    UINT Value;&#10;  };&#10;} D3DDDICB_SUBMITCOMMANDFLAGS;">D3DDDICB_SUBMITCOMMANDFLAGS</a> Flags;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                        BroadcastContextCount;
  HANDLE                      BroadcastContext[D3DDDI_MAX_BROADCAST_CONTEXT];
  VOID                        *pPrivateDriverData;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                        PrivateDriverDataSize;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                        NumPrimaries;
  D3DKMT_HANDLE               WrittenPrimaries[D3DDDI_MAX_WRITTEN_PRIMARIES];
  <a href="d3dddi_markerlogtype" title="typedef enum D3DDDI_MARKERLOGTYPE {&#10;  D3DDDIMLT_NONE,&#10;  D3DDDIMLT_PROFILE,&#10;  D3DDDIMLT_FT_PROFILE,&#10;  D3DDDIMLT_BATCHED&#10;} ;">D3DDDI_MARKERLOGTYPE</a>        MarkerLogType;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                        RenderCBSequence;
  union {
    struct {
      <a href="uint" title="typedef unsigned int UINT;">UINT</a> FirstAPISequenceNumberHigh;
      <a href="uint" title="typedef unsigned int UINT;">UINT</a> CompletedAPISequenceNumberLow0Size;
      <a href="uint" title="typedef unsigned int UINT;">UINT</a> CompletedAPISequenceNumberLow1Size;
      <a href="uint" title="typedef unsigned int UINT;">UINT</a> BegunAPISequenceNumberLow0Size;
      <a href="uint" title="typedef unsigned int UINT;">UINT</a> BegunAPISequenceNumberLow1Size;
    };
    <a href="uint" title="typedef unsigned int UINT;">UINT</a> BatchedMarkerDataCount;
  };
  union {
    struct {
      const <a href="uint" title="typedef unsigned int UINT;">UINT</a> *pCompletedAPISequenceNumberLow0;
      const <a href="uint" title="typedef unsigned int UINT;">UINT</a> *pCompletedAPISequenceNumberLow1;
      const <a href="uint" title="typedef unsigned int UINT;">UINT</a> *pBegunAPISequenceNumberLow0;
      const <a href="uint" title="typedef unsigned int UINT;">UINT</a> *pBegunAPISequenceNumberLow1;
    };
    const <a href="d3dddi_batchedmarkerdata" title="typedef struct _D3DDDI_BATCHEDMARKERDATA {&#10;  HANDLE     hRTCommandListHandle;&#10;  UINT       FirstAPISequenceNumberHigh;&#10;  UINT       CompletedAPISequenceNumberLowSize;&#10;  const UINT *pCompletedAPISequenceNumberLow;&#10;} D3DDDI_BATCHEDMARKERDATA;">D3DDDI_BATCHEDMARKERDATA</a> *pBatchedMarkerData;
  };
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                        Reserved;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a>                        NumHistoryBuffers;
  D3DKMT_HANDLE               *HistoryBufferArray;
  HANDLE                      hSyncToken;
  void                        *pReserved;
} D3DDDICB_SUBMITCOMMAND;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/ns-d3dumddi-_d3dddicb_submitcommand">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/d3dddicb_submitcommand.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-d3dumddi-_d3dddicb_submitcommand)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="d3dddicb_submitcommand-structure">D3DDDICB_SUBMITCOMMAND structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>D3DDDICB_SUBMITCOMMAND</strong> structure is used to submit command buffers on contexts that support graphics processing unit (GPU) virtual addressing.</p>

<h2 id="members">Members</h2>

<h3 id="commands"><code>Commands</code></h3>

<p>GPU virtual address to the commands being submitted to the context for execution. This information is provided to the kernel mode driver during command submission and is also used for debugging purposes.</p>

<h3 id="commandlength"><code>CommandLength</code></h3>

<p>Specifies the length, in bytes, of the commands being submitted to the GPU. This information is provided to the kernel mode driver during command submission and is also used for debugging purposes.</p>

<h3 id="flags"><code>Flags</code></h3>

<p>An instance of the <strong><a href="d3dddicb_submitcommandflags" title="typedef struct _D3DDDICB_SUBMITCOMMANDFLAGS {&#10;  union {&#10;    struct {&#10;      UINT NullRendering : 1;&#10;      UINT Reserved : 31;&#10;    };&#10;    UINT Value;&#10;  };&#10;} D3DDDICB_SUBMITCOMMANDFLAGS;">D3DDDICB_SUBMITCOMMANDFLAGS</a></strong> structure.</p>

<h3 id="broadcastcontextcount"><code>BroadcastContextCount</code></h3>

<p>Specifies the number of context these command should be submitted to. This count must be at least 1.</p>

<h3 id="broadcastcontextd3dddi_max_broadcast_context"><code>BroadcastContext[D3DDDI_MAX_BROADCAST_CONTEXT]</code></h3>

<p>Specifies the handle of the context to execute the specified commands.</p>

<h3 id="pprivatedriverdata"><code>pPrivateDriverData</code></h3>

<p>Pointer to driver private data to be passed to the kernel mode driver as part of this submission.</p>

<h3 id="privatedriverdatasize"><code>PrivateDriverDataSize</code></h3>

<p>Size of the private driver data information being passed. This size must be smaller than the size requested by the kernel mode driver for submission private driver data.</p>

<h3 id="numprimaries"><code>NumPrimaries</code></h3>

<p>Specifies the number of primaries and swapchain back buffers being written to by the submitted commands. This is equal to the number of allocations in the <strong>WrittenPrimaries</strong> array.</p>

<h3 id="writtenprimariesd3dddi_max_written_primaries"><code>WrittenPrimaries[D3DDDI_MAX_WRITTEN_PRIMARIES]</code></h3>

<p>Arrays of handle to the primaries and swapchain back buffers being written to by the submitted commands.</p>

<h3 id="markerlogtype"><code>MarkerLogType</code></h3>

<p>A <strong><a href="d3dddi_markerlogtype" title="typedef enum D3DDDI_MARKERLOGTYPE {&#10;  D3DDDIMLT_NONE,&#10;  D3DDDIMLT_PROFILE,&#10;  D3DDDIMLT_FT_PROFILE,&#10;  D3DDDIMLT_BATCHED&#10;} ;">D3DDDI_MARKERLOGTYPE</a></strong> enumeration that indicates the type of marker in the Event Tracing for Windows (ETW) log that the user-mode display driver supports.</p>

<h3 id="rendercbsequence"><code>RenderCBSequence</code></h3>

<p>A unique identifier for each <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_rendercb"><strong>pfnRenderCb</strong></a> function call. Starts at a value of 1 for contexts associated with single-threaded user-mode DDIs and ranges to a value of 0x80000001 for contexts associated with free-threaded user mode DDIs. The user-mode display driver must increment the value for each <strong>pfnRenderCb</strong> call it makes on any engine.</p>

<h3 id="firstapisequencenumberhigh"><code>FirstAPISequenceNumberHigh</code></h3>

<p>Used by the driver to pass the context's API sequence number.</p>

<h3 id="completedapisequencenumberlow0size"><code>CompletedAPISequenceNumberLow0Size</code></h3>

<p>Used by the driver to pass the context's API sequence number.</p>

<h3 id="completedapisequencenumberlow1size"><code>CompletedAPISequenceNumberLow1Size</code></h3>

<p>Used by the driver to pass the context's API sequence number.</p>

<h3 id="begunapisequencenumberlow0size"><code>BegunAPISequenceNumberLow0Size</code></h3>

<p>Used by the driver to pass the context's API sequence number.</p>

<h3 id="begunapisequencenumberlow1size"><code>BegunAPISequenceNumberLow1Size</code></h3>

<p>Used by the driver to pass the context's API sequence number.</p>

<h3 id="batchedmarkerdatacount"><code>BatchedMarkerDataCount</code></h3>

<p>Used by the driver to pass the context's batched marker data count.</p>

<h3 id="pcompletedapisequencenumberlow0"><code>pCompletedAPISequenceNumberLow0</code></h3>

<p>A pointer used by the driver to pass the context's API sequence number.</p>

<h3 id="pcompletedapisequencenumberlow1"><code>pCompletedAPISequenceNumberLow1</code></h3>

<p>A pointer used by the driver to pass the context's API sequence number.</p>

<h3 id="pbegunapisequencenumberlow0"><code>pBegunAPISequenceNumberLow0</code></h3>

<p>A pointer used by the driver to pass the context's API sequence number.</p>

<h3 id="pbegunapisequencenumberlow1"><code>pBegunAPISequenceNumberLow1</code></h3>

<p>A pointer used by the driver to pass the context's API sequence number.</p>

<h3 id="pbatchedmarkerdata"><code>pBatchedMarkerData</code></h3>

<p>A pointer used by the driver to pass the context's batched marker data.</p>

<h3 id="reserved"><code>Reserved</code></h3>

<p>This member is reserved and should be set to zero.</p>

<h3 id="numhistorybuffers"><code>NumHistoryBuffers</code></h3>

<p>The number of history buffers.</p>

<h3 id="historybufferarray"><code>HistoryBufferArray</code></h3>

<p>A pointer to the array of history buffers.</p>

<h3 id="hsynctoken"><code>hSyncToken</code></h3>

<h3 id="preserved"><code>pReserved</code></h3>

<h2 id="remarks">Remarks</h2>

<p>The <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_submitcommandcb"><strong>pfnSubmitCommandCb</strong></a> code path no longer provides an allocation list for the user mode driver to provide a list of allocations that will be read and written to during this command. However, it is necessary to synchronize some writes that would not normally be known without the allocation list. For this, a new small allocation list specifically for surfaces which will be written to and used for displaying content. The <strong>WrittenPrimaries</strong> array should be used to provide such allocations.</p>

<p>Despite the name, <strong>WrittenPrimaries</strong> must contain allocations that are considered <strong>SwapChainBackBuffer</strong> allocations according to the runtime in addition to the primaries. This is exposed to the user mode driver by a new flag in <strong><a href="d3d10_ddi_resource_misc_flag" title="typedef enum D3D10_DDI_RESOURCE_MISC_FLAG {&#10;  D3D10_DDI_RESOURCE_AUTO_GEN_MIP_MAP = 0x00000001L,&#10;  D3D10_DDI_RESOURCE_MISC_SHARED = 0x00000002L,&#10;  D3D10_DDI_RESOURCE_MISC_DISCARD_ON_PRESENT = 0x00000008L,&#10;  D3D11_DDI_RESOURCE_MISC_DRAWINDIRECT_ARGS = 0x00000010L,&#10;  D3D11_DDI_RESOURCE_MISC_BUFFER_ALLOW_RAW_VIEWS = 0x00000020L,&#10;  D3D11_DDI_RESOURCE_MISC_BUFFER_STRUCTURED = 0x00000040L,&#10;  D3D11_DDI_RESOURCE_MISC_RESOURCE_CLAMP = 0x00000080L,&#10;  D3D10_DDI_RESOURCE_MISC_REMOTE = 0x00000400,&#10;  D3D11_1DDI_RESOURCE_MISC_RESTRICTED_CONTENT = 0x00000800L,&#10;  D3D11_1DDI_RESOURCE_MISC_RESTRICT_SHARED_RESOURCE_DRIVER = 0x00001000L,&#10;  D3DWDDM1_3DDI_RESOURCE_MISC_CROSS_ADAPTER = 0x00002000L,&#10;  D3DWDDM1_3DDI_RESOURCE_MISC_TILED = 0x00004000L,&#10;  D3DWDDM1_3DDI_RESOURCE_MISC_TILE_POOL = 0x00008000L,&#10;  D3DWDDM2_0DDI_RESOURCE_MISC_HW_PROTECTED = 0x00010000L,&#10;  D3DWDDM2_0DDI_RESOURCE_MISC_DISPLAYABLE_SURFACE = 0x00020000L,&#10;  D3DWDDM2_0DDI_RESOURCE_MISC_CONTAINS_HW_PROTECTED = 0x00040000L,&#10;  D3DWDDM3_2DDI_RESOURCE_MISC_NO_SHADER_ACCESS,&#10;  D3DWDDM2_5DDI_RESOURCE_MISC_PHYSICALLY_CONTIGUOUS = 0x01000000L&#10;} ;">D3D10_DDI_RESOURCE_MISC_FLAG</a></strong>. The runtime will provide the <strong>D3DWDDM2_0DDI_RESOURCE_MISC_DISPLAYABLE_SURFACE</strong> flag to the user mode driver during calls to create a resource or heap that is created as a <strong>FlipEx swapchain</strong> or <strong>primary</strong>. The driver may use this flag to determine all allocations that should be put in the <strong>WrittenPrimaries</strong> list for Microsoft Direct3D 11. Other runtimes have not changed.</p>

<p>If the driver receives a call to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_createresource"><strong>CreateResource</strong></a> that has this flag, the allocation should be added to this list on every <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_submitcommandcb"><strong>pfnSubmitCommandCb</strong></a> call that writes to the surface.</p>

<h2 id="see-also">See also</h2>

<p><strong><a href="d3d10_ddi_resource_misc_flag" title="typedef enum D3D10_DDI_RESOURCE_MISC_FLAG {&#10;  D3D10_DDI_RESOURCE_AUTO_GEN_MIP_MAP = 0x00000001L,&#10;  D3D10_DDI_RESOURCE_MISC_SHARED = 0x00000002L,&#10;  D3D10_DDI_RESOURCE_MISC_DISCARD_ON_PRESENT = 0x00000008L,&#10;  D3D11_DDI_RESOURCE_MISC_DRAWINDIRECT_ARGS = 0x00000010L,&#10;  D3D11_DDI_RESOURCE_MISC_BUFFER_ALLOW_RAW_VIEWS = 0x00000020L,&#10;  D3D11_DDI_RESOURCE_MISC_BUFFER_STRUCTURED = 0x00000040L,&#10;  D3D11_DDI_RESOURCE_MISC_RESOURCE_CLAMP = 0x00000080L,&#10;  D3D10_DDI_RESOURCE_MISC_REMOTE = 0x00000400,&#10;  D3D11_1DDI_RESOURCE_MISC_RESTRICTED_CONTENT = 0x00000800L,&#10;  D3D11_1DDI_RESOURCE_MISC_RESTRICT_SHARED_RESOURCE_DRIVER = 0x00001000L,&#10;  D3DWDDM1_3DDI_RESOURCE_MISC_CROSS_ADAPTER = 0x00002000L,&#10;  D3DWDDM1_3DDI_RESOURCE_MISC_TILED = 0x00004000L,&#10;  D3DWDDM1_3DDI_RESOURCE_MISC_TILE_POOL = 0x00008000L,&#10;  D3DWDDM2_0DDI_RESOURCE_MISC_HW_PROTECTED = 0x00010000L,&#10;  D3DWDDM2_0DDI_RESOURCE_MISC_DISPLAYABLE_SURFACE = 0x00020000L,&#10;  D3DWDDM2_0DDI_RESOURCE_MISC_CONTAINS_HW_PROTECTED = 0x00040000L,&#10;  D3DWDDM3_2DDI_RESOURCE_MISC_NO_SHADER_ACCESS,&#10;  D3DWDDM2_5DDI_RESOURCE_MISC_PHYSICALLY_CONTIGUOUS = 0x01000000L&#10;} ;">D3D10_DDI_RESOURCE_MISC_FLAG</a></strong></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_rendercb"><strong>pfnRenderCb</strong></a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_submitcommandcb"><strong>pfnSubmitCommandCb</strong></a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/ns-d3dumddi-_d3dddicb_submitcommand">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dumddi/ns-d3dumddi-_d3dddicb_submitcommand.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
