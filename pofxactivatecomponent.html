<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PoFxActivateComponent - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PoFxActivateComponent - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PoFxActivateComponent - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">VOID PoFxActivateComponent(
  [in] POHANDLE Handle,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>    Component,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>    Flags
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-pofxactivatecomponent">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pofxactivatecomponent.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-wdm-pofxactivatecomponent)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>PoFxActivateComponent function</h1>
<h2>Description</h2>
<p>The <strong>PoFxActivateComponent</strong> routine increments the activation reference count on the specified component.</p>
<h2>Parameters</h2>
<h3><code>Handle</code> [in]</h3>
<p>A handle that represents the registration of the device with the power management framework (PoFx). The device driver previously received this handle from the <a href="pofxregisterdevice" title="NTSTATUS PoFxRegisterDevice(&#10;  [in]  PDEVICE_OBJECT Pdo,&#10;  [in]  PPO_FX_DEVICE  Device,&#10;  [out] POHANDLE       *Handle&#10;);">PoFxRegisterDevice</a> routine.</p>
<h3><code>Component</code> [in]</h3>
<p>The index that identifies the component. This parameter is an index into the <strong>Components</strong> array in the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_po_fx_device_v1">PO_FX_DEVICE</a> structure that the device driver used to register the device with PoFx. If the <strong>Components</strong> array contains N elements, component indexes range from 0 to Nâ€“1.</p>
<h3><code>Flags</code> [in]</h3>
<p>The flags for the activation operation. Set this member to zero or to one of the following flag <strong>PO_FX_FLAG_*XXX</strong>* bits:</p>
<p>These two flag bits are mutually exclusive. For more information, see Remarks.</p>
<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>PO_FX_FLAG_BLOCKING</strong><br /><br />0x1</td>
  <td>Make the condition change synchronous. If this flag is set, the routine that requests the condition change does not return control to the calling driver until the component hardware completes the transition to the new condition. This flag can be used only if the caller is running at IRQL &lt; DISPATCH_LEVEL.</td>
</tr>
<tr>
  <td><strong>PO_FX_FLAG_ASYNC_ONLY</strong><br /><br />0x2</td>
  <td>Make the condition change fully asynchronous. If this flag is set, the calling driver's callback routine is called from a thread other than the thread in which the routine that requests the condition change is called. Thus, the routine that requests the condition change always returns asynchronously without waiting for the callback to complete.</td>
</tr>
</tbody>
</table>
<h2>Remarks</h2>
<p>Before a device driver can access a component in a device, the driver must first call <strong>PoFxActivateComponent</strong> to obtain an activation reference to the component. If the component is not already in the active condition, this call initiates a transition from the idle condition to the active condition. When this transition completes, PoFx calls the driver's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_active_condition_callback">ComponentActiveConditionCallback</a> routine to notify the driver. The driver can access the hardware registers in a component only when the component is in the active condition.</p>
<p>If the component is already in the active condition when <strong>PoFxActivateComponent</strong> is called, no transition is required, and the <em>ComponentActiveConditionCallback</em> routine is not called.</p>
<p>After a component enters the active condition, it remains in the active condition for as long as the driver holds one or more activation references on the component. To release an activation reference, the driver calls the <a href="pofxidlecomponent" title="VOID PoFxIdleComponent(&#10;  [in] POHANDLE Handle,&#10;  [in] ULONG    Component,&#10;  [in] ULONG    Flags&#10;);">PoFxIdleComponent</a> routine. When the driver releases the last activation reference on a component, <strong><a href="pofxidlecomponent" title="VOID PoFxIdleComponent(&#10;  [in] POHANDLE Handle,&#10;  [in] ULONG    Component,&#10;  [in] ULONG    Flags&#10;);">PoFxIdleComponent</a></strong> initiates a transition from the active condition to the idle condition. A component that is in the idle condition can potentially enter a low-power Fx state.</p>
<p>If <em>Flags</em> = <strong>PO_FX_FLAG_BLOCKING</strong>, the <strong>PoFxActivateComponent</strong> call is synchronous. If the component is already in the active condition, the call increments the activation reference count and returns without waiting. Otherwise, <strong>PoFxActivateComponent</strong> waits to return until the component completes the transition to the active condition. In this case, if the component is not already in the F0 state when the call occurs, <strong>PoFxActivateComponent</strong> calls the driver's <em>ComponentIdleStateCallback</em> routine to initiate the transition to F0. After the component enters the F0 state, <strong>PoFxActivateComponent</strong> calls the driver's <em>ComponentActiveConditionCallback</em> routine to inform the driver that the component is in the active condition. These callbacks occur in the same thread as the call to <strong>PoFxActivateComponent</strong>, and <strong>PoFxActivateComponent</strong> returns only after the <em>ComponentActiveConditionCallback</em> callback returns.</p>
<p>If <em>Flags</em> = <strong>PO_FX_FLAG_ASYNC_ONLY</strong>, the <strong>PoFxActivateComponent</strong> call is asynchronous. If the component is already in the active condition, the call increments the activation reference count and returns. Otherwise, <strong>PoFxActivateComponent</strong> schedules the <em>ComponentIdleStateCallback</em> (if necessary) and <em>ComponentActiveConditionCallback</em> callbacks to occur in another thread, and then returns without waiting for either callback to occur. The callbacks can occur before or after <strong>PoFxActivateComponent</strong> returns. The driver relies on the <em>ComponentActiveConditionCallback</em> callback to determine when the component completes the transition to the active condition.</p>
<p>The driver can set <em>Flags</em> = 0 to indicate that it does not care whether the <strong>PoFxActivateComponent</strong> call is synchronous or asynchronous. In this case, PoFx decides whether to make the call synchronous or asynchronous.</p>
<p>Two or more code paths in the same driver might need to concurrently access a particular component. The <strong>PoFxActivateComponent</strong> and <strong><a href="pofxidlecomponent" title="VOID PoFxIdleComponent(&#10;  [in] POHANDLE Handle,&#10;  [in] ULONG    Component,&#10;  [in] ULONG    Flags&#10;);">PoFxIdleComponent</a></strong> routines use activation reference counts to enable the various parts of the driver to independently maintain access to the component without requiring the driver to centrally manage access to the component.</p>
<p>PoFx maintains an activation reference count for each component in a device. A <strong>PoFxActivateComponent</strong> call increments this count by one, and a <strong><a href="pofxidlecomponent" title="VOID PoFxIdleComponent(&#10;  [in] POHANDLE Handle,&#10;  [in] ULONG    Component,&#10;  [in] ULONG    Flags&#10;);">PoFxIdleComponent</a></strong> call decrements the count by one. When the count is nonzero, the component either is in the active condition or is in the process of switching to the active condition. A component that has a count of zero either is in the idle condition or is in the process of switching to the idle condition.</p>
<p>When a <strong>PoFxActivateComponent</strong> call causes the activation reference count to increment from 0 to 1, <strong>PoFxActivateComponent</strong> initiates a transition from the idle condition to the active condition. When a <strong><a href="pofxidlecomponent" title="VOID PoFxIdleComponent(&#10;  [in] POHANDLE Handle,&#10;  [in] ULONG    Component,&#10;  [in] ULONG    Flags&#10;);">PoFxIdleComponent</a></strong> call causes the count to decrement from 1 to 0, <strong><a href="pofxidlecomponent" title="VOID PoFxIdleComponent(&#10;  [in] POHANDLE Handle,&#10;  [in] ULONG    Component,&#10;  [in] ULONG    Flags&#10;);">PoFxIdleComponent</a></strong> initiates a transition from the active condition to the idle condition.</p>
<p>PoFx notifies the driver when a transition between the active condition and idle condition occurs. A <em>ComponentActiveConditionCallback</em> callback notifies the driver of a transition to the active condition, and a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_idle_condition_callback">ComponentIdleConditionCallback</a> callback notifies the driver of a transition to the idle condition. When a <strong>PoFxActivateComponent</strong> or <strong><a href="pofxidlecomponent" title="VOID PoFxIdleComponent(&#10;  [in] POHANDLE Handle,&#10;  [in] ULONG    Component,&#10;  [in] ULONG    Flags&#10;);">PoFxIdleComponent</a></strong> call simply increments or decrements the activation reference count without causing such a transition, the driver receives no notification.</p>
<h2>See also</h2>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_active_condition_callback">ComponentActiveConditionCallback</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-po_fx_component_idle_state_callback">ComponentIdleStateCallback</a></p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_po_fx_device_v1">PO_FX_DEVICE</a></p>
<p><a href="pofxidlecomponent" title="VOID PoFxIdleComponent(&#10;  [in] POHANDLE Handle,&#10;  [in] ULONG    Component,&#10;  [in] ULONG    Flags&#10;);">PoFxIdleComponent</a></p>
<p><a href="pofxregisterdevice" title="NTSTATUS PoFxRegisterDevice(&#10;  [in]  PDEVICE_OBJECT Pdo,&#10;  [in]  PPO_FX_DEVICE  Device,&#10;  [out] POHANDLE       *Handle&#10;);">PoFxRegisterDevice</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-pofxactivatecomponent">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/nf-wdm-pofxactivatecomponent.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
