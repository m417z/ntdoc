<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FSCTL_ALLOW_EXTENDED_DASD_IO - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FSCTL_ALLOW_EXTENDED_DASD_IO - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FSCTL_ALLOW_EXTENDED_DASD_IO - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// winioctl.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">// <a href="ctl_code" title="void CTL_CODE(&#10;  DeviceType,&#10;  Function,&#10;  Method,&#10;  Access&#10;);">CTL_CODE</a>(0x0009, 0x020, METHOD_NEITHER, FILE_ANY_ACCESS)
#define FSCTL_ALLOW_EXTENDED_DASD_IO 0x00090083</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ni-winioctl-fsctl_allow_extended_dasd_io">View the official Win32 API reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/fsctl_allow_extended_dasd_io.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Win32 API reference (ni-winioctl-fsctl_allow_extended_dasd_io)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="fsctl_allow_extended_dasd_io-ioctl">FSCTL_ALLOW_EXTENDED_DASD_IO IOCTL</h1>

<h2 id="description">Description</h2>

<p>Signals the file system drive not to perform any I/O boundary checks on partition read or write calls. Instead, boundary checks are performed by the device driver.</p>

<p>To perform this operation, call the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/ioapiset/nf-ioapiset-deviceiocontrol">DeviceIoControl</a> function with the following parameters.</p>

<p><!-- CODE_MARKER --></p>

<div class="codehilite">
<pre><span></span><code><span class="n">BOOL</span><span class="w"> </span><span class="n">DeviceIoControl</span><span class="p">(</span>
<span class="w">  </span><span class="p">(</span><span class="n">HANDLE</span><span class="p">)</span><span class="w"> </span><span class="n">hDevice</span><span class="p">,</span><span class="w">                    </span><span class="c1">// handle to file</span>
<span class="w">  </span><span class="n">FSCTL_ALLOW_EXTENDED_DASD_IO</span><span class="p">,</span><span class="w">        </span><span class="c1">// dwIoControlCode</span>
<span class="w">  </span><span class="nb">NULL</span><span class="p">,</span><span class="w">                                </span><span class="c1">// lpInBuffer</span>
<span class="w">  </span><span class="mi">0</span><span class="p">,</span><span class="w">                                   </span><span class="c1">// nInBufferSize</span>
<span class="w">  </span><span class="nb">NULL</span><span class="p">,</span><span class="w">                                </span><span class="c1">// lpOutBuffer</span>
<span class="w">  </span><span class="mi">0</span><span class="p">,</span><span class="w">                                   </span><span class="c1">// nOutBufferSize</span>
<span class="w">  </span><span class="p">(</span><span class="n">LPDWORD</span><span class="p">)</span><span class="w"> </span><span class="n">lpBytesReturned</span><span class="p">,</span><span class="w">           </span><span class="c1">// number of bytes returned</span>
<span class="w">  </span><span class="p">(</span><span class="n">LPOVERLAPPED</span><span class="p">)</span><span class="w"> </span><span class="n">lpOverlapped</span><span class="w">          </span><span class="c1">// OVERLAPPED structure</span>
<span class="p">);</span>
</code></pre>
</div>

<h3 id="parameters">Parameters</h3>

<h4 id="input-buffer">Input buffer</h4>

<h4 id="input-buffer-length">Input buffer length</h4>

<h4 id="output-buffer">Output buffer</h4>

<h4 id="output-buffer-length">Output buffer length</h4>

<h4 id="inputoutput-buffer">Input/output buffer</h4>

<h4 id="inputoutput-buffer-length">Input/output buffer length</h4>

<h4 id="status-block">Status block</h4>

<p>Irp->IoStatus.Status is set to <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the request is successful.</p>

<p>Otherwise, Status to the appropriate error condition as a <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> code.</p>

<p>For more information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/ntstatus-values">NTSTATUS Values</a>.</p>

<h2 id="remarks">Remarks</h2>

<p>A call using the <strong>FSCTL_ALLOW_EXTENDED_DASD_IO</strong> control code should only be used with great caution by programmers familiar with the underlying structure of a hard disk drive and file system. Improper use or inaccurate checking in subsequent write operations to the partition can result in damage to data on the partition, or destruction of the entire partition.</p>

<p>The <strong>FSCTL_ALLOW_EXTENDED_DASD_IO</strong> control code is used to signal the file system driver not to perform any I/O boundary checks on read or write calls made with the specified handle. <strong>FSCTL_ALLOW_EXTENDED_DASD_IO</strong> allows access to hidden sectors, a part of the partition that might exist between the first sector of the partition (the boot parameter block) and the first useful sector of the partition. <strong>FSCTL_ALLOW_EXTENDED_DASD_IO</strong> also allows access to lost clusters, which might exist between the last useful cluster and the end of the partition.</p>

<p>I/O requests issued after this operation are passed directly to the device driver. If these subsequent calls request data beyond the partition boundary, the driver causes them to fail.</p>

<p>For the implications of overlapped I/O on this operation, see the Remarks section of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/ioapiset/nf-ioapiset-deviceiocontrol">DeviceIoControl</a>.</p>

<p>To retrieve a handle to a partition, call <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/fileapi/nf-fileapi-createfilea">CreateFile</a> with the <em>lpFileName</em> parameter set to a string of the following form:</p>

<p>\.*X*:</p>

<p>where <em>X</em> is the drive letter.</p>

<p>The application calling <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/fileapi/nf-fileapi-createfilea">CreateFile</a> must also specify the <strong><a href="file_share_read" title="#define FILE_SHARE_READ 0x00000001">FILE_SHARE_READ</a></strong> and <strong><a href="file_share_write" title="#define FILE_SHARE_WRITE 0x00000002">FILE_SHARE_WRITE</a></strong> flags in the <em>dwShareMode</em> parameter of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/fileapi/nf-fileapi-createfilea">CreateFile</a>. For more information, see the Disk Devices section in <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/fileapi/nf-fileapi-createfilea">CreateFile</a>.</p>

<p>To determine the partition structure of the drive and to determine if the system recognizes the partition, use the <a href="ioctl_disk_get_drive_layout_ex" title="// CTL_CODE(0x0007, 0x014, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_DISK_GET_DRIVE_LAYOUT_EX 0x00070050">IOCTL_DISK_GET_DRIVE_LAYOUT_EX</a> or <a href="ioctl_disk_get_drive_layout" title="// CTL_CODE(0x0007, 0x003, METHOD_BUFFERED, FILE_READ_ACCESS)&#10;#define IOCTL_DISK_GET_DRIVE_LAYOUT 0x0007400C">IOCTL_DISK_GET_DRIVE_LAYOUT</a> control code, as appropriate. For similar information on a single partition, use the <a href="ioctl_disk_get_partition_info_ex" title="// CTL_CODE(0x0007, 0x012, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_DISK_GET_PARTITION_INFO_EX 0x00070048">IOCTL_DISK_GET_PARTITION_INFO_EX</a> or <a href="ioctl_disk_get_partition_info" title="// CTL_CODE(0x0007, 0x001, METHOD_BUFFERED, FILE_READ_ACCESS)&#10;#define IOCTL_DISK_GET_PARTITION_INFO 0x00074004">IOCTL_DISK_GET_PARTITION_INFO</a> control code, as appropriate. To determine the size of a cluster, use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/fileapi/nf-fileapi-getdiskfreespaceexa">GetDiskFreeSpaceEx</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/fileapi/nf-fileapi-getdiskfreespacea">GetDiskFreeSpace</a> function, as appropriate.</p>

<p>In Windows Server 2012, this function is supported by the following technologies.</p>

<table>
<thead>
<tr>
  <th>Technology</th>
  <th>Supported</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Server Message Block (SMB) 3.0 protocol</td>
  <td>No</td>
</tr>
<tr>
  <td>SMB 3.0 Transparent Failover (TFO)</td>
  <td>No</td>
</tr>
<tr>
  <td>SMB 3.0 with Scale-out File Shares (SO)</td>
  <td>No</td>
</tr>
<tr>
  <td>Cluster Shared Volume File System (CsvFS)</td>
  <td>Yes</td>
</tr>
<tr>
  <td>Resilient File System (ReFS)</td>
  <td>Yes</td>
</tr>
</tbody>
</table>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/fileapi/nf-fileapi-createfilea">CreateFile</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/ioapiset/nf-ioapiset-deviceiocontrol">DeviceIoControl</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/FileIO/file-management-control-codes">File Management Control Codes</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/fileapi/nf-fileapi-getdiskfreespacea">GetDiskFreeSpace</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/fileapi/nf-fileapi-getdiskfreespaceexa">GetDiskFreeSpaceEx</a></p>

<p><a href="ioctl_disk_get_drive_layout" title="// CTL_CODE(0x0007, 0x003, METHOD_BUFFERED, FILE_READ_ACCESS)&#10;#define IOCTL_DISK_GET_DRIVE_LAYOUT 0x0007400C">IOCTL_DISK_GET_DRIVE_LAYOUT</a></p>

<p><a href="ioctl_disk_get_drive_layout_ex" title="// CTL_CODE(0x0007, 0x014, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_DISK_GET_DRIVE_LAYOUT_EX 0x00070050">IOCTL_DISK_GET_DRIVE_LAYOUT_EX</a></p>

<p><a href="ioctl_disk_get_partition_info" title="// CTL_CODE(0x0007, 0x001, METHOD_BUFFERED, FILE_READ_ACCESS)&#10;#define IOCTL_DISK_GET_PARTITION_INFO 0x00074004">IOCTL_DISK_GET_PARTITION_INFO</a></p>

<p><a href="ioctl_disk_get_partition_info_ex" title="// CTL_CODE(0x0007, 0x012, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_DISK_GET_PARTITION_INFO_EX 0x00070048">IOCTL_DISK_GET_PARTITION_INFO_EX</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/minwinbase/ns-minwinbase-overlapped">OVERLAPPED</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ni-winioctl-fsctl_allow_extended_dasd_io">View the official Win32 API reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/sdk-api/blob/docs/sdk-api-src/content/winioctl/ni-winioctl-fsctl_allow_extended_dasd_io.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
