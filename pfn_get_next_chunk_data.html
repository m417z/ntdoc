<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PFN_GET_NEXT_CHUNK_DATA - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PFN_GET_NEXT_CHUNK_DATA - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PFN_GET_NEXT_CHUNK_DATA - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// netdispumdddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PFN_GET_NEXT_CHUNK_DATA PfnGetNextChunkData;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> PfnGetNextChunkData(
  [in]           HANDLE hMiracastDeviceHandle,
  [in]           <a href="uint" title="typedef unsigned int UINT;">UINT</a> TimeoutInMilliseconds,
  [in]           <a href="uint" title="typedef unsigned int UINT;">UINT</a> AdditionalWaitEventCount,
  [in, optional] HANDLE *pAdditionalWaitEvents,
  [in, out]      <a href="uint" title="typedef unsigned int UINT;">UINT</a> *pChunkDataBufferSize,
  [out]          <a href="miracast_chunk_data" title="typedef struct {&#10;  MIRACAST_CHUNK_INFO ChunkInfo;&#10;  UINT                PrivateDriverDataSize;&#10;  UCHAR               PrivateDriverData[1];&#10;} MIRACAST_CHUNK_DATA;">MIRACAST_CHUNK_DATA</a> *pChunkDataBuffer,
  [out]          <a href="uint" title="typedef unsigned int UINT;">UINT</a> *pOutstandingChunksToProcess
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_get_next_chunk_data">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pfn_get_next_chunk_data.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-netdispumdddi-pfn_get_next_chunk_data)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pfn_get_next_chunk_data-callback-function">PFN_GET_NEXT_CHUNK_DATA callback function</h1>

<h2 id="description">Description</h2>

<p>Provides info about the next Miracast encode chunk that was reported to the Microsoft DirectX graphics kernel subsystem when the <a href="dxgk_interrupt_type" title="typedef enum _DXGK_INTERRUPT_TYPE {&#10;  DXGK_INTERRUPT_DMA_COMPLETED = 1,&#10;  DXGK_INTERRUPT_DMA_PREEMPTED = 2,&#10;  DXGK_INTERRUPT_CRTC_VSYNC = 3,&#10;  DXGK_INTERRUPT_DMA_FAULTED = 4,&#10;  DXGK_INTERRUPT_DISPLAYONLY_VSYNC = 5,&#10;  DXGK_INTERRUPT_DISPLAYONLY_PRESENT_PROGRESS = 6,&#10;  DXGK_INTERRUPT_CRTC_VSYNC_WITH_MULTIPLANE_OVERLAY = 7,&#10;  DXGK_INTERRUPT_MICACAST_CHUNK_PROCESSING_COMPLETE = 8,&#10;  DXGK_INTERRUPT_DMA_PAGE_FAULTED = 9,&#10;  DXGK_INTERRUPT_CRTC_VSYNC_WITH_MULTIPLANE_OVERLAY2 = 10,&#10;  DXGK_INTERRUPT_MONITORED_FENCE_SIGNALED = 11,&#10;  DXGK_INTERRUPT_HWQUEUE_PAGE_FAULTED = 12,&#10;  DXGK_INTERRUPT_HWCONTEXTLIST_SWITCH_COMPLETED = 13,&#10;  DXGK_INTERRUPT_PERIODIC_MONITORED_FENCE_SIGNALED = 14,&#10;  DXGK_INTERRUPT_SCHEDULING_LOG_INTERRUPT = 15,&#10;  DXGK_INTERRUPT_GPU_ENGINE_TIMEOUT = 16,&#10;  DXGK_INTERRUPT_SUSPEND_CONTEXT_COMPLETED = 17,&#10;  DXGK_INTERRUPT_CRTC_VSYNC_WITH_MULTIPLANE_OVERLAY3 = 18,&#10;  DXGK_INTERRUPT_NATIVE_FENCE_SIGNALED = 19,&#10;...">DXGK_INTERRUPT_TYPE</a> interrupt type is <strong>DXGK_INTERRUPT_MICACAST_CHUNK_PROCESSING_COMPLETE</strong>.The data type of this function is <strong>PFN_GET_NEXT_CHUNK_DATA</strong>.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="hmiracastdevicehandle-in"><code>hMiracastDeviceHandle</code> [in]</h3>

<p>A handle that represents a Miracast device. The Miracast user-mode driver previously obtained this handle as the <em>hMiracastDeviceHandle</em> parameter in a call to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_create_miracast_context">CreateMiracastContext</a> function.</p>

<h3 id="timeoutinmilliseconds-in"><code>TimeoutInMilliseconds</code> [in]</h3>

<p>The timeout interval value, in milliseconds, supplied by the Miracast user-mode driver.</p>

<p>If this value is <strong>INFINITE</strong>, the operating system blocks calls to <strong>GetNextChunkData</strong> until a chunk becomes available.</p>

<p>If this value is zero and a chunk is not ready, the operating system will not block a call to <strong>GetNextChunkData</strong>.</p>

<h3 id="additionalwaiteventcount-in"><code>AdditionalWaitEventCount</code> [in]</h3>

<p>The number of additional events that are supplied in the <em>pAdditionalWaitEvents</em> parameter.</p>

<p>A maximum of 4 wait events can be supplied.</p>

<h3 id="padditionalwaitevents-in-optional"><code>pAdditionalWaitEvents</code> [in, optional]</h3>

<p>An optional pointer to an array of events that <strong>GetNextChunkData</strong> will wait on while waiting for a new encode chunk.</p>

<h3 id="pchunkdatabuffersize-in-out"><code>pChunkDataBufferSize</code> [in, out]</h3>

<p>A pointer to a variable that contains the size, in bytes, of the <em>pChunkDataBuffer</em> buffer.</p>

<p>When <strong>GetNextChunkData</strong> is called, this parameter contains the size of <em>pChunkDataBuffer</em>.</p>

<p>When <strong>GetNextChunkData</strong> returns a success code, this parameter contains the size of actual encode chunk data returned in <em>pChunkDataBuffer</em>.</p>

<h3 id="pchunkdatabuffer-out"><code>pChunkDataBuffer</code> [out]</h3>

<p>A pointer to a buffer of type <a href="miracast_chunk_data" title="typedef struct {&#10;  MIRACAST_CHUNK_INFO ChunkInfo;&#10;  UINT                PrivateDriverDataSize;&#10;  UCHAR               PrivateDriverData[1];&#10;} MIRACAST_CHUNK_DATA;">MIRACAST_CHUNK_DATA</a> that the operating system provides to store information about the next encode chunk. This parameter is provided only if the call to <strong>GetNextChunkData</strong> is successful.</p>

<h3 id="poutstandingchunkstoprocess-out"><code>pOutstandingChunksToProcess</code> [out]</h3>

<p>A pointer to a variable that contains the number of outstanding encode chunks that are available for the driver at the time this call returned. This parameter is provided only if the call to <strong>GetNextChunkData</strong> is successful.</p>

<p>Note that as chunks are completed by the GPU asynchronously, this parameter only gives an indication of the number of outstanding chunks.</p>

<h2 id="return-value">Return value</h2>

<p>If info on an encode chunk was returned successfully, the <strong><a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a></strong> status code is returned, and the value of <em>*pChunkDataBufferSize</em> is non-zero.</p>

<p>These additional status codes can be returned:</p>

<h2 id="remarks">Remarks</h2>

<p>This function is optional. The user-mode display driver should only call it if the display miniport driver responds to interrupts from the GPU when the GPU completes the encoding of a chunk by passing data in the <a href="miracast_chunk_data" title="typedef struct {&#10;  MIRACAST_CHUNK_INFO ChunkInfo;&#10;  UINT                PrivateDriverDataSize;&#10;  UCHAR               PrivateDriverData[1];&#10;} MIRACAST_CHUNK_DATA;">MIRACAST_CHUNK_DATA</a>.<strong>PrivateDriverData</strong> member at that interrupt time.</p>

<p>The user-mode display driver can use the sizes of the <a href="miracast_chunk_data" title="typedef struct {&#10;  MIRACAST_CHUNK_INFO ChunkInfo;&#10;  UINT                PrivateDriverDataSize;&#10;  UCHAR               PrivateDriverData[1];&#10;} MIRACAST_CHUNK_DATA;">MIRACAST_CHUNK_DATA</a> structure and the <strong><a href="miracast_chunk_data" title="typedef struct {&#10;  MIRACAST_CHUNK_INFO ChunkInfo;&#10;  UINT                PrivateDriverDataSize;&#10;  UCHAR               PrivateDriverData[1];&#10;} MIRACAST_CHUNK_DATA;">MIRACAST_CHUNK_DATA</a></strong>.<strong>PrivateDriverData</strong> member to compute the size of a chunk and hence how to move from chunk to chunk in the returned buffer.</p>

<p>In a call to this function, as many available packets as can fit will be placed sequentially in the supplied buffer. This code snippet shows how to calculate the size of each packet:</p>

<p><!-- CODE_MARKER --></p>

<div class="codehilite">
<pre><span></span><code><span class="n">ChunkSize</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n"><a href="field_offset" title="void FIELD_OFFSET(&#10;  type,&#10;  field&#10;);">FIELD_OFFSET</a></span>
<span class="w">    </span><span class="p">(</span><span class="n"><a href="d3dkmt_miracast_chunk_data" title="typedef struct {&#10;  DXGK_MIRACAST_CHUNK_INFO ChunkInfo;&#10;  UINT                     PrivateDriverDataSize;&#10;  BYTE                     PrivateDriverData[1];&#10;} D3DKMT_MIRACAST_CHUNK_DATA;">D3DKMT_MIRACAST_CHUNK_DATA</a></span><span class="p">,</span><span class="w"> </span><span class="n">PrivateDriverData</span><span class="p">)</span><span class="w"> </span>\
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Chunk</span><span class="o">-&gt;</span><span class="n">ChunkData</span><span class="p">.</span><span class="n">PrivateDriverDataSize</span><span class="p">;</span>
</code></pre>
</div>

<h4 id="thread-safety">Thread Safety</h4>

<p>Only one thread should call this function at a time. Otherwise it's unpredictable which call would receive chunk info and which call would fail.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_create_miracast_context">CreateMiracastContext</a></p>

<p><a href="dxgk_interrupt_type" title="typedef enum _DXGK_INTERRUPT_TYPE {&#10;  DXGK_INTERRUPT_DMA_COMPLETED = 1,&#10;  DXGK_INTERRUPT_DMA_PREEMPTED = 2,&#10;  DXGK_INTERRUPT_CRTC_VSYNC = 3,&#10;  DXGK_INTERRUPT_DMA_FAULTED = 4,&#10;  DXGK_INTERRUPT_DISPLAYONLY_VSYNC = 5,&#10;  DXGK_INTERRUPT_DISPLAYONLY_PRESENT_PROGRESS = 6,&#10;  DXGK_INTERRUPT_CRTC_VSYNC_WITH_MULTIPLANE_OVERLAY = 7,&#10;  DXGK_INTERRUPT_MICACAST_CHUNK_PROCESSING_COMPLETE = 8,&#10;  DXGK_INTERRUPT_DMA_PAGE_FAULTED = 9,&#10;  DXGK_INTERRUPT_CRTC_VSYNC_WITH_MULTIPLANE_OVERLAY2 = 10,&#10;  DXGK_INTERRUPT_MONITORED_FENCE_SIGNALED = 11,&#10;  DXGK_INTERRUPT_HWQUEUE_PAGE_FAULTED = 12,&#10;  DXGK_INTERRUPT_HWCONTEXTLIST_SWITCH_COMPLETED = 13,&#10;  DXGK_INTERRUPT_PERIODIC_MONITORED_FENCE_SIGNALED = 14,&#10;  DXGK_INTERRUPT_SCHEDULING_LOG_INTERRUPT = 15,&#10;  DXGK_INTERRUPT_GPU_ENGINE_TIMEOUT = 16,&#10;  DXGK_INTERRUPT_SUSPEND_CONTEXT_COMPLETED = 17,&#10;  DXGK_INTERRUPT_CRTC_VSYNC_WITH_MULTIPLANE_OVERLAY3 = 18,&#10;  DXGK_INTERRUPT_NATIVE_FENCE_SIGNALED = 19,&#10;...">DXGK_INTERRUPT_TYPE</a></p>

<p><a href="miracast_chunk_data" title="typedef struct {&#10;  MIRACAST_CHUNK_INFO ChunkInfo;&#10;  UINT                PrivateDriverDataSize;&#10;  UCHAR               PrivateDriverData[1];&#10;} MIRACAST_CHUNK_DATA;">MIRACAST_CHUNK_DATA</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_get_next_chunk_data">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/netdispumdddi/nc-netdispumdddi-pfn_get_next_chunk_data.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
