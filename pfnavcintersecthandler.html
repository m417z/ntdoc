<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PFNAVCINTERSECTHANDLER - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PFNAVCINTERSECTHANDLER - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PFNAVCINTERSECTHANDLER - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// avc.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> ( *PFNAVCINTERSECTHANDLER)(
  _In_      PVOID        Context,
  _In_      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>        PinId,
  _In_      PKSDATARANGE CallerDataRange,
  _In_      PKSDATARANGE DescriptorDataRange,
  _In_      <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>        DataBufferSize,
  _Out_opt_ PVOID        Data,
  _Out_     PULONG       ReportedDataSize
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/avc/nc-avc-pfnavcintersecthandler">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pfnavcintersecthandler.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-avc-pfnavcintersecthandler)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pfnavcintersecthandler-callback">PFNAVCINTERSECTHANDLER callback</h1>

<h2 id="description">Description</h2>

<p>The AV/C intersect handler determines if the data ranges are compatible. This is a user-defined function based on the following prototype:</p>

<h2 id="parameters">Parameters</h2>

<h3 id="context-in"><code>Context</code> [in]</h3>

<p>An optional value expected by the intersect handler. This value is either provided by the subunit driver (if the subunit driver provides the intersect handler), or by the lower driver providing the intersect handler.</p>

<h3 id="pinid-in"><code>PinId</code> [in]</h3>

<p>Specifies the offset (or ID) of the pin for which the intersection is being done.</p>

<h3 id="datarange-in"><code>DataRange</code> [in]</h3>

<h3 id="matchingdatarange-in"><code>MatchingDataRange</code> [in]</h3>

<h3 id="databuffersize-in"><code>DataBufferSize</code> [in]</h3>

<p>The size of the buffer passed by the <strong>Data</strong> member. If this is nonzero, then the intersect handler should attempt to return the data format resulting from a matching pair of data ranges. If this is zero, then the intersect handler should provide the required buffer size in <strong>ReportedDataSize</strong>, and return STATUS_BUFFER_OVERFLOW.</p>

<h3 id="data-out-optional"><code>Data</code> [out, optional]</h3>

<p>An optional buffer to receive the data format resulting from a matching pair of data ranges. This member is ignored if <strong>DataBufferSize</strong> is zero.</p>

<h3 id="datasize-out"><code>DataSize</code> [out]</h3>

<h2 id="return-value">Return value</h2>

<p>The intersect handler should return <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the data ranges are compatible, and there was enough buffer space to return the resulting format.</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>STATUS_NO_MATCH</strong></td>
  <td>The data ranges are not compatible.</td>
</tr>
<tr>
  <td><strong>STATUS_INTERNAL_ERROR</strong></td>
  <td>There was an unexpected format size mismatch.</td>
</tr>
<tr>
  <td><strong>STATUS_BUFFER_OVERFLOW</strong></td>
  <td>The intersect handler returns the required buffer size through the <strong>ReportedDataSize</strong> member.</td>
</tr>
<tr>
  <td><strong>STATUS_BUFFER_TOO_SMALL</strong></td>
  <td>The intersect handler was not provided with a buffer large enough to hold the resulting format. The intersect handler must be called again with the <strong>DataBufferSize</strong> set to zero to determine the required buffer size.</td>
</tr>
<tr>
  <td><strong>STATUS_INSUFFICIENT_RESOURCES</strong></td>
  <td>An internal buffer allocation failed.</td>
</tr>
</tbody>
</table>

<h2 id="syntax">Syntax</h2>

<p><!-- CODE_MARKER --></p>

<div class="codehilite">
<pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="n"><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a></span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="n">PFNAVCINTERSECTHANDLER</span><span class="p">)(</span>
<span class="w">  </span><span class="n">_In_</span><span class="w">      </span><span class="n">PVOID</span><span class="w">        </span><span class="n">Context</span><span class="p">,</span>
<span class="w">  </span><span class="n">_In_</span><span class="w">      </span><span class="n"><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></span><span class="w">        </span><span class="n">PinId</span><span class="p">,</span>
<span class="w">  </span><span class="n">_In_</span><span class="w">      </span><span class="n">PKSDATARANGE</span><span class="w"> </span><span class="n">CallerDataRange</span><span class="p">,</span>
<span class="w">  </span><span class="n">_In_</span><span class="w">      </span><span class="n">PKSDATARANGE</span><span class="w"> </span><span class="n">DescriptorDataRange</span><span class="p">,</span>
<span class="w">  </span><span class="n">_In_</span><span class="w">      </span><span class="n"><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></span><span class="w">        </span><span class="n">DataBufferSize</span><span class="p">,</span>
<span class="w">  </span><span class="n">_Out_opt_</span><span class="w"> </span><span class="n">PVOID</span><span class="w">        </span><span class="n">Data</span><span class="p">,</span>
<span class="w">  </span><span class="n">_Out_</span><span class="w">     </span><span class="n">PULONG</span><span class="w">       </span><span class="n">ReportedDataSize</span>
<span class="p">);</span>
</code></pre>
</div>

<h2 id="remarks">Remarks</h2>

<p>The AV/C intersect handler is user-defined, based on the function prototype above.</p>

<p>The handler is used in conjunction with the <strong>AVC_FUNCTION_GET_PIN_DESCRIPTOR</strong> function code. The purpose of the handler is to match identical pin data formats and return them to the caller.</p>

<h2 id="see-also">See also</h2>

<ul>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/avc-function-get-pin-descriptor">AVC_FUNCTION_GET_PIN_DESCRIPTOR</a></li>
<li><a href="avc_pin_descriptor" title="typedef struct _AVC_PIN_DESCRIPTOR {&#10;  ULONG                  PinId;&#10;  KSPIN_DESCRIPTOR       PinDescriptor;&#10;  PFNAVCINTERSECTHANDLER IntersectHandler;&#10;  PVOID                  Context;&#10;} AVC_PIN_DESCRIPTOR, *PAVC_PIN_DESCRIPTOR;">AVC_PIN_DESCRIPTOR</a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/nc-ks-pfnksintersecthandlerex">AVStrMiniIntersectHandlerEx</a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/data-range-intersections-in-avstream">DataRange Intersections in AVStream</a></li>
</ul>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/avc/nc-avc-pfnavcintersecthandler">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/avc/nc-avc-pfnavcintersecthandler.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
