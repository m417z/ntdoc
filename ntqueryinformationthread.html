<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NtQueryInformationThread - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NtQueryInformationThread - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NtQueryInformationThread - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTPSAPI_H
//
// Threads
//
#if (PHNT_MODE != PHNT_MODE_KERNEL)

</span><span class="ntdoc-code-intro">/**
 * Retrieves information about the specified thread.
 *
 * \param ThreadHandle A handle to the thread.
 * \param ThreadInformationClass The type of thread information to be retrieved.
 * \param ThreadInformation A pointer to a buffer that receives the thread information.
 * \param ThreadInformationLength The size of the buffer pointed to by the ThreadInformation parameter.
 * \param ReturnLength An optional pointer to a variable that receives the size of the data returned.
 * \return <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> Successful or errant status.
 */
</span><span class="ntdoc-code-body">NTSYSCALLAPI
<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>
NTAPI
NtQueryInformationThread(
    _In_ HANDLE ThreadHandle,
    _In_ <a href="threadinfoclass" title="typedef enum _THREADINFOCLASS&#10;{&#10;    ThreadBasicInformation,                         // q: THREAD_BASIC_INFORMATION&#10;    ThreadTimes,                                    // q: KERNEL_USER_TIMES&#10;    ThreadPriority,                                 // s: KPRIORITY (requires SeIncreaseBasePriorityPrivilege)&#10;    ThreadBasePriority,                             // s: KPRIORITY&#10;    ThreadAffinityMask,                             // s: KAFFINITY&#10;    ThreadImpersonationToken,                       // s: HANDLE&#10;    ThreadDescriptorTableEntry,                     // q: DESCRIPTOR_TABLE_ENTRY (or WOW64_DESCRIPTOR_TABLE_ENTRY)&#10;    ThreadEnableAlignmentFaultFixup,                // s: BOOLEAN&#10;    ThreadEventPair,                                // q: Obsolete&#10;    ThreadQuerySetWin32StartAddress,                // qs: PVOID (requires THREAD_SET_LIMITED_INFORMATION)&#10;    ThreadZeroTlsCell,                              // s: ULONG // TlsIndex // 10&#10;    ThreadPerformanceCount,                         // q: LARGE_INTEGER&#10;    ThreadAmILastThread,                            // q: ULONG&#10;    ThreadIdealProcessor,                           // s: ULONG&#10;    ThreadPriorityBoost,                            // qs: ULONG&#10;    ThreadSetTlsArrayAddress,                       // s: ULONG_PTR&#10;    ThreadIsIoPending,                              // q: ULONG&#10;    ThreadHideFromDebugger,                         // q: BOOLEAN; s: void&#10;...">THREADINFOCLASS</a> ThreadInformationClass,
    _Out_writes_bytes_(ThreadInformationLength) PVOID ThreadInformation,
    _In_ <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> ThreadInformationLength,
    _Out_opt_ PULONG ReturnLength
    );
</span><span class="ntdoc-code-footer">
#endif
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/1958e4efdb339eb2f01732202252f3d4fc64ea95/phnt/include/ntpsapi.h#L2501">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTZWAPI_H

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NTSYSCALLAPI
<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>
NTAPI
ZwQueryInformationThread(
    _In_ HANDLE ThreadHandle,
    _In_ <a href="threadinfoclass" title="typedef enum _THREADINFOCLASS&#10;{&#10;    ThreadBasicInformation,                         // q: THREAD_BASIC_INFORMATION&#10;    ThreadTimes,                                    // q: KERNEL_USER_TIMES&#10;    ThreadPriority,                                 // s: KPRIORITY (requires SeIncreaseBasePriorityPrivilege)&#10;    ThreadBasePriority,                             // s: KPRIORITY&#10;    ThreadAffinityMask,                             // s: KAFFINITY&#10;    ThreadImpersonationToken,                       // s: HANDLE&#10;    ThreadDescriptorTableEntry,                     // q: DESCRIPTOR_TABLE_ENTRY (or WOW64_DESCRIPTOR_TABLE_ENTRY)&#10;    ThreadEnableAlignmentFaultFixup,                // s: BOOLEAN&#10;    ThreadEventPair,                                // q: Obsolete&#10;    ThreadQuerySetWin32StartAddress,                // qs: PVOID (requires THREAD_SET_LIMITED_INFORMATION)&#10;    ThreadZeroTlsCell,                              // s: ULONG // TlsIndex // 10&#10;    ThreadPerformanceCount,                         // q: LARGE_INTEGER&#10;    ThreadAmILastThread,                            // q: ULONG&#10;    ThreadIdealProcessor,                           // s: ULONG&#10;    ThreadPriorityBoost,                            // qs: ULONG&#10;    ThreadSetTlsArrayAddress,                       // s: ULONG_PTR&#10;    ThreadIsIoPending,                              // q: ULONG&#10;    ThreadHideFromDebugger,                         // q: BOOLEAN; s: void&#10;...">THREADINFOCLASS</a> ThreadInformationClass,
    _Out_writes_bytes_(ThreadInformationLength) PVOID ThreadInformation,
    _In_ <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> ThreadInformationLength,
    _Out_opt_ PULONG ReturnLength
    );
</span><span class="ntdoc-code-footer">
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/1958e4efdb339eb2f01732202252f3d4fc64ea95/phnt/include/ntzwapi.h#L3195">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// winternl.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">__kernel_entry <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> NtQueryInformationThread(
  [in]            HANDLE          ThreadHandle,
  [in]            <a href="threadinfoclass" title="typedef enum _THREADINFOCLASS&#10;{&#10;    ThreadBasicInformation,                         // q: THREAD_BASIC_INFORMATION&#10;    ThreadTimes,                                    // q: KERNEL_USER_TIMES&#10;    ThreadPriority,                                 // s: KPRIORITY (requires SeIncreaseBasePriorityPrivilege)&#10;    ThreadBasePriority,                             // s: KPRIORITY&#10;    ThreadAffinityMask,                             // s: KAFFINITY&#10;    ThreadImpersonationToken,                       // s: HANDLE&#10;    ThreadDescriptorTableEntry,                     // q: DESCRIPTOR_TABLE_ENTRY (or WOW64_DESCRIPTOR_TABLE_ENTRY)&#10;    ThreadEnableAlignmentFaultFixup,                // s: BOOLEAN&#10;    ThreadEventPair,                                // q: Obsolete&#10;    ThreadQuerySetWin32StartAddress,                // qs: PVOID (requires THREAD_SET_LIMITED_INFORMATION)&#10;    ThreadZeroTlsCell,                              // s: ULONG // TlsIndex // 10&#10;    ThreadPerformanceCount,                         // q: LARGE_INTEGER&#10;    ThreadAmILastThread,                            // q: ULONG&#10;    ThreadIdealProcessor,                           // s: ULONG&#10;    ThreadPriorityBoost,                            // qs: ULONG&#10;    ThreadSetTlsArrayAddress,                       // s: ULONG_PTR&#10;    ThreadIsIoPending,                              // q: ULONG&#10;    ThreadHideFromDebugger,                         // q: BOOLEAN; s: void&#10;...">THREADINFOCLASS</a> ThreadInformationClass,
  [in, out]       PVOID           ThreadInformation,
  [in]            <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>           ThreadInformationLength,
  [out, optional] PULONG          ReturnLength
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows/win32/api/winternl/nf-winternl-ntqueryinformationthread">View the official Win32 API reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<p>Queries various information about the specified thread. This function is partially documented in <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/previous-versions/windows/hardware/kernel/mt629133%28v=vs.85%29">Windows Driver Kit</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntqueryinformationthread">Windows SDK</a>.</p>

<h1 id="parameters">Parameters</h1>

<ul>
<li><code>ThreadHandle</code> - a handle to the thread or the <code><a href="ntcurrentthread" title="#define NtCurrentThread() ((HANDLE)(LONG_PTR)-2)">NtCurrentThread</a></code> pseudo-handle. For most information classes, the handle must grant either <code><a href="thread_query_information" title="#define THREAD_QUERY_INFORMATION 0x0040">THREAD_QUERY_INFORMATION</a></code> or <code><a href="thread_query_limited_information" title="#define THREAD_QUERY_LIMITED_INFORMATION 0x0800">THREAD_QUERY_LIMITED_INFORMATION</a></code> access.</li>
<li><code>ThreadInformationClass</code> - the type of information to retrieve.</li>
<li><code>ThreadInformation</code> - a pointer to user-allocated buffer that receives the requested information.</li>
<li><code>ThreadInformationLength</code> - the size of the provided buffer in bytes.</li>
<li><code>ReturnLength</code> - an optional pointer to a variable that receives the number of bytes written when the function succeeds or the number of bytes requires when the buffer is too small.</li>
</ul>

<h1 id="information-classes">Information classes</h1>

<p>For the list of supported info classes and required thread access, see <code><a href="threadinfoclass" title="typedef enum _THREADINFOCLASS&#10;{&#10;    ThreadBasicInformation,                         // q: THREAD_BASIC_INFORMATION&#10;    ThreadTimes,                                    // q: KERNEL_USER_TIMES&#10;    ThreadPriority,                                 // s: KPRIORITY (requires SeIncreaseBasePriorityPrivilege)&#10;    ThreadBasePriority,                             // s: KPRIORITY&#10;    ThreadAffinityMask,                             // s: KAFFINITY&#10;    ThreadImpersonationToken,                       // s: HANDLE&#10;    ThreadDescriptorTableEntry,                     // q: DESCRIPTOR_TABLE_ENTRY (or WOW64_DESCRIPTOR_TABLE_ENTRY)&#10;    ThreadEnableAlignmentFaultFixup,                // s: BOOLEAN&#10;    ThreadEventPair,                                // q: Obsolete&#10;    ThreadQuerySetWin32StartAddress,                // qs: PVOID (requires THREAD_SET_LIMITED_INFORMATION)&#10;    ThreadZeroTlsCell,                              // s: ULONG // TlsIndex // 10&#10;    ThreadPerformanceCount,                         // q: LARGE_INTEGER&#10;    ThreadAmILastThread,                            // q: ULONG&#10;    ThreadIdealProcessor,                           // s: ULONG&#10;    ThreadPriorityBoost,                            // qs: ULONG&#10;    ThreadSetTlsArrayAddress,                       // s: ULONG_PTR&#10;    ThreadIsIoPending,                              // q: ULONG&#10;    ThreadHideFromDebugger,                         // q: BOOLEAN; s: void&#10;...">THREADINFOCLASS</a></code>.</p>

<h1 id="notable-return-values">Notable return values</h1>

<ul>
<li><code>STATUS_BUFFER_TOO_SMALL</code> and <code>STATUS_INFO_LENGTH_MISMATCH</code> indicate that the requested information does not fit into the provided buffer.</li>
</ul>

<h1 id="related-win32-api">Related Win32 API</h1>

<ul>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getthreadinformation"><code>GetThreadInformation</code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getthreadid"><code>GetThreadId</code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getprocessidofthread"><code>GetProcessIdOfThread</code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getexitcodethread"><code>GetExitCodeThread</code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getthreaddescription"><code>GetThreadDescription</code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getthreadiopendingflag"><code>GetThreadIOPendingFlag</code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getthreadpriority"><code>GetThreadPriority</code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-getthreadtimes"><code>GetThreadTimes</code></a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/wow64apiset/nf-wow64apiset-wow64getthreadcontext"><code>Wow64GetThreadContext</code></a></li>
</ul>

<h1 id="see-also">See also</h1>

<ul>
<li><code><a href="ntopenthread" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtOpenThread(&#10;    _Out_ PHANDLE ThreadHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ PCOBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_opt_ PCLIENT_ID ClientId&#10;    );">NtOpenThread</a></code></li>
<li><code><a href="ntsetinformationthread" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationThread(&#10;    _In_ HANDLE ThreadHandle,&#10;    _In_ THREADINFOCLASS ThreadInformationClass,&#10;    _In_reads_bytes_(ThreadInformationLength) PVOID ThreadInformation,&#10;    _In_ ULONG ThreadInformationLength&#10;    );">NtSetInformationThread</a></code></li>
<li><code><a href="ntqueryinformationprocess" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQueryInformationProcess(&#10;    _In_ HANDLE ProcessHandle,&#10;    _In_ PROCESSINFOCLASS ProcessInformationClass,&#10;    _Out_writes_bytes_(ProcessInformationLength) PVOID ProcessInformation,&#10;    _In_ ULONG ProcessInformationLength,&#10;    _Out_opt_ PULONG ReturnLength&#10;    );">NtQueryInformationProcess</a></code></li>
<li><code><a href="ntsetinformationprocess" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationProcess(&#10;    _In_ HANDLE ProcessHandle,&#10;    _In_ PROCESSINFOCLASS ProcessInformationClass,&#10;    _In_reads_bytes_(ProcessInformationLength) PVOID ProcessInformation,&#10;    _In_ ULONG ProcessInformationLength&#10;    );">NtSetInformationProcess</a></code></li>
</ul>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ntqueryinformationthread.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Win32 API reference (nf-winternl-ntqueryinformationthread)</h1>
</div>
<div class="ntdoc-description">
<h1>NtQueryInformationThread function</h1>

<h2>Description</h2>

<p>[<strong>NtQueryInformationThread</strong> may be altered or unavailable in future versions of Windows. Applications should use the alternate functions listed in this topic.]</p>

<p>Retrieves information about the specified thread.</p>

<h2>Parameters</h2>

<h3><code>ThreadHandle</code> [in]</h3>

<p>A handle to the thread about which information is being requested.</p>

<h3><code>ThreadInformationClass</code> [in]</h3>

<p>If this parameter is the <strong>ThreadIsIoPending</strong> value of the <strong><a href="threadinfoclass" title="typedef enum _THREADINFOCLASS&#10;{&#10;    ThreadBasicInformation,                         // q: THREAD_BASIC_INFORMATION&#10;    ThreadTimes,                                    // q: KERNEL_USER_TIMES&#10;    ThreadPriority,                                 // s: KPRIORITY (requires SeIncreaseBasePriorityPrivilege)&#10;    ThreadBasePriority,                             // s: KPRIORITY&#10;    ThreadAffinityMask,                             // s: KAFFINITY&#10;    ThreadImpersonationToken,                       // s: HANDLE&#10;    ThreadDescriptorTableEntry,                     // q: DESCRIPTOR_TABLE_ENTRY (or WOW64_DESCRIPTOR_TABLE_ENTRY)&#10;    ThreadEnableAlignmentFaultFixup,                // s: BOOLEAN&#10;    ThreadEventPair,                                // q: Obsolete&#10;    ThreadQuerySetWin32StartAddress,                // qs: PVOID (requires THREAD_SET_LIMITED_INFORMATION)&#10;    ThreadZeroTlsCell,                              // s: ULONG // TlsIndex // 10&#10;    ThreadPerformanceCount,                         // q: LARGE_INTEGER&#10;    ThreadAmILastThread,                            // q: ULONG&#10;    ThreadIdealProcessor,                           // s: ULONG&#10;    ThreadPriorityBoost,                            // qs: ULONG&#10;    ThreadSetTlsArrayAddress,                       // s: ULONG_PTR&#10;    ThreadIsIoPending,                              // q: ULONG&#10;    ThreadHideFromDebugger,                         // q: BOOLEAN; s: void&#10;...">THREADINFOCLASS</a></strong> enumeration, the function determines whether the thread has any I/O operations pending.</p>

<p>Use the public function <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/processthreadsapi/nf-processthreadsapi-getthreadiopendingflag">GetThreadIOPendingFlag</a> instead to obtain this information.</p>

<p>If this parameter is the <strong>ThreadQuerySetWin32StartAddress</strong> value of the <strong><a href="threadinfoclass" title="typedef enum _THREADINFOCLASS&#10;{&#10;    ThreadBasicInformation,                         // q: THREAD_BASIC_INFORMATION&#10;    ThreadTimes,                                    // q: KERNEL_USER_TIMES&#10;    ThreadPriority,                                 // s: KPRIORITY (requires SeIncreaseBasePriorityPrivilege)&#10;    ThreadBasePriority,                             // s: KPRIORITY&#10;    ThreadAffinityMask,                             // s: KAFFINITY&#10;    ThreadImpersonationToken,                       // s: HANDLE&#10;    ThreadDescriptorTableEntry,                     // q: DESCRIPTOR_TABLE_ENTRY (or WOW64_DESCRIPTOR_TABLE_ENTRY)&#10;    ThreadEnableAlignmentFaultFixup,                // s: BOOLEAN&#10;    ThreadEventPair,                                // q: Obsolete&#10;    ThreadQuerySetWin32StartAddress,                // qs: PVOID (requires THREAD_SET_LIMITED_INFORMATION)&#10;    ThreadZeroTlsCell,                              // s: ULONG // TlsIndex // 10&#10;    ThreadPerformanceCount,                         // q: LARGE_INTEGER&#10;    ThreadAmILastThread,                            // q: ULONG&#10;    ThreadIdealProcessor,                           // s: ULONG&#10;    ThreadPriorityBoost,                            // qs: ULONG&#10;    ThreadSetTlsArrayAddress,                       // s: ULONG_PTR&#10;    ThreadIsIoPending,                              // q: ULONG&#10;    ThreadHideFromDebugger,                         // q: BOOLEAN; s: void&#10;...">THREADINFOCLASS</a></strong> enumeration, the function returns the start address of the thread. Note that on versions of Windows prior to Windows Vista, the returned start address is only reliable before the thread starts running.</p>

<p>If this parameter is the <strong>ThreadSubsystemInformation</strong> value of the <strong><a href="threadinfoclass" title="typedef enum _THREADINFOCLASS&#10;{&#10;    ThreadBasicInformation,                         // q: THREAD_BASIC_INFORMATION&#10;    ThreadTimes,                                    // q: KERNEL_USER_TIMES&#10;    ThreadPriority,                                 // s: KPRIORITY (requires SeIncreaseBasePriorityPrivilege)&#10;    ThreadBasePriority,                             // s: KPRIORITY&#10;    ThreadAffinityMask,                             // s: KAFFINITY&#10;    ThreadImpersonationToken,                       // s: HANDLE&#10;    ThreadDescriptorTableEntry,                     // q: DESCRIPTOR_TABLE_ENTRY (or WOW64_DESCRIPTOR_TABLE_ENTRY)&#10;    ThreadEnableAlignmentFaultFixup,                // s: BOOLEAN&#10;    ThreadEventPair,                                // q: Obsolete&#10;    ThreadQuerySetWin32StartAddress,                // qs: PVOID (requires THREAD_SET_LIMITED_INFORMATION)&#10;    ThreadZeroTlsCell,                              // s: ULONG // TlsIndex // 10&#10;    ThreadPerformanceCount,                         // q: LARGE_INTEGER&#10;    ThreadAmILastThread,                            // q: ULONG&#10;    ThreadIdealProcessor,                           // s: ULONG&#10;    ThreadPriorityBoost,                            // qs: ULONG&#10;    ThreadSetTlsArrayAddress,                       // s: ULONG_PTR&#10;    ThreadIsIoPending,                              // q: ULONG&#10;    ThreadHideFromDebugger,                         // q: BOOLEAN; s: void&#10;...">THREADINFOCLASS</a></strong> enumeration, the function retrieves a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/content/ntddk/ne-ntddk-_subsystem_information_type">SUBSYSTEM_INFORMATION_TYPE</a> value indicating the subsystem type of the thread. The buffer pointed to by the <em>ThreadInformation</em> parameter should be large enough to hold a single <strong><a href="subsystem_information_type" title="typedef enum _SUBSYSTEM_INFORMATION_TYPE&#10;{&#10;    SubsystemInformationTypeWin32,&#10;    SubsystemInformationTypeWSL,&#10;    MaxSubsystemInformationType&#10;} SUBSYSTEM_INFORMATION_TYPE;">SUBSYSTEM_INFORMATION_TYPE</a></strong> enumeration.</p>

<h3><code>ThreadInformation</code> [in, out]</h3>

<p>A pointer to a buffer in which the function writes the requested information. If <strong>ThreadIsIoPending</strong> is specified for the <em>ThreadInformationClass</em> parameter, this buffer must be large enough to hold a <strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></strong> value, which indicates whether the specified thread has I/O requests pending. If this value is equal to zero, then there are no I/O operations pending; otherwise, if the value is nonzero, then the thread does have I/O operations pending.</p>

<p>Use the public function <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/processthreadsapi/nf-processthreadsapi-getthreadiopendingflag">GetThreadIOPendingFlag</a> instead to obtain this information.</p>

<p>If <strong>ThreadQuerySetWin32StartAddress</strong> is specified for the <em>ThreadInformationClass</em> parameter, this buffer must be large enough to hold a PVOID value, which is the start address of the thread.</p>

<h3><code>ThreadInformationLength</code> [in]</h3>

<p>The size of the buffer pointed to by the <em>ThreadInformation</em> parameter, in bytes.</p>

<h3><code>ReturnLength</code> [out, optional]</h3>

<p>A pointer to a variable in which the function returns the size of the requested information. If the function was successful, this is the size of the information written to the buffer pointed to by the <em>ThreadInformation</em> parameter, but if the buffer was too small, this is the minimum size of buffer required to receive the information successfully.</p>

<h2>Return value</h2>

<p>Returns an <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> success or error code.</p>

<p>The forms and significance of <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> error codes are listed in the Ntstatus.h header file available in the DDK, and are described in the DDK documentation under Kernel-Mode Driver Architecture / Design Guide / Driver Programming Techniques / Logging Errors.</p>

<h2>Remarks</h2>

<p>The <strong>NtQueryInformationThread</strong> function is internal to the operating system and subject to change from one release of Windows to another. To maintain the compatibility of your application, it is better to use the public function previously mentioned instead.</p>

<p>If you do use <strong>NtQueryInformationThread</strong>, access the function through <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/Dlls/using-run-time-dynamic-linking">run-time dynamic linking</a>. This gives your code an opportunity to respond gracefully if the function has been changed or removed from the operating system. Signature changes, however, may not be detectable.</p>

<p>This function has no associated import library. You must use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya">LoadLibrary</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress">GetProcAddress</a> functions to dynamically link to Ntdll.dll.</p>

<h2>See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/api/processthreadsapi/nf-processthreadsapi-getthreadiopendingflag">GetThreadIOPendingFlag</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows/win32/api/winternl/nf-winternl-ntqueryinformationthread">View the official Win32 API reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/sdk-api/blob/docs/sdk-api-src/content/winternl/nf-winternl-ntqueryinformationthread.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>NTinternals.net (undocumented.ntinternals.net)</h1>
</div>
<div class="ntdoc-description">
<p>This function is <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntqueryinformationthread">documented in Windows SDK</a>.</p>

<hr />

<h3>ThreadHandle</h3>

<p>Handle to Thread Object opened with <code><a href="thread_query_information" title="#define THREAD_QUERY_INFORMATION 0x0040">THREAD_QUERY_INFORMATION</a></code> access.</p>

<h3>ThreadInformationClass</h3>

<p>Information class defined in <code>THREAD_INFORMATION_CLASS</code> enumerated type.</p>

<h3>ThreadInformation</h3>

<p>Caller's allocated buffer for results.</p>

<h3>ThreadInformationLength</h3>

<p>Length of buffer, in bytes.</p>

<h3>ReturnLength</h3>

<p>Optional pointer to required buffer length.</p>

<hr />

<p>See <code>THREAD_INFORMATION_CLASS</code> for more information.</p>

<h1>Documented by</h1>

<ul>
<li>Tomasz Nowak</li>
</ul>

<h1>See also</h1>

<ul>
<li><code><a href="ntsetinformationthread" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationThread(&#10;    _In_ HANDLE ThreadHandle,&#10;    _In_ THREADINFOCLASS ThreadInformationClass,&#10;    _In_reads_bytes_(ThreadInformationLength) PVOID ThreadInformation,&#10;    _In_ ULONG ThreadInformationLength&#10;    );">NtSetInformationThread</a></code></li>
<li><code>THREAD_INFORMATION_CLASS</code></li>
</ul>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/undocumented.ntinternals.net/ntqueryinformationthread.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
