<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="ClfsMgmtSetLogFileSize - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ClfsMgmtSetLogFileSize - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            ClfsMgmtSetLogFileSize - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">CLFSUSER_API <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> ClfsMgmtSetLogFileSize(
  [in]           PLOG_FILE_OBJECT                     LogFile,
  [in]           PULONGLONG                           NewSizeInContainers,
  [out]          PULONGLONG                           ResultingSizeInContainers,
  [in, optional] PCLFS_SET_LOG_SIZE_COMPLETE_CALLBACK CompletionRoutine,
  [in, optional] PVOID                                CompletionRoutineData
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-clfsmgmtsetlogfilesize">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/clfsmgmtsetlogfilesize.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-wdm-clfsmgmtsetlogfilesize)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="clfsmgmtsetlogfilesize-function">ClfsMgmtSetLogFileSize function</h1>

<h2 id="description">Description</h2>

<p>The <strong>ClfsMgmtSetLogFileSize</strong> routine adds containers to a log or deletes containers from a log.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="logfile-in"><code>LogFile</code> [in]</h3>

<p>A pointer to a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_file_object">LOG_FILE_OBJECT</a> structure that represents the CLFS log, or a stream within the log, to which containers are being added or deleted.</p>

<h3 id="newsizeincontainers-in"><code>NewSizeInContainers</code> [in]</h3>

<p>A pointer to the requested log size. The caller sets this parameter to one of the following values.</p>

<table>
<thead>
<tr>
  <th>Value</th>
  <th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
  <td>0</td>
  <td>Enforce the minimum size policy. For more information about this policy, see <a href="clfsmgmtinstallpolicy" title="CLFSUSER_API NTSTATUS ClfsMgmtInstallPolicy(&#10;  [in] PLOG_FILE_OBJECT  LogFile,&#10;  [in] PCLFS_MGMT_POLICY Policy,&#10;  [in] ULONG             PolicyLength&#10;);">ClfsMgmtInstallPolicy</a>.&lt;br&gt;&lt;br&gt;If a minimum size policy is not installed, one of the following occurs:&lt;br&gt;&lt;br&gt;* If the log currently has less than 2 containers, the log will be expanded to a size of 2 containers.&lt;br&gt;* If the log currently has 2 or more containers, no changes are made and the call succeeds.&lt;br&gt;&lt;br&gt;If a minimum size policy is installed, one of the following occurs:&lt;br&gt;&lt;br&gt;* If the log currently has less than the minimum number of containers specified by the minimum size policy, the log expands to the policy-specified minimum number of containers.&lt;br&gt;* If the number of containers in the log is greater than or equal to the minimum number of containers specified by the minimum size policy, no changes are made and the call succeeds with no error.</td>
</tr>
<tr>
  <td>1</td>
  <td>Invalid value. The call fails and returns STATUS_INVALID_VALUE.</td>
</tr>
<tr>
  <td>2 to 1023</td>
  <td>The desired size of the log, expressed as the number of containers.&lt;br&gt;&lt;br&gt;If this number is smaller than the minimum number of containers specified by the installed policy, the call fails with ERROR_COULD_NOT_RESIZE_LOG.&lt;br&gt;&lt;br&gt;If this number is larger than the maximum number of containers specified by the installed policy, the log expands only as far as the policy-specified maximum number of containers, and the call succeeds with no error.</td>
</tr>
<tr>
  <td>1024 to MAXULONGLONG</td>
  <td>If no maximum size policy is installed, the call fails and returns ERROR_LOG_POLICY_CONFLICT.&lt;br&gt;&lt;br&gt;If a maximum size policy is installed, the log expands to the maximum number of containers specified by the maximum size policy and the call succeeds with no error.</td>
</tr>
</tbody>
</table>

<p>To determine the actual log size, which might be different from the requested size, use the <em>ResultingSizeInContainers</em> parameter.</p>

<h3 id="resultingsizeincontainers-out"><code>ResultingSizeInContainers</code> [out]</h3>

<p>A pointer to the resulting log size. If successful, the routine writes the actual size of the log, expressed as the number of containers in the log, to the location pointed to by this parameter.</p>

<h3 id="completionroutine-in-optional"><code>CompletionRoutine</code> [in, optional]</h3>

<p>Not used. Set to NULL.</p>

<h3 id="completionroutinedata-in-optional"><code>CompletionRoutineData</code> [in, optional]</h3>

<p>Not used. Set to NULL.</p>

<h2 id="return-value">Return value</h2>

<p>The <strong>ClfsMgmtSetLogFileSize</strong> routine returns one of the following <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> values:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong><a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a></strong></td>
  <td>The log file size has been set. The <em>ResultingSizeInContainers</em> parameter contains the current size of the log.</td>
</tr>
<tr>
  <td><strong>STATUS_UNSUCCESSFUL</strong></td>
  <td>CLFS management was not able to set the log file size.</td>
</tr>
<tr>
  <td><strong>STATUS_INVALID_PARAMETER_1</strong></td>
  <td>The value of the <em>LogFile</em> parameter is <strong>NULL</strong>, or the contents of the <em>NewSizeInContainers</em> parameter is 1.</td>
</tr>
<tr>
  <td><strong>STATUS_INVALID_PARAMETER_2</strong></td>
  <td>The value of the <em>NewSizeInContainers</em> parameter is <strong>NULL</strong>.</td>
</tr>
<tr>
  <td><strong>STATUS_LOG_POLICY_INVALID</strong></td>
  <td>There is a conflict between the maximum size and minimum size policies for the log.</td>
</tr>
<tr>
  <td><strong>STATUS_COULD_NOT_RESIZE_LOG</strong></td>
  <td>CLFS management could not delete enough containers to reach <em>NewSizeInContainers</em>.</td>
</tr>
<tr>
  <td><strong>STATUS_LOG_POLICY_CONFLICT</strong></td>
  <td>CLFS management could not add enough containers to the log to reach <em>NewSizeInContainers</em>. This might be due to a conflict with a policy that the client set.</td>
</tr>
</tbody>
</table>

<p>This routine might also return other <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/ntstatus-values">NTSTATUS Values</a>.</p>

<h2 id="remarks">Remarks</h2>

<p>The <strong>ClfsMgmtSetLogFileSize</strong> routine is typically used only when a client starts or stops. Do not call the <strong>ClfsMgmtSetLogFileSize</strong> routine from within your <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-pclfs_client_advance_tail_callback">ClfsAdvanceTailCallback</a> function.</p>

<h2 id="see-also">See also</h2>

<p><a href="clfs_mgmt_policy_type" title="typedef enum _CLFS_MGMT_POLICY_TYPE {&#10;  ClfsMgmtPolicyMaximumSize,&#10;  ClfsMgmtPolicyMinimumSize,&#10;  ClfsMgmtPolicyNewContainerSize,&#10;  ClfsMgmtPolicyGrowthRate,&#10;  ClfsMgmtPolicyLogTail,&#10;  ClfsMgmtPolicyAutoShrink,&#10;  ClfsMgmtPolicyAutoGrow,&#10;  ClfsMgmtPolicyNewContainerPrefix,&#10;  ClfsMgmtPolicyNewContainerSuffix,&#10;  ClfsMgmtPolicyNewContainerExtension,&#10;  ClfsMgmtPolicyInvalid&#10;} CLFS_MGMT_POLICY_TYPE, *PCLFS_MGMT_POLICY_TYPE;">CLFS_MGMT_POLICY_TYPE</a></p>

<p><a href="clfsmgmtinstallpolicy" title="CLFSUSER_API NTSTATUS ClfsMgmtInstallPolicy(&#10;  [in] PLOG_FILE_OBJECT  LogFile,&#10;  [in] PCLFS_MGMT_POLICY Policy,&#10;  [in] ULONG             PolicyLength&#10;);">ClfsMgmtInstallPolicy</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-clfsmgmtsetlogfilesize">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/nf-wdm-clfsmgmtsetlogfilesize.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
