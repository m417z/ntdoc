<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="CSV_CONTROL_OP - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>CSV_CONTROL_OP - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            CSV_CONTROL_OP - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntifs.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef enum _CSV_CONTROL_OP {
  CsvControlStartRedirectFile = 0x02,
  CsvControlStopRedirectFile = 0x03,
  CsvControlQueryRedirectState = 0x04,
  CsvControlQueryFileRevision = 0x06,
  CsvControlQueryMdsPath = 0x08,
  CsvControlQueryFileRevisionFileId128 = 0x09,
  CsvControlQueryVolumeRedirectState = 0x0a,
  CsvControlEnableUSNRangeModificationTracking = 0x0d,
  CsvControlMarkHandleLocalVolumeMount = 0x0e,
  CsvControlUnmarkHandleLocalVolumeMount = 0x0f,
  CsvControlGetCsvFsMdsPathV2 = 0x12,
  CsvControlDisableCaching = 0x13,
  CsvControlEnableCaching = 0x14,
  CsvControlStartForceDFO = 0x15,
  CsvControlStopForceDFO = 0x16,
  CsvControlQueryMdsPathNoPause = 0x17,
  CsvControlSetVolumeId = 0x18,
  CsvControlQueryVolumeId = 0x19
} CSV_CONTROL_OP, *PCSV_CONTROL_OP;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/ne-ntifs-_csv_control_op">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// winioctl.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef enum _CSV_CONTROL_OP {
  CsvControlStartRedirectFile = 0x02,
  CsvControlStopRedirectFile = 0x03,
  CsvControlQueryRedirectState = 0x04,
  CsvControlQueryFileRevision = 0x06,
  CsvControlQueryMdsPath = 0x08,
  CsvControlQueryFileRevisionFileId128 = 0x09,
  CsvControlQueryVolumeRedirectState = 0x0a,
  CsvControlEnableUSNRangeModificationTracking = 0x0d,
  CsvControlMarkHandleLocalVolumeMount = 0x0e,
  CsvControlUnmarkHandleLocalVolumeMount = 0x0f,
  CsvControlGetCsvFsMdsPathV2 = 0x12,
  CsvControlDisableCaching = 0x13,
  CsvControlEnableCaching = 0x14,
  CsvControlStartForceDFO,
  CsvControlStopForceDFO,
  CsvControlQueryMdsPathNoPause,
  CsvControlSetVolumeId,
  CsvControlQueryVolumeId
} CSV_CONTROL_OP, *PCSV_CONTROL_OP;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ne-winioctl-csv_control_op">View the official Win32 API reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/csv_control_op.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ne-ntifs-_csv_control_op)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="csv_control_op-enumeration">CSV_CONTROL_OP enumeration</h1>

<h2 id="description">Description</h2>

<p>Specifies the type of cluster shared volume (CSV) control operation to use with the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ni-winioctl-fsctl_csv_control">FSCTL_CSV_CONTROL</a> control code.</p>

<h2 id="constants">Constants</h2>

<h3 id="csvcontrolstartredirectfile0x02"><code>CsvControlStartRedirectFile:0x02</code></h3>

<p>Starts CSV file redirection.</p>

<h3 id="csvcontrolstopredirectfile0x03"><code>CsvControlStopRedirectFile:0x03</code></h3>

<p>Stops CSV file redirection.</p>

<h3 id="csvcontrolqueryredirectstate0x04"><code>CsvControlQueryRedirectState:0x04</code></h3>

<p>Search for state redirection. When this value is specified, the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_query_redirect_state">CSV_QUERY_REDIRECT_STATE</a> structure must also be used.</p>

<h3 id="csvcontrolqueryfilerevision0x06"><code>CsvControlQueryFileRevision:0x06</code></h3>

<p>Search for file revision. When this value is specified, the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_query_file_revision">CSV_QUERY_FILE_REVISION</a> structure must also be used.</p>

<h3 id="csvcontrolquerymdspath0x08"><code>CsvControlQueryMdsPath:0x08</code></h3>

<p>Search for MDS path. When this value is specified, the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_query_mds_path">CSV_QUERY_MDS_PATH</a> structure must also be used.</p>

<h3 id="csvcontrolqueryfilerevisionfileid1280x09"><code>CsvControlQueryFileRevisionFileId128:0x09</code></h3>

<p>Search for 128-bit file revision. When this value is specified, the CSV_QUERY_FILE_REVISION_FILE_ID_128 structure must also be used.</p>

<h3 id="csvcontrolqueryvolumeredirectstate0x0a"><code>CsvControlQueryVolumeRedirectState:0x0a</code></h3>

<p>Search for volume state redirection. When this value is specified, the CSV_QUERY_VOLUME_REDIRECT_STATE structure must also be used.</p>

<h3 id="csvcontrolenableusnrangemodificationtracking0x0d"><code>CsvControlEnableUSNRangeModificationTracking:0x0d</code></h3>

<p>Enable USN range tracking.</p>

<h3 id="csvcontrolmarkhandlelocalvolumemount0x0e"><code>CsvControlMarkHandleLocalVolumeMount:0x0e</code></h3>

<p>When a VHD file is about to be loopback mounted, marks a handle and requests that CVSFS to fail I/Os and invalidate handles after a short timeout (currently 20 seconds) if no I/Os make progress.</p>

<h3 id="csvcontrolunmarkhandlelocalvolumemount0x0f"><code>CsvControlUnmarkHandleLocalVolumeMount:0x0f</code></h3>

<p>When a VHD file is about to be loopback unmounted, unmarks a handle that had been previously marked by <strong>CsvControlMarkHandleLocalVolumeMount</strong>.</p>

<h3 id="csvcontrolgetcsvfsmdspathv20x12"><code>CsvControlGetCsvFsMdsPathV2:0x12</code></h3>

<p>Search for version 2 of the MDS path. When this value is specified, the CSV_QUERY_MDS_PATH_V2 structure must also be used.</p>

<h3 id="csvcontroldisablecaching0x13"><code>CsvControlDisableCaching:0x13</code></h3>

<p>Disables caching of the CSV file.</p>

<h3 id="csvcontrolenablecaching0x14"><code>CsvControlEnableCaching:0x14</code></h3>

<p>Enables caching of the CSV file.</p>

<h3 id="csvcontrolstartforcedfo0x15"><code>CsvControlStartForceDFO:0x15</code></h3>

<p>Forces CSVFS to start forwarding I/O down-level on a down-level file object (DFO). See Remarks for details.</p>

<h3 id="csvcontrolstopforcedfo0x16"><code>CsvControlStopForceDFO:0x16</code></h3>

<p>Stop forcing CSVFS's forwarding of I/O on a DFO. See Remarks for details.</p>

<h3 id="csvcontrolquerymdspathnopause0x17"><code>CsvControlQueryMdsPathNoPause:0x17</code></h3>

<p>Similar to CsvControlQueryMdsPath. Search for MDS path, but if the CSV volume is paused at the moment of the request, set <strong>MdsNodeId</strong> to 0xFFFFFFFF instead of returning the last coordinating node. This allows the client to detect that the coordinating node might be changing. When CsvControlQueryMdsPathNoPause is specified, the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_query_mds_path">CSV_QUERY_MDS_PATH</a> structure must also be used.</p>

<h3 id="csvcontrolsetvolumeid0x18"><code>CsvControlSetVolumeId:0x18</code></h3>

<p>Set the CSV Volume GUID. See Remarks for details.</p>

<h3 id="csvcontrolqueryvolumeid0x19"><code>CsvControlQueryVolumeId:0x19</code></h3>

<p>Query whether the CSV Volume GUID is available. See Remarks for details.</p>

<h2 id="remarks">Remarks</h2>

<p>An alternative to calling the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ni-winioctl-fsctl_csv_control">FSCTL_CSV_CONTROL</a> control code with this enumeration is to use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_control_param">CSV_CONTROL_PARAM</a> structure, which encapsulates a member of this enumeration type.</p>

<h3 id="csvcontrolstartforcedfo-and-csvcontrolstopforcedfo">CsvControlStartForceDFO and CsvControlStopForceDFO</h3>

<p>When a file object is opened on CSVFS, CSVFS opens on the down-level file system (NTFS or REFS) a down-level file object (DFO) matching every user open. That file object is opened as a part of an application opening a file on CSVFS and is closed when the application closes the handle for the file object on CSVFS. Internally CSVFS opens an additional file object called paging file object (PFO) that is shared among all opens of the same file on CSVFS. By default, CSVFS uses it for many operations, such as the following:</p>

<ul>
<li>Oplock negotiation</li>
<li>Byte range locks</li>
<li>Forwarding of paging I/O</li>
</ul>

<p>Some filtering solutions might mark the handle in a special way, and then expect that all reads and writes should be forwarded down-level by CSVFS on the matching DFO. An application can force CSVFS to start forwarding IO down-level on DFO by sending <strong>CsvControlStartForceDFO</strong>. Later on, the application can use <strong>CsvControlStopForceDFO</strong> to revert to the default behavior. Closing the handle that was used to send <strong>CsvControlStartForceDFO</strong> will implicitly revert back as if application sent <strong>CsvControlStopForceDFO</strong>.</p>

<h3 id="csvcontrolsetvolumeid-and-csvcontrolqueryvolumeid">CsvControlSetVolumeId and CsvControlQueryVolumeId</h3>

<p>These controls allow file system minifilters attached to the down-level file system below CSVFS to learn the CSV Volume GUID. The Cluster Physical Disk Resource sets this GUID after the down-level file system is mounted so it is not available if the filter attaches during mount. During filter attach, the file system minifilter can issue CsvControlQueryVolumeId to query whether the GUID is already available. Control has to be sent to the top of stack to make sure <em>csvflt</em> receives it. If the volume GUID is not available yet, then <em>csvflt</em> will return STATUS_UNSUCCESSFUL. The filter should not fail to attach if the volume GUID is not yet available.</p>

<p>At a later point, the Physical Disk Resource will send CsvControlSetVolumeId with the volume GUID. Every filter on the stack can use the CsvControlSetVolumeId control to store the volume GUID. Filters must not complete this control. Instead they should allow it to go down the stack, allowing other filters the opportunity to store the GUID.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/fileio/file-management-enumerations">File Management Enumerations</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_control_param">CSV_CONTROL_PARAM</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_query_file_revision">CSV_QUERY_FILE_REVISION</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_query_mds_path">CSV_QUERY_MDS_PATH</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_query_redirect_state">CSV_QUERY_REDIRECT_STATE</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ni-winioctl-fsctl_csv_control">FSCTL_CSV_CONTROL</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/ne-ntifs-_csv_control_op">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntifs/ne-ntifs-_csv_control_op.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Win32 API reference (ne-winioctl-csv_control_op)</h1>
</div>
<div class="ntdoc-description">
<h1>CSV_CONTROL_OP enumeration</h1>

<h2>Description</h2>

<p>Specifies the type of CSV control operation to use with the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ni-winioctl-fsctl_csv_control">FSCTL_CSV_CONTROL</a> control code.</p>

<h2>Constants</h2>

<h3><code>CsvControlStartRedirectFile:0x02</code></h3>

<p>Start file redirection.</p>

<h3><code>CsvControlStopRedirectFile:0x03</code></h3>

<p>Stop file redirection.</p>

<h3><code>CsvControlQueryRedirectState:0x04</code></h3>

<p>Search for state redirection. When this value is specified, the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_query_redirect_state">CSV_QUERY_REDIRECT_STATE</a> structure must also be used.</p>

<h3><code>CsvControlQueryFileRevision:0x06</code></h3>

<p>Search for file revision. When this value is specified, the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_query_file_revision">CSV_QUERY_FILE_REVISION</a> structure must also be used.</p>

<h3><code>CsvControlQueryMdsPath:0x08</code></h3>

<h3><code>CsvControlQueryFileRevisionFileId128:0x09</code></h3>

<h3><code>CsvControlQueryVolumeRedirectState:0x0a</code></h3>

<h3><code>CsvControlEnableUSNRangeModificationTracking:0x0d</code></h3>

<h3><code>CsvControlMarkHandleLocalVolumeMount:0x0e</code></h3>

<h3><code>CsvControlUnmarkHandleLocalVolumeMount:0x0f</code></h3>

<h3><code>CsvControlGetCsvFsMdsPathV2:0x12</code></h3>

<h3><code>CsvControlDisableCaching:0x13</code></h3>

<h3><code>CsvControlEnableCaching:0x14</code></h3>

<h4>- CsvControlMdsPath</h4>

<p>Search for MDS path. When this value is specified, the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_query_mds_path">CSV_QUERY_MDS_PATH</a> structure must also be used.</p>

<h2>Remarks</h2>

<p>An alternative to calling the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ni-winioctl-fsctl_csv_control">FSCTL_CSV_CONTROL</a> control code with this enumeration is to use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_control_param">CSV_CONTROL_PARAM</a> structure, which encapsulates a member of this enumeration type.</p>

<h2>See also</h2>

<ul>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_control_param">CSV_CONTROL_PARAM</a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_query_file_revision">CSV_QUERY_FILE_REVISION</a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_query_mds_path">CSV_QUERY_MDS_PATH</a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-csv_query_redirect_state">CSV_QUERY_REDIRECT_STATE</a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ni-winioctl-fsctl_csv_control">FSCTL_CSV_CONTROL</a></li>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/FileIO/file-management-enumerations">File Management Enumerations</a></li>
</ul>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ne-winioctl-csv_control_op">View the official Win32 API reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/sdk-api/blob/docs/sdk-api-src/content/winioctl/ne-winioctl-csv_control_op.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
