<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="D3DKMT_CREATEALLOCATIONFLAGS - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>D3DKMT_CREATEALLOCATIONFLAGS - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            D3DKMT_CREATEALLOCATIONFLAGS - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dkmthk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _D3DKMT_CREATEALLOCATIONFLAGS {
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> CreateResource : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> CreateShared : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> NonSecure : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> CreateProtected : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> RestrictSharedAccess : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> ExistingSysMem : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> NtSecuritySharing : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> ReadOnly : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> CreateWriteCombined : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> CreateCached : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> SwapChainBackBuffer : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> CrossAdapter : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> OpenCrossAdapter : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> PartialSharedCreation : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> Zeroed : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> WriteWatch : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> StandardAllocation : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> ExistingSection : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> AllowNotZeroed : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> PhysicallyContiguous : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> NoKmdAccess : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> SharedDisplayable : 1;
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> NoImplicitSynchronization : 1;
#if ...
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> Reserved : 9;
#elif
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> Reserved : 10;
#elif
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> Reserved : 11;
#elif
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> Reserved : 13;
#elif
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> Reserved : 14;
#elif
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> Reserved : 16;
#elif
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> Reserved : 21;
#else
  <a href="uint" title="typedef unsigned int UINT;">UINT</a> Reserved : 26;
#endif
} D3DKMT_CREATEALLOCATIONFLAGS;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmthk/ns-d3dkmthk-_d3dkmt_createallocationflags">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/d3dkmt_createallocationflags.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-d3dkmthk-_d3dkmt_createallocationflags)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2>Description</h2>
<p><strong>D3DKMT_CREATEALLOCATIONFLAGS</strong> is a structure of bit fields that specify how to create an allocation in a call to the <strong><a href="d3dkmtcreateallocation" title="NTSTATUS D3DKMTCreateAllocation(&#10;  D3DKMT_CREATEALLOCATION *unnamedParam1&#10;);">D3DKMTCreateAllocation</a></strong> function.</p>
<h2>Members</h2>
<h3><code>CreateResource</code></h3>
<p>Specifies whether to create a device-specific resource. If you set <strong>CreateShared</strong>, you must also set <strong>CreateResource</strong>.</p>
<h3><code>CreateShared</code></h3>
<p>Specifies whether to create a resource shared across all devices. If you set <strong>CreateShared</strong>, you must also set <strong>CreateResource</strong>. For more information on using <strong>CreateShared</strong>, see the Remarks section.</p>
<h3><code>NonSecure</code></h3>
<p>Specifies whether to create an allocation that can be opened by any process. If <strong>NonSecure</strong> is set, secure and non-secure processes can open the allocation.</p>
<h3><code>CreateProtected</code></h3>
<p>This member is reserved and should be set to zero. Supported starting with Windows 7.</p>
<h3><code>RestrictSharedAccess</code></h3>
<p>Specifies whether to create a resource shared across all devices but with some restrictions. Supported starting with Windows 7.</p>
<h3><code>ExistingSysMem</code></h3>
<p>This member is reserved and should be set to zero. Supported starting with Windows 7. <strong>ExistingSysMem</strong>'s limitations follow:</p>
<ul>
<li>

</li>
<li>

</li>
<li><p>When the kernel creates a D3DKMDT_STANDARDALLOCATION_GDISURFACE type of standard allocation:</p>
<ul>
<li>

</li>
</ul></li>
</ul>
<pre><code>    <a href="d3dkmdt_gdisurfacedata" title="typedef struct _D3DKMDT_GDISURFACEDATA {&#10;  [in]  UINT                    Width;&#10;  [in]  UINT                    Height;&#10;  [in]  D3DDDIFORMAT            Format;&#10;  [in]  D3DKMDT_GDISURFACETYPE  Type;&#10;  [in]  D3DKMDT_GDISURFACEFLAGS Flags;&#10;  [out] UINT                    Pitch;&#10;} D3DKMDT_GDISURFACEDATA;">D3DKMDT_GDISURFACEDATA</a>::Width = Size of ExistingSysMem buffer
<a href="d3dkmdt_gdisurfacedata" title="typedef struct _D3DKMDT_GDISURFACEDATA {&#10;  [in]  UINT                    Width;&#10;  [in]  UINT                    Height;&#10;  [in]  D3DDDIFORMAT            Format;&#10;  [in]  D3DKMDT_GDISURFACETYPE  Type;&#10;  [in]  D3DKMDT_GDISURFACEFLAGS Flags;&#10;  [out] UINT                    Pitch;&#10;} D3DKMDT_GDISURFACEDATA;">D3DKMDT_GDISURFACEDATA</a>::Height = 1
<a href="d3dkmdt_gdisurfacedata" title="typedef struct _D3DKMDT_GDISURFACEDATA {&#10;  [in]  UINT                    Width;&#10;  [in]  UINT                    Height;&#10;  [in]  D3DDDIFORMAT            Format;&#10;  [in]  D3DKMDT_GDISURFACETYPE  Type;&#10;  [in]  D3DKMDT_GDISURFACEFLAGS Flags;&#10;  [out] UINT                    Pitch;&#10;} D3DKMDT_GDISURFACEDATA;">D3DKMDT_GDISURFACEDATA</a>::Format = D3DDDIFMT_UNKNOWN
<a href="d3dkmdt_gdisurfacedata" title="typedef struct _D3DKMDT_GDISURFACEDATA {&#10;  [in]  UINT                    Width;&#10;  [in]  UINT                    Height;&#10;  [in]  D3DDDIFORMAT            Format;&#10;  [in]  D3DKMDT_GDISURFACETYPE  Type;&#10;  [in]  D3DKMDT_GDISURFACEFLAGS Flags;&#10;  [out] UINT                    Pitch;&#10;} D3DKMDT_GDISURFACEDATA;">D3DKMDT_GDISURFACEDATA</a>::Type = D3DKMDT_GDISURFACE_TEXTURE_CROSSADAPTER
</code></pre>
<ul>
<li><p>Protect against ExistingSysMem pointer pointing to a DXGALLOCATION which is MemRotated</p>
<p>The kernel must protect against the scenario where user mode locks an existing DXGALLOCATION and uses the resulting CPU pointer to create an ExistingSysMem standard allocation. This case is invalid if the DXGALLOCATION VAD is <a href="mem_rotate" title="#define MEM_ROTATE 0x00800000">MEM_ROTATE</a>, i.e. if the allocation could be in VRAM. The kernel takes the following steps in the create standard allocation with ExistingSysMem call:</p>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
</ul></li>
</ul>
<h3><code>NtSecuritySharing</code></h3>
<p>Specifies whether the allocation is shared with an NT handle, meaning that it doesn't have a global <strong>D3DKMT_HANDLE</strong> kernel-mode handle to the resource.</p>
<p>If <strong>NtSecuritySharing</strong> is set to 1 (TRUE):</p>
<ul>
<li>

</li>
<li>

</li>
</ul>
<p>For more information on using <strong>NtSecuritySharing</strong>, see the Remarks section. Supported starting with Windows 8.</p>
<h3><code>ReadOnly</code></h3>
<p>Specifies whether the allocation can only be read from. Supported starting with Windows 8.</p>
<h3><code>CreateWriteCombined</code></h3>
<p>This member is reserved and should be set to zero. Supported starting with Windows 8.</p>
<h3><code>CreateCached</code></h3>
<p>This member is reserved and should be set to zero. Supported starting with Windows 8.</p>
<h3><code>SwapChainBackBuffer</code></h3>
<p>This member is reserved and should be set to zero. Supported starting with Windows 8.</p>
<h3><code>CrossAdapter</code></h3>
<p>If set, indicates that the resource is a shared <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/display/using-cross-adapter-resources-in-a-hybrid-system#definition-and-properties-of-a-cross--adapter-resource">cross-adapter resource</a>.</p>
<h3><code>OpenCrossAdapter</code></h3>
<p>If set, indicates that the resource is created by opening a cross adapter resource. Can't be used when allocation is created from the user mode. Supported starting with Windows 8.1 (WDDM 1.3).</p>
<h3><code>PartialSharedCreation</code></h3>
<p>Specifies whether the allocation is created as a partial shared allocation. Supported starting with Windows 8.1 (WDDM 1.3).</p>
<h3><code>Zeroed</code></h3>
<p>[out] Set when the allocation was fulfilled with zeroed pages. Supported starting with Windows 8 (WDDM 1.3).</p>
<h3><code>WriteWatch</code></h3>
<p>[in] Indicates whether to create the allocation with write-watch enabled. Supported starting with Windows 8.1 (WDDM 1.3).</p>
<h3><code>StandardAllocation</code></h3>
<p>[in] When set, instructs <em>Dxgkrnl</em> to create a standard allocation using <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmthk/ns-d3dkmthk-_d3dkmt_createallocation"><strong>pStandardAllocation</strong></a> instead of <strong>pPrivateDriverData</strong>. Either <strong>ExistingSysMem</strong> or <strong>ExistingSection</strong> (but not both) must also be set if <strong>StandardAllocation</strong> is set. Additionally, when creating a <strong>StandardAllocation</strong>, the <strong>CreateShared</strong> and <strong>CrossAdapter</strong> flags must also be set. Supported starting with Windows 10 version 1709 (WDDM 2.3).</p>
<h3><code>ExistingSection</code></h3>
<p>[in] When set, instructs <em>Dxgkrnl</em> to use the section handle (<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dukmdt/ns-d3dukmdt-_d3dddi_allocationinfo2"><strong>hSection</strong></a>) instead of the system memory pointer (<strong>pSystemMem</strong>). <strong>ExistingSystemMem</strong> and <strong>ExistingSection</strong> can't both be set for the same allocation. If <strong>ExistingSection</strong> is set, <strong>StandardAllocation</strong> must also be set. Supported starting with Windows 10 version 1709 (WDDM 2.3).</p>
<h3><code>AllowNotZeroed</code></h3>
<p>[in] Indicates that the allocation can be created without zeroing the pages. Supported starting with Windows 10, version 1903 (WDDM 2.6).</p>
<h3><code>PhysicallyContiguous</code></h3>
<p>[in] Indicates that the allocation must be physically contiguous. Supported starting with Windows 10, version 2004 (WDDM 2.7).</p>
<h3><code>NoKmdAccess</code></h3>
<p>[in] Indicates that the KMD isn't notified about the allocation. Supported starting with Windows 10, version 2004 (WDDM 2.7).</p>
<h3><code>SharedDisplayable</code></h3>
<p>Indicates that the allocation is a shared, displayable resource. Supported starting with Windows 11 (WDDM 3.0).</p>
<h3><code>Reserved</code></h3>
<p>Supported starting with Windows 8.</p>
<p>This member is reserved and should be set to zero.</p>
<h2>Remarks</h2>
<p>Objects to be shared by using the <strong><a href="d3dkmtshareobjects" title="NTSTATUS D3DKMTShareObjects(&#10;  [in]  UINT                cObjects,&#10;  [in]  const D3DKMT_HANDLE *hObjects,&#10;  [in]  POBJECT_ATTRIBUTES  pObjectAttributes,&#10;  [in]  DWORD               dwDesiredAccess,&#10;  [out] HANDLE              *phSharedNtHandle&#10;);">D3DKMTShareObjects</a></strong> function must first be created with the <strong>NtSecuritySharing</strong> flag value set. This flag value is available in the <strong>D3DKMT_CREATEALLOCATIONFLAGS</strong>, <strong><a href="d3dkmt_createkeyedmutex2_flags" title="typedef struct _D3DKMT_CREATEKEYEDMUTEX2_FLAGS {&#10;  union {&#10;    struct {&#10;      UINT NtSecuritySharing : 1;&#10;      UINT Reserved : 31;&#10;    };&#10;    [in] UINT Value;&#10;  };&#10;} D3DKMT_CREATEKEYEDMUTEX2_FLAGS;">D3DKMT_CREATEKEYEDMUTEX2_FLAGS</a></strong>, and <strong><a href="d3dddi_synchronizationobject_flags" title="typedef struct _D3DDDI_SYNCHRONIZATIONOBJECT_FLAGS {&#10;  union {&#10;    struct {&#10;      UINT Shared : 1;&#10;      UINT NtSecuritySharing : 1;&#10;      UINT CrossAdapter : 1;&#10;      UINT TopOfPipeline : 1;&#10;      UINT NoSignal : 1;&#10;      UINT NoWait : 1;&#10;      UINT NoSignalMaxValueOnTdr : 1;&#10;      UINT NoGPUAccess : 1;&#10;      UINT SignalByKmd : 1;&#10;      UINT Unused : 1;&#10;      UINT UnwaitCpuWaitersOnlyOnDestroy : 1;&#10;#if ...&#10;      UINT Reserved : 20;&#10;#elif&#10;      UINT Reserved : 21;&#10;#elif&#10;      UINT Reserved : 22;&#10;...">D3DDDI_SYNCHRONIZATIONOBJECT_FLAGS</a></strong> structures.</p>
<p>Drivers should follow these guidelines on <strong>D3DKMT_CREATEALLOCATIONFLAGS</strong> sharing flags:</p>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h2>See also</h2>
<p><strong><a href="d3dkmtcreateallocation" title="NTSTATUS D3DKMTCreateAllocation(&#10;  D3DKMT_CREATEALLOCATION *unnamedParam1&#10;);">D3DKMTCreateAllocation</a></strong></p>
<p><strong><a href="d3dkmt_createallocation" title="typedef struct _D3DKMT_CREATEALLOCATION {&#10;  [in]     D3DKMT_HANDLE                hDevice;&#10;  [in/out] D3DKMT_HANDLE                hResource;&#10;  [out]    D3DKMT_HANDLE                hGlobalShare;&#10;  [in]     const VOID                   *pPrivateRuntimeData;&#10;  [in]     UINT                         PrivateRuntimeDataSize;&#10;  union {&#10;    [in]     D3DKMT_CREATESTANDARDALLOCATION *pStandardAllocation;&#10;    [in]     const VOID                      *pPrivateDriverData;&#10;  };&#10;  [in/out] UINT                         PrivateDriverDataSize;&#10;  [in]     UINT                         NumAllocations;&#10;  union {&#10;    [in]     D3DDDI_ALLOCATIONINFO  *pAllocationInfo;&#10;    [in]     D3DDDI_ALLOCATIONINFO2 *pAllocationInfo2;&#10;  };&#10;  [in]     D3DKMT_CREATEALLOCATIONFLAGS Flags;&#10;  [in]     HANDLE                       hPrivateRuntimeResourceHandle;&#10;} D3DKMT_CREATEALLOCATION;">D3DKMT_CREATEALLOCATION</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmthk/ns-d3dkmthk-_d3dkmt_createallocationflags">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dkmthk/ns-d3dkmthk-_d3dkmt_createallocationflags.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
