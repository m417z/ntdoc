<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FLT_CONTEXT_REGISTRATION - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FLT_CONTEXT_REGISTRATION - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FLT_CONTEXT_REGISTRATION - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// fltkernel.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _FLT_CONTEXT_REGISTRATION {
  FLT_CONTEXT_TYPE               ContextType;
  FLT_CONTEXT_REGISTRATION_FLAGS Flags;
  <a href="pflt_context_cleanup_callback" title="PFLT_CONTEXT_CLEANUP_CALLBACK PfltContextCleanupCallback;&#10;&#10;VOID PfltContextCleanupCallback(&#10;  [in] PFLT_CONTEXT Context,&#10;  [in] FLT_CONTEXT_TYPE ContextType&#10;)&#10;{...}">PFLT_CONTEXT_CLEANUP_CALLBACK</a>  ContextCleanupCallback;
  <a href="size_t-2" title="typedef ULONG_PTR SIZE_T;">SIZE_T</a>                         Size;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                          PoolTag;
  <a href="pflt_context_allocate_callback" title="PFLT_CONTEXT_ALLOCATE_CALLBACK PfltContextAllocateCallback;&#10;&#10;PVOID PfltContextAllocateCallback(&#10;  [in] POOL_TYPE PoolType,&#10;  [in] SIZE_T Size,&#10;  [in] FLT_CONTEXT_TYPE ContextType&#10;)&#10;{...}">PFLT_CONTEXT_ALLOCATE_CALLBACK</a> ContextAllocateCallback;
  <a href="pflt_context_free_callback" title="PFLT_CONTEXT_FREE_CALLBACK PfltContextFreeCallback;&#10;&#10;VOID PfltContextFreeCallback(&#10;  [in] PVOID Pool,&#10;  [in] FLT_CONTEXT_TYPE ContextType&#10;)&#10;{...}">PFLT_CONTEXT_FREE_CALLBACK</a>     ContextFreeCallback;
  PVOID                          Reserved1;
} FLT_CONTEXT_REGISTRATION, *PFLT_CONTEXT_REGISTRATION;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fltkernel/ns-fltkernel-_flt_context_registration">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/flt_context_registration.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-fltkernel-_flt_context_registration)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>_FLT_CONTEXT_REGISTRATION structure</h1>
<h2>Description</h2>
<p>The FLT_CONTEXT_REGISTRATION structure is used to register context types.</p>
<h2>Members</h2>
<h3><code>ContextType</code></h3>
<p>The type of context. This member is required and must be one of the following values:</p>
<p>FLT_FILE_CONTEXT (Windows Vista and later only.)</p>
<p>FLT_INSTANCE_CONTEXT</p>
<p>FLT_STREAM_CONTEXT</p>
<p>FLT_STREAMHANDLE_CONTEXT</p>
<p>FLT_SECTION_CONTEXT (Windows 8 and later only.)</p>
<p>FLT_TRANSACTION_CONTEXT (Windows Vista and later only.)</p>
<p>FLT_VOLUME_CONTEXT</p>
<h3><code>Flags</code></h3>
<p>A bitmask of flags that specify how the filter manager allocates a new context from a lookaside list of fixed-size contexts. This member can be zero or the following value.</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>FLTFL_CONTEXT_REGISTRATION_NO_EXACT_SIZE_MATCH</td>
<td>If the minifilter uses fixed-size contexts and this flag is specified, the filter manager allocates a context from the lookaside list if the size of the context in the lookaside list is greater than or equal to the requested size. Otherwise, the filter manager allocates a context from the lookaside list only if the size of the context in the lookaside list is equal to the requested size.</td>
</tr>
</tbody>
</table>
<h3><code>ContextCleanupCallback</code></h3>
<p>A pointer to a minifilter-defined <strong>ContextCleanupCallback</strong> routine of type <a href="pflt_context_cleanup_callback" title="PFLT_CONTEXT_CLEANUP_CALLBACK PfltContextCleanupCallback;&#10;&#10;VOID PfltContextCleanupCallback(&#10;  [in] PFLT_CONTEXT Context,&#10;  [in] FLT_CONTEXT_TYPE ContextType&#10;)&#10;{...}">PFLT_CONTEXT_CLEANUP_CALLBACK</a>. The filter manager calls this routine immediately before it deletes the context. If the minifilter has no memory or pointers to clean up inside the context, this member is optional and can be <strong>NULL</strong>.</p>
<h3><code>Size</code></h3>
<p>The size, in bytes, of the minifilter-defined portion of the context, if the minifilter uses fixed-size contexts. Zero is a valid size value. If the minifilter uses variable-size contexts, this member is required and must be set to FLT_VARIABLE_SIZED_CONTEXTS.</p>
<h3><code>PoolTag</code></h3>
<p>A pool tag value to be used for the context. This tag, which is specified as a string of one to four 7-bit ASCII characters, appears in any crash dump of the system that occurs. If the <strong>ContextAllocateCallback</strong> member is <strong>NULL</strong>, this member is required and cannot be zero.</p>
<h3><code>ContextAllocateCallback</code></h3>
<p>Pointer to a minifilter-defined <strong>ContextAllocateCallback</strong> routine of type <a href="pflt_context_allocate_callback" title="PFLT_CONTEXT_ALLOCATE_CALLBACK PfltContextAllocateCallback;&#10;&#10;PVOID PfltContextAllocateCallback(&#10;  [in] POOL_TYPE PoolType,&#10;  [in] SIZE_T Size,&#10;  [in] FLT_CONTEXT_TYPE ContextType&#10;)&#10;{...}">PFLT_CONTEXT_ALLOCATE_CALLBACK</a>. This member is optional and can be <strong>NULL</strong>. If it is not <strong>NULL</strong>, the <strong>Size</strong> and <strong>PoolTag</strong> members are ignored.</p>
<h3><code>ContextFreeCallback</code></h3>
<p>A pointer to a minifilter-defined <strong>ContextFreeCallback</strong> routine of type <a href="pflt_context_free_callback" title="PFLT_CONTEXT_FREE_CALLBACK PfltContextFreeCallback;&#10;&#10;VOID PfltContextFreeCallback(&#10;  [in] PVOID Pool,&#10;  [in] FLT_CONTEXT_TYPE ContextType&#10;)&#10;{...}">PFLT_CONTEXT_FREE_CALLBACK</a>. This member is optional and can be <strong>NULL</strong>. If it is not <strong>NULL</strong>, the <strong>Size</strong> and <strong>PoolTag</strong> members are ignored.</p>
<h3><code>Reserved1</code></h3>
<p>Reserved for system use. Minifilters must set this member to <strong>NULL</strong>.</p>
<h2>Remarks</h2>
<p>When a minifilter calls <a href="fltregisterfilter" title="NTSTATUS FLTAPI FltRegisterFilter(&#10;  [in]  PDRIVER_OBJECT         Driver,&#10;  [in]  const FLT_REGISTRATION *Registration,&#10;  [out] PFLT_FILTER            *RetFilter&#10;);">FltRegisterFilter</a> from its <strong><a href="driverentry" title="NTSTATUS DriverEntry(&#10;  [in] PDRIVER_OBJECT  DriverObject,&#10;  [in] PUNICODE_STRING RegistryPath&#10;);">DriverEntry</a></strong> routine, it must register each context type that it uses.</p>
<p>To register these context types, the minifilter creates a variable-length array of FLT_CONTEXT_REGISTRATION structures and stores a pointer to the array in the <strong>ContextRegistration</strong> member of the <a href="flt_registration" title="typedef struct _FLT_REGISTRATION {&#10;  USHORT                                      Size;&#10;  USHORT                                      Version;&#10;  FLT_REGISTRATION_FLAGS                      Flags;&#10;  const FLT_CONTEXT_REGISTRATION              *ContextRegistration;&#10;  const FLT_OPERATION_REGISTRATION            *OperationRegistration;&#10;  PFLT_FILTER_UNLOAD_CALLBACK                 FilterUnloadCallback;&#10;  PFLT_INSTANCE_SETUP_CALLBACK                InstanceSetupCallback;&#10;  PFLT_INSTANCE_QUERY_TEARDOWN_CALLBACK       InstanceQueryTeardownCallback;&#10;  PFLT_INSTANCE_TEARDOWN_CALLBACK             InstanceTeardownStartCallback;&#10;  PFLT_INSTANCE_TEARDOWN_CALLBACK             InstanceTeardownCompleteCallback;&#10;  PFLT_GENERATE_FILE_NAME                     GenerateFileNameCallback;&#10;  PFLT_NORMALIZE_NAME_COMPONENT               NormalizeNameComponentCallback;&#10;  PFLT_NORMALIZE_CONTEXT_CLEANUP              NormalizeContextCleanupCallback;&#10;  PFLT_TRANSACTION_NOTIFICATION_CALLBACK      TransactionNotificationCallback;&#10;  PFLT_NORMALIZE_NAME_COMPONENT_EX            NormalizeNameComponentExCallback;&#10;  PFLT_SECTION_CONFLICT_NOTIFICATION_CALLBACK SectionNotificationCallback;&#10;} FLT_REGISTRATION, *PFLT_REGISTRATION;">FLT_REGISTRATION</a> structure that the minifilter passes as the <em>Registration</em> parameter of <a href="fltregisterfilter" title="NTSTATUS FLTAPI FltRegisterFilter(&#10;  [in]  PDRIVER_OBJECT         Driver,&#10;  [in]  const FLT_REGISTRATION *Registration,&#10;  [out] PFLT_FILTER            *RetFilter&#10;);">FltRegisterFilter</a>. The last element of this array must be {FLT_CONTEXT_END}.</p>
<p>For each context type that the minifilter uses, the minifilter must supply at least one FLT_CONTEXT_REGISTRATION structure, according to the following rules:</p>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h2>See also</h2>
<p><a href="flt_registration" title="typedef struct _FLT_REGISTRATION {&#10;  USHORT                                      Size;&#10;  USHORT                                      Version;&#10;  FLT_REGISTRATION_FLAGS                      Flags;&#10;  const FLT_CONTEXT_REGISTRATION              *ContextRegistration;&#10;  const FLT_OPERATION_REGISTRATION            *OperationRegistration;&#10;  PFLT_FILTER_UNLOAD_CALLBACK                 FilterUnloadCallback;&#10;  PFLT_INSTANCE_SETUP_CALLBACK                InstanceSetupCallback;&#10;  PFLT_INSTANCE_QUERY_TEARDOWN_CALLBACK       InstanceQueryTeardownCallback;&#10;  PFLT_INSTANCE_TEARDOWN_CALLBACK             InstanceTeardownStartCallback;&#10;  PFLT_INSTANCE_TEARDOWN_CALLBACK             InstanceTeardownCompleteCallback;&#10;  PFLT_GENERATE_FILE_NAME                     GenerateFileNameCallback;&#10;  PFLT_NORMALIZE_NAME_COMPONENT               NormalizeNameComponentCallback;&#10;  PFLT_NORMALIZE_CONTEXT_CLEANUP              NormalizeContextCleanupCallback;&#10;  PFLT_TRANSACTION_NOTIFICATION_CALLBACK      TransactionNotificationCallback;&#10;  PFLT_NORMALIZE_NAME_COMPONENT_EX            NormalizeNameComponentExCallback;&#10;  PFLT_SECTION_CONFLICT_NOTIFICATION_CALLBACK SectionNotificationCallback;&#10;} FLT_REGISTRATION, *PFLT_REGISTRATION;">FLT_REGISTRATION</a></p>
<p><a href="fltregisterfilter" title="NTSTATUS FLTAPI FltRegisterFilter(&#10;  [in]  PDRIVER_OBJECT         Driver,&#10;  [in]  const FLT_REGISTRATION *Registration,&#10;  [out] PFLT_FILTER            *RetFilter&#10;);">FltRegisterFilter</a></p>
<p><a href="pflt_context_allocate_callback" title="PFLT_CONTEXT_ALLOCATE_CALLBACK PfltContextAllocateCallback;&#10;&#10;PVOID PfltContextAllocateCallback(&#10;  [in] POOL_TYPE PoolType,&#10;  [in] SIZE_T Size,&#10;  [in] FLT_CONTEXT_TYPE ContextType&#10;)&#10;{...}">PFLT_CONTEXT_ALLOCATE_CALLBACK</a></p>
<p><a href="pflt_context_cleanup_callback" title="PFLT_CONTEXT_CLEANUP_CALLBACK PfltContextCleanupCallback;&#10;&#10;VOID PfltContextCleanupCallback(&#10;  [in] PFLT_CONTEXT Context,&#10;  [in] FLT_CONTEXT_TYPE ContextType&#10;)&#10;{...}">PFLT_CONTEXT_CLEANUP_CALLBACK</a></p>
<p><a href="pflt_context_free_callback" title="PFLT_CONTEXT_FREE_CALLBACK PfltContextFreeCallback;&#10;&#10;VOID PfltContextFreeCallback(&#10;  [in] PVOID Pool,&#10;  [in] FLT_CONTEXT_TYPE ContextType&#10;)&#10;{...}">PFLT_CONTEXT_FREE_CALLBACK</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fltkernel/ns-fltkernel-_flt_context_registration">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/fltkernel/ns-fltkernel-_flt_context_registration.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
