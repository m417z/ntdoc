<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="DXGK_DIAGNOSTIC_PSR - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>DXGK_DIAGNOSTIC_PSR - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            DXGK_DIAGNOSTIC_PSR - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// dispmprt.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _DXGK_DIAGNOSTIC_PSR {
  <a href="dxgk_diagnostic_header" title="typedef struct _DXGK_DIAGNOSTIC_HEADER {&#10;  DXGK_DIAGNOSTIC_CATEGORIES Category;&#10;  DXGK_DIAGNOSTIC_TYPES      Type;&#10;  union {&#10;    struct {&#10;      UINT Size : 16;&#10;      UINT Reserved : 16;&#10;    };&#10;    UINT Value;&#10;  };&#10;  UINT                       SequenceNumber;&#10;  union {&#10;    D3DDDI_VIDEO_PRESENT_TARGET_ID TargetId;&#10;    D3DDDI_VIDEO_PRESENT_SOURCE_ID SourceId;&#10;    UINT                           Id;&#10;  };&#10;} DXGK_DIAGNOSTIC_HEADER;">DXGK_DIAGNOSTIC_HEADER</a> Header;
  union {
    <a href="dxgk_diagnostic_psr_refresh_reason" title="typedef union _DXGK_DIAGNOSTIC_PSR_REFRESH_REASON {&#10;  struct {&#10;    UINT Present : 1;&#10;    UINT CursorUpdate : 1;&#10;    UINT VSyncEnabled : 1;&#10;    UINT ColorTransformationChange : 1;&#10;    UINT BrightnessChange : 1;&#10;    UINT SinkRequest : 1;&#10;    UINT Other : 1;&#10;    UINT Reserved : 25;&#10;  };&#10;  UINT   Value;&#10;} DXGK_DIAGNOSTIC_PSR_REFRESH_REASON;">DXGK_DIAGNOSTIC_PSR_REFRESH_REASON</a> RefreshReason;
    <a href="uint" title="typedef unsigned int UINT;">UINT</a>                               Value;
  };
} DXGK_DIAGNOSTIC_PSR;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dispmprt/ns-dispmprt-_dxgk_diagnostic_psr">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/dxgk_diagnostic_psr.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-dispmprt-_dxgk_diagnostic_psr)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="dxgk_diagnostic_psr-structure">DXGK_DIAGNOSTIC_PSR structure</h1>

<h2 id="description">Description</h2>

<p>A diagnostic that indicates that the panel connected via the target in the <em>TargetId</em> field in the <strong><a href="dxgk_diagnostic_header" title="typedef struct _DXGK_DIAGNOSTIC_HEADER {&#10;  DXGK_DIAGNOSTIC_CATEGORIES Category;&#10;  DXGK_DIAGNOSTIC_TYPES      Type;&#10;  union {&#10;    struct {&#10;      UINT Size : 16;&#10;      UINT Reserved : 16;&#10;    };&#10;    UINT Value;&#10;  };&#10;  UINT                       SequenceNumber;&#10;  union {&#10;    D3DDDI_VIDEO_PRESENT_TARGET_ID TargetId;&#10;    D3DDDI_VIDEO_PRESENT_SOURCE_ID SourceId;&#10;    UINT                           Id;&#10;  };&#10;} DXGK_DIAGNOSTIC_HEADER;">DXGK_DIAGNOSTIC_HEADER</a></strong> structure has entered or exited a panel self-refresh (PSR) state.</p>

<h2 id="members">Members</h2>

<h3 id="header"><code>Header</code></h3>

<p>A <strong><a href="dxgk_diagnostic_header" title="typedef struct _DXGK_DIAGNOSTIC_HEADER {&#10;  DXGK_DIAGNOSTIC_CATEGORIES Category;&#10;  DXGK_DIAGNOSTIC_TYPES      Type;&#10;  union {&#10;    struct {&#10;      UINT Size : 16;&#10;      UINT Reserved : 16;&#10;    };&#10;    UINT Value;&#10;  };&#10;  UINT                       SequenceNumber;&#10;  union {&#10;    D3DDDI_VIDEO_PRESENT_TARGET_ID TargetId;&#10;    D3DDDI_VIDEO_PRESENT_SOURCE_ID SourceId;&#10;    UINT                           Id;&#10;  };&#10;} DXGK_DIAGNOSTIC_HEADER;">DXGK_DIAGNOSTIC_HEADER</a></strong> structure that indicates what kind of diagnostic is being reported.</p>

<h3 id="refreshreason"><code>RefreshReason</code></h3>

<p>A set of <strong><a href="dxgk_diagnostic_psr_refresh_reason" title="typedef union _DXGK_DIAGNOSTIC_PSR_REFRESH_REASON {&#10;  struct {&#10;    UINT Present : 1;&#10;    UINT CursorUpdate : 1;&#10;    UINT VSyncEnabled : 1;&#10;    UINT ColorTransformationChange : 1;&#10;    UINT BrightnessChange : 1;&#10;    UINT SinkRequest : 1;&#10;    UINT Other : 1;&#10;    UINT Reserved : 25;&#10;  };&#10;  UINT   Value;&#10;} DXGK_DIAGNOSTIC_PSR_REFRESH_REASON;">DXGK_DIAGNOSTIC_PSR_REFRESH_REASON</a></strong> bit-fields that indicate the reason or reasons for exiting PSR or, if none is set, indicates that the target is entering PSR.</p>

<h3 id="value"><code>Value</code></h3>

<p>Value of the PSR.</p>

<h2 id="remarks">Remarks</h2>

<p>When the panel enters self-refresh, the driver should send this diagnostic with none of the bit-fields set in the <em>RefreshReason</em> field.</p>

<p>When the panel needs to exit self-refresh to update the content, the driver should send this diagnostic with at least one of the bit-fields within RefreshReason, indicating the reason(s) for exiting PSR. If multiple factors caused PSR to be exited, the driver should attempt to set all appropriate bit-field reasons. However, it is more important that flags should not be set if the reason was not the trigger to exit PSR, than it is to capture all the reasons which did trigger the exit. This is because once PSR has been exited, the driver should not subsequently report additional reasons that PSR would have been exited so under reporting is valid, as long as at least one reason is provided.</p>

<p>If the panel and driver support PSR2, where updates do not require a full frame to be sent to the panel in order to refresh a smaller portion, such updates should still be reported to the OS while exiting PSR. For example, if the display is in PSR and the cursor shape is changed without any other updates, the driver should be able to send a small fraction of the full frame of pixels, likely only the lines containing the cursor. In this case, the driver should still report that PSR has been exited, with reason <em>CursorUpdate</em>. In a later release, extra diagnostic fields may be added to distinguish partial and full updates.</p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/dispmprt/ns-dispmprt-_dxgk_diagnostic_psr">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/dispmprt/ns-dispmprt-_dxgk_diagnostic_psr.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
