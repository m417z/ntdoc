<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="IddCxAdapterDisplayConfigUpdate2 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>IddCxAdapterDisplayConfigUpdate2 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            IddCxAdapterDisplayConfigUpdate2 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// iddcx.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">HRESULT IddCxAdapterDisplayConfigUpdate2(
  IDDCX_ADAPTER                              AdapterObject,
  const <a href="idarg_in_adapterdisplayconfigupdate2" title="struct IDARG_IN_ADAPTERDISPLAYCONFIGUPDATE2 {&#10;  UINT                     PathCount;&#10;  IDDCX_DISPLAYCONFIGPATH2 *pPaths;&#10;};">IDARG_IN_ADAPTERDISPLAYCONFIGUPDATE2</a> *pInArgs
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/iddcx/nf-iddcx-iddcxadapterdisplayconfigupdate2">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/iddcxadapterdisplayconfigupdate2.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-iddcx-iddcxadapterdisplayconfigupdate2)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2>Description</h2>
<p>A remote driver can call <strong>IddCxAdapterDisplayConfigUpdate2</strong> to allow a client to tell the server how to update the monitor configuration.</p>
<h2>Parameters</h2>
<h3><code>AdapterObject</code></h3>
<p>[in] The <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/display/iddcx-objects"><strong>IDDCX_ADAPTER</strong></a> object of the remote adapter that the display configuration is specified for.</p>
<h3><code>pInArgs</code></h3>
<p>[in] Pointer to an <strong><a href="idarg_in_adapterdisplayconfigupdate2" title="struct IDARG_IN_ADAPTERDISPLAYCONFIGUPDATE2 {&#10;  UINT                     PathCount;&#10;  IDDCX_DISPLAYCONFIGPATH2 *pPaths;&#10;};">IDARG_IN_ADAPTERDISPLAYCONFIGUPDATE2</a></strong> structure containing input arguments to the function.</p>
<h2>Return value</h2>
<p><strong>IddCxAdapterDisplayConfigUpdate2</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> upon success; otherwise, it returns an appropriate error code.</p>
<h2>Remarks</h2>
<p>A remote indirect display driver can call <strong>IddCxAdapterDisplayConfigUpdate2</strong> to set the mode, colorimetry and other values that the OS should use for a specific monitor. Only remote drivers are able to call this function.</p>
<p>For more information about HDR support, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/display/iddcx1.10-updates">IddCx version 1.10 updates</a>.</p>
<p>The <strong><a href="iddcx_displayconfigpath2" title="struct IDDCX_DISPLAYCONFIGPATH2 {&#10;  UINT                                    Size;&#10;  IDDCX_DISPLAYCONFIGPATH2_FLAGS          Flags;&#10;  IDDCX_MONITOR                           MonitorObject;&#10;  IDDCX_DISPLAYCONFIG_MODE                Mode;&#10;  UINT                                    MonitorScaleFactor;&#10;  DISPLAYCONFIG_2DREGION                  MonitorPhysicalSize;&#10;  IDDCX_DISPLAYCONFIG_MONITOR_COLORIMETRY MonitorColorimetry;&#10;  UINT                                    MonitorSdrWhiteLevel;&#10;};">IDDCX_DISPLAYCONFIGPATH2</a></strong> structure is defined in such a way that not all information has to be provided in every call. For example, some paths may not supply colorimetry data if the color mode is not HDR or WCG, or <strong>IddCxAdapterDisplayConfigUpdate2</strong> could be called to only update the SDR white level if no layout changes are required.</p>
<p>Controlling modes (setting the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/iddcx/ne-iddcx-iddcx_displayconfigpath2_flags"><strong>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</strong></a> flag for a path) has some additional rules and clarifications:</p>
<ul>
<li>If any path has <strong>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</strong> set then all paths provided must have it set</li>
<li>When <strong>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</strong> is provided on all paths then any currently active paths not in the path list will become inactive</li>
<li>If only non-<strong>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</strong> flags are set then only the paths to be updated need to be present</li>
<li>Depending on the color mode specified, additional data may be required for a path. The following table indicates what additional flags must be set:</li>
</ul>
<table>
<thead>
<tr>
  <th>Color mode</th>
  <th>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MONITOR_COLORIMETRY_VALID</th>
  <th>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MONITOR_SDRWHITELEVEL_VALID</th>
</tr>
</thead>
<tbody>
<tr>
  <td>SDR</td>
  <td>No</td>
  <td>No</td>
</tr>
<tr>
  <td>SDRWCG</td>
  <td>Yes</td>
  <td>No</td>
</tr>
<tr>
  <td>HDR</td>
  <td>Yes</td>
  <td>Yes</td>
</tr>
</tbody>
</table>
<h3>First versus subsequent calls to IddCxAdapterDisplayConfigUpdate2</h3>
<p>The first time a path is included in a <strong>IddCxAdapterDisplayConfigUpdate2</strong> call has different requirements than subsequent times. The following table outlines the requirements.</p>
<table>
<thead>
<tr>
  <th>Path field</th>
  <th>Required in initial call for path</th>
  <th>Can be updated after initial call</th>
  <th>How would Windows client get the info</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Mode</td>
  <td>Yes</td>
  <td>Yes</td>
  <td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winuser/nf-winuser-querydisplayconfig"><strong>QueryDisplayConfig</strong></a> will provide client display configuration and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/gdi/wm-displaychange"><strong>WM_DISPLAYCHANGE</strong></a> is sent when display config changes; <a rel="noopener" target="_blank" href="https://learn.microsoft.com/uwp/api/windows.graphics.display.advancedcolorinfo.currentadvancedcolorkind"><strong>AdvancedColorInfo.CurrentAdvancedColorKind</strong></a> will give a color mode</td>
</tr>
<tr>
  <td>Scale factor</td>
  <td>Yes</td>
  <td>Yes</td>
  <td>Drivers can use the method used for <strong><a href="iddcxadapterdisplayconfigupdate" title="NTSTATUS IddCxAdapterDisplayConfigUpdate(&#10;  IDDCX_ADAPTER                             AdapterObject,&#10;  const IDARG_IN_ADAPTERDISPLAYCONFIGUPDATE *pInArgs&#10;);">IddCxAdapterDisplayConfigUpdate</a></strong></td>
</tr>
<tr>
  <td>Physical size</td>
  <td>Yes if no EDID passed</td>
  <td>No</td>
  <td>Not needed if EDID passed</td>
</tr>
<tr>
  <td>Colorimetry</td>
  <td>Yes for non SDR color mode</td>
  <td>Yes</td>
  <td>Most fields from corresponding <strong>AdvancedColorInfo</strong> fields</td>
</tr>
<tr>
  <td>SDR white level</td>
  <td>Yes for HDR color mode, default is 80 nits</td>
  <td>Yes</td>
  <td><strong>AdvancedColorInfo.SdrWhiteLevelInNits</strong>, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/direct3darticles/high-dynamic-range">DirectX with Advanced Color on HDR/SDR displays</a> for more information</td>
</tr>
</tbody>
</table>
<h3>Behavior differences when running on Windows 11, version 22H2 September Update</h3>
<p>Due to underlying OS functionality, the support for drivers requesting HDR and WCG color modes when running on Windows 11, version 22H2 September Update differs slightly from when running on the Windows platform release coming in 2024. A driver can use the <strong><a href="iddcxgetversion" title="NTSTATUS IddCxGetVersion(&#10;  [out] IDARG_OUT_GETVERSION *pOutArgs&#10;);">IddCxGetVersion</a></strong> function to determine which OS they are running on. The following table describes which color modes a driver can request depending on the monitor descriptor previously provided to the OS:</p>
<table>
<thead>
<tr>
  <th>Edid type</th>
  <th>22H2 September Update possible color modes</th>
  <th>Platform release in 2024 possible color modes</th>
</tr>
</thead>
<tbody>
<tr>
  <td>None</td>
  <td>SDR, HDR</td>
  <td>SDR, SDRWCG, HDR</td>
</tr>
<tr>
  <td>SDR</td>
  <td>SDR, SDRWCG</td>
  <td>SDR, SDRWCG</td>
</tr>
<tr>
  <td>HDR</td>
  <td>SDR, HDR</td>
  <td>SDR, SDRWCG, HDR</td>
</tr>
</tbody>
</table>
<h3>Examples</h3>
<p>Some examples of which paths to include in subsequent <strong>IddCxAdapterDisplayConfigUpdate2</strong> calls follow. At the start of each scenario, a remote session has the following paths configured:</p>
<table>
<thead>
<tr>
  <th>Monitor</th>
  <th>Resolution</th>
  <th>Desktop position</th>
  <th>Color mode</th>
</tr>
</thead>
<tbody>
<tr>
  <td>1</td>
  <td>1920x1080 @ 30Hz</td>
  <td>0,0</td>
  <td>SDR</td>
</tr>
<tr>
  <td>2</td>
  <td>1024x768 @ 30Hz</td>
  <td>1024,0</td>
  <td>SDRWCG</td>
</tr>
<tr>
  <td>3</td>
  <td>3840x2160 @ 30Hz</td>
  <td>0,1848</td>
  <td>HDR</td>
</tr>
</tbody>
</table>
<h4>Scenario 1 - Change the desktop position of Monitor 3 to be left of Monitor 1</h4>
<table>
<thead>
<tr>
  <th>Monitor</th>
  <th>Flags</th>
  <th>Details</th>
</tr>
</thead>
<tbody>
<tr>
  <td>1</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</td>
  <td>No change to current mode data</td>
</tr>
<tr>
  <td>2</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</td>
  <td>No change to current mode data</td>
</tr>
<tr>
  <td>3</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</td>
  <td>Change the desktop position to -3840,0</td>
</tr>
</tbody>
</table>
<h4>Scenario 2 – Change monitor 2 from SDRWCG to SDR</h4>
<table>
<thead>
<tr>
  <th>Monitor</th>
  <th>Flags</th>
  <th>Details</th>
</tr>
</thead>
<tbody>
<tr>
  <td>1</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</td>
  <td>No change to current mode data</td>
</tr>
<tr>
  <td>2</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</td>
  <td>Set new color mode</td>
</tr>
<tr>
  <td>3</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</td>
  <td>No change to current mode data</td>
</tr>
</tbody>
</table>
<h4>Scenario 3 – Change monitor 1 from SDR to HDR</h4>
<table>
<thead>
<tr>
  <th>Monitor</th>
  <th>Flags</th>
  <th>Details</th>
</tr>
</thead>
<tbody>
<tr>
  <td>1</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID, IDDCX_DISPLAYCONFIGPATH2_FLAGS_MONITOR_COLORIMETRY_VALID, IDDCX_DISPLAYCONFIGPATH2_FLAGS_MONITOR_SDRWHITELEVEL_VALID</td>
  <td>Set new color mode, colorimetry and SDR white level</td>
</tr>
<tr>
  <td>2</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</td>
  <td>No change to current mode data</td>
</tr>
<tr>
  <td>3</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</td>
  <td>No change to current mode data</td>
</tr>
</tbody>
</table>
<h4>Scenario 4 – Change scale factor of Monitor 2</h4>
<table>
<thead>
<tr>
  <th>Monitor</th>
  <th>Flags</th>
  <th>Details</th>
</tr>
</thead>
<tbody>
<tr>
  <td>2</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MONITOR_SCALE_FACTOR_VALID</td>
  <td>Set new scale factor</td>
</tr>
</tbody>
</table>
<h4>Scenario 5 – Change scale factor of Monitor 2 and the desktop position of Monitor 3 to be left of Monitor 1</h4>
<table>
<thead>
<tr>
  <th>Monitor</th>
  <th>Flags</th>
  <th>Details</th>
</tr>
</thead>
<tbody>
<tr>
  <td>1</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</td>
  <td>No change to current mode data</td>
</tr>
<tr>
  <td>2</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID, IDDCX_DISPLAYCONFIGPATH2_FLAGS_MONITOR_SCALE_FACTOR_VALID</td>
  <td>No change to current mode data, set new scale factor</td>
</tr>
<tr>
  <td>3</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</td>
  <td>Change the desktop position to -3840,0</td>
</tr>
</tbody>
</table>
<h4>Scenario 6 – Remove Monitor 2 from the current configuration</h4>
<table>
<thead>
<tr>
  <th>Monitor</th>
  <th>Flags</th>
  <th>Details</th>
</tr>
</thead>
<tbody>
<tr>
  <td>1</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</td>
  <td>No change to current mode data</td>
</tr>
<tr>
  <td>3</td>
  <td>IDDCX_DISPLAYCONFIGPATH2_FLAGS_MODE_VALID</td>
  <td>No change to current mode data</td>
</tr>
</tbody>
</table>
<h2>See also</h2>
<p><strong><a href="idarg_in_adapterdisplayconfigupdate2" title="struct IDARG_IN_ADAPTERDISPLAYCONFIGUPDATE2 {&#10;  UINT                     PathCount;&#10;  IDDCX_DISPLAYCONFIGPATH2 *pPaths;&#10;};">IDARG_IN_ADAPTERDISPLAYCONFIGUPDATE2</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/iddcx/nf-iddcx-iddcxadapterdisplayconfigupdate2">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/iddcx/nf-iddcx-iddcxadapterdisplayconfigupdate2.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
