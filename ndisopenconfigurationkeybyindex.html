<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NdisOpenConfigurationKeyByIndex - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NdisOpenConfigurationKeyByIndex - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NdisOpenConfigurationKeyByIndex - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">VOID NdisOpenConfigurationKeyByIndex(
  [out] PNDIS_STATUS Status,
  [in]  NDIS_HANDLE  ConfigurationHandle,
  [in]  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>        Index,
  [out] PNDIS_STRING KeyName,
  [out] PNDIS_HANDLE KeyHandle
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndisopenconfigurationkeybyindex">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndisopenconfigurationkeybyindex.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ndis-ndisopenconfigurationkeybyindex)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="ndisopenconfigurationkeybyindex-function">NdisOpenConfigurationKeyByIndex function</h1>

<h2 id="description">Description</h2>

<p>The
<strong>NdisOpenConfigurationKeyByIndex</strong> function opens a subkey of a given open registry key that is
designated by a caller-supplied handle.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="status-out"><code>Status</code> [out]</h3>

<p>A pointer to a caller-supplied variable in which this function returns the status of its attempt
to open the designated registry key. Possible return values are one of the following:</p>

<h4 id="ndis_status_success">NDIS_STATUS_SUCCESS</h4>

<p>NDIS has initialized accessed to the subkey specified by
<em>KeyName</em> and
<em>Index</em> .</p>

<h4 id="ndis_status_failure">NDIS_STATUS_FAILURE</h4>

<p>The key could not be opened.</p>

<h3 id="configurationhandle-in"><code>ConfigurationHandle</code> [in]</h3>

<p>The handle to a registry key for which a subkey is to be opened. Typically,
<em>ConfigurationHandle</em> is returned by the
<a rel="noopener" target="_blank" href="ndisopenconfigurationex">NdisOpenConfigurationEx</a> function.</p>

<h3 id="index-in"><code>Index</code> [in]</h3>

<p>The index of the subkey to be opened. This zero-based value designates the subkey to be opened
under the key already opened with
<em>ConfigurationHandle</em> .</p>

<h3 id="keyname-out"><code>KeyName</code> [out]</h3>

<p>A pointer to an NDIS_STRING type containing a caller-supplied buffer in which this functions
returns a counted string in the system-default character set. This string specifies the name of the
opened subkey if the call succeeds. For Microsoft Windows 2000 and later drivers, this string contains
Unicode characters. That is, for Windows 2000 and later, NDIS defines the NDIS_STRING type as a
<a rel="noopener" target="_blank" href="unicode_string">UNICODE_STRING</a> type.</p>

<h3 id="keyhandle-out"><code>KeyHandle</code> [out]</h3>

<p>A pointer to a caller-supplied variable in which this function returns a handle to the opened
subkey if the call succeeds.</p>

<h2 id="remarks">Remarks</h2>

<p><strong>NdisOpenConfigurationKeyByIndex</strong> allows a driver to access configuration information that its
installation file stored in a registry subkey.</p>

<p>Note that the
<em>ConfigurationHandle</em> passed in to
<strong>NdisOpenConfigurationKeyByIndex</strong> can be any valid handle to a registry key already opened by the
caller.
<strong>NdisOpenConfigurationKeyByIndex</strong> returns configuration information for subkeys relative to any valid
<em>ConfigurationHandle</em> .</p>

<p>Since
<strong>NdisOpenConfigurationKeyByIndex</strong> references a subkey through an index, the driver does not have to
specify subkey names. A driver can sequence through a set of registry subkeys by repeatedly calling
<strong>NdisOpenConfigurationKeyIndex</strong> after incrementing the index until the function returns
NDIS_STATUS_FAILURE, thereby indicating that there are no more subkeys to open.</p>

<p>After a driver has consumed and, possibly, modified the configuration information stored in the
registry, it must call the
<a rel="noopener" target="_blank" href="ndiscloseconfiguration">NdisCloseConfiguration</a> function to
release the handle that is obtained from
<strong>NdisOpenConfigurationKeyByIndex</strong>.
<strong><a href="ndiscloseconfiguration" title="VOID NdisCloseConfiguration(&#10;  [in] NDIS_HANDLE ConfigurationHandle&#10;);">NdisCloseConfiguration</a></strong> also frees any temporary storage that NDIS allocated for the driver's calls
to the
<a rel="noopener" target="_blank" href="ndisreadconfiguration">NdisReadConfiguration</a>,
<a rel="noopener" target="_blank" href="ndisreadnetworkaddress">NdisReadNetworkAddress</a>, or
<a rel="noopener" target="_blank" href="ndiswriteconfiguration">NdisWriteConfiguration</a> functions
with the
<em>SubKeyHandle</em> that
<strong>NdisOpenConfigurationKeyByIndex</strong> returned.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="string">ANSI_STRING</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-miniport_initialize">MiniportInitializeEx</a></p>

<p><a rel="noopener" target="_blank" href="ndiscloseconfiguration">NdisCloseConfiguration</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/ndis-ndisopenconfigurationex">NdisOpenConfigurationEx</a></p>

<p><a rel="noopener" target="_blank" href="ndisopenconfigurationkeybyname">NdisOpenConfigurationKeyByName</a></p>

<p><a rel="noopener" target="_blank" href="ndisreadconfiguration">NdisReadConfiguration</a></p>

<p><a rel="noopener" target="_blank" href="ndiswriteconfiguration">NdisWriteConfiguration</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_bind_adapter_ex">ProtocolBindAdapterEx</a></p>

<p><a rel="noopener" target="_blank" href="unicode_string">UNICODE_STRING</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndisopenconfigurationkeybyindex">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ndis/nf-ndis-ndisopenconfigurationkeybyindex.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
