<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PROTOCOL_SEND_NET_BUFFER_LISTS_COMPLETE - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PROTOCOL_SEND_NET_BUFFER_LISTS_COMPLETE - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PROTOCOL_SEND_NET_BUFFER_LISTS_COMPLETE - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PROTOCOL_SEND_NET_BUFFER_LISTS_COMPLETE ProtocolSendNetBufferListsComplete;

VOID ProtocolSendNetBufferListsComplete(
  [in] NDIS_HANDLE ProtocolBindingContext,
  [in] <a href="net_buffer_list" title="typedef struct _NET_BUFFER_LIST {&#10;  union {&#10;    struct {&#10;      NET_BUFFER_LIST *Next;&#10;      NET_BUFFER      *FirstNetBuffer;&#10;    };&#10;    SLIST_HEADER           Link;&#10;    NET_BUFFER_LIST_HEADER NetBufferListHeader;&#10;  };&#10;  NET_BUFFER_LIST_CONTEXT *Context;&#10;  NET_BUFFER_LIST         *ParentNetBufferList;&#10;  NDIS_HANDLE             NdisPoolHandle;&#10;  PVOID                   NdisReserved[2];&#10;  PVOID                   ProtocolReserved[4];&#10;  PVOID                   MiniportReserved[2];&#10;  PVOID                   Scratch;&#10;  NDIS_HANDLE             SourceHandle;&#10;  ULONG                   NblFlags;&#10;  LONG                    ChildRefCount;&#10;  ULONG                   Flags;&#10;...">PNET_BUFFER_LIST</a> NetBufferList,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> SendCompleteFlags
)
{...}</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_send_net_buffer_lists_complete">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/protocol_send_net_buffer_lists_complete.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-ndis-protocol_send_net_buffer_lists_complete)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="protocol_send_net_buffer_lists_complete-callback-function">PROTOCOL_SEND_NET_BUFFER_LISTS_COMPLETE callback function</h1>

<h2 id="description">Description</h2>

<p>The
<em>ProtocolSendNetBufferListsComplete</em> function completes a send operation that the protocol driver
initiated with a call to the
<a href="ndissendnetbufferlists" title="VOID NdisSendNetBufferLists(&#10;  [in] NDIS_HANDLE                       NdisBindingHandle,&#10;  [in] __drv_aliasesMem PNET_BUFFER_LIST NetBufferLists,&#10;  [in] NDIS_PORT_NUMBER                  PortNumber,&#10;  [in] ULONG                             SendFlags&#10;);">NdisSendNetBufferLists</a> function.</p>

<p><strong>Note</strong> You must declare the function by using the <strong>PROTOCOL_SEND_NET_BUFFER_LISTS_COMPLETE</strong> type. For more
information, see the following Examples section.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="protocolbindingcontext-in"><code>ProtocolBindingContext</code> [in]</h3>

<p>A handle to a context area that the protocol driver allocated to maintain state information about
a binding. This handle was passed to NDIS in a previous call to
<a href="ndisopenadapterex" title="NDIS_STATUS NdisOpenAdapterEx(&#10;  [in]  NDIS_HANDLE           NdisProtocolHandle,&#10;  [in]  NDIS_HANDLE           ProtocolBindingContext,&#10;  [in]  PNDIS_OPEN_PARAMETERS OpenParameters,&#10;  [in]  NDIS_HANDLE           BindContext,&#10;  [out] PNDIS_HANDLE          NdisBindingHandle&#10;);">NdisOpenAdapterEx</a>.</p>

<h3 id="sendcompleteflags-in"><code>SendCompleteFlags</code> [in]</h3>

<p>NDIS flags that can be combined with an OR operation. To clear all the flags, set this member to
zero. This function supports the NDIS_SEND_COMPLETE_FLAGS_DISPATCH_LEVEL flag which; if set, indicates
that the current IRQL is DISPATCH_LEVEL. For more information about this flag, see
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/dispatch-irql-tracking">Dispatch IRQL Tracking</a>.</p>

<h3 id="netbufferlist-in"><code>NetBufferList</code> [in]</h3>

<p>A pointer to a list of
<a href="net_buffer_list" title="typedef struct _NET_BUFFER_LIST {&#10;  union {&#10;    struct {&#10;      NET_BUFFER_LIST *Next;&#10;      NET_BUFFER      *FirstNetBuffer;&#10;    };&#10;    SLIST_HEADER           Link;&#10;    NET_BUFFER_LIST_HEADER NetBufferListHeader;&#10;  };&#10;  NET_BUFFER_LIST_CONTEXT *Context;&#10;  NET_BUFFER_LIST         *ParentNetBufferList;&#10;  NDIS_HANDLE             NdisPoolHandle;&#10;  PVOID                   NdisReserved[2];&#10;  PVOID                   ProtocolReserved[4];&#10;  PVOID                   MiniportReserved[2];&#10;  PVOID                   Scratch;&#10;  NDIS_HANDLE             SourceHandle;&#10;  ULONG                   NblFlags;&#10;  LONG                    ChildRefCount;&#10;  ULONG                   Flags;&#10;...">NET_BUFFER_LIST</a> structures that the
protocol driver supplied in a previous call to
<a href="ndissendnetbufferlists" title="VOID NdisSendNetBufferLists(&#10;  [in] NDIS_HANDLE                       NdisBindingHandle,&#10;  [in] __drv_aliasesMem PNET_BUFFER_LIST NetBufferLists,&#10;  [in] NDIS_PORT_NUMBER                  PortNumber,&#10;  [in] ULONG                             SendFlags&#10;);">NdisSendNetBufferLists</a>.</p>

<h2 id="remarks">Remarks</h2>

<p><em>ProtocolSendNetBufferListsComplete</em> is a required function for protocol drivers.
<em>ProtocolSendNetBufferListsComplete</em> performs whatever postprocessing is necessary to complete a send
operation. For example, the protocol driver can notify the clients that requested the protocol to send
the network data that the send operation is complete.</p>

<p>NDIS calls
<em>ProtocolSendNetBufferListsComplete</em> after the underlying miniport driver calls the
<a href="ndismsendnetbufferlistscomplete" title="VOID NdisMSendNetBufferListsComplete(&#10;  [in] NDIS_HANDLE      MiniportAdapterHandle,&#10;       PNET_BUFFER_LIST NetBufferList,&#10;  [in] ULONG            SendCompleteFlags&#10;);">NdisMSendNetBufferListsComplete</a> function. Completion of a send operation usually implies that the
underlying miniport driver has transmitted the specified network data. However, a miniport driver can
indicate that a send operation has completed as soon as it transfers the network data to its NIC.</p>

<p>When NDIS calls
<em>ProtocolSendNetBufferListsComplete</em>, the protocol driver regains ownership of all of the resources
associated with the
<a href="net_buffer_list" title="typedef struct _NET_BUFFER_LIST {&#10;  union {&#10;    struct {&#10;      NET_BUFFER_LIST *Next;&#10;      NET_BUFFER      *FirstNetBuffer;&#10;    };&#10;    SLIST_HEADER           Link;&#10;    NET_BUFFER_LIST_HEADER NetBufferListHeader;&#10;  };&#10;  NET_BUFFER_LIST_CONTEXT *Context;&#10;  NET_BUFFER_LIST         *ParentNetBufferList;&#10;  NDIS_HANDLE             NdisPoolHandle;&#10;  PVOID                   NdisReserved[2];&#10;  PVOID                   ProtocolReserved[4];&#10;  PVOID                   MiniportReserved[2];&#10;  PVOID                   Scratch;&#10;  NDIS_HANDLE             SourceHandle;&#10;  ULONG                   NblFlags;&#10;  LONG                    ChildRefCount;&#10;  ULONG                   Flags;&#10;...">NET_BUFFER_LIST</a> structures that are
specified by the
<em>NetBufferLists</em> parameter.</p>

<p>NDIS always submits protocol-supplied network data to the underlying miniport driver in the
protocol-determined order as passed to
<strong><a href="ndissendnetbufferlists" title="VOID NdisSendNetBufferLists(&#10;  [in] NDIS_HANDLE                       NdisBindingHandle,&#10;  [in] __drv_aliasesMem PNET_BUFFER_LIST NetBufferLists,&#10;  [in] NDIS_PORT_NUMBER                  PortNumber,&#10;  [in] ULONG                             SendFlags&#10;);">NdisSendNetBufferLists</a></strong>. However, the underlying driver can complete the send requests in any
order. That is, protocol drivers can rely on NDIS to submit network data in FIFO order to the underlying
driver. However, protocol drivers cannot rely on the underlying driver to call
<strong><a href="ndismsendnetbufferlistscomplete" title="VOID NdisMSendNetBufferListsComplete(&#10;  [in] NDIS_HANDLE      MiniportAdapterHandle,&#10;       PNET_BUFFER_LIST NetBufferList,&#10;  [in] ULONG            SendCompleteFlags&#10;);">NdisMSendNetBufferListsComplete</a></strong> in the same order.</p>

<p>NDIS calls
<em>ProtocolSendNetBufferListsComplete</em> at IRQL&lt;= DISPATCH_LEVEL.</p>

<h3 id="examples">Examples</h3>

<p>To define a <em>ProtocolSendNetBufferListsComplete</em> function, you must first provide a function declaration that identifies the type of function you're defining. Windows provides a set of function types for drivers. Declaring a function using the function types helps <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/code-analysis-for-drivers">Code Analysis for Drivers</a>, <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/static-driver-verifier">Static Driver Verifier</a> (SDV), and other verification tools find errors, and it's a requirement for writing drivers for the Windows operating system.</p>

<p>For example, to define a <em>ProtocolSendNetBufferListsComplete</em> function that is named "MySendNetBufferListsComplete", use the <strong>PROTOCOL_SEND_NET_BUFFER_LISTS_COMPLETE</strong> type as shown in this code example:</p>

<pre><code>PROTOCOL_SEND_NET_BUFFER_LISTS_COMPLETE MySendNetBufferListsComplete;
</code></pre>

<p>Then, implement your function as follows:</p>

<pre><code>_Use_decl_annotations_
VOID
 MySendNetBufferListsComplete(
    NDIS_HANDLE  ProtocolBindingContext,
    <a href="net_buffer_list" title="typedef struct _NET_BUFFER_LIST {&#10;  union {&#10;    struct {&#10;      NET_BUFFER_LIST *Next;&#10;      NET_BUFFER      *FirstNetBuffer;&#10;    };&#10;    SLIST_HEADER           Link;&#10;    NET_BUFFER_LIST_HEADER NetBufferListHeader;&#10;  };&#10;  NET_BUFFER_LIST_CONTEXT *Context;&#10;  NET_BUFFER_LIST         *ParentNetBufferList;&#10;  NDIS_HANDLE             NdisPoolHandle;&#10;  PVOID                   NdisReserved[2];&#10;  PVOID                   ProtocolReserved[4];&#10;  PVOID                   MiniportReserved[2];&#10;  PVOID                   Scratch;&#10;  NDIS_HANDLE             SourceHandle;&#10;  ULONG                   NblFlags;&#10;  LONG                    ChildRefCount;&#10;  ULONG                   Flags;&#10;...">PNET_BUFFER_LIST</a>  NetBufferLists,
    <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>  SendCompleteFlags
    )
  {...}
</code></pre>

<p>The <strong>PROTOCOL_SEND_NET_BUFFER_LISTS_COMPLETE</strong> function type is defined in the Ndis.h header file. To more accurately identify errors when you run the code analysis tools, be sure to add the <em>Use_decl_annotations</em> annotation to your function definition. The <em>Use_decl_annotations</em> annotation ensures that the annotations that are applied to the <strong>PROTOCOL_SEND_NET_BUFFER_LISTS_COMPLETE</strong> function type in the header file are used. For more information about the requirements for function declarations, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/declaring-functions-by-using-function-role-types-for-ndis-drivers">Declaring Functions by Using Function Role Types for NDIS Drivers</a>.</p>

<p>For information about <em>Use_decl_annotations</em>, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/visualstudio/code-quality/annotating-function-behavior">Annotating Function Behavior</a>.</p>

<h2 id="see-also">See also</h2>

<p><a href="net_buffer" title="typedef struct _NET_BUFFER {&#10;  union {&#10;    struct {&#10;      NET_BUFFER *Next;&#10;      MDL        *CurrentMdl;&#10;      ULONG      CurrentMdlOffset;&#10;      union {&#10;        ULONG  DataLength;&#10;        SIZE_T stDataLength;&#10;      };&#10;      MDL        *MdlChain;&#10;      ULONG      DataOffset;&#10;    };&#10;    SLIST_HEADER      Link;&#10;    NET_BUFFER_HEADER NetBufferHeader;&#10;  };&#10;  USHORT           ChecksumBias;&#10;  USHORT           Reserved;&#10;  NDIS_HANDLE      NdisPoolHandle;&#10;  PVOID            NdisReserved[2];&#10;...">NET_BUFFER</a></p>

<p><a href="net_buffer_list" title="typedef struct _NET_BUFFER_LIST {&#10;  union {&#10;    struct {&#10;      NET_BUFFER_LIST *Next;&#10;      NET_BUFFER      *FirstNetBuffer;&#10;    };&#10;    SLIST_HEADER           Link;&#10;    NET_BUFFER_LIST_HEADER NetBufferListHeader;&#10;  };&#10;  NET_BUFFER_LIST_CONTEXT *Context;&#10;  NET_BUFFER_LIST         *ParentNetBufferList;&#10;  NDIS_HANDLE             NdisPoolHandle;&#10;  PVOID                   NdisReserved[2];&#10;  PVOID                   ProtocolReserved[4];&#10;  PVOID                   MiniportReserved[2];&#10;  PVOID                   Scratch;&#10;  NDIS_HANDLE             SourceHandle;&#10;  ULONG                   NblFlags;&#10;  LONG                    ChildRefCount;&#10;  ULONG                   Flags;&#10;...">NET_BUFFER_LIST</a></p>

<p><a href="ndismsendnetbufferlistscomplete" title="VOID NdisMSendNetBufferListsComplete(&#10;  [in] NDIS_HANDLE      MiniportAdapterHandle,&#10;       PNET_BUFFER_LIST NetBufferList,&#10;  [in] ULONG            SendCompleteFlags&#10;);">NdisMSendNetBufferListsComplete</a></p>

<p><a href="ndisopenadapterex" title="NDIS_STATUS NdisOpenAdapterEx(&#10;  [in]  NDIS_HANDLE           NdisProtocolHandle,&#10;  [in]  NDIS_HANDLE           ProtocolBindingContext,&#10;  [in]  PNDIS_OPEN_PARAMETERS OpenParameters,&#10;  [in]  NDIS_HANDLE           BindContext,&#10;  [out] PNDIS_HANDLE          NdisBindingHandle&#10;);">NdisOpenAdapterEx</a></p>

<p><a href="ndissendnetbufferlists" title="VOID NdisSendNetBufferLists(&#10;  [in] NDIS_HANDLE                       NdisBindingHandle,&#10;  [in] __drv_aliasesMem PNET_BUFFER_LIST NetBufferLists,&#10;  [in] NDIS_PORT_NUMBER                  PortNumber,&#10;  [in] ULONG                             SendFlags&#10;);">NdisSendNetBufferLists</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_send_net_buffer_lists_complete">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ndis/nc-ndis-protocol_send_net_buffer_lists_complete.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
