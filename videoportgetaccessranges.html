<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="VideoPortGetAccessRanges - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>VideoPortGetAccessRanges - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            VideoPortGetAccessRanges - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// video.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">VIDEOPORT_DEPRECATED VIDEOPORT_API VP_STATUS VideoPortGetAccessRanges(
  PVOID                   HwDeviceExtension,
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   NumRequestedResources,
  <a href="io_resource_descriptor" title="typedef struct _IO_RESOURCE_DESCRIPTOR {&#10;  UCHAR  Option;&#10;  UCHAR  Type;&#10;  UCHAR  ShareDisposition;&#10;  UCHAR  Spare1;&#10;  USHORT Flags;&#10;  USHORT Spare2;&#10;  union {&#10;    struct {&#10;      ULONG            Length;&#10;      ULONG            Alignment;&#10;      PHYSICAL_ADDRESS MinimumAddress;&#10;      PHYSICAL_ADDRESS MaximumAddress;&#10;    } Port;&#10;    struct {&#10;      ULONG            Length;&#10;      ULONG            Alignment;&#10;      PHYSICAL_ADDRESS MinimumAddress;&#10;      PHYSICAL_ADDRESS MaximumAddress;&#10;    } Memory;&#10;...">PIO_RESOURCE_DESCRIPTOR</a> RequestedResources,
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                   NumAccessRanges,
  <a href="video_access_range" title="typedef struct _VIDEO_ACCESS_RANGE {&#10;  PHYSICAL_ADDRESS RangeStart;&#10;  ULONG            RangeLength;&#10;  UCHAR            RangeInIoSpace;&#10;  UCHAR            RangeVisible;&#10;  UCHAR            RangeShareable;&#10;  UCHAR            RangePassive;&#10;} VIDEO_ACCESS_RANGE, *PVIDEO_ACCESS_RANGE;">PVIDEO_ACCESS_RANGE</a>     AccessRanges,
  PVOID                   VendorId,
  PVOID                   DeviceId,
  PULONG                  Slot
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/video/nf-video-videoportgetaccessranges">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/videoportgetaccessranges.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-video-videoportgetaccessranges)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>VideoPortGetAccessRanges function</h1>
<h2>Description</h2>
<p>Deprecated. The <strong>VideoPortGetAccessRanges</strong> function retrieves bus-relative configuration information and, if possible, claims these hardware resources in the registry for the caller.</p>
<h2>Parameters</h2>
<h3><code>HwDeviceExtension</code></h3>
<p>Pointer to the miniport driver's device extension.</p>
<h3><code>NumRequestedResources</code></h3>
<p>Specifies the number of elements in the <strong>RequestedResources</strong> array.</p>
<h3><code>RequestedResources</code></h3>
<p>[in, optional] An array of <a href="io_resource_descriptor" title="typedef struct _IO_RESOURCE_DESCRIPTOR {&#10;  UCHAR  Option;&#10;  UCHAR  Type;&#10;  UCHAR  ShareDisposition;&#10;  UCHAR  Spare1;&#10;  USHORT Flags;&#10;  USHORT Spare2;&#10;  union {&#10;    struct {&#10;      ULONG            Length;&#10;      ULONG            Alignment;&#10;      PHYSICAL_ADDRESS MinimumAddress;&#10;      PHYSICAL_ADDRESS MaximumAddress;&#10;    } Port;&#10;    struct {&#10;      ULONG            Length;&#10;      ULONG            Alignment;&#10;      PHYSICAL_ADDRESS MinimumAddress;&#10;      PHYSICAL_ADDRESS MaximumAddress;&#10;    } Memory;&#10;...">IO_RESOURCE_DESCRIPTOR</a>-type elements. Each descriptor specifies a single hardware resource that the miniport driver needs, prefers, or can use as an alternative to that specified in another array element. For detailed information about this structure, see the description of <a href="https://learn.microsoft.com/windows-hardware/drivers/kernel/mmcreatemdl"><strong>IoAssignResources</strong></a>.</p>
<h3><code>NumAccessRanges</code></h3>
<p>Specifies the number of elements in the <strong>AccessRanges</strong> array.</p>
<h3><code>AccessRanges</code></h3>
<p>[out] Pointer to an area on the stack or to a static structure in the miniport driver to which <strong>VideoPortGetAccessRanges</strong> returns an array of <strong><a href="video_access_range" title="typedef struct _VIDEO_ACCESS_RANGE {&#10;  PHYSICAL_ADDRESS RangeStart;&#10;  ULONG            RangeLength;&#10;  UCHAR            RangeInIoSpace;&#10;  UCHAR            RangeVisible;&#10;  UCHAR            RangeShareable;&#10;  UCHAR            RangePassive;&#10;} VIDEO_ACCESS_RANGE, *PVIDEO_ACCESS_RANGE;">VIDEO_ACCESS_RANGE</a></strong> elements filled with the bus-relative device memory ranges for the adapter.</p>
<h3><code>VendorId</code></h3>
<p>Should be set to NULL.</p>
<h3><code>DeviceId</code></h3>
<p>Should be set to NULL.</p>
<h3><code>Slot</code></h3>
<p>Pointer to a memory location in which the video port driver stores the slot number for the device, or is NULL.</p>
<p>For Plug and Play devices, if this is a valid pointer, the video port driver stores the slot number at the memory location specified by the pointer. If a NULL value is passed in the call, the video port driver does not store a value in the location.</p>
<h2>Return value</h2>
<p><strong>VideoPortGetAccessRanges</strong> returns NO_ERROR if it successfully filled in the <strong>AccessRanges</strong> information or returned configuration information at <strong>RequestedResources</strong>.</p>
<h2>Remarks</h2>
<p>Every video miniport driver either must use access ranges returned by <strong>VideoPortGetAccessRanges</strong>, or must call <strong><a href="videoportverifyaccessranges" title="VIDEOPORT_DEPRECATED VIDEOPORT_API VP_STATUS VideoPortVerifyAccessRanges(&#10;                 PVOID               HwDeviceExtension,&#10;                 ULONG               NumAccessRanges,&#10;  [in, optional] PVIDEO_ACCESS_RANGE AccessRanges&#10;);">VideoPortVerifyAccessRanges</a></strong> before attempting to access a video adapter during the driver (and system) initialization process.</p>
<p><strong>VideoPortGetAccessRanges</strong> can be called only from a miniport driver's <a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/video/nc-video-pvideo_hw_find_adapter"><strong>HwVidFindAdapter</strong></a> function.</p>
<p>For most miniport drivers, <strong>VideoPortGetAccessRanges</strong> can retrieve, verify, and claim the bus-relative access ranges and any interrupt and/or DMA channel/port used by a particular video adapter, while <strong><a href="videoportverifyaccessranges" title="VIDEOPORT_DEPRECATED VIDEOPORT_API VP_STATUS VideoPortVerifyAccessRanges(&#10;                 PVOID               HwDeviceExtension,&#10;                 ULONG               NumAccessRanges,&#10;  [in, optional] PVIDEO_ACCESS_RANGE AccessRanges&#10;);">VideoPortVerifyAccessRanges</a></strong> can only verify and claim miniport driver-specified resources. That is, for all configuration information that it returns, <strong>VideoPortGetAccessRanges</strong> claims the corresponding hardware resources in the registry for the caller. A miniport driver need not call <strong><a href="videoportverifyaccessranges" title="VIDEOPORT_DEPRECATED VIDEOPORT_API VP_STATUS VideoPortVerifyAccessRanges(&#10;                 PVOID               HwDeviceExtension,&#10;                 ULONG               NumAccessRanges,&#10;  [in, optional] PVIDEO_ACCESS_RANGE AccessRanges&#10;);">VideoPortVerifyAccessRanges</a></strong> with the returned bus-relative configuration information, unless the miniport driver attempts to modify any of the returned values.</p>
<p>Each successful call to <strong>VideoPortGetAccessRanges</strong> or <strong><a href="videoportverifyaccessranges" title="VIDEOPORT_DEPRECATED VIDEOPORT_API VP_STATUS VideoPortVerifyAccessRanges(&#10;                 PVOID               HwDeviceExtension,&#10;                 ULONG               NumAccessRanges,&#10;  [in, optional] PVIDEO_ACCESS_RANGE AccessRanges&#10;);">VideoPortVerifyAccessRanges</a></strong> for a particular adapter overwrites the miniport driver's preceding claim on hardware resources in the registry.</p>
<p>After a successful call to <strong>VideoPortGetAccessRanges</strong>, the miniport driver must map the returned bus-relative ranges to logical ranges with <strong><a href="videoportgetdevicebase" title="VIDEOPORT_DEPRECATED VIDEOPORT_API PVOID VideoPortGetDeviceBase(&#10;  PVOID            HwDeviceExtension,&#10;  PHYSICAL_ADDRESS IoAddress,&#10;  ULONG            NumberOfUchars,&#10;  UCHAR            InIoSpace&#10;);">VideoPortGetDeviceBase</a></strong> <em>before</em> calling the appropriate <strong>VideoPortRead/Write<em>Xxx</em></strong> function to communicate with the adapter.</p>
<p>Generally, the miniport driver of a PCI device should have its <a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/video/nc-video-pvideo_hw_find_adapter"><strong>HwVidFindAdapter</strong></a> function call <strong>VideoPortGetAccessRanges</strong>, rather than attempt to manipulate the nondevice-specific <a href="pci_common_config" title="typedef struct _PCI_COMMON_CONFIG : PCI_COMMON_HEADER {&#10;  UCHAR DeviceSpecific[192];&#10;} PCI_COMMON_CONFIG, *PPCI_COMMON_CONFIG;">PCI_COMMON_CONFIG</a> information returned by a call to <strong><a href="videoportgetbusdata" title="VIDEOPORT_DEPRECATED VIDEOPORT_API ULONG VideoPortGetBusData(&#10;        PVOID         HwDeviceExtension,&#10;        BUS_DATA_TYPE BusDataType,&#10;        ULONG         SlotNumber,&#10;  [out] PVOID         Buffer,&#10;        ULONG         Offset,&#10;        ULONG         Length&#10;);">VideoPortGetBusData</a></strong>. This miniport driver can typically call <strong>VideoPortGetAccessRanges</strong> with a NULL<strong>RequestedResources</strong> pointer. The video port driver then uses the configuration space of the PCI bus to determine the resources for the video adapter. The miniport driver can call <strong>VideoPortGetAccessRanges</strong>, using a set of driver-supplied <strong>RequestedResources</strong> specifications, if its original call fails to return valid configuration data for the adapter.</p>
<p>Note that miniport drivers of adapters on other types of I/O buses also can call <strong>VideoPortGetAccessRanges</strong>. These drivers should call <strong>VideoPortGetAccessRanges</strong> using a <strong>RequestedResources</strong> pointer to a driver-supplied array of I/O resource descriptors.</p>
<p>If the <strong>HwVidFindAdapter</strong> function claims bus-relative access ranges and possibly other hardware resources for an adapter, but then determines that it does not support the adapter, then the miniport driver must relinquish its claims on hardware resources in the registry by calling <strong>VideoPortGetAccessRanges</strong> or <strong><a href="videoportverifyaccessranges" title="VIDEOPORT_DEPRECATED VIDEOPORT_API VP_STATUS VideoPortVerifyAccessRanges(&#10;                 PVOID               HwDeviceExtension,&#10;                 ULONG               NumAccessRanges,&#10;  [in, optional] PVIDEO_ACCESS_RANGE AccessRanges&#10;);">VideoPortVerifyAccessRanges</a></strong> with the <strong>NumAccessRanges</strong> parameter set to zero.</p>
<h2>See also</h2>
<p><a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/video/nc-video-pvideo_hw_find_adapter"><strong>HwVidFindAdapter</strong></a></p>
<p><a href="https://learn.microsoft.com/windows-hardware/drivers/kernel/mmcreatemdl"><strong>IoAssignResources</strong></a></p>
<p><a href="https://learn.microsoft.com/previous-versions/windows/hardware/drivers/ff537455(v=vs.85)"><strong>PCI_COMMON_CONFIG</strong></a></p>
<p><strong><a href="pci_slot_number" title="typedef struct _PCI_SLOT_NUMBER {&#10;  union {&#10;    struct {&#10;      ULONG DeviceNumber : 5;&#10;      ULONG FunctionNumber : 3;&#10;      ULONG Reserved : 24;&#10;    } bits;&#10;    ULONG AsULONG;&#10;  } u;&#10;} PCI_SLOT_NUMBER, *PPCI_SLOT_NUMBER;">PCI_SLOT_NUMBER</a></strong></p>
<p><strong><a href="video_port_config_info" title="typedef struct _VIDEO_PORT_CONFIG_INFO {&#10;  ULONG                        Length;&#10;  ULONG                        SystemIoBusNumber;&#10;  INTERFACE_TYPE               AdapterInterfaceType;&#10;  ULONG                        BusInterruptLevel;&#10;  ULONG                        BusInterruptVector;&#10;  KINTERRUPT_MODE              InterruptMode;&#10;  ULONG                        NumEmulatorAccessEntries;&#10;  PEMULATOR_ACCESS_ENTRY       EmulatorAccessEntries;&#10;  ULONG_PTR                    EmulatorAccessEntriesContext;&#10;  PHYSICAL_ADDRESS             VdmPhysicalVideoMemoryAddress;&#10;  ULONG                        VdmPhysicalVideoMemoryLength;&#10;  ULONG                        HardwareStateSize;&#10;  ULONG                        DmaChannel;&#10;  ULONG                        DmaPort;&#10;  UCHAR                        DmaShareable;&#10;  UCHAR                        InterruptShareable;&#10;  BOOLEAN                      Master;&#10;  DMA_WIDTH                    DmaWidth;&#10;  DMA_SPEED                    DmaSpeed;&#10;...">VIDEO_PORT_CONFIG_INFO</a></strong></p>
<p><strong><a href="videoportgetbusdata" title="VIDEOPORT_DEPRECATED VIDEOPORT_API ULONG VideoPortGetBusData(&#10;        PVOID         HwDeviceExtension,&#10;        BUS_DATA_TYPE BusDataType,&#10;        ULONG         SlotNumber,&#10;  [out] PVOID         Buffer,&#10;        ULONG         Offset,&#10;        ULONG         Length&#10;);">VideoPortGetBusData</a></strong></p>
<p><strong><a href="videoportgetdevicebase" title="VIDEOPORT_DEPRECATED VIDEOPORT_API PVOID VideoPortGetDeviceBase(&#10;  PVOID            HwDeviceExtension,&#10;  PHYSICAL_ADDRESS IoAddress,&#10;  ULONG            NumberOfUchars,&#10;  UCHAR            InIoSpace&#10;);">VideoPortGetDeviceBase</a></strong></p>
<p><strong><a href="videoportsetbusdata" title="VIDEOPORT_DEPRECATED VIDEOPORT_API ULONG VideoPortSetBusData(&#10;       PVOID         HwDeviceExtension,&#10;       BUS_DATA_TYPE BusDataType,&#10;       ULONG         SlotNumber,&#10;  [in] PVOID         Buffer,&#10;       ULONG         Offset,&#10;       ULONG         Length&#10;);">VideoPortSetBusData</a></strong></p>
<p><strong><a href="videoportverifyaccessranges" title="VIDEOPORT_DEPRECATED VIDEOPORT_API VP_STATUS VideoPortVerifyAccessRanges(&#10;                 PVOID               HwDeviceExtension,&#10;                 ULONG               NumAccessRanges,&#10;  [in, optional] PVIDEO_ACCESS_RANGE AccessRanges&#10;);">VideoPortVerifyAccessRanges</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/video/nf-video-videoportgetaccessranges">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/video/nf-video-videoportgetaccessranges.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
