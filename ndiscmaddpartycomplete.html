<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NdisCmAddPartyComplete - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NdisCmAddPartyComplete - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NdisCmAddPartyComplete - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">VOID NdisCmAddPartyComplete(
  [in]           NDIS_STATUS         Status,
  [in]           NDIS_HANDLE         NdisPartyHandle,
  [in, optional] NDIS_HANDLE         CallMgrPartyContext,
  [in]           PCO_CALL_PARAMETERS CallParameters
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndiscmaddpartycomplete">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndiscmaddpartycomplete.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ndis-ndiscmaddpartycomplete)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="ndiscmaddpartycomplete-function">NdisCmAddPartyComplete function</h1>

<h2 id="description">Description</h2>

<p><strong>NdisCmAddPartyComplete</strong> returns the final status of a client's request, for which the call manager
previously returned NDIS_STATUS_PENDING, to add a party on an established multipoint VC.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="status-in"><code>Status</code> [in]</h3>

<p>Specifies the final status of the call manager's add-party operation, either NDIS_STATUS_SUCCESS
or any NDIS_STATUS_<em>XXX</em> except NDIS_STATUS_PENDING.</p>

<h3 id="ndispartyhandle-in"><code>NdisPartyHandle</code> [in]</h3>

<p>Specifies the handle identifying the party. This handle was input to the call manager's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cm_add_party">ProtocolCmAddParty</a> function.</p>

<h3 id="callmgrpartycontext-in-optional"><code>CallMgrPartyContext</code> [in, optional]</h3>

<p>Specifies the handle to a caller-allocated resident context area in which the call manager will
maintain party-specific state information if the add-party operation succeeded. Otherwise, this
parameter can be <strong>NULL</strong> because it is ignored.</p>

<h3 id="callparameters-in"><code>CallParameters</code> [in]</h3>

<p>Pointer to a structure of type
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/hardware/network/ff545384(v=vs.85)">CO_CALL_PARAMETERS</a> that contains the call
parameters, originally supplied by the client, for the party to be added.</p>

<h2 id="remarks">Remarks</h2>

<p>If a stand-alone call manager's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cm_add_party">ProtocolCmAddParty</a> function returns
NDIS_STATUS_PENDING, the CM subsequently must call
<strong>NdisCmAddPartyComplete</strong> to notify the client and NDIS that its attempt to add a party on the
multipoint VC has completed, whether successfully or with an error.</p>

<p>If the client passed in traffic parameters at
<em>CallParameters</em> that did not match those already established for the multipoint VC, the designer of
the call manager must determine how to handle this condition, subject to any constraints imposed by the
network medium. Possibilities include the following:</p>

<ul>
<li>Set up the per-party traffic parameters if the underlying network medium supports this feature on
multipoint VCs.</li>
<li>Reset the client-supplied traffic parameters to those established for the VC when the original
outgoing call was made before the CM calls
<strong>NdisCmAddPartyComplete</strong> with NDIS_STATUS_SUCCESS as the
<em>Status</em> .</li>
<li>Change the traffic parameters for the VC and, for every party currently connected on it, to the
client-supplied values before the CM calls
<strong>NdisCmAddPartyComplete</strong> with NDIS_STATUS_SUCCESS as the
<em>Status</em> .</li>
<li>Fail the client's attempt to add a party. (This alternative implicitly forces clients to set up
their traffic parameters for a multipoint VC with
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndisclmakecall">NdisClMakeCall</a> and to specify the same
traffic parameters at each subsequent call to
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndiscladdparty">NdisClAddParty</a> for the given multipoint
VC.)</li>
</ul>

<p>For some connection-oriented media , traffic parameters are per-VC in nature and, consequently,
identical for all parties on a multipoint VC.</p>

<p>If the CM sets
<em>Status</em> to NDIS_STATUS_SUCCESS, it must supply an explicit handle, which is usually a pointer to the
CM-allocated per-party state area, as
<em>CallMgrPartyContext</em> when it calls
<strong>NdisCmAddPartyComplete</strong>.</p>

<p>A call to
<strong>NdisCmAddPartyComplete</strong> causes NDIS to call the client's
<a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cl_add_party_complete">ProtocolClAddPartyComplete</a> function.</p>

<p>Only stand-alone call managers, which register themselves with NDIS as protocol drivers, can call
<strong>NdisCmAddPartyComplete</strong>. Connection-oriented miniport drivers that provide integrated
call-management support call
<strong><a href="ndismcmaddpartycomplete" title="void NdisMCmAddPartyComplete(&#10;  _S_,&#10;  _H_,&#10;  _C_,&#10;  _P_&#10;);">NdisMCmAddPartyComplete</a></strong> instead.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/previous-versions/windows/hardware/network/ff545384(v=vs.85)">CO_CALL_PARAMETERS</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndisallocatefromnpagedlookasidelist">NdisAllocateFromNPagedLookasideList</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndiscladdparty">NdisClAddParty</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndismcmaddpartycomplete">NdisMCmAddPartyComplete</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cl_add_party_complete">ProtocolClAddPartyComplete</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nc-ndis-protocol_cm_add_party">ProtocolCmAddParty</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ndis/nf-ndis-ndiscmaddpartycomplete">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ndis/nf-ndis-ndiscmaddpartycomplete.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
