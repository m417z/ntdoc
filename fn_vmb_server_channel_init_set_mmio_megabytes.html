<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FN_VMB_SERVER_CHANNEL_INIT_SET_MMIO_MEGABYTES - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FN_VMB_SERVER_CHANNEL_INIT_SET_MMIO_MEGABYTES - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FN_VMB_SERVER_CHANNEL_INIT_SET_MMIO_MEGABYTES - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// vmbuskernelmodeclientlibapi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">FN_VMB_SERVER_CHANNEL_INIT_SET_MMIO_MEGABYTES FnVmbServerChannelInitSetMmioMegabytes;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> FnVmbServerChannelInitSetMmioMegabytes(
  VMBCHANNEL Channel,
  <a href="uint16" title="typedef unsigned short UINT16;">UINT16</a> MmioMegabytes,
  <a href="uint16" title="typedef unsigned short UINT16;">UINT16</a> MmioMegabytesOptional
)
{...}</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/vmbuskernelmodeclientlibapi/nc-vmbuskernelmodeclientlibapi-fn_vmb_server_channel_init_set_mmio_megabytes">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/fn_vmb_server_channel_init_set_mmio_megabytes.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-vmbuskernelmodeclientlibapi-fn_vmb_server_channel_init_set_mmio_megabytes)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="fn_vmb_server_channel_init_set_mmio_megabytes-callback-function">FN_VMB_SERVER_CHANNEL_INIT_SET_MMIO_MEGABYTES callback function</h1>

<h2 id="description">Description</h2>

<p>The <strong>VmbServerChannelInitSetMmioMegabytes</strong> function specifies the amount, megabytes, of guest memory-mapped I/O (MMIO) space to reserve for the device.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="channel"><code>Channel</code></h3>

<p>A handle for a channel.</p>

<h3 id="mmiomegabytes"><code>MmioMegabytes</code></h3>

<p>The amount of MMIO space, in megabytes, to reserve.</p>

<h3 id="mmiomegabytesoptional"><code>MmioMegabytesOptional</code></h3>

<p>The amount of extra optional MMIO space, in megabytes, to reserve.</p>

<h2 id="return-value">Return value</h2>

<p><strong>VmbServerChannelInitSetMmioMegabytes</strong> returns the following status values:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>STATUS_INVALID_PARAMETER_1</strong></td>
  <td>The <em>Channel</em> value was invalid or in an invalid state, such as Disabled.</td>
</tr>
<tr>
  <td><strong>STATUS_INVALID_PARAMETER</strong></td>
  <td>Both <em>MmioMegabytes</em> and <em>MmioMegabytesOptional</em> have a value of zero (0). One of these parameters must be greater than zero</td>
</tr>
</tbody>
</table>

<h2 id="prototype">Prototype</h2>

<p><!-- CODE_MARKER --></p>

<div class="codehilite">
<pre><span></span><code><span class="c1">//Declaration</span>

<span class="n">FN_VMB_SERVER_CHANNEL_INIT_SET_MMIO_MEGABYTES</span><span class="w"> </span><span class="n">FnVmbServerChannelInitSetMmioMegabytes</span><span class="p">;</span>

<span class="c1">// Definition</span>

<span class="n"><a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a></span><span class="w"> </span><span class="nf">FnVmbServerChannelInitSetMmioMegabytes</span>
<span class="p">(</span>
<span class="w">    </span><span class="n">VMBCHANNEL</span><span class="w"> </span><span class="n">Channel</span>
<span class="w">    </span><span class="n"><a href="uint16" title="typedef unsigned short UINT16;">UINT16</a></span><span class="w"> </span><span class="n">MmioMegabytes</span>
<span class="w">    </span><span class="n"><a href="uint16" title="typedef unsigned short UINT16;">UINT16</a></span><span class="w"> </span><span class="n">MmioMegabytesOptional</span>
<span class="p">)</span>
<span class="p">{...}</span>
</code></pre>
</div>

<h2 id="remarks">Remarks</h2>

<p>This function exists as a convenience for driver creators. Everything it does could be done by interacting the with the guest plug-and-play manager and requesting memory-mapped I/O space directly. It is a common requirement that the Windows and Linux VMBus drivers have the capacity to reserve MMIO space on behalf of the client. This function allows the server endpoint to suggest the right amount of MMIO space to reserve.</p>

<blockquote>
  <p>[!IMPORTANT]
  This function is called through the VMBus Kernel Mode Client Library (KMCL) interface, provided by the Vmbkmcl.sys bus driver. This is a server-only function accessed from the <strong><a href="kmcl_server_only_methods" title="typedef struct _KMCL_SERVER_ONLY_METHODS {&#10;  PFN_VMB_CHANNEL_MAP_GPADL                                     VmbChannelMapGpadl;&#10;  PFN_VMB_CHANNEL_RESTORE_FROM_BUFFER                           VmbChannelRestoreFromBuffer;&#10;  PFN_VMB_CHANNEL_SAVE_BEGIN                                    VmbChannelSaveBegin;&#10;  PFN_VMB_CHANNEL_SAVE_CONTINUE                                 VmbChannelSaveContinue;&#10;  PFN_VMB_CHANNEL_SAVE_END                                      VmbChannelSaveEnd;&#10;  PFN_VMB_CHANNEL_UNMAP_GPADL                                   VmbChannelUnmapGpadl;&#10;  PFN_VMB_CONVERT_VMBUS_HANDLE_TO_KERNEL_HANDLE                 VmbConvertVmbusHandleToKernelHandle;&#10;  PFN_VMB_PACKET_RESTORE                                        VmbPacketRestore;&#10;  PFN_VMB_SERVER_CHANNEL_INIT_SET_FLAGS                         VmbServerChannelInitSetFlags;&#10;  PFN_VMB_SERVER_CHANNEL_INIT_SET_MMIO_MEGABYTES                VmbServerChannelInitSetMmioMegabytes;&#10;  PFN_VMB_SERVER_CHANNEL_INIT_SET_SAVE_RESTORE_PACKET_CALLBACKS VmbServerChannelInitSetSaveRestorePacketCallbacks;&#10;  PFN_VMB_SERVER_CHANNEL_INIT_SET_TARGET_INTERFACE_ID           VmbServerChannelInitSetTargetInterfaceId;&#10;  PFN_VMB_SERVER_CHANNEL_INIT_SET_TARGET_VTL                    VmbServerChannelInitSetTargetVtl;&#10;  PFN_VMB_SERVER_CHANNEL_INIT_SET_VMBUS_HANDLE                  VmbServerChannelInitSetVmbusHandle;&#10;} KMCL_SERVER_ONLY_METHODS;">KMCL_SERVER_ONLY_METHODS</a></strong> structure.</p>
  
  <p>For more information, see the Remarks section of <strong><a href="kmcl_server_only_methods" title="typedef struct _KMCL_SERVER_ONLY_METHODS {&#10;  PFN_VMB_CHANNEL_MAP_GPADL                                     VmbChannelMapGpadl;&#10;  PFN_VMB_CHANNEL_RESTORE_FROM_BUFFER                           VmbChannelRestoreFromBuffer;&#10;  PFN_VMB_CHANNEL_SAVE_BEGIN                                    VmbChannelSaveBegin;&#10;  PFN_VMB_CHANNEL_SAVE_CONTINUE                                 VmbChannelSaveContinue;&#10;  PFN_VMB_CHANNEL_SAVE_END                                      VmbChannelSaveEnd;&#10;  PFN_VMB_CHANNEL_UNMAP_GPADL                                   VmbChannelUnmapGpadl;&#10;  PFN_VMB_CONVERT_VMBUS_HANDLE_TO_KERNEL_HANDLE                 VmbConvertVmbusHandleToKernelHandle;&#10;  PFN_VMB_PACKET_RESTORE                                        VmbPacketRestore;&#10;  PFN_VMB_SERVER_CHANNEL_INIT_SET_FLAGS                         VmbServerChannelInitSetFlags;&#10;  PFN_VMB_SERVER_CHANNEL_INIT_SET_MMIO_MEGABYTES                VmbServerChannelInitSetMmioMegabytes;&#10;  PFN_VMB_SERVER_CHANNEL_INIT_SET_SAVE_RESTORE_PACKET_CALLBACKS VmbServerChannelInitSetSaveRestorePacketCallbacks;&#10;  PFN_VMB_SERVER_CHANNEL_INIT_SET_TARGET_INTERFACE_ID           VmbServerChannelInitSetTargetInterfaceId;&#10;  PFN_VMB_SERVER_CHANNEL_INIT_SET_TARGET_VTL                    VmbServerChannelInitSetTargetVtl;&#10;  PFN_VMB_SERVER_CHANNEL_INIT_SET_VMBUS_HANDLE                  VmbServerChannelInitSetVmbusHandle;&#10;} KMCL_SERVER_ONLY_METHODS;">KMCL_SERVER_ONLY_METHODS</a></strong>.</p>
</blockquote>

<h2 id="see-also">See also</h2>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/vmbuskernelmodeclientlibapi/nc-vmbuskernelmodeclientlibapi-fn_vmb_server_channel_init_set_mmio_megabytes">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/vmbuskernelmodeclientlibapi/nc-vmbuskernelmodeclientlibapi-fn_vmb_server_channel_init_set_mmio_megabytes.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
