<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="FILE_OBJECTID_INFORMATION - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FILE_OBJECTID_INFORMATION - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            FILE_OBJECTID_INFORMATION - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTIOAPI_H

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _FILE_OBJECTID_INFORMATION
{
    <a href="ulonglong" title="typedef unsigned __int64 ULONGLONG;">ULONGLONG</a> FileReference;
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> ObjectId[16]; // GUID
    union
    {
        struct
        {
            <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> BirthVolumeId[16];
            <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> BirthObjectId[16];
            <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> DomainId[16];
        };
        <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> ExtendedInfo[48];
    };
} FILE_OBJECTID_INFORMATION, *PFILE_OBJECTID_INFORMATION;
</span><span class="ntdoc-code-footer">
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/aebe4d4eee5745592695617ad1593cde422109ef/phnt/include/ntioapi.h#L1521">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntifs.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _FILE_OBJECTID_INFORMATION {
  <a href="longlong" title="typedef __int64 LONGLONG;">LONGLONG</a> FileReference;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>    ObjectId[16];
  union {
    struct {
      <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> BirthVolumeId[16];
      <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> BirthObjectId[16];
      <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> DomainId[16];
    } DUMMYSTRUCTNAME;
    <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> ExtendedInfo[48];
  } DUMMYUNIONNAME;
} FILE_OBJECTID_INFORMATION, *PFILE_OBJECTID_INFORMATION;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/ns-ntifs-_file_objectid_information">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<p>This structure is <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/ns-ntifs-_file_objectid_information">documented in Windows Driver Kit</a>.</p>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/file_objectid_information.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntifs-_file_objectid_information)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="file_objectid_information-structure">FILE_OBJECTID_INFORMATION structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>FILE_OBJECTID_INFORMATION</strong> structure is used to query object ID information for the files in a directory on an NTFS volume.</p>

<h2 id="members">Members</h2>

<h3 id="filereference"><code>FileReference</code></h3>

<p>The 8-byte file reference number for the file. NTFS generates this number and assigns it to the file automatically when the file is created.</p>

<h3 id="objectid"><code>ObjectId</code></h3>

<p>The 16-byte file object ID for the file. NTFS generates this number and assigns it to the file at the request of a driver or application. File object IDs are guaranteed to be unique only within the volume where the file resides.</p>

<h3 id="dummyunionname"><code>DUMMYUNIONNAME</code></h3>

<h3 id="dummyunionnamedummystructname"><code>DUMMYUNIONNAME.DUMMYSTRUCTNAME</code></h3>

<h3 id="dummyunionnamedummystructnamebirthvolumeid"><code>DUMMYUNIONNAME.DUMMYSTRUCTNAME.BirthVolumeId</code></h3>

<p>The object identifier of the volume on which the file resided when the object identifier was created, or zero if the volume had no object identifier at that time. After copy operations, move operations, or other file operations, <strong>BirthVolumeId</strong> may not be the same as the object identifier of the volume on which the object currently resides.</p>

<h3 id="dummyunionnamedummystructnamebirthobjectid"><code>DUMMYUNIONNAME.DUMMYSTRUCTNAME.BirthObjectId</code></h3>

<p>The object identifier of the file at the time it was created. After copy operations, move operations, or other file operations <strong>BirthObjectId</strong> may not be the same as the current value of the <strong>ObjectId</strong> member.</p>

<h3 id="dummyunionnamedummystructnamedomainid"><code>DUMMYUNIONNAME.DUMMYSTRUCTNAME.DomainId</code></h3>

<p>Reserved; must be zero.</p>

<h3 id="dummyunionnameextendedinfo"><code>DUMMYUNIONNAME.ExtendedInfo</code></h3>

<p>User-provided data. You can use it to contain the <strong>BirthVolumeID</strong>, <strong>BirthObjectID</strong>, and <strong>DomainID</strong> members, or you can define a different data structure.</p>

<h2 id="remarks">Remarks</h2>

<p>This information can be queried in either of the following ways:</p>

<ul>
<li><p>Call <a href="ntquerydirectoryfile" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQueryDirectoryFile(&#10;    _In_ HANDLE FileHandle,&#10;    _In_opt_ HANDLE Event,&#10;    _In_opt_ PIO_APC_ROUTINE ApcRoutine,&#10;    _In_opt_ PVOID ApcContext,&#10;    _Out_ PIO_STATUS_BLOCK IoStatusBlock,&#10;    _Out_writes_bytes_(Length) PVOID FileInformation,&#10;    _In_ ULONG Length,&#10;    _In_ FILE_INFORMATION_CLASS FileInformationClass,&#10;    _In_ BOOLEAN ReturnSingleEntry,&#10;    _In_opt_ PCUNICODE_STRING FileName,&#10;    _In_ BOOLEAN RestartScan&#10;    );">ZwQueryDirectoryFile</a>, passing FileObjectIdInformation as the value of <strong>FileInformationClass</strong> and passing a caller-allocated, <strong>FILE_OBJECTID_INFORMATION</strong>-structured buffer as the value of <strong>FileInformation</strong>.</p></li>
<li><p>Create an <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a> with major function code <a href="irp_mj_directory_control" title="#define IRP_MJ_DIRECTORY_CONTROL 0x0c">IRP_MJ_DIRECTORY_CONTROL</a> and minor function code IRP_MN_QUERY_DIRECTORY.</p></li>
</ul>

<p>No special access rights are required to query for this information.</p>

<p>Support for file reference numbers and file object IDs is file system-specific:</p>

<ul>
<li>File object IDs are supported only on NTFS volumes. NTFS allows files to be opened by object ID as well as by file reference number.</li>
<li>ReFS doesn't support object IDs. ReFS uses 128-bit file IDs, so can't cleanly distinguish between file ID versus object ID when processing an open by ID. (File IDs are 64-bits on NTFS, so are easily distinguished from object IDs. NTFS also simultaneously supports opening by 128-bit ID: if the high 64-bits are zero, the low 64-bits are treated as a file ID; otherwise, the 128-bit value is treated as an object ID.)</li>
</ul>

<p>File system filter drivers that use file object IDs should be tested for interoperability with DFS, the Replicator service, and the Distributed Link Tracking service, all of which use and manipulate file object IDs.</p>

<p>This structure must be aligned on a <a href="long" title="typedef long LONG;">LONG</a> (4-byte) boundary.</p>

<h2 id="see-also">See also</h2>

<p><a href="file_internal_information" title="typedef struct _FILE_INTERNAL_INFORMATION&#10;{&#10;    union&#10;    {&#10;        ULARGE_INTEGER IndexNumber;&#10;        struct&#10;        {&#10;            ULONGLONG MftRecordIndex : 48; // rev&#10;            ULONGLONG SequenceNumber : 16; // rev&#10;        };&#10;    };&#10;} FILE_INTERNAL_INFORMATION, *PFILE_INTERNAL_INFORMATION;">FILE_INTERNAL_INFORMATION</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ifs/irp-mj-directory-control">IRP_MJ_DIRECTORY_CONTROL</a></p>

<p><a href="ntquerydirectoryfile" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQueryDirectoryFile(&#10;    _In_ HANDLE FileHandle,&#10;    _In_opt_ HANDLE Event,&#10;    _In_opt_ PIO_APC_ROUTINE ApcRoutine,&#10;    _In_opt_ PVOID ApcContext,&#10;    _Out_ PIO_STATUS_BLOCK IoStatusBlock,&#10;    _Out_writes_bytes_(Length) PVOID FileInformation,&#10;    _In_ ULONG Length,&#10;    _In_ FILE_INFORMATION_CLASS FileInformationClass,&#10;    _In_ BOOLEAN ReturnSingleEntry,&#10;    _In_opt_ PCUNICODE_STRING FileName,&#10;    _In_ BOOLEAN RestartScan&#10;    );">ZwQueryDirectoryFile</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/ns-ntifs-_file_objectid_information">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntifs/ns-ntifs-_file_objectid_information.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
