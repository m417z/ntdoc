<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NDIS_NIC_SWITCH_VPORT_PARAMETERS - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NDIS_NIC_SWITCH_VPORT_PARAMETERS - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NDIS_NIC_SWITCH_VPORT_PARAMETERS - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _NDIS_NIC_SWITCH_VPORT_PARAMETERS {
  <a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a>                         Header;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                                      Flags;
  NDIS_NIC_SWITCH_ID                         SwitchId;
  NDIS_NIC_SWITCH_VPORT_ID                   VPortId;
  NDIS_VPORT_NAME                            VPortName;
  NDIS_SRIOV_FUNCTION_ID                     AttachedFunctionId;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                                      NumQueuePairs;
  <a href="ndis_nic_switch_vport_interrupt_moderation" title="typedef enum _NDIS_NIC_SWITCH_VPORT_INTERRUPT_MODERATION {&#10;  NdisNicSwitchVPortInterruptModerationUndefined,&#10;  NdisNicSwitchVPortInterruptModerationAdaptive,&#10;  NdisNicSwitchVPortInterruptModerationOff,&#10;  NdisNicSwitchVPortInterruptModerationLow,&#10;  NdisNicSwitchVPortInterruptModerationMedium,&#10;  NdisNicSwitchVPortInterruptModerationHigh&#10;} NDIS_NIC_SWITCH_VPORT_INTERRUPT_MODERATION, *PNDIS_NIC_SWITCH_VPORT_INTERRUPT_MODERATION;">NDIS_NIC_SWITCH_VPORT_INTERRUPT_MODERATION</a> InterruptModeration;
  <a href="ndis_nic_switch_vport_state" title="typedef enum _NDIS_NIC_SWITCH_VPORT_STATE {&#10;  NdisNicSwitchVPortStateUndefined,&#10;  NdisNicSwitchVPortStateActivated,&#10;  NdisNicSwitchVPortStateDeactivated,&#10;  NdisNicSwitchVPortStateMaximum&#10;} NDIS_NIC_SWITCH_VPORT_STATE, *PNDIS_NIC_SWITCH_VPORT_STATE;">NDIS_NIC_SWITCH_VPORT_STATE</a>                VPortState;
  <a href="group_affinity" title="typedef struct _GROUP_AFFINITY {&#10;  KAFFINITY Mask;&#10;  USHORT    Group;&#10;  USHORT    Reserved[3];&#10;} GROUP_AFFINITY, *PGROUP_AFFINITY;">GROUP_AFFINITY</a>                             ProcessorAffinity;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                                      LookaheadSize;
  NDIS_NDK_PARAMETERS                        NdkParams;
  NDIS_QOS_SQ_ID                             QosSqId;
} NDIS_NIC_SWITCH_VPORT_PARAMETERS, *PNDIS_NIC_SWITCH_VPORT_PARAMETERS;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_nic_switch_vport_parameters">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndis_nic_switch_vport_parameters.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddndis-_ndis_nic_switch_vport_parameters)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_ndis_nic_switch_vport_parameters-structure">_NDIS_NIC_SWITCH_VPORT_PARAMETERS structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>NDIS_NIC_SWITCH_VPORT_PARAMETERS</strong> structure specifies the configuration for a virtual port (VPort) on a network adapter switch of the network adapter.</p>

<h2 id="members">Members</h2>

<h3 id="header"><code>Header</code></h3>

<p>The type, revision, and size of the <strong>NDIS_NIC_SWITCH_VPORT_PARAMETERS</strong> structure. This member is formatted as an <a rel="noopener" target="_blank" href="ndis_object_header">NDIS_OBJECT_HEADER</a> structure.</p>

<p>The miniport driver must set the <strong>Type</strong> member of <strong>Header</strong> to NDIS_OBJECT_TYPE_DEFAULT.</p>

<p>To indicate the version of the <strong>NDIS_NIC_SWITCH_VPORT_PARAMETERS</strong> structure, set the <strong>Revision</strong> member of <strong>Header</strong> to one of the following values:</p>

<h4 id="ndis_nic_switch_vport_parameters_revision_2">NDIS_NIC_SWITCH_VPORT_PARAMETERS_REVISION_2</h4>

<p>Added the <strong>QosSqId</strong> field for NDIS 6.50.</p>

<p>Set the <strong>Size</strong> member to NDIS_SIZEOF_NIC_SWITCH_VPORT_PARAMETERS_REVISION_2.</p>

<h4 id="ndis_nic_switch_vport_parameters_revision_1">NDIS_NIC_SWITCH_VPORT_PARAMETERS_REVISION_1</h4>

<p>Original version for NDIS 6.30 and later.</p>

<p>Set the <strong>Size</strong> member to NDIS_SIZEOF_NIC_SWITCH_VPORT_PARAMETERS_REVISION_1.</p>

<h3 id="flags"><code>Flags</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains a bitwise OR of flags. The following flags are defined for this member.</p>

<h4 id="ndis_nic_switch_vport_params_lookahead_split_enabled">NDIS_NIC_SWITCH_VPORT_PARAMS_LOOKAHEAD_SPLIT_ENABLED</h4>

<p>This flag is reserved for future use.
Miniport drivers must ignore this flag.</p>

<h4 id="ndis_nic_switch_vport_params_flags_changed">NDIS_NIC_SWITCH_VPORT_PARAMS_FLAGS_CHANGED</h4>

<p>This flag specifies that the <strong>Flags</strong> member has been updated after the VPort has been created. These flags can be enabled or disabled after the VPort has been created by using an OID set request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a>.</p>

<blockquote>
  <p>[!NOTE]
  This flag is valid only when this structure is used in OID set requests of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a>.</p>
</blockquote>

<h4 id="ndis_nic_switch_vport_params_name_changed">NDIS_NIC_SWITCH_VPORT_PARAMS_NAME_CHANGED</h4>

<p>This flag specifies that the <strong>VPortName</strong> member has been updated after the VPort has been created. This member can be updated by using an OID set request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a>.</p>

<blockquote>
  <p>[!NOTE]
  This flag is valid only when this structure is used in OID set requests of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a>.</p>
</blockquote>

<h4 id="ndis_nic_switch_vport_params_int_mod_changed">NDIS_NIC_SWITCH_VPORT_PARAMS_INT_MOD_CHANGED</h4>

<p>This flag specifies that the <strong>InterruptModeration</strong> member has been updated after the VPort has been created. This member can be updated by using an OID set request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a>.</p>

<blockquote>
  <p>[!NOTE]
  This flag is valid only when this structure is used in OID set requests of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a>.</p>
</blockquote>

<h4 id="ndis_nic_switch_vport_params_state_changed">NDIS_NIC_SWITCH_VPORT_PARAMS_STATE_CHANGED</h4>

<p>This flag specifies that the <strong>VPortState</strong> member has been updated after the VPort has been created. This member can be updated by using an OID set request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a>.</p>

<blockquote>
  <p>[!NOTE]
  This flag is valid only when this structure is used in OID set requests of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a>.</p>
</blockquote>

<h4 id="ndis_nic_switch_vport_params_processor_affinity_changed">NDIS_NIC_SWITCH_VPORT_PARAMS_PROCESSOR_AFFINITY_CHANGED</h4>

<p>This flag specifies that the <strong>ProcessoryAffinity</strong> member has been updated after the VPort has been created. The processor affinity of a VPort can only be updated if the VPort is attached to the PF on the network adapter. The <strong>ProcessoryAffinity</strong> member can be updated by using an OID set request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a>.</p>

<blockquote>
  <p>[!NOTE]
  This flag is valid only when this structure is used in OID set requests of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a>.</p>
</blockquote>

<h4 id="ndis_nic_switch_vport_params_num_queue_pairs_changed">NDIS_NIC_SWITCH_VPORT_PARAMS_NUM_QUEUE_PAIRS_CHANGED</h4>

<p>This flag specifies that the <strong>NumQueuePairs</strong> member has been updated after the VPort has been created. When <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/overview-of-virtual-machine-multiple-queues">Virtual Machine Multiple Queues (VMMQ)</a> is enabled, the number of queues for default and non-default Vports can be updated. The <strong>NumQueuePairs</strong> member can be updated by using an OID set request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a>.</p>

<p><strong>Note</strong> This flag is valid only when this structure is used in OID set requests of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a>.</p>

<h3 id="switchid"><code>SwitchId</code></h3>

<p>An NDIS_NIC_SWITCH_ID value that specifies the identifier of the switch on which the VPort is to be created.</p>

<p>The switch identifier is an integer between zero and the number of switches that the network adapter supports. An NDIS_DEFAULT_SWITCH_ID value indicates the default network adapter switch.</p>

<blockquote>
  <p>[!NOTE]
  Starting with Windows Server 2012, the single root I/O virtualization (SR-IOV) interface only supports the default network adapter switch on the network adapter. The value of this member must be set to NDIS_DEFAULT_SWITCH_ID.</p>
</blockquote>

<h3 id="vportid"><code>VPortId</code></h3>

<p>An NDIS_NIC_SWITCH_VPORT_ID value that specifies the identifier of a VPort on the network adapter. The value is allocated by NDIS, and is unique across the network adapter.</p>

<p>The <strong>VPortId</strong> value is within the range from zero to (<strong>NumVPorts</strong> - 1), where <strong>NumVPorts</strong> is the number of VPorts that the miniport driver has configured on the network adapter. The driver specifies this number in the <strong>NumVPorts</strong> member of the <a rel="noopener" target="_blank" href="ndis_nic_switch_info">NDIS_NIC_SWITCH_INFO</a> structure. The driver returns this structure through an OID query request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-enum-switches">OID_NIC_SWITCH_ENUM_SWITCHES</a>.</p>

<blockquote>
  <p>[!NOTE]
  A VPort identifier of NDIS_DEFAULT_VPORT_ID is reserved for the default VPort that is attached to the PF on the default NIC switch.</p>
</blockquote>

<h3 id="vportname"><code>VPortName</code></h3>

<p>An NDIS_VPORT_NAME value that specifies the name of the VPort. This member contains a user-friendly description of the VPort.</p>

<h3 id="attachedfunctionid"><code>AttachedFunctionId</code></h3>

<p>An NDIS_SRIOV_FUNCTION_ID value that specifies the ID of the Physical Function (PF) or Virtual Function (VF) that the VPort is attached to. A value of NDIS_PF_FUNCTION_ID specifies that the VPort is attached to the PF. If the value is a valid VF identifier, the VPort is attached to the VF.</p>

<h3 id="numqueuepairs"><code>NumQueuePairs</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that specifies the number of queue pairs configured for this VPort.</p>

<p>A queue pair consists of a transmit queue and receive queue. Queue pairs associated with the default VPort are configured at the time of switch creation through an OID method request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-create-switch">OID_NIC_SWITCH_CREATE_SWITCH</a>.
One or more queue pairs are configured on a nondefault VPort through an OID method request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-create-vport">OID_NIC_SWITCH_CREATE_VPORT</a>.</p>

<h3 id="interruptmoderation"><code>InterruptModeration</code></h3>

<p>An <a rel="noopener" target="_blank" href="ndis_nic_switch_vport_interrupt_moderation">NDIS_NIC_SWITCH_VPORT_INTERRUPT_MODERATION</a> value that specifies the interrupt moderation setting of the VPort.</p>

<h3 id="vportstate"><code>VPortState</code></h3>

<p>An <a rel="noopener" target="_blank" href="ndis_nic_switch_vport_state">NDIS_NIC_SWITCH_VPORT_STATE</a> value that specifies the current state of the VPort.</p>

<h3 id="processoraffinity"><code>ProcessorAffinity</code></h3>

<p>A <a href="group_affinity" title="typedef struct _GROUP_AFFINITY {&#10;  KAFFINITY Mask;&#10;  USHORT    Group;&#10;  USHORT    Reserved[3];&#10;} GROUP_AFFINITY, *PGROUP_AFFINITY;">GROUP_AFFINITY</a> value that specifies the group number and a bitmap of the CPUs that this VPort is associated with. This field is valid only for VPorts that are attached to the PF.</p>

<blockquote>
  <p>[!NOTE]
  For nondefault PF VPorts, a <a href="group_affinity" title="typedef struct _GROUP_AFFINITY {&#10;  KAFFINITY Mask;&#10;  USHORT    Group;&#10;  USHORT    Reserved[3];&#10;} GROUP_AFFINITY, *PGROUP_AFFINITY;">GROUP_AFFINITY</a> value that specifies only one processor must be specified when the VPort is created. VPorts are created through an OID method request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-create-vport">OID_NIC_SWITCH_CREATE_VPORT</a>.</p>
</blockquote>

<p>The processor affinity associated with the nondefault VPort attached to the PF can be changed after VPort creation. The processor affinity associated with the default VPort can also be changed by using an OID set request of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a>.</p>

<h3 id="lookaheadsize"><code>LookaheadSize</code></h3>

<p>This member is reserved for future use. This member must be set to zero.</p>

<h3 id="ndkparams"><code>NdkParams</code></h3>

<h3 id="qossqid"><code>QosSqId</code></h3>

<p>Associates a vPort with a Scheduler Queue (SQ). Set this field to a valid SQ ID to associate the vPort to an SQ. Set this field to <strong>zero</strong> if there is no SQ association. For more information on <strong>NDIS_QOS_SQ_ID</strong>, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-qos-offload-create-sq">OID_QOS_OFFLOAD_CREATE_SQ</a>.</p>

<h2 id="remarks">Remarks</h2>

<p>This structure is used in OID requests of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-create-vport">OID_NIC_SWITCH_CREATE_VPORT</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a>.</p>

<p>For more information about the SR-IOV interface, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/overview-of-single-root-i-o-virtualization--sr-iov-">Overview of Single Root I/O Virtualization (SR-IOV)</a>.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="ndis_nic_switch_info">NDIS_NIC_SWITCH_INFO</a></p>

<p><a rel="noopener" target="_blank" href="ndis_nic_switch_vf_info">NDIS_NIC_SWITCH_VF_INFO</a></p>

<p><a rel="noopener" target="_blank" href="ndis_object_header">NDIS_OBJECT_HEADER</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-create-vport">OID_NIC_SWITCH_CREATE_VPORT</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-enum-switches">OID_NIC_SWITCH_ENUM_SWITCHES</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-nic-switch-vport-parameters">OID_NIC_SWITCH_VPORT_PARAMETERS</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_nic_switch_vport_parameters">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddndis/ns-ntddndis-_ndis_nic_switch_vport_parameters.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
