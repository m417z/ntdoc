<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="VOLUME_BITMAP_BUFFER - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>VOLUME_BITMAP_BUFFER - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            VOLUME_BITMAP_BUFFER - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntifs.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct {
  LARGE_INTEGER StartingLcn;
  LARGE_INTEGER BitmapSize;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a>         Buffer[1];
} VOLUME_BITMAP_BUFFER, *PVOLUME_BITMAP_BUFFER;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/ns-ntifs-volume_bitmap_buffer">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// winioctl.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct {
  LARGE_INTEGER StartingLcn;
  LARGE_INTEGER BitmapSize;
  <a href="byte" title="typedef unsigned char BYTE;">BYTE</a>          Buffer[1];
} VOLUME_BITMAP_BUFFER, *PVOLUME_BITMAP_BUFFER;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-volume_bitmap_buffer">View the official Win32 API reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/volume_bitmap_buffer.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntifs-volume_bitmap_buffer)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2 id="description">Description</h2>

<p>The <strong>VOLUME_BITMAP_BUFFER</strong> structure contains a bitmap of occupied and available clusters on a disk. This structure is the output buffer for the <strong><a href="fsctl_get_volume_bitmap" title="// CTL_CODE(0x0009, 0x01b, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define FSCTL_GET_VOLUME_BITMAP 0x0009006F">FSCTL_GET_VOLUME_BITMAP</a></strong> control code.</p>

<h2 id="members">Members</h2>

<h3 id="startinglcn"><code>StartingLcn</code></h3>

<p>Starting logical cluster number (LCN) requested as an input to the operation.</p>

<h3 id="bitmapsize"><code>BitmapSize</code></h3>

<p>Number of clusters on the volume, starting from the starting LCN returned in <strong>StartingLcn</strong>.</p>

<h3 id="buffer1"><code>Buffer[1]</code></h3>

<p>Array of bytes containing the bitmap that the operation returns. The bitmap is bitwise from bit zero of the bitmap to the end. Thus, starting at the requested cluster, the bitmap goes from bit 0 of byte 0, bit 1 of byte 0 ... bit 7 of byte 0, bit 0 of byte 1, and so on. The value 1 indicates that the cluster is allocated (in use). The value 0 indicates that the cluster is not allocated (free).</p>

<h2 id="remarks">Remarks</h2>

<p><strong>BitmapSize</strong> is the number of clusters on the volume starting from <strong>StartingLcn</strong>. For example, suppose there are 0xD3F7 clusters on the volume. If you start the bitmap query at LCN 0xA007, then both the FAT and NTFS file systems will round down the returned starting LCN to LCN 0xA000. The value returned in the <strong>BitmapSize</strong> member will be (0xD3F7 – 0xA000), or 0x33F7.</p>

<h2 id="see-also">See also</h2>

<p><strong><a href="fsctl_get_volume_bitmap" title="// CTL_CODE(0x0009, 0x01b, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define FSCTL_GET_VOLUME_BITMAP 0x0009006F">FSCTL_GET_VOLUME_BITMAP</a></strong></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/ns-ntifs-volume_bitmap_buffer">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntifs/ns-ntifs-volume_bitmap_buffer.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Win32 API reference (ns-winioctl-volume_bitmap_buffer)</h1>
</div>
<div class="ntdoc-description">
<h1>VOLUME_BITMAP_BUFFER structure</h1>

<h2>Description</h2>

<p>Represents the occupied and available clusters on a disk. This structure is the output buffer for the
<a href="fsctl_get_volume_bitmap" title="// CTL_CODE(0x0009, 0x01b, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define FSCTL_GET_VOLUME_BITMAP 0x0009006F">FSCTL_GET_VOLUME_BITMAP</a> control code.</p>

<h2>Members</h2>

<h3><code>StartingLcn</code></h3>

<p>Starting LCN requested as an input to the operation.</p>

<h3><code>BitmapSize</code></h3>

<p>The number of clusters on the volume, starting from the starting LCN returned in the <strong>StartingLcn</strong> member of this structure. See the following Remarks section for details.</p>

<h3><code>Buffer</code></h3>

<p>Array of bytes containing the bitmap that the operation returns. The bitmap is bitwise from bit zero of the bitmap to the end. Thus, starting at the requested cluster, the bitmap goes from bit 0 of byte 0, bit 1 of byte 0 ... bit 7 of byte 0, bit 0 of byte 1, and so on. The value 1 indicates that the cluster is allocated (in use). The value 0 indicates that the cluster is not allocated (free).</p>

<h2>Remarks</h2>

<p>The <strong>BitmapSize</strong> member is the number of clusters on the volume starting from the starting LCN returned in the <strong>StartingLcn</strong> member of this structure. For example, suppose there are 0xD3F7 clusters on the volume. If you start the bitmap query at LCN 0xA007, then both the FAT and NTFS file systems will round down the returned starting LCN to LCN 0xA000. The value returned in the <strong>BitmapSize</strong> member will be (0xD3F7 – 0xA000), or 0x33F7.</p>

<h2>See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/desktop/FileIO/defragmenting-files">Defragmentation</a></p>

<p><a href="fsctl_get_volume_bitmap" title="// CTL_CODE(0x0009, 0x01b, METHOD_NEITHER, FILE_ANY_ACCESS)&#10;#define FSCTL_GET_VOLUME_BITMAP 0x0009006F">FSCTL_GET_VOLUME_BITMAP</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows/win32/api/winioctl/ns-winioctl-volume_bitmap_buffer">View the official Win32 API reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/sdk-api/blob/docs/sdk-api-src/content/winioctl/ns-winioctl-volume_bitmap_buffer.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
