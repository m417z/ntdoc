<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="RtlGetElementGenericTableAvl - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>RtlGetElementGenericTableAvl - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            RtlGetElementGenericTableAvl - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTRTL_H

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">_Check_return_
NTSYSAPI
PVOID
NTAPI
RtlGetElementGenericTableAvl(
    _In_ <a href="rtl_avl_table" title="typedef struct _RTL_AVL_TABLE&#10;{&#10;    RTL_BALANCED_LINKS BalancedRoot;&#10;    PVOID OrderedPointer;&#10;    ULONG WhichOrderedElement;&#10;    ULONG NumberGenericTableElements;&#10;    ULONG DepthOfTree;&#10;    PRTL_BALANCED_LINKS RestartKey;&#10;    ULONG DeleteCount;&#10;    PRTL_AVL_COMPARE_ROUTINE CompareRoutine;&#10;    PRTL_AVL_ALLOCATE_ROUTINE AllocateRoutine;&#10;    PRTL_AVL_FREE_ROUTINE FreeRoutine;&#10;    PVOID TableContext;&#10;} RTL_AVL_TABLE, *PRTL_AVL_TABLE;">PRTL_AVL_TABLE</a> Table,
    _In_ <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> I
    );
</span><span class="ntdoc-code-footer">
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/c7a74aeca340d1e3528acaa99b3405f36f41899f/phnt/include/ntrtl.h#L614">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NTSYSAPI PVOID RtlGetElementGenericTableAvl(
  [in] <a href="rtl_avl_table" title="typedef struct _RTL_AVL_TABLE&#10;{&#10;    RTL_BALANCED_LINKS BalancedRoot;&#10;    PVOID OrderedPointer;&#10;    ULONG WhichOrderedElement;&#10;    ULONG NumberGenericTableElements;&#10;    ULONG DepthOfTree;&#10;    PRTL_BALANCED_LINKS RestartKey;&#10;    ULONG DeleteCount;&#10;    PRTL_AVL_COMPARE_ROUTINE CompareRoutine;&#10;    PRTL_AVL_ALLOCATE_ROUTINE AllocateRoutine;&#10;    PRTL_AVL_FREE_ROUTINE FreeRoutine;&#10;    PVOID TableContext;&#10;} RTL_AVL_TABLE, *PRTL_AVL_TABLE;">PRTL_AVL_TABLE</a> Table,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>          I
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddk/nf-ntddk-rtlgetelementgenerictableavl">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<p>This function is <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/nf-ntddk-rtlgetelementgenerictableavl">documented in Windows Driver Kit</a>.</p>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/rtlgetelementgenerictableavl.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ntddk-rtlgetelementgenerictableavl)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="rtlgetelementgenerictableavl-function">RtlGetElementGenericTableAvl function</h1>

<h2 id="description">Description</h2>

<p>The <strong>RtlGetElementGenericTableAvl</strong> routine returns a pointer to the caller-supplied data for a particular generic Adelson-Velsky/Landis (AVL) table element.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="table-in"><code>Table</code> [in]</h3>

<p>Pointer to the generic AVL table (<a href="rtl_avl_table" title="typedef struct _RTL_AVL_TABLE&#10;{&#10;    RTL_BALANCED_LINKS BalancedRoot;&#10;    PVOID OrderedPointer;&#10;    ULONG WhichOrderedElement;&#10;    ULONG NumberGenericTableElements;&#10;    ULONG DepthOfTree;&#10;    PRTL_BALANCED_LINKS RestartKey;&#10;    ULONG DeleteCount;&#10;    PRTL_AVL_COMPARE_ROUTINE CompareRoutine;&#10;    PRTL_AVL_ALLOCATE_ROUTINE AllocateRoutine;&#10;    PRTL_AVL_FREE_ROUTINE FreeRoutine;&#10;    PVOID TableContext;&#10;} RTL_AVL_TABLE, *PRTL_AVL_TABLE;">RTL_AVL_TABLE</a>) from which the <em>I</em>th element is to be retrieved. The table must have been initialized by calling <a href="rtlinitializegenerictableavl" title="NTSYSAPI&#10;VOID&#10;NTAPI&#10;RtlInitializeGenericTableAvl(&#10;    _Out_ PRTL_AVL_TABLE Table,&#10;    _In_ PRTL_AVL_COMPARE_ROUTINE CompareRoutine,&#10;    _In_ PRTL_AVL_ALLOCATE_ROUTINE AllocateRoutine,&#10;    _In_ PRTL_AVL_FREE_ROUTINE FreeRoutine,&#10;    _In_opt_ PVOID TableContext&#10;    );">RtlInitializeGenericTableAvl</a>.</p>

<h3 id="i-in"><code>I</code> [in]</h3>

<p>Index of the element selected. This value is zero-based, so the index of the last-inserted element currently in <em>Table</em> is always one less than the value returned by <a href="rtlnumbergenerictableelementsavl" title="NTSYSAPI&#10;ULONG&#10;NTAPI&#10;RtlNumberGenericTableElementsAvl(&#10;    _In_ PRTL_AVL_TABLE Table&#10;    );">RtlNumberGenericTableElementsAvl</a>.</p>

<h2 id="return-value">Return value</h2>

<p><strong>RtlGetElementGenericTableAvl</strong> returns a pointer to the caller-supplied data for the <em>I</em>th element in the generic AVL table. It returns <strong>NULL</strong> if the given <em>I</em> is too large or if the generic AVL table currently has no elements.</p>

<h2 id="remarks">Remarks</h2>

<p><strong>RtlGetElementGenericTableAvl</strong> returns the <em>I</em>th element inserted in the generic AVL table. To retrieve the first element, set <em>I</em> to zero. To retrieve the last element, set <em>I</em> to (<a href="rtlnumbergenerictableelementsavl" title="NTSYSAPI&#10;ULONG&#10;NTAPI&#10;RtlNumberGenericTableElementsAvl(&#10;    _In_ PRTL_AVL_TABLE Table&#10;    );">RtlNumberGenericTableElementsAvl</a>(<em>Table</em>)-1). Note that if an element is deleted from the generic table, the indexes of all elements inserted after the deleted element are decremented. Thus an element's index might change over time.</p>

<p><strong>RtlGetElementGenericTableAvl</strong> is more efficient than <a href="rtllookupelementgenerictableavl" title="_Check_return_&#10;NTSYSAPI&#10;PVOID&#10;NTAPI&#10;RtlLookupElementGenericTableAvl(&#10;    _In_ PRTL_AVL_TABLE Table,&#10;    _In_ PVOID Buffer&#10;    );">RtlLookupElementGenericTableAvl</a> if the caller can supply the index of a particular element for which the caller needs access to the associated data. However, calling <strong>RtlGetElementGenericTableAvl</strong> repeatedly to test for such an element is less efficient than calling <strong><a href="rtllookupelementgenerictableavl" title="_Check_return_&#10;NTSYSAPI&#10;PVOID&#10;NTAPI&#10;RtlLookupElementGenericTableAvl(&#10;    _In_ PRTL_AVL_TABLE Table,&#10;    _In_ PVOID Buffer&#10;    );">RtlLookupElementGenericTableAvl</a></strong> to locate it.</p>

<p>Callers of the Rtl..GenericTable routines are responsible for exclusively synchronizing access to the generic table. An exclusive fast mutex is the most efficient synchronization mechanism to use for this purpose.</p>

<p>By default, the operating system uses splay trees to implement generic tables. Under some circumstances, operations on a splay tree will make the tree deep and narrow and might even turn it into a straight line. Very deep trees degrade the performance of searches. You can ensure a more balanced, shallower tree implementation of generic tables by using Adelson-Velsky/Landis (AVL) trees. If you want to configure the generic table routines to use AVL trees instead of splay trees in your driver, insert the following define statement in a common header file before including <em>Ntddk.h</em>:</p>

<p><code>#define RTL_USE_AVL_TABLES 0</code></p>

<p>If RTL_USE_AVL_TABLES is not defined, you must use the AVL form of the generic table routines. For example, use the <strong>RtlGetElementGenericTableAvl</strong> routine instead of <a href="rtlgetelementgenerictable" title="_Check_return_&#10;NTSYSAPI&#10;PVOID&#10;NTAPI&#10;RtlGetElementGenericTable(&#10;    _In_ PRTL_GENERIC_TABLE Table,&#10;    _In_ ULONG I&#10;    );">RtlGetElementGenericTable</a>. In the call to <strong>RtlGetElementGenericTableAvl</strong>, the caller must pass a <a href="rtl_avl_table" title="typedef struct _RTL_AVL_TABLE&#10;{&#10;    RTL_BALANCED_LINKS BalancedRoot;&#10;    PVOID OrderedPointer;&#10;    ULONG WhichOrderedElement;&#10;    ULONG NumberGenericTableElements;&#10;    ULONG DepthOfTree;&#10;    PRTL_BALANCED_LINKS RestartKey;&#10;    ULONG DeleteCount;&#10;    PRTL_AVL_COMPARE_ROUTINE CompareRoutine;&#10;    PRTL_AVL_ALLOCATE_ROUTINE AllocateRoutine;&#10;    PRTL_AVL_FREE_ROUTINE FreeRoutine;&#10;    PVOID TableContext;&#10;} RTL_AVL_TABLE, *PRTL_AVL_TABLE;">RTL_AVL_TABLE</a> table structure rather than <a href="rtl_generic_table" title="typedef struct _RTL_GENERIC_TABLE&#10;{&#10;    PRTL_SPLAY_LINKS TableRoot;&#10;    LIST_ENTRY InsertOrderList;&#10;    PLIST_ENTRY OrderedPointer;&#10;    ULONG WhichOrderedElement;&#10;    ULONG NumberGenericTableElements;&#10;    PRTL_GENERIC_COMPARE_ROUTINE CompareRoutine;&#10;    PRTL_GENERIC_ALLOCATE_ROUTINE AllocateRoutine;&#10;    PRTL_GENERIC_FREE_ROUTINE FreeRoutine;&#10;    PVOID TableContext;&#10;} RTL_GENERIC_TABLE, *PRTL_GENERIC_TABLE;">RTL_GENERIC_TABLE</a>.</p>

<p>Callers of <strong>RtlGetElementGenericTableAvl</strong> must be running at IRQL &lt; DISPATCH_LEVEL if the caller-allocated memory for the generic table is pageable.</p>

<h2 id="see-also">See also</h2>

<p><a href="rtldeleteelementgenerictableavl" title="NTSYSAPI&#10;BOOLEAN&#10;NTAPI&#10;RtlDeleteElementGenericTableAvl(&#10;    _In_ PRTL_AVL_TABLE Table,&#10;    _In_ PVOID Buffer&#10;    );">RtlDeleteElementGenericTableAvl</a></p>

<p><a href="rtlenumerategenerictablewithoutsplayingavl" title="_Check_return_&#10;NTSYSAPI&#10;PVOID&#10;NTAPI&#10;RtlEnumerateGenericTableWithoutSplayingAvl(&#10;    _In_ PRTL_AVL_TABLE Table,&#10;    _Inout_ PVOID *RestartKey&#10;    );">RtlEnumerateGenericTableWithoutSplayingAvl</a></p>

<p><a href="rtlinitializegenerictableavl" title="NTSYSAPI&#10;VOID&#10;NTAPI&#10;RtlInitializeGenericTableAvl(&#10;    _Out_ PRTL_AVL_TABLE Table,&#10;    _In_ PRTL_AVL_COMPARE_ROUTINE CompareRoutine,&#10;    _In_ PRTL_AVL_ALLOCATE_ROUTINE AllocateRoutine,&#10;    _In_ PRTL_AVL_FREE_ROUTINE FreeRoutine,&#10;    _In_opt_ PVOID TableContext&#10;    );">RtlInitializeGenericTableAvl</a></p>

<p><a href="rtlinsertelementgenerictableavl" title="NTSYSAPI&#10;PVOID&#10;NTAPI&#10;RtlInsertElementGenericTableAvl(&#10;    _In_ PRTL_AVL_TABLE Table,&#10;    _In_reads_bytes_(BufferSize) PVOID Buffer,&#10;    _In_ CLONG BufferSize,&#10;    _Out_opt_ PBOOLEAN NewElement&#10;    );">RtlInsertElementGenericTableAvl</a></p>

<p><a href="rtllookupelementgenerictableavl" title="_Check_return_&#10;NTSYSAPI&#10;PVOID&#10;NTAPI&#10;RtlLookupElementGenericTableAvl(&#10;    _In_ PRTL_AVL_TABLE Table,&#10;    _In_ PVOID Buffer&#10;    );">RtlLookupElementGenericTableAvl</a></p>

<p><a href="rtlnumbergenerictableelementsavl" title="NTSYSAPI&#10;ULONG&#10;NTAPI&#10;RtlNumberGenericTableElementsAvl(&#10;    _In_ PRTL_AVL_TABLE Table&#10;    );">RtlNumberGenericTableElementsAvl</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddk/nf-ntddk-rtlgetelementgenerictableavl">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddk/nf-ntddk-rtlgetelementgenerictableavl.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
