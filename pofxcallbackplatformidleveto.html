<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="POFXCALLBACKPLATFORMIDLEVETO - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>POFXCALLBACKPLATFORMIDLEVETO - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            POFXCALLBACKPLATFORMIDLEVETO - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// pep_x.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">POFXCALLBACKPLATFORMIDLEVETO Pofxcallbackplatformidleveto;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> Pofxcallbackplatformidleveto(
  [in] POHANDLE ProcessorHandle,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> PlatformState,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> VetoReason,
  [in] BOOLEAN Increment
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pep_x/nc-pep_x-pofxcallbackplatformidleveto">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// pepfx.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">POFXCALLBACKPLATFORMIDLEVETO Pofxcallbackplatformidleveto;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> Pofxcallbackplatformidleveto(
  [in] POHANDLE ProcessorHandle,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> PlatformState,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> VetoReason,
  [in] BOOLEAN Increment
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pepfx/nc-pepfx-pofxcallbackplatformidleveto">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pofxcallbackplatformidleveto.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-pep_x-pofxcallbackplatformidleveto)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pofxcallbackplatformidleveto-callback-function-pep_xh">POFXCALLBACKPLATFORMIDLEVETO callback function (pep_x.h)</h1>

<h2 id="description">Description</h2>

<p>The <strong><a href="platformidleveto" title="#define PlatformIdleVeto 82 // in: (kernel-mode only) // deprecated">PlatformIdleVeto</a></strong> routine increments or decrements the veto count for a veto code for a platform idle state.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="processorhandle-in"><code>ProcessorHandle</code> [in]</h3>

<p>A POHANDLE value that represents the registration of the processor (as a device) with <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_kernel/#device-power-management">power management framework</a> (PoFx). The platform extension plug-in (PEP) previously received this handle from PoFx during the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pepfx/ns-pepfx-_pep_register_crashdump_device">PEP_DPM_REGISTER_DEVICE</a> notification that informed the PEP that the processor had been registered with PoFx.</p>

<h3 id="platformstate-in"><code>PlatformState</code> [in]</h3>

<p>The index of the platform idle state whose veto count is being incremented or decremented. The PEP previously specified the supported platform idle states in response to a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pepfx/ns-pepfx-_pep_ppm_query_platform_states">PEP_NOTIFY_PPM_QUERY_PLATFORM_STATES</a> notification. If the PEP specified N platform idle states, valid platform idle state indexes range from 0 to Nâ€“1.</p>

<h3 id="vetoreason-in"><code>VetoReason</code> [in]</h3>

<p>A PEP-defined veto code that indicates why the platform idle state cannot be entered. The PEP previously specified the number of supported veto reasons in response to a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pepfx/ns-pepfx-_pep_ppm_query_veto_reason">PEP_NOTIFY_PPM_QUERY_VETO_REASONS</a> notification. If the PEP specified M veto reasons, valid veto codes range from 1 to M.</p>

<h3 id="increment-in"><code>Increment</code> [in]</h3>

<p>Whether to increment or decrement the veto count. Set to TRUE to increment the veto count for this veto reason, or to FALSE to decrement the count.</p>

<h2 id="return-value">Return value</h2>

<p><strong><a href="platformidleveto" title="#define PlatformIdleVeto 82 // in: (kernel-mode only) // deprecated">PlatformIdleVeto</a></strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the call successfully increments or decrements the veto count. Possible error return values include the following status code.</p>

<table>
<thead>
<tr>
  <th>Return value</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>STATUS_NOT_IMPLEMENTED</td>
  <td>Indicates that the <strong><a href="platformidleveto" title="#define PlatformIdleVeto 82 // in: (kernel-mode only) // deprecated">PlatformIdleVeto</a></strong> routine is not implemented for this processor.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>This routine is implemented by the PoFx and is called by the PEP. The <strong><a href="platformidleveto" title="#define PlatformIdleVeto 82 // in: (kernel-mode only) // deprecated">PlatformIdleVeto</a></strong> member of the <a href="pep_kernel_information_struct_v3" title="typedef struct _PEP_KERNEL_INFORMATION_STRUCT_V3 {&#10;  USHORT                                   Version;&#10;  USHORT                                   Size;&#10;  POHANDLE                                 Plugin;&#10;  PPOFXCALLBACKREQUESTWORKER               RequestWorker;&#10;  PPOFXCALLBACKENUMERATEUNMASKEDINTERRUPTS EnumerateUnmaskedInterrupts;&#10;  PPOFXCALLBACKPROCESSORHALT               ProcessorHalt;&#10;  PPOFXCALLBACKREQUESTINTERRUPT            RequestInterrupt;&#10;  PPOFXCALLBACKCRITICALRESOURCE            TransitionCriticalResource;&#10;  PPOFXCALLBACKPROCESSORIDLEVETO           ProcessorIdleVeto;&#10;  PPOFXCALLBACKPLATFORMIDLEVETO            PlatformIdleVeto;&#10;  PPOFXCALLBACKUPDATEPROCESSORIDLESTATE    UpdateProcessorIdleState;&#10;  PPOFXCALLBACKUPDATEPLATFORMIDLESTATE     UpdatePlatformIdleState;&#10;  PPOFXCALLBACKREQUESTCOMMON               RequestCommon;&#10;} PEP_KERNEL_INFORMATION_STRUCT_V3, *PPEP_KERNEL_INFORMATION_STRUCT_V3;">PEP_KERNEL_INFORMATION_STRUCT_V3</a> structure is a pointer to a <strong><a href="platformidleveto" title="#define PlatformIdleVeto 82 // in: (kernel-mode only) // deprecated">PlatformIdleVeto</a></strong> routine.</p>

<p>After the PEP handles the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pepfx/ns-pepfx-_pep_ppm_query_platform_states">PEP_NOTIFY_PPM_QUERY_PLATFORM_STATES</a> notification, each platform idle state starts with a veto count of zero for all veto codes. The PEP can increment the veto count of a veto code to prevent the operating system from transitioning the platform to this idle state. The PEP decrements the veto count when the veto reason that caused the count to be incremented is no longer in effect. Only after the count for all veto codes has decremented to zero is the operating system allowed to transition the platform to this idle state.</p>

<p>This routine must be called at IRQL = PASSIVE_LEVEL.</p>

<h2 id="see-also">See also</h2>

<p><a href="pep_kernel_information_struct_v3" title="typedef struct _PEP_KERNEL_INFORMATION_STRUCT_V3 {&#10;  USHORT                                   Version;&#10;  USHORT                                   Size;&#10;  POHANDLE                                 Plugin;&#10;  PPOFXCALLBACKREQUESTWORKER               RequestWorker;&#10;  PPOFXCALLBACKENUMERATEUNMASKEDINTERRUPTS EnumerateUnmaskedInterrupts;&#10;  PPOFXCALLBACKPROCESSORHALT               ProcessorHalt;&#10;  PPOFXCALLBACKREQUESTINTERRUPT            RequestInterrupt;&#10;  PPOFXCALLBACKCRITICALRESOURCE            TransitionCriticalResource;&#10;  PPOFXCALLBACKPROCESSORIDLEVETO           ProcessorIdleVeto;&#10;  PPOFXCALLBACKPLATFORMIDLEVETO            PlatformIdleVeto;&#10;  PPOFXCALLBACKUPDATEPROCESSORIDLESTATE    UpdateProcessorIdleState;&#10;  PPOFXCALLBACKUPDATEPLATFORMIDLESTATE     UpdatePlatformIdleState;&#10;  PPOFXCALLBACKREQUESTCOMMON               RequestCommon;&#10;} PEP_KERNEL_INFORMATION_STRUCT_V3, *PPEP_KERNEL_INFORMATION_STRUCT_V3;">PEP_KERNEL_INFORMATION_STRUCT_V3</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pepfx/ns-pepfx-_pep_ppm_query_platform_states">PEP_NOTIFY_PPM_QUERY_PLATFORM_STATES</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pepfx/ns-pepfx-_pep_ppm_query_veto_reason">PEP_NOTIFY_PPM_QUERY_VETO_REASONS</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pep_x/nc-pep_x-pofxcallbackplatformidleveto">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/pep_x/nc-pep_x-pofxcallbackplatformidleveto.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-pepfx-pofxcallbackplatformidleveto)</h1>
</div>
<div class="ntdoc-description">
<h1>POFXCALLBACKPLATFORMIDLEVETO callback function (pepfx.h)</h1>

<h2>Description</h2>

<p>The <strong><a href="platformidleveto" title="#define PlatformIdleVeto 82 // in: (kernel-mode only) // deprecated">PlatformIdleVeto</a></strong> routine increments or decrements the veto count for a veto code for a platform idle state.</p>

<h2>Parameters</h2>

<h3><code>ProcessorHandle</code> [in]</h3>

<p>A POHANDLE value that represents the registration of the processor (as a device) with <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_kernel/#device-power-management">power management framework</a> (PoFx). The platform extension plug-in (PEP) previously received this handle from PoFx during the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pepfx/ns-pepfx-_pep_register_crashdump_device">PEP_DPM_REGISTER_DEVICE</a> notification that informed the PEP that the processor had been registered with PoFx.</p>

<h3><code>PlatformState</code> [in]</h3>

<p>The index of the platform idle state whose veto count is being incremented or decremented. The PEP previously specified the supported platform idle states in response to a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pepfx/ns-pepfx-_pep_ppm_query_platform_states">PEP_NOTIFY_PPM_QUERY_PLATFORM_STATES</a> notification. If the PEP specified N platform idle states, valid platform idle state indexes range from 0 to Nâ€“1.</p>

<h3><code>VetoReason</code> [in]</h3>

<p>A PEP-defined veto code that indicates why the platform idle state cannot be entered. The PEP previously specified the number of supported veto reasons in response to a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pepfx/ns-pepfx-_pep_ppm_query_veto_reason">PEP_NOTIFY_PPM_QUERY_VETO_REASONS</a> notification. If the PEP specified M veto reasons, valid veto codes range from 1 to M.</p>

<h3><code>Increment</code> [in]</h3>

<p>Whether to increment or decrement the veto count. Set to TRUE to increment the veto count for this veto reason, or to FALSE to decrement the count.</p>

<h2>Return value</h2>

<p><strong><a href="platformidleveto" title="#define PlatformIdleVeto 82 // in: (kernel-mode only) // deprecated">PlatformIdleVeto</a></strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the call successfully increments or decrements the veto count. Possible error return values include the following status code.</p>

<table>
<thead>
<tr>
  <th>Return value</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>STATUS_NOT_IMPLEMENTED</td>
  <td>Indicates that the <strong><a href="platformidleveto" title="#define PlatformIdleVeto 82 // in: (kernel-mode only) // deprecated">PlatformIdleVeto</a></strong> routine is not implemented for this processor.</td>
</tr>
</tbody>
</table>

<h2>Remarks</h2>

<p>This routine is implemented by the PoFx and is called by the PEP. The <strong><a href="platformidleveto" title="#define PlatformIdleVeto 82 // in: (kernel-mode only) // deprecated">PlatformIdleVeto</a></strong> member of the <a href="pep_kernel_information_struct_v3" title="typedef struct _PEP_KERNEL_INFORMATION_STRUCT_V3 {&#10;  USHORT                                   Version;&#10;  USHORT                                   Size;&#10;  POHANDLE                                 Plugin;&#10;  PPOFXCALLBACKREQUESTWORKER               RequestWorker;&#10;  PPOFXCALLBACKENUMERATEUNMASKEDINTERRUPTS EnumerateUnmaskedInterrupts;&#10;  PPOFXCALLBACKPROCESSORHALT               ProcessorHalt;&#10;  PPOFXCALLBACKREQUESTINTERRUPT            RequestInterrupt;&#10;  PPOFXCALLBACKCRITICALRESOURCE            TransitionCriticalResource;&#10;  PPOFXCALLBACKPROCESSORIDLEVETO           ProcessorIdleVeto;&#10;  PPOFXCALLBACKPLATFORMIDLEVETO            PlatformIdleVeto;&#10;  PPOFXCALLBACKUPDATEPROCESSORIDLESTATE    UpdateProcessorIdleState;&#10;  PPOFXCALLBACKUPDATEPLATFORMIDLESTATE     UpdatePlatformIdleState;&#10;  PPOFXCALLBACKREQUESTCOMMON               RequestCommon;&#10;} PEP_KERNEL_INFORMATION_STRUCT_V3, *PPEP_KERNEL_INFORMATION_STRUCT_V3;">PEP_KERNEL_INFORMATION_STRUCT_V3</a> structure is a pointer to a <strong><a href="platformidleveto" title="#define PlatformIdleVeto 82 // in: (kernel-mode only) // deprecated">PlatformIdleVeto</a></strong> routine.</p>

<p>After the PEP handles the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pepfx/ns-pepfx-_pep_ppm_query_platform_states">PEP_NOTIFY_PPM_QUERY_PLATFORM_STATES</a> notification, each platform idle state starts with a veto count of zero for all veto codes. The PEP can increment the veto count of a veto code to prevent the operating system from transitioning the platform to this idle state. The PEP decrements the veto count when the veto reason that caused the count to be incremented is no longer in effect. Only after the count for all veto codes has decremented to zero is the operating system allowed to transition the platform to this idle state.</p>

<p>This routine must be called at IRQL = PASSIVE_LEVEL.</p>

<h2>See also</h2>

<p><a href="pep_kernel_information_struct_v3" title="typedef struct _PEP_KERNEL_INFORMATION_STRUCT_V3 {&#10;  USHORT                                   Version;&#10;  USHORT                                   Size;&#10;  POHANDLE                                 Plugin;&#10;  PPOFXCALLBACKREQUESTWORKER               RequestWorker;&#10;  PPOFXCALLBACKENUMERATEUNMASKEDINTERRUPTS EnumerateUnmaskedInterrupts;&#10;  PPOFXCALLBACKPROCESSORHALT               ProcessorHalt;&#10;  PPOFXCALLBACKREQUESTINTERRUPT            RequestInterrupt;&#10;  PPOFXCALLBACKCRITICALRESOURCE            TransitionCriticalResource;&#10;  PPOFXCALLBACKPROCESSORIDLEVETO           ProcessorIdleVeto;&#10;  PPOFXCALLBACKPLATFORMIDLEVETO            PlatformIdleVeto;&#10;  PPOFXCALLBACKUPDATEPROCESSORIDLESTATE    UpdateProcessorIdleState;&#10;  PPOFXCALLBACKUPDATEPLATFORMIDLESTATE     UpdatePlatformIdleState;&#10;  PPOFXCALLBACKREQUESTCOMMON               RequestCommon;&#10;} PEP_KERNEL_INFORMATION_STRUCT_V3, *PPEP_KERNEL_INFORMATION_STRUCT_V3;">PEP_KERNEL_INFORMATION_STRUCT_V3</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pepfx/ns-pepfx-_pep_ppm_query_platform_states">PEP_NOTIFY_PPM_QUERY_PLATFORM_STATES</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pepfx/ns-pepfx-_pep_ppm_query_veto_reason">PEP_NOTIFY_PPM_QUERY_VETO_REASONS</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/pepfx/nc-pepfx-pofxcallbackplatformidleveto">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/pepfx/nc-pepfx-pofxcallbackplatformidleveto.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
