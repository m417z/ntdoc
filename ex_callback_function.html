<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="EX_CALLBACK_FUNCTION - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>EX_CALLBACK_FUNCTION - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github.ntdoc.min.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github-dark-dimmed.ntdoc.min.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            EX_CALLBACK_FUNCTION - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">EX_CALLBACK_FUNCTION ExCallbackFunction;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> ExCallbackFunction(
  [in]           PVOID CallbackContext,
  [in, optional] PVOID Argument1,
  [in, optional] PVOID Argument2
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-ex_callback_function">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ex_callback_function.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-wdm-ex_callback_function)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>EX_CALLBACK_FUNCTION callback function</h1>
<h2>Description</h2>
<p>A filter driver's <em>RegistryCallback</em> routine can monitor, block, or modify a registry operation.</p>
<h2>Parameters</h2>
<h3><code>CallbackContext</code> [in]</h3>
<p>The value that the driver passed as the <em>Context</em> parameter to <a href="cmregistercallback" title="NTSTATUS CmRegisterCallback(&#10;  [in]           PEX_CALLBACK_FUNCTION Function,&#10;  [in, optional] PVOID                 Context,&#10;  [out]          PLARGE_INTEGER        Cookie&#10;);">CmRegisterCallback</a> or <a href="cmregistercallbackex" title="NTSTATUS CmRegisterCallbackEx(&#10;  [in]           PEX_CALLBACK_FUNCTION Function,&#10;  [in]           PCUNICODE_STRING      Altitude,&#10;  [in]           PVOID                 Driver,&#10;  [in, optional] PVOID                 Context,&#10;  [out]          PLARGE_INTEGER        Cookie,&#10;                 PVOID                 Reserved&#10;);">CmRegisterCallbackEx</a> when it registered this <em>RegistryCallback</em> routine.</p>
<h3><code>Argument1</code> [in, optional]</h3>
<p>A <strong><a href="reg_notify_class" title="typedef enum _REG_NOTIFY_CLASS {&#10;  RegNtDeleteKey,&#10;  RegNtPreDeleteKey,&#10;  RegNtSetValueKey,&#10;  RegNtPreSetValueKey,&#10;  RegNtDeleteValueKey,&#10;  RegNtPreDeleteValueKey,&#10;  RegNtSetInformationKey,&#10;  RegNtPreSetInformationKey,&#10;  RegNtRenameKey,&#10;  RegNtPreRenameKey,&#10;  RegNtEnumerateKey,&#10;  RegNtPreEnumerateKey,&#10;  RegNtEnumerateValueKey,&#10;  RegNtPreEnumerateValueKey,&#10;  RegNtQueryKey,&#10;  RegNtPreQueryKey,&#10;  RegNtQueryValueKey,&#10;  RegNtPreQueryValueKey,&#10;  RegNtQueryMultipleValueKey,&#10;...">REG_NOTIFY_CLASS</a></strong>-typed value that identifies the type of registry operation that is being performed and whether the <em>RegistryCallback</em> routine is being called before or after the registry operation is performed.</p>
<h3><code>Argument2</code> [in, optional]</h3>
<p>A pointer to a structure that contains information that is specific to the type of registry operation. The structure type depends on the <strong><a href="reg_notify_class" title="typedef enum _REG_NOTIFY_CLASS {&#10;  RegNtDeleteKey,&#10;  RegNtPreDeleteKey,&#10;  RegNtSetValueKey,&#10;  RegNtPreSetValueKey,&#10;  RegNtDeleteValueKey,&#10;  RegNtPreDeleteValueKey,&#10;  RegNtSetInformationKey,&#10;  RegNtPreSetInformationKey,&#10;  RegNtRenameKey,&#10;  RegNtPreRenameKey,&#10;  RegNtEnumerateKey,&#10;  RegNtPreEnumerateKey,&#10;  RegNtEnumerateValueKey,&#10;  RegNtPreEnumerateValueKey,&#10;  RegNtQueryKey,&#10;  RegNtPreQueryKey,&#10;  RegNtQueryValueKey,&#10;  RegNtPreQueryValueKey,&#10;  RegNtQueryMultipleValueKey,&#10;...">REG_NOTIFY_CLASS</a></strong>-typed value for <em>Argument1</em>, as shown in the following table. For information about which <a href="reg_notify_class" title="typedef enum _REG_NOTIFY_CLASS {&#10;  RegNtDeleteKey,&#10;  RegNtPreDeleteKey,&#10;  RegNtSetValueKey,&#10;  RegNtPreSetValueKey,&#10;  RegNtDeleteValueKey,&#10;  RegNtPreDeleteValueKey,&#10;  RegNtSetInformationKey,&#10;  RegNtPreSetInformationKey,&#10;  RegNtRenameKey,&#10;  RegNtPreRenameKey,&#10;  RegNtEnumerateKey,&#10;  RegNtPreEnumerateKey,&#10;  RegNtEnumerateValueKey,&#10;  RegNtPreEnumerateValueKey,&#10;  RegNtQueryKey,&#10;  RegNtPreQueryKey,&#10;  RegNtQueryValueKey,&#10;  RegNtPreQueryValueKey,&#10;  RegNtQueryMultipleValueKey,&#10;...">REG_NOTIFY_CLASS</a>-typed values are available for which operating system versions, see <strong><a href="reg_notify_class" title="typedef enum _REG_NOTIFY_CLASS {&#10;  RegNtDeleteKey,&#10;  RegNtPreDeleteKey,&#10;  RegNtSetValueKey,&#10;  RegNtPreSetValueKey,&#10;  RegNtDeleteValueKey,&#10;  RegNtPreDeleteValueKey,&#10;  RegNtSetInformationKey,&#10;  RegNtPreSetInformationKey,&#10;  RegNtRenameKey,&#10;  RegNtPreRenameKey,&#10;  RegNtEnumerateKey,&#10;  RegNtPreEnumerateKey,&#10;  RegNtEnumerateValueKey,&#10;  RegNtPreEnumerateValueKey,&#10;  RegNtQueryKey,&#10;  RegNtPreQueryKey,&#10;  RegNtQueryValueKey,&#10;  RegNtPreQueryValueKey,&#10;  RegNtQueryMultipleValueKey,&#10;...">REG_NOTIFY_CLASS</a></strong>.</p>
<table>
<thead>
<tr>
<th><a href="reg_notify_class" title="typedef enum _REG_NOTIFY_CLASS {&#10;  RegNtDeleteKey,&#10;  RegNtPreDeleteKey,&#10;  RegNtSetValueKey,&#10;  RegNtPreSetValueKey,&#10;  RegNtDeleteValueKey,&#10;  RegNtPreDeleteValueKey,&#10;  RegNtSetInformationKey,&#10;  RegNtPreSetInformationKey,&#10;  RegNtRenameKey,&#10;  RegNtPreRenameKey,&#10;  RegNtEnumerateKey,&#10;  RegNtPreEnumerateKey,&#10;  RegNtEnumerateValueKey,&#10;  RegNtPreEnumerateValueKey,&#10;  RegNtQueryKey,&#10;  RegNtPreQueryKey,&#10;  RegNtQueryValueKey,&#10;  RegNtPreQueryValueKey,&#10;  RegNtQueryMultipleValueKey,&#10;...">REG_NOTIFY_CLASS</a> value</th>
<th>Structure type</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>RegNtDeleteKey</strong></td>
<td><a href="reg_delete_key_information" title="typedef struct _REG_DELETE_KEY_INFORMATION {&#10;  PVOID Object;&#10;  PVOID CallContext;&#10;  PVOID ObjectContext;&#10;  PVOID Reserved;&#10;} REG_DELETE_KEY_INFORMATION, *PREG_DELETE_KEY_INFORMATION, REG_FLUSH_KEY_INFORMATION, *PREG_FLUSH_KEY_INFORMATION;">REG_DELETE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreDeleteKey</strong></td>
<td><a href="reg_delete_key_information" title="typedef struct _REG_DELETE_KEY_INFORMATION {&#10;  PVOID Object;&#10;  PVOID CallContext;&#10;  PVOID ObjectContext;&#10;  PVOID Reserved;&#10;} REG_DELETE_KEY_INFORMATION, *PREG_DELETE_KEY_INFORMATION, REG_FLUSH_KEY_INFORMATION, *PREG_FLUSH_KEY_INFORMATION;">REG_DELETE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostDeleteKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtSetValueKey</strong></td>
<td><a href="reg_set_value_key_information" title="typedef struct _REG_SET_VALUE_KEY_INFORMATION {&#10;  PVOID           Object;&#10;  PUNICODE_STRING ValueName;&#10;  ULONG           TitleIndex;&#10;  ULONG           Type;&#10;  PVOID           Data;&#10;  ULONG           DataSize;&#10;  PVOID           CallContext;&#10;  PVOID           ObjectContext;&#10;  PVOID           Reserved;&#10;} REG_SET_VALUE_KEY_INFORMATION, *PREG_SET_VALUE_KEY_INFORMATION;">REG_SET_VALUE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreSetValueKey</strong></td>
<td><a href="reg_set_value_key_information" title="typedef struct _REG_SET_VALUE_KEY_INFORMATION {&#10;  PVOID           Object;&#10;  PUNICODE_STRING ValueName;&#10;  ULONG           TitleIndex;&#10;  ULONG           Type;&#10;  PVOID           Data;&#10;  ULONG           DataSize;&#10;  PVOID           CallContext;&#10;  PVOID           ObjectContext;&#10;  PVOID           Reserved;&#10;} REG_SET_VALUE_KEY_INFORMATION, *PREG_SET_VALUE_KEY_INFORMATION;">REG_SET_VALUE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostSetValueKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtDeleteValueKey</strong></td>
<td><a href="reg_delete_value_key_information" title="typedef struct _REG_DELETE_VALUE_KEY_INFORMATION {&#10;  PVOID           Object;&#10;  PUNICODE_STRING ValueName;&#10;  PVOID           CallContext;&#10;  PVOID           ObjectContext;&#10;  PVOID           Reserved;&#10;} REG_DELETE_VALUE_KEY_INFORMATION, *PREG_DELETE_VALUE_KEY_INFORMATION;">REG_DELETE_VALUE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreDeleteValueKey</strong></td>
<td><a href="reg_delete_value_key_information" title="typedef struct _REG_DELETE_VALUE_KEY_INFORMATION {&#10;  PVOID           Object;&#10;  PUNICODE_STRING ValueName;&#10;  PVOID           CallContext;&#10;  PVOID           ObjectContext;&#10;  PVOID           Reserved;&#10;} REG_DELETE_VALUE_KEY_INFORMATION, *PREG_DELETE_VALUE_KEY_INFORMATION;">REG_DELETE_VALUE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostDeleteValueKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtSetInformationKey</strong></td>
<td><a href="reg_set_information_key_information" title="typedef struct _REG_SET_INFORMATION_KEY_INFORMATION {&#10;  PVOID                     Object;&#10;  KEY_SET_INFORMATION_CLASS KeySetInformationClass;&#10;  PVOID                     KeySetInformation;&#10;  ULONG                     KeySetInformationLength;&#10;  PVOID                     CallContext;&#10;  PVOID                     ObjectContext;&#10;  PVOID                     Reserved;&#10;} REG_SET_INFORMATION_KEY_INFORMATION, *PREG_SET_INFORMATION_KEY_INFORMATION;">REG_SET_INFORMATION_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreSetInformationKey</strong></td>
<td><a href="reg_set_information_key_information" title="typedef struct _REG_SET_INFORMATION_KEY_INFORMATION {&#10;  PVOID                     Object;&#10;  KEY_SET_INFORMATION_CLASS KeySetInformationClass;&#10;  PVOID                     KeySetInformation;&#10;  ULONG                     KeySetInformationLength;&#10;  PVOID                     CallContext;&#10;  PVOID                     ObjectContext;&#10;  PVOID                     Reserved;&#10;} REG_SET_INFORMATION_KEY_INFORMATION, *PREG_SET_INFORMATION_KEY_INFORMATION;">REG_SET_INFORMATION_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostSetInformationKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtRenameKey</strong></td>
<td><a href="reg_rename_key_information" title="typedef struct _REG_RENAME_KEY_INFORMATION {&#10;  PVOID           Object;&#10;  PUNICODE_STRING NewName;&#10;  PVOID           CallContext;&#10;  PVOID           ObjectContext;&#10;  PVOID           Reserved;&#10;} REG_RENAME_KEY_INFORMATION, *PREG_RENAME_KEY_INFORMATION;">REG_RENAME_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreRenameKey</strong></td>
<td><a href="reg_rename_key_information" title="typedef struct _REG_RENAME_KEY_INFORMATION {&#10;  PVOID           Object;&#10;  PUNICODE_STRING NewName;&#10;  PVOID           CallContext;&#10;  PVOID           ObjectContext;&#10;  PVOID           Reserved;&#10;} REG_RENAME_KEY_INFORMATION, *PREG_RENAME_KEY_INFORMATION;">REG_RENAME_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostRenameKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtEnumerateKey</strong></td>
<td><a href="reg_enumerate_key_information" title="typedef struct _REG_ENUMERATE_KEY_INFORMATION {&#10;  PVOID                 Object;&#10;  ULONG                 Index;&#10;  KEY_INFORMATION_CLASS KeyInformationClass;&#10;  PVOID                 KeyInformation;&#10;  ULONG                 Length;&#10;  PULONG                ResultLength;&#10;  PVOID                 CallContext;&#10;  PVOID                 ObjectContext;&#10;  PVOID                 Reserved;&#10;} REG_ENUMERATE_KEY_INFORMATION, *PREG_ENUMERATE_KEY_INFORMATION;">REG_ENUMERATE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreEnumerateKey</strong></td>
<td><a href="reg_enumerate_key_information" title="typedef struct _REG_ENUMERATE_KEY_INFORMATION {&#10;  PVOID                 Object;&#10;  ULONG                 Index;&#10;  KEY_INFORMATION_CLASS KeyInformationClass;&#10;  PVOID                 KeyInformation;&#10;  ULONG                 Length;&#10;  PULONG                ResultLength;&#10;  PVOID                 CallContext;&#10;  PVOID                 ObjectContext;&#10;  PVOID                 Reserved;&#10;} REG_ENUMERATE_KEY_INFORMATION, *PREG_ENUMERATE_KEY_INFORMATION;">REG_ENUMERATE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostEnumerateKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtEnumerateValueKey</strong></td>
<td><a href="reg_enumerate_value_key_information" title="typedef struct _REG_ENUMERATE_VALUE_KEY_INFORMATION {&#10;  PVOID                       Object;&#10;  ULONG                       Index;&#10;  KEY_VALUE_INFORMATION_CLASS KeyValueInformationClass;&#10;  PVOID                       KeyValueInformation;&#10;  ULONG                       Length;&#10;  PULONG                      ResultLength;&#10;  PVOID                       CallContext;&#10;  PVOID                       ObjectContext;&#10;  PVOID                       Reserved;&#10;} REG_ENUMERATE_VALUE_KEY_INFORMATION, *PREG_ENUMERATE_VALUE_KEY_INFORMATION;">REG_ENUMERATE_VALUE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreEnumerateValueKey</strong></td>
<td><a href="reg_enumerate_value_key_information" title="typedef struct _REG_ENUMERATE_VALUE_KEY_INFORMATION {&#10;  PVOID                       Object;&#10;  ULONG                       Index;&#10;  KEY_VALUE_INFORMATION_CLASS KeyValueInformationClass;&#10;  PVOID                       KeyValueInformation;&#10;  ULONG                       Length;&#10;  PULONG                      ResultLength;&#10;  PVOID                       CallContext;&#10;  PVOID                       ObjectContext;&#10;  PVOID                       Reserved;&#10;} REG_ENUMERATE_VALUE_KEY_INFORMATION, *PREG_ENUMERATE_VALUE_KEY_INFORMATION;">REG_ENUMERATE_VALUE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostEnumerateValueKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtQueryKey</strong></td>
<td><a href="reg_query_key_information" title="typedef struct _REG_QUERY_KEY_INFORMATION {&#10;  PVOID                 Object;&#10;  KEY_INFORMATION_CLASS KeyInformationClass;&#10;  PVOID                 KeyInformation;&#10;  ULONG                 Length;&#10;  PULONG                ResultLength;&#10;  PVOID                 CallContext;&#10;  PVOID                 ObjectContext;&#10;  PVOID                 Reserved;&#10;} REG_QUERY_KEY_INFORMATION, *PREG_QUERY_KEY_INFORMATION;">REG_QUERY_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreQueryKey</strong></td>
<td><a href="reg_query_key_information" title="typedef struct _REG_QUERY_KEY_INFORMATION {&#10;  PVOID                 Object;&#10;  KEY_INFORMATION_CLASS KeyInformationClass;&#10;  PVOID                 KeyInformation;&#10;  ULONG                 Length;&#10;  PULONG                ResultLength;&#10;  PVOID                 CallContext;&#10;  PVOID                 ObjectContext;&#10;  PVOID                 Reserved;&#10;} REG_QUERY_KEY_INFORMATION, *PREG_QUERY_KEY_INFORMATION;">REG_QUERY_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostQueryKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtQueryValueKey</strong></td>
<td><a href="reg_query_value_key_information" title="typedef struct _REG_QUERY_VALUE_KEY_INFORMATION {&#10;  PVOID                       Object;&#10;  PUNICODE_STRING             ValueName;&#10;  KEY_VALUE_INFORMATION_CLASS KeyValueInformationClass;&#10;  PVOID                       KeyValueInformation;&#10;  ULONG                       Length;&#10;  PULONG                      ResultLength;&#10;  PVOID                       CallContext;&#10;  PVOID                       ObjectContext;&#10;  PVOID                       Reserved;&#10;} REG_QUERY_VALUE_KEY_INFORMATION, *PREG_QUERY_VALUE_KEY_INFORMATION;">REG_QUERY_VALUE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreQueryValueKey</strong></td>
<td><a href="reg_query_value_key_information" title="typedef struct _REG_QUERY_VALUE_KEY_INFORMATION {&#10;  PVOID                       Object;&#10;  PUNICODE_STRING             ValueName;&#10;  KEY_VALUE_INFORMATION_CLASS KeyValueInformationClass;&#10;  PVOID                       KeyValueInformation;&#10;  ULONG                       Length;&#10;  PULONG                      ResultLength;&#10;  PVOID                       CallContext;&#10;  PVOID                       ObjectContext;&#10;  PVOID                       Reserved;&#10;} REG_QUERY_VALUE_KEY_INFORMATION, *PREG_QUERY_VALUE_KEY_INFORMATION;">REG_QUERY_VALUE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostQueryValueKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtQueryMultipleValueKey</strong></td>
<td><a href="reg_query_multiple_value_key_information" title="typedef struct _REG_QUERY_MULTIPLE_VALUE_KEY_INFORMATION {&#10;  PVOID            Object;&#10;  PKEY_VALUE_ENTRY ValueEntries;&#10;  ULONG            EntryCount;&#10;  PVOID            ValueBuffer;&#10;  PULONG           BufferLength;&#10;  PULONG           RequiredBufferLength;&#10;  PVOID            CallContext;&#10;  PVOID            ObjectContext;&#10;  PVOID            Reserved;&#10;} REG_QUERY_MULTIPLE_VALUE_KEY_INFORMATION, *PREG_QUERY_MULTIPLE_VALUE_KEY_INFORMATION;">REG_QUERY_MULTIPLE_VALUE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreQueryMultipleValueKey</strong></td>
<td><a href="reg_query_multiple_value_key_information" title="typedef struct _REG_QUERY_MULTIPLE_VALUE_KEY_INFORMATION {&#10;  PVOID            Object;&#10;  PKEY_VALUE_ENTRY ValueEntries;&#10;  ULONG            EntryCount;&#10;  PVOID            ValueBuffer;&#10;  PULONG           BufferLength;&#10;  PULONG           RequiredBufferLength;&#10;  PVOID            CallContext;&#10;  PVOID            ObjectContext;&#10;  PVOID            Reserved;&#10;} REG_QUERY_MULTIPLE_VALUE_KEY_INFORMATION, *PREG_QUERY_MULTIPLE_VALUE_KEY_INFORMATION;">REG_QUERY_MULTIPLE_VALUE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostQueryMultipleValueKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreCreateKey</strong></td>
<td><a href="reg_pre_create_key_information" title="typedef struct _REG_PRE_CREATE_KEY_INFORMATION {&#10;  PUNICODE_STRING CompleteName;&#10;} REG_PRE_CREATE_KEY_INFORMATION, REG_PRE_OPEN_KEY_INFORMATION, *PREG_PRE_CREATE_KEY_INFORMATION, *PREG_PRE_OPEN_KEY_INFORMATION;">REG_PRE_CREATE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreCreateKeyEx</strong></td>
<td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_reg_create_key_information">REG_CREATE_KEY_INFORMATION**</a></td>
</tr>
<tr>
<td><strong>RegNtPostCreateKey</strong></td>
<td><a href="reg_post_create_key_information" title="typedef struct _REG_POST_CREATE_KEY_INFORMATION {&#10;  PUNICODE_STRING CompleteName;&#10;  PVOID           Object;&#10;  NTSTATUS        Status;&#10;} REG_POST_CREATE_KEY_INFORMATION, REG_POST_OPEN_KEY_INFORMATION, *PREG_POST_CREATE_KEY_INFORMATION, *PREG_POST_OPEN_KEY_INFORMATION;">REG_POST_CREATE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostCreateKeyEx</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreOpenKey</strong></td>
<td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_reg_pre_create_key_information">REG_PRE_OPEN_KEY_INFORMATION**</a></td>
</tr>
<tr>
<td><strong>RegNtPreOpenKeyEx</strong></td>
<td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_reg_create_key_information">REG_OPEN_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostOpenKey</strong></td>
<td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_reg_post_create_key_information">REG_POST_OPEN_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostOpenKeyEx</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtKeyHandleClose</strong></td>
<td><a href="reg_key_handle_close_information" title="typedef struct _REG_KEY_HANDLE_CLOSE_INFORMATION {&#10;  PVOID Object;&#10;  PVOID CallContext;&#10;  PVOID ObjectContext;&#10;  PVOID Reserved;&#10;} REG_KEY_HANDLE_CLOSE_INFORMATION, *PREG_KEY_HANDLE_CLOSE_INFORMATION;">REG_KEY_HANDLE_CLOSE_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreKeyHandleClose</strong></td>
<td><a href="reg_key_handle_close_information" title="typedef struct _REG_KEY_HANDLE_CLOSE_INFORMATION {&#10;  PVOID Object;&#10;  PVOID CallContext;&#10;  PVOID ObjectContext;&#10;  PVOID Reserved;&#10;} REG_KEY_HANDLE_CLOSE_INFORMATION, *PREG_KEY_HANDLE_CLOSE_INFORMATION;">REG_KEY_HANDLE_CLOSE_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostKeyHandleClose</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreFlushKey</strong></td>
<td><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_reg_delete_key_information">REG_FLUSH_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostFlushKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreLoadKey</strong></td>
<td><a href="reg_load_key_information" title="typedef struct _REG_LOAD_KEY_INFORMATION {&#10;  PVOID           Object;&#10;  PUNICODE_STRING KeyName;&#10;  PUNICODE_STRING SourceFile;&#10;  ULONG           Flags;&#10;  PVOID           TrustClassObject;&#10;  PVOID           UserEvent;&#10;  ACCESS_MASK     DesiredAccess;&#10;  PHANDLE         RootHandle;&#10;  PVOID           CallContext;&#10;  PVOID           ObjectContext;&#10;  PVOID           Reserved;&#10;} REG_LOAD_KEY_INFORMATION, *PREG_LOAD_KEY_INFORMATION;">REG_LOAD_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostLoadKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreUnLoadKey</strong></td>
<td><a href="reg_unload_key_information" title="typedef struct _REG_UNLOAD_KEY_INFORMATION {&#10;  PVOID Object;&#10;  PVOID UserEvent;&#10;  PVOID CallContext;&#10;  PVOID ObjectContext;&#10;  PVOID Reserved;&#10;} REG_UNLOAD_KEY_INFORMATION, *PREG_UNLOAD_KEY_INFORMATION;">REG_UNLOAD_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostUnLoadKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreQueryKeySecurity</strong></td>
<td><a href="reg_query_key_security_information" title="typedef struct _REG_QUERY_KEY_SECURITY_INFORMATION {&#10;  PVOID                 Object;&#10;  PSECURITY_INFORMATION SecurityInformation;&#10;  PSECURITY_DESCRIPTOR  SecurityDescriptor;&#10;  PULONG                Length;&#10;  PVOID                 CallContext;&#10;  PVOID                 ObjectContext;&#10;  PVOID                 Reserved;&#10;} REG_QUERY_KEY_SECURITY_INFORMATION, *PREG_QUERY_KEY_SECURITY_INFORMATION;">REG_QUERY_KEY_SECURITY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostQueryKeySecurity</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreSetKeySecurity</strong></td>
<td><a href="reg_set_key_security_information" title="typedef struct _REG_SET_KEY_SECURITY_INFORMATION {&#10;  PVOID                 Object;&#10;  PSECURITY_INFORMATION SecurityInformation;&#10;  PSECURITY_DESCRIPTOR  SecurityDescriptor;&#10;  PVOID                 CallContext;&#10;  PVOID                 ObjectContext;&#10;  PVOID                 Reserved;&#10;} REG_SET_KEY_SECURITY_INFORMATION, *PREG_SET_KEY_SECURITY_INFORMATION;">REG_SET_KEY_SECURITY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostSetKeySecurity</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtCallbackObjectContextCleanup</strong></td>
<td><a href="reg_callback_context_cleanup_information" title="typedef struct _REG_CALLBACK_CONTEXT_CLEANUP_INFORMATION {&#10;  PVOID Object;&#10;  PVOID ObjectContext;&#10;  PVOID Reserved;&#10;} REG_CALLBACK_CONTEXT_CLEANUP_INFORMATION, *PREG_CALLBACK_CONTEXT_CLEANUP_INFORMATION;">REG_CALLBACK_CONTEXT_CLEANUP_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreRestoreKey</strong></td>
<td><a href="reg_restore_key_information" title="typedef struct _REG_RESTORE_KEY_INFORMATION {&#10;  PVOID  Object;&#10;  HANDLE FileHandle;&#10;  ULONG  Flags;&#10;  PVOID  CallContext;&#10;  PVOID  ObjectContext;&#10;  PVOID  Reserved;&#10;} REG_RESTORE_KEY_INFORMATION, *PREG_RESTORE_KEY_INFORMATION;">REG_RESTORE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostRestoreKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreSaveKey</strong></td>
<td><a href="reg_save_key_information" title="typedef struct _REG_SAVE_KEY_INFORMATION {&#10;  PVOID  Object;&#10;  HANDLE FileHandle;&#10;  ULONG  Format;&#10;  PVOID  CallContext;&#10;  PVOID  ObjectContext;&#10;  PVOID  Reserved;&#10;} REG_SAVE_KEY_INFORMATION, *PREG_SAVE_KEY_INFORMATION;">REG_SAVE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostSaveKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreReplaceKey</strong></td>
<td><a href="reg_replace_key_information" title="typedef struct _REG_REPLACE_KEY_INFORMATION {&#10;  PVOID           Object;&#10;  PUNICODE_STRING OldFileName;&#10;  PUNICODE_STRING NewFileName;&#10;  PVOID           CallContext;&#10;  PVOID           ObjectContext;&#10;  PVOID           Reserved;&#10;} REG_REPLACE_KEY_INFORMATION, *PREG_REPLACE_KEY_INFORMATION;">REG_REPLACE_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostReplaceKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreQueryKeyName</strong></td>
<td><a href="reg_query_key_name" title="typedef struct _REG_QUERY_KEY_NAME {&#10;  PVOID                    Object;&#10;  POBJECT_NAME_INFORMATION ObjectNameInfo;&#10;  ULONG                    Length;&#10;  PULONG                   ReturnLength;&#10;  PVOID                    CallContext;&#10;  PVOID                    ObjectContext;&#10;  PVOID                    Reserved;&#10;} REG_QUERY_KEY_NAME, *PREG_QUERY_KEY_NAME;">REG_QUERY_KEY_NAME</a></td>
</tr>
<tr>
<td><strong>RegNtPostQueryKeyName</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPreSaveMergedKey</strong></td>
<td><a href="reg_save_merged_key_information" title="typedef struct _REG_SAVE_MERGED_KEY_INFORMATION {&#10;  PVOID  Object;&#10;  HANDLE FileHandle;&#10;  PVOID  HighKeyObject;&#10;  PVOID  LowKeyObject;&#10;  PVOID  CallContext;&#10;  PVOID  ObjectContext;&#10;  PVOID  Reserved;&#10;} REG_SAVE_MERGED_KEY_INFORMATION, *PREG_SAVE_MERGED_KEY_INFORMATION;">REG_SAVE_MERGED_KEY_INFORMATION</a></td>
</tr>
<tr>
<td><strong>RegNtPostSaveMergedKey</strong></td>
<td><a href="reg_post_operation_information" title="typedef struct _REG_POST_OPERATION_INFORMATION {&#10;  PVOID    Object;&#10;  NTSTATUS Status;&#10;  PVOID    PreInformation;&#10;  NTSTATUS ReturnStatus;&#10;  PVOID    CallContext;&#10;  PVOID    ObjectContext;&#10;  PVOID    Reserved;&#10;} REG_POST_OPERATION_INFORMATION, *PREG_POST_OPERATION_INFORMATION;">REG_POST_OPERATION_INFORMATION</a></td>
</tr>
</tbody>
</table>
<p>Starting with Windows 7, the actual data structure passed in when the notify class is RegNtPreCreateKeyEx or RegNtPreOpenKeyEx is the V1 version of this structure, <strong><a href="reg_create_key_information_v1" title="typedef struct _REG_CREATE_KEY_INFORMATION_V1 {&#10;  PUNICODE_STRING CompleteName;&#10;  PVOID           RootObject;&#10;  PVOID           ObjectType;&#10;  ULONG           Options;&#10;  PUNICODE_STRING Class;&#10;  PVOID           SecurityDescriptor;&#10;  PVOID           SecurityQualityOfService;&#10;  ACCESS_MASK     DesiredAccess;&#10;  ACCESS_MASK     GrantedAccess;&#10;  PULONG          Disposition;&#10;  PVOID           *ResultObject;&#10;  PVOID           CallContext;&#10;  PVOID           RootObjectContext;&#10;  PVOID           Transaction;&#10;  ULONG_PTR       Version;&#10;  PUNICODE_STRING RemainingName;&#10;  ULONG           Wow64Flags;&#10;  ULONG           Attributes;&#10;  KPROCESSOR_MODE CheckAccessMode;&#10;...">REG_CREATE_KEY_INFORMATION_V1</a></strong> or <strong>REG_OPEN_KEY_INFORMATION_V1</strong>, respectively. Check the Reserved member to determine the version of the structure.</p>
<table>
<thead>
<tr>
<th>Version number</th>
<th>Structure name</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td><a href="reg_create_key_information" title="typedef struct _REG_CREATE_KEY_INFORMATION {&#10;  PUNICODE_STRING CompleteName;&#10;  PVOID           RootObject;&#10;  PVOID           ObjectType;&#10;  ULONG           CreateOptions;&#10;  PUNICODE_STRING Class;&#10;  PVOID           SecurityDescriptor;&#10;  PVOID           SecurityQualityOfService;&#10;  ACCESS_MASK     DesiredAccess;&#10;  ACCESS_MASK     GrantedAccess;&#10;  PULONG          Disposition;&#10;  PVOID           *ResultObject;&#10;  PVOID           CallContext;&#10;  PVOID           RootObjectContext;&#10;  PVOID           Transaction;&#10;  PVOID           Reserved;&#10;} REG_CREATE_KEY_INFORMATION, REG_OPEN_KEY_INFORMATION, *PREG_CREATE_KEY_INFORMATION, *PREG_OPEN_KEY_INFORMATION;">REG_CREATE_KEY_INFORMATION</a> and REG_OPEN_KEY_INFORMATION</td>
</tr>
<tr>
<td>1</td>
<td><a href="reg_create_key_information_v1" title="typedef struct _REG_CREATE_KEY_INFORMATION_V1 {&#10;  PUNICODE_STRING CompleteName;&#10;  PVOID           RootObject;&#10;  PVOID           ObjectType;&#10;  ULONG           Options;&#10;  PUNICODE_STRING Class;&#10;  PVOID           SecurityDescriptor;&#10;  PVOID           SecurityQualityOfService;&#10;  ACCESS_MASK     DesiredAccess;&#10;  ACCESS_MASK     GrantedAccess;&#10;  PULONG          Disposition;&#10;  PVOID           *ResultObject;&#10;  PVOID           CallContext;&#10;  PVOID           RootObjectContext;&#10;  PVOID           Transaction;&#10;  ULONG_PTR       Version;&#10;  PUNICODE_STRING RemainingName;&#10;  ULONG           Wow64Flags;&#10;  ULONG           Attributes;&#10;  KPROCESSOR_MODE CheckAccessMode;&#10;...">REG_CREATE_KEY_INFORMATION_V1</a> and REG_OPEN_KEY_INFORMATION_V1</td>
</tr>
</tbody>
</table>
<h2>Return value</h2>
<p>For more information about when a <em>RegistryCallback</em> routine should return each of these status values, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/filtering-registry-calls">Filtering Registry Calls</a>.</p>
<h2>Remarks</h2>
<p>To be notified of registry operations, a kernel-mode component (such as the driver component of an antivirus software package) can call <a href="cmregistercallback" title="NTSTATUS CmRegisterCallback(&#10;  [in]           PEX_CALLBACK_FUNCTION Function,&#10;  [in, optional] PVOID                 Context,&#10;  [out]          PLARGE_INTEGER        Cookie&#10;);">CmRegisterCallback</a> or <a href="cmregistercallbackex" title="NTSTATUS CmRegisterCallbackEx(&#10;  [in]           PEX_CALLBACK_FUNCTION Function,&#10;  [in]           PCUNICODE_STRING      Altitude,&#10;  [in]           PVOID                 Driver,&#10;  [in, optional] PVOID                 Context,&#10;  [out]          PLARGE_INTEGER        Cookie,&#10;                 PVOID                 Reserved&#10;);">CmRegisterCallbackEx</a> to register a <em>RegistryCallback</em> routine.</p>
<p>The <em>RegistryCallback</em> routine can inspect the contents of the input and output buffers that are supplied for registry operations. A registry operation can be initiated by a user-mode application that calls a user-mode registry routine (such as <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winreg/nf-winreg-regcreatekeyexa">RegCreateKeyEx</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winreg/nf-winreg-regopenkeyexa">RegOpenKeyEx</a>) or by a driver that calls a kernel-mode registry routine (such as <a href="ntcreatekey" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateKey(&#10;    _Out_ PHANDLE KeyHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _Reserved_ ULONG TitleIndex,&#10;    _In_opt_ PCUNICODE_STRING Class,&#10;    _In_ ULONG CreateOptions,&#10;    _Out_opt_ PULONG Disposition&#10;    );">ZwCreateKey</a> or <a href="ntopenkey" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtOpenKey(&#10;    _Out_ PHANDLE KeyHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ POBJECT_ATTRIBUTES ObjectAttributes&#10;    );">ZwOpenKey</a>). An <em>input buffer</em> is a memory buffer supplied by the initiator from which the registry reads input data for the operation. An <em>output buffer</em> is a buffer supplied by the initiator into which the registry writes output data requested by the initiator.</p>
<p>Before calling the <em>RegistryCallback</em> routine, the kernel probes (to verify alignment and accessibility) all members of the <em>Argument2</em> structures that point to output buffers in user-mode memory, but does not capture user-mode output buffers in system memory. The callback routine must enclose any access of an output buffer in a <strong>try</strong>/<strong>except</strong> block. If the callback routine needs to pass an output buffer pointer to a system routine (for example, <a href="ntopenkey" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtOpenKey(&#10;    _Out_ PHANDLE KeyHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ POBJECT_ATTRIBUTES ObjectAttributes&#10;    );">ZwOpenKey</a>), and the buffer is in user-mode memory, the callback routine must first capture the buffer.</p>
<p>The handling of input buffers depends on the Windows version. Starting with Windows 8, the kernel captures all input buffers pointed to by members of the <em>Argument2</em> structures in system memory before calling the <em>RegistryCallback</em> routine. In versions of Windows before Windows 8, the kernel probes all members of the <em>Argument2</em> structures that point to input buffers in user-mode memory, but captures only some of these buffers in system memory. In these earlier versions of Windows, the callback routine must enclose any access of an input buffer in a <strong>try</strong>/<strong>except</strong> block. Additionally, if the callback routine needs to pass an input buffer pointer to a system routine (for example, <strong><a href="ntopenkey" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtOpenKey(&#10;    _Out_ PHANDLE KeyHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ POBJECT_ATTRIBUTES ObjectAttributes&#10;    );">ZwOpenKey</a></strong>), and the buffer is in user-mode memory, the callback routine must first capture the buffer.</p>
<p>The following table summarizes the requirements for buffer accesses by the <em>RegistryCallback</em> routine.</p>
<table>
<thead>
<tr>
<th>Buffer type</th>
<th>Windows version</th>
<th>Buffer pointer passed to callback routine</th>
<th>Safe for callback routine to directly access?</th>
<th>Safe to pass to system routines (such as <strong><a href="ntopenkey" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtOpenKey(&#10;    _Out_ PHANDLE KeyHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ POBJECT_ATTRIBUTES ObjectAttributes&#10;    );">ZwOpenKey</a></strong>)?</th>
</tr>
</thead>
<tbody>
<tr>
<td>User-mode input</td>
<td>Windows 8 and later</td>
<td>Points to captured data.</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>User-mode input</td>
<td>Windows 7 and earlier</td>
<td>Points to captured data or original user-mode buffer.</td>
<td>No. Must read under try/except.</td>
<td>No. Must allocate kernel memory, copy data from the original buffer under try/except, and pass the copied data to the system routine.</td>
</tr>
<tr>
<td>User-mode output</td>
<td>All</td>
<td>Points to original user-mode buffer.</td>
<td>No. Must write under try/except.</td>
<td>No. Must allocate kernel memory, pass kernel memory to the system routine, and copy the results back to the original buffer under try/except.</td>
</tr>
<tr>
<td>Kernel-mode input and output</td>
<td>All</td>
<td>Points to original kernel-mode buffer.</td>
<td>Yes</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<p>For more information about <em>RegistryCallback</em> routines and registry filter drivers, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/kernel/filtering-registry-calls">Filtering Registry Calls</a>.</p>
<p>A <em>RegistryCallback</em> executes at IRQL = PASSIVE_LEVEL and in the context of the thread that is performing the registry operation.</p>
<h3>Examples</h3>
<p>To define a <em>RegistryCallback</em> callback routine, you must first provide a function declaration that identifies the type of callback routine you're defining. Windows provides a set of callback function types for drivers. Declaring a function using the callback function types helps <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/code-analysis-for-drivers">Code Analysis for Drivers</a>, <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/static-driver-verifier">Static Driver Verifier</a> (SDV), and other verification tools find errors, and it's a requirement for writing drivers for the Windows operating system.</p>
<p>For example, to define a <em>RegistryCallback</em> callback routine that is named <code>MyRegistryCallback</code>, use the EX_CALLBACK_FUNCTION type as shown in this code example:</p>
<pre><code class="language-cpp">EX_CALLBACK_FUNCTION MyRegistryCallback;
</code></pre>
<p>Then, implement your callback routine as follows:</p>
<pre><code class="language-cpp">_Use_decl_annotations_
<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>
  MyRegistryCallback(
    PVOID  CallbackContext,
    PVOID  Argument1,
    PVOID  Argument2
    )
  {
      // Function body
  }
</code></pre>
<p>The EX_CALLBACK_FUNCTION function type is defined in the Wdm.h header file. To more accurately identify errors when you run the code analysis tools, be sure to add the <em>Use_decl_annotations</em> annotation to your function definition. The <em>Use_decl_annotations</em> annotation ensures that the annotations that are applied to the EX_CALLBACK_FUNCTION function type in the header file are used. For more information about the requirements for function declarations, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/declaring-functions-using-function-role-types-for-wdm-drivers">Declaring Functions by Using Function Role Types for WDM Drivers</a>. For information about <em>Use_decl_annotations</em>, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/visualstudio/code-quality/annotating-function-behavior">Annotating Function Behavior</a>.</p>
<h2>See also</h2>
<p><a href="cmregistercallback" title="NTSTATUS CmRegisterCallback(&#10;  [in]           PEX_CALLBACK_FUNCTION Function,&#10;  [in, optional] PVOID                 Context,&#10;  [out]          PLARGE_INTEGER        Cookie&#10;);">CmRegisterCallback</a></p>
<p><a href="cmunregistercallback" title="NTSTATUS CmUnRegisterCallback(&#10;  [in] LARGE_INTEGER Cookie&#10;);">CmUnRegisterCallback</a></p>
<p><a href="probeforread" title="VOID ProbeForRead(&#10;  [in] const volatile VOID *Address,&#10;  [in] SIZE_T              Length,&#10;  [in] ULONG               Alignment&#10;);">ProbeForRead</a></p>
<p><strong><a href="reg_notify_class" title="typedef enum _REG_NOTIFY_CLASS {&#10;  RegNtDeleteKey,&#10;  RegNtPreDeleteKey,&#10;  RegNtSetValueKey,&#10;  RegNtPreSetValueKey,&#10;  RegNtDeleteValueKey,&#10;  RegNtPreDeleteValueKey,&#10;  RegNtSetInformationKey,&#10;  RegNtPreSetInformationKey,&#10;  RegNtRenameKey,&#10;  RegNtPreRenameKey,&#10;  RegNtEnumerateKey,&#10;  RegNtPreEnumerateKey,&#10;  RegNtEnumerateValueKey,&#10;  RegNtPreEnumerateValueKey,&#10;  RegNtQueryKey,&#10;  RegNtPreQueryKey,&#10;  RegNtQueryValueKey,&#10;  RegNtPreQueryValueKey,&#10;  RegNtQueryMultipleValueKey,&#10;...">REG_NOTIFY_CLASS</a></strong></p>
<p><a href="ntopenkey" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtOpenKey(&#10;    _Out_ PHANDLE KeyHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_ POBJECT_ATTRIBUTES ObjectAttributes&#10;    );">ZwOpenKey</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-ex_callback_function">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/nc-wdm-ex_callback_function.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script src="modules/highlight.js/highlight.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
