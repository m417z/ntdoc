<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="IP_DISCARD_REASON - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>IP_DISCARD_REASON - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            IP_DISCARD_REASON - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// fwpsk.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef enum {
  IpDiscardBadSourceAddress,
  IpDiscardNotLocallyDestined,
  IpDiscardProtocolUnreachable,
  IpDiscardPortUnreachable,
  IpDiscardBadLength,
  IpDiscardMalformedHeader,
  IpDiscardNoRoute,
  IpDiscardBeyondScope,
  IpDiscardInspectionDrop,
  IpDiscardTooManyDecapsulations,
  IpDiscardAdministrativelyProhibited,
  IpDiscardBadChecksum,
  IpDiscardFirstFragmentIncomplete,
  IpDiscardHeaderNotContiguous,
  IpDiscardHeaderNotAligned,
  IpDiscardReceivePathMax,
  IpDiscardHopLimitExceeded,
  IpDiscardAddressUnreachable,
  IpDiscardRscPacket,
  IpDiscardSourceViolation,
  IpDiscardForwardPathMax,
  IpDiscardArbitrationUnhandled,
  IpDiscardInspectionAbsorb,
  IpDiscardDontFragmentMtuExceeded,
  IpDiscardBufferLengthExceeded,
  IpDiscardAddressResolutionTimeout,
  IpDiscardAddressResolutionFailure,
  IpDiscardIpsecFailure,
  IpDiscardExtensionHeadersFailure,
  IpDiscardAllocationFailure,
  IpDiscardIpsnpiClientDrop,
  IpDiscardUnsupportedOffload,
  IpDiscardRoutingFailure,
  IpDiscardAncillaryDataFailure,
  IpDiscardRawDataFailure,
  IpDiscardSessionStateFailure,
  IpDiscardIpsnpiAllocationFailure,
  IpDiscardIpsnpiModifiedButNotForwarded,
  IpDiscardIpsnpiNoNextHop,
  IpDiscardIpsnpiNoCompartment,
  IpDiscardIpsnpiNoInterface,
  IpDiscardIpsnpiNoSubInterface,
  IpDiscardIpsnpiInterfaceDisabled,
  IpDiscardIpsnpiSegmentationFailed,
  IpDiscardIpsnpiNoEthernetHeader,
  IpDiscardIpsnpiUnexpectedFragment,
  IpDiscardIpsnpiUnsupportedInterfaceType,
  IpDiscardIpsnpiInvalidLsoInfo,
  IpDiscardIpsnpiInvalidUsoInfo,
  IpDiscardInternalError,
  IpDiscardAdministrativelyConfigured,
  IpDiscardBadOption,
  IpDiscardLoopbackDisallowed,
  IpDiscardSmallerScope,
  IpDiscardQueueFull,
  IpDiscardInterfaceDisabled,
  IpDiscardNlClientDiscard,
  IpDiscardIpsnpiUroSegmentSizeExceedsMtu,
  IpDiscardSwUsoFailure,
  IpDiscardMax
} IP_DISCARD_REASON, *PIP_DISCARD_REASON;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/ne-fwpsk-ip_discard_reason">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ip_discard_reason.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ne-fwpsk-ip_discard_reason)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2 id="description">Description</h2>

<p>The <strong>IP_DISCARD_REASON</strong> enum defines the possible reasons that data is discarded by one of the network layers.</p>

<h2 id="constants">Constants</h2>

<h3 id="ipdiscardbadsourceaddress"><code>IpDiscardBadSourceAddress</code></h3>

<p>The outgoing packet's source address is a multicast address, a broadcast address, or an IPv6 address that contains an embedded IPv4 loopback or unspecified address.</p>

<h3 id="ipdiscardnotlocallydestined"><code>IpDiscardNotLocallyDestined</code></h3>

<p>The received packet's destination address doesn't exist on the system, and no appropriate forwarding interface exists.</p>

<h3 id="ipdiscardprotocolunreachable"><code>IpDiscardProtocolUnreachable</code></h3>

<p>There's either no transport protocol handler for the received packet or the transport protocol handler refused to process the packet.</p>

<h3 id="ipdiscardportunreachable"><code>IpDiscardPortUnreachable</code></h3>

<p>There's no application that is receiving packets on the received packet's destination port.</p>

<h3 id="ipdiscardbadlength"><code>IpDiscardBadLength</code></h3>

<p>A length field specified within the received packet is inconsistent with the packet's length.</p>

<h3 id="ipdiscardmalformedheader"><code>IpDiscardMalformedHeader</code></h3>

<p>The received packet contains a recognized extension header or option whose contents are invalid.</p>

<h3 id="ipdiscardnoroute"><code>IpDiscardNoRoute</code></h3>

<p>The received packet can't be forwarded to its destination address because the system's routing table doesn't contain a route to that destination.</p>

<h3 id="ipdiscardbeyondscope"><code>IpDiscardBeyondScope</code></h3>

<p>The received packet can't be forwarded because the packet's incoming and outgoing network interfaces have different zone indexes for the packet's zone level.</p>

<h3 id="ipdiscardinspectiondrop"><code>IpDiscardInspectionDrop</code></h3>

<p>The packet was dropped during inspection due to failing security checks or protocol compliance issues.</p>

<h3 id="ipdiscardtoomanydecapsulations"><code>IpDiscardTooManyDecapsulations</code></h3>

<p>The received packet cannot be forwarded to its destination address because there are too many decapsulations.</p>

<h3 id="ipdiscardadministrativelyprohibited"><code>IpDiscardAdministrativelyProhibited</code></h3>

<p>The packet was discarded due to administrative policies prohibiting its transmission or receipt.</p>

<h3 id="ipdiscardbadchecksum"><code>IpDiscardBadChecksum</code></h3>

<p>The packet was discarded because its checksum was incorrect, indicating potential data corruption.</p>

<h3 id="ipdiscardfirstfragmentincomplete"><code>IpDiscardFirstFragmentIncomplete</code></h3>

<p>The first fragment of the packet was incomplete, leading to the discard of the entire packet.</p>

<h3 id="ipdiscardheadernotcontiguous"><code>IpDiscardHeaderNotContiguous</code></h3>

<p>The packet's header wasn't contiguous in memory, causing it to be discarded.</p>

<h3 id="ipdiscardheadernotaligned"><code>IpDiscardHeaderNotAligned</code></h3>

<p>The packet header wasn't properly aligned, leading to its discard due to formatting issues.</p>

<h3 id="ipdiscardreceivepathmax"><code>IpDiscardReceivePathMax</code></h3>

<p>The packet was discarded as it exceeded the maximum length allowed on the receive path.</p>

<h3 id="ipdiscardhoplimitexceeded"><code>IpDiscardHopLimitExceeded</code></h3>

<p>The received packet's hop limit or time-to-live limit has been exceeded.</p>

<h3 id="ipdiscardaddressunreachable"><code>IpDiscardAddressUnreachable</code></h3>

<p>The outgoing packet can't be sent to the packet's destination address either because the destination doesn't exist or packets aren't allowed to be sent to that destination.</p>

<h3 id="ipdiscardrscpacket"><code>IpDiscardRscPacket</code></h3>

<p>The outgoing packet can't be sent because it is a receive-side coalesced (RSC) packet.</p>

<h3 id="ipdiscardsourceviolation"><code>IpDiscardSourceViolation</code></h3>

<p>The packet was discarded because it violated source address validation checks.</p>

<h3 id="ipdiscardforwardpathmax"><code>IpDiscardForwardPathMax</code></h3>

<p>The packet exceeded the maximum path length for forwarding and was discarded.</p>

<h3 id="ipdiscardarbitrationunhandled"><code>IpDiscardArbitrationUnhandled</code></h3>

<p>The packet was discarded because it required arbitration that wasn't handled.</p>

<h3 id="ipdiscardinspectionabsorb"><code>IpDiscardInspectionAbsorb</code></h3>

<p>The outgoing packet cannot be sent because WFP took ownership of the packet.</p>

<h3 id="ipdiscarddontfragmentmtuexceeded"><code>IpDiscardDontFragmentMtuExceeded</code></h3>

<p>The packet was discarded because it exceeded the MTU size and had the Don't Fragment bit set.</p>

<h3 id="ipdiscardbufferlengthexceeded"><code>IpDiscardBufferLengthExceeded</code></h3>

<p>The packet was discarded because it exceeded the buffer length limitations.</p>

<h3 id="ipdiscardaddressresolutiontimeout"><code>IpDiscardAddressResolutionTimeout</code></h3>

<p>The packet was discarded due to a timeout in address resolution.</p>

<h3 id="ipdiscardaddressresolutionfailure"><code>IpDiscardAddressResolutionFailure</code></h3>

<p>The packet was discarded because address resolution failed.</p>

<h3 id="ipdiscardipsecfailure"><code>IpDiscardIpsecFailure</code></h3>

<p>The packet was discarded due to an IPsec processing failure.</p>

<h3 id="ipdiscardextensionheadersfailure"><code>IpDiscardExtensionHeadersFailure</code></h3>

<p>The packet was discarded because of a failure related to processing IPv6 extension headers.</p>

<h3 id="ipdiscardallocationfailure"><code>IpDiscardAllocationFailure</code></h3>

<p>The packet was discarded due to a failure in allocating necessary resources.</p>

<h3 id="ipdiscardipsnpiclientdrop"><code>IpDiscardIpsnpiClientDrop</code></h3>

<p>The packet was discarded by an IPSNPI client due to unspecified reasons.</p>

<h3 id="ipdiscardunsupportedoffload"><code>IpDiscardUnsupportedOffload</code></h3>

<p>The packet was discarded because it required an unsupported offload operation.</p>

<h3 id="ipdiscardroutingfailure"><code>IpDiscardRoutingFailure</code></h3>

<p>The packet was discarded due to a failure in routing.</p>

<h3 id="ipdiscardancillarydatafailure"><code>IpDiscardAncillaryDataFailure</code></h3>

<p>The packet was discarded because of a failure related to ancillary data processing.</p>

<h3 id="ipdiscardrawdatafailure"><code>IpDiscardRawDataFailure</code></h3>

<p>The packet was discarded due to a failure in processing raw data.</p>

<h3 id="ipdiscardsessionstatefailure"><code>IpDiscardSessionStateFailure</code></h3>

<p>The packet was discarded because of a failure related to session state management.</p>

<h3 id="ipdiscardipsnpiallocationfailure"><code>IpDiscardIpsnpiAllocationFailure</code></h3>

<p>The packet was discarded due to an allocation failure within the IPSNPI subsystem.</p>

<h3 id="ipdiscardipsnpimodifiedbutnotforwarded"><code>IpDiscardIpsnpiModifiedButNotForwarded</code></h3>

<p>The packet was modified by IPSNPI but not forwarded, leading to its discard.</p>

<h3 id="ipdiscardipsnpinonexthop"><code>IpDiscardIpsnpiNoNextHop</code></h3>

<p>The packet was discarded because no next hop could be determined in the IPSNPI subsystem.</p>

<h3 id="ipdiscardipsnpinocompartment"><code>IpDiscardIpsnpiNoCompartment</code></h3>

<p>The packet was discarded due to a missing compartment in the IPSNPI subsystem.</p>

<h3 id="ipdiscardipsnpinointerface"><code>IpDiscardIpsnpiNoInterface</code></h3>

<p>The packet was discarded because no interface was found in the IPSNPI subsystem.</p>

<h3 id="ipdiscardipsnpinosubinterface"><code>IpDiscardIpsnpiNoSubInterface</code></h3>

<p>The packet was discarded due to the absence of a sub-interface in the IPSNPI subsystem.</p>

<h3 id="ipdiscardipsnpiinterfacedisabled"><code>IpDiscardIpsnpiInterfaceDisabled</code></h3>

<p>The packet was discarded because the interface in the IPSNPI subsystem was disabled.</p>

<h3 id="ipdiscardipsnpisegmentationfailed"><code>IpDiscardIpsnpiSegmentationFailed</code></h3>

<p>The packet was discarded due to a failure in segmentation within the IPSNPI subsystem.</p>

<h3 id="ipdiscardipsnpinoethernetheader"><code>IpDiscardIpsnpiNoEthernetHeader</code></h3>

<p>The packet was discarded because it lacked an Ethernet header in the IPSNPI subsystem.</p>

<h3 id="ipdiscardipsnpiunexpectedfragment"><code>IpDiscardIpsnpiUnexpectedFragment</code></h3>

<p>The packet was discarded because it was an unexpected fragment in the IPSNPI subsystem.</p>

<h3 id="ipdiscardipsnpiunsupportedinterfacetype"><code>IpDiscardIpsnpiUnsupportedInterfaceType</code></h3>

<p>The packet was discarded due to an unsupported interface type in the IPSNPI subsystem.</p>

<h3 id="ipdiscardipsnpiinvalidlsoinfo"><code>IpDiscardIpsnpiInvalidLsoInfo</code></h3>

<p>The packet was discarded because of invalid Large Send Offload (LSO) information in the IPSNPI subsystem.</p>

<h3 id="ipdiscardipsnpiinvalidusoinfo"><code>IpDiscardIpsnpiInvalidUsoInfo</code></h3>

<p>The packet was discarded due to invalid UDP Segmentation Offload (USO) information in the IPSNPI subsystem.</p>

<h3 id="ipdiscardinternalerror"><code>IpDiscardInternalError</code></h3>

<p>The packet was discarded due to an internal error within the system.</p>

<h3 id="ipdiscardadministrativelyconfigured"><code>IpDiscardAdministrativelyConfigured</code></h3>

<p>The packet was discarded due to an administrative configuration that prevented its processing.</p>

<h3 id="ipdiscardbadoption"><code>IpDiscardBadOption</code></h3>

<p>The packet was discarded because it contained a bad option or an option that couldn't be processed.</p>

<h3 id="ipdiscardloopbackdisallowed"><code>IpDiscardLoopbackDisallowed</code></h3>

<p>The packet was discarded because loopback was disallowed for its type or destination.</p>

<h3 id="ipdiscardsmallerscope"><code>IpDiscardSmallerScope</code></h3>

<p>The packet was discarded because its scope was smaller than required for successful delivery.</p>

<h3 id="ipdiscardqueuefull"><code>IpDiscardQueueFull</code></h3>

<p>The packet was discarded because the processing queue was full.</p>

<h3 id="ipdiscardinterfacedisabled"><code>IpDiscardInterfaceDisabled</code></h3>

<p>The packet was discarded because the interface it arrived on was disabled.</p>

<h3 id="ipdiscardnlclientdiscard"><code>IpDiscardNlClientDiscard</code></h3>

<p>The packet was discarded by a Netlink client due to unspecified reasons.</p>

<h3 id="ipdiscardipsnpiurosegmentsizeexceedsmtu"><code>IpDiscardIpsnpiUroSegmentSizeExceedsMtu</code></h3>

<p>The packet was discarded because the segment size for UDP RSC Offload (URO) exceeded the MTU in the IPSNPI subsystem.</p>

<h3 id="ipdiscardswusofailure"><code>IpDiscardSwUsoFailure</code></h3>

<p>The packet was discarded due to a UDP Segmentation Offload (USO) failure.</p>

<h3 id="ipdiscardmax"><code>IpDiscardMax</code></h3>

<p>The maximum value for enumeration.</p>

<h2 id="remarks">Remarks</h2>

<h2 id="see-also">See also</h2>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/fwpsk/ne-fwpsk-ip_discard_reason">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/fwpsk/ne-fwpsk-ip_discard_reason.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
