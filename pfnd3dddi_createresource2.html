<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PFND3DDDI_CREATERESOURCE2 - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PFND3DDDI_CREATERESOURCE2 - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PFND3DDDI_CREATERESOURCE2 - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dumddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PFND3DDDI_CREATERESOURCE2 Pfnd3dddiCreateresource2;

HRESULT Pfnd3dddiCreateresource2(
  [in] HANDLE hDevice,
       <a href="d3dddiarg_createresource2" title="typedef struct _D3DDDIARG_CREATERESOURCE2 {&#10;  [in]     D3DDDIFORMAT                   Format;&#10;  [in]     D3DDDI_POOL                    Pool;&#10;  [in]     D3DDDIMULTISAMPLE_TYPE         MultisampleType;&#10;  [in]     UINT                           MultisampleQuality;&#10;  [in]     const D3DDDI_SURFACEINFO       *pSurfList;&#10;  [in]     UINT                           SurfCount;&#10;  [in]     UINT                           MipLevels;&#10;  [in]     UINT                           Fvf;&#10;  [in]     D3DDDI_VIDEO_PRESENT_SOURCE_ID VidPnSourceId;&#10;  [in]     D3DDDI_RATIONAL                RefreshRate;&#10;  [in/out] HANDLE                         hResource;&#10;  [in]     D3DDDI_RESOURCEFLAGS           Flags;&#10;  [in]     D3DDDI_ROTATION                Rotation;&#10;  [in]     D3DDDI_RESOURCEFLAGS2          Flags2;&#10;} D3DDDIARG_CREATERESOURCE2;">D3DDDIARG_CREATERESOURCE2</a> *unnamedParam2
)
{...}</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_createresource2">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pfnd3dddi_createresource2.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-d3dumddi-pfnd3dddi_createresource2)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pfnd3dddi_createresource2-callback-function">PFND3DDDI_CREATERESOURCE2 callback function</h1>

<h2 id="description">Description</h2>

<p>Creates a resource. Implemented by Windows Display Driver Model (WDDM) 1.2 and later user-mode display drivers.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="hdevice-in"><code>hDevice</code> [in]</h3>

<p>A handle to the display device (graphics context) that is used to create the resource.</p>

<h3 id="unnamedparam2"><code>unnamedParam2</code></h3>

<p><em>pResource2</em> [in, out]</p>

<p>A pointer to a <a href="d3dddiarg_createresource2" title="typedef struct _D3DDDIARG_CREATERESOURCE2 {&#10;  [in]     D3DDDIFORMAT                   Format;&#10;  [in]     D3DDDI_POOL                    Pool;&#10;  [in]     D3DDDIMULTISAMPLE_TYPE         MultisampleType;&#10;  [in]     UINT                           MultisampleQuality;&#10;  [in]     const D3DDDI_SURFACEINFO       *pSurfList;&#10;  [in]     UINT                           SurfCount;&#10;  [in]     UINT                           MipLevels;&#10;  [in]     UINT                           Fvf;&#10;  [in]     D3DDDI_VIDEO_PRESENT_SOURCE_ID VidPnSourceId;&#10;  [in]     D3DDDI_RATIONAL                RefreshRate;&#10;  [in/out] HANDLE                         hResource;&#10;  [in]     D3DDDI_RESOURCEFLAGS           Flags;&#10;  [in]     D3DDDI_ROTATION                Rotation;&#10;  [in]     D3DDDI_RESOURCEFLAGS2          Flags2;&#10;} D3DDDIARG_CREATERESOURCE2;">D3DDDIARG_CREATERESOURCE2</a> structure that describes the resource that is created.</p>

<h2 id="return-value">Return value</h2>

<p>Returns <strong>S_OK</strong> or an appropriate error result. WDDM 1.3 and later Direct3D Level 9 drivers must return this error code:</p>

<table>
<thead>
<tr>
  <th style="text-align:left;"><strong>Return code</strong></th>
  <th style="text-align:left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:left;"><strong>E_INVALIDARG</strong></td>
  <td style="text-align:left;">The <a href="d3dddiarg_createresource2" title="typedef struct _D3DDDIARG_CREATERESOURCE2 {&#10;  [in]     D3DDDIFORMAT                   Format;&#10;  [in]     D3DDDI_POOL                    Pool;&#10;  [in]     D3DDDIMULTISAMPLE_TYPE         MultisampleType;&#10;  [in]     UINT                           MultisampleQuality;&#10;  [in]     const D3DDDI_SURFACEINFO       *pSurfList;&#10;  [in]     UINT                           SurfCount;&#10;  [in]     UINT                           MipLevels;&#10;  [in]     UINT                           Fvf;&#10;  [in]     D3DDDI_VIDEO_PRESENT_SOURCE_ID VidPnSourceId;&#10;  [in]     D3DDDI_RATIONAL                RefreshRate;&#10;  [in/out] HANDLE                         hResource;&#10;  [in]     D3DDDI_RESOURCEFLAGS           Flags;&#10;  [in]     D3DDDI_ROTATION                Rotation;&#10;  [in]     D3DDDI_RESOURCEFLAGS2          Flags2;&#10;} D3DDDIARG_CREATERESOURCE2;">D3DDDIARG_CREATERESOURCE2</a> .Flagsmember has the CaptureBuffer flag value set and the resource exceeds what the driver can support.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>The call to <em>CreateResource2</em> can contain a list of surfaces. The <strong>SurfCount</strong> member of the <a href="d3dddiarg_createresource2" title="typedef struct _D3DDDIARG_CREATERESOURCE2 {&#10;  [in]     D3DDDIFORMAT                   Format;&#10;  [in]     D3DDDI_POOL                    Pool;&#10;  [in]     D3DDDIMULTISAMPLE_TYPE         MultisampleType;&#10;  [in]     UINT                           MultisampleQuality;&#10;  [in]     const D3DDDI_SURFACEINFO       *pSurfList;&#10;  [in]     UINT                           SurfCount;&#10;  [in]     UINT                           MipLevels;&#10;  [in]     UINT                           Fvf;&#10;  [in]     D3DDDI_VIDEO_PRESENT_SOURCE_ID VidPnSourceId;&#10;  [in]     D3DDDI_RATIONAL                RefreshRate;&#10;  [in/out] HANDLE                         hResource;&#10;  [in]     D3DDDI_RESOURCEFLAGS           Flags;&#10;  [in]     D3DDDI_ROTATION                Rotation;&#10;  [in]     D3DDDI_RESOURCEFLAGS2          Flags2;&#10;} D3DDDIARG_CREATERESOURCE2;">D3DDDIARG_CREATERESOURCE2</a> structure that is specified by the <em>pResource2</em> parameter specifies the number of surfaces—including MIP-map levels—to create. For example, a 256x256x9 texture MIP-map resource contains a list of nine surfaces where the <strong>SurfCount</strong> member and number of MIP-map levels are both set to 9. A cube map that contains nine MIP-map levels should have the number of MIP-map levels set to 9 and <strong>SurfCount</strong> set to 54. A three-surface swap chain should have <strong>SurfCount</strong> set to 3 and the number of MIP-map levels set to 0. Note that the number of MIP-map levels is always less than or equal to the value in <strong>SurfCount</strong>.</p>

<p>In response to the <em>CreateResource2</em> call, the user-mode display driver can call the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_allocatecb">pfnAllocateCb</a> function to create one or more memory allocations. The user-mode display driver must determine whether it must create multiple allocations per surface, one allocation for all surfaces, or one allocation per surface. For more information about allocations, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/display/video-memory-management-and-gpu-scheduling">Video Memory Management and GPU Scheduling</a>.</p>

<p><strong>Note</strong> The driver's <em>CreateResource2</em> function is not required to call <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_allocatecb">pfnAllocateCb</a> before returning; instead, the driver can defer allocation creation.</p>

<p><strong>Note</strong> A resource can be shared only if all of the allocations for the resource are made atomically in a single call to <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_allocatecb">pfnAllocateCb</a>.</p>

<p>The <strong>hResource</strong> member in the <a href="d3dddiarg_createresource2" title="typedef struct _D3DDDIARG_CREATERESOURCE2 {&#10;  [in]     D3DDDIFORMAT                   Format;&#10;  [in]     D3DDDI_POOL                    Pool;&#10;  [in]     D3DDDIMULTISAMPLE_TYPE         MultisampleType;&#10;  [in]     UINT                           MultisampleQuality;&#10;  [in]     const D3DDDI_SURFACEINFO       *pSurfList;&#10;  [in]     UINT                           SurfCount;&#10;  [in]     UINT                           MipLevels;&#10;  [in]     UINT                           Fvf;&#10;  [in]     D3DDDI_VIDEO_PRESENT_SOURCE_ID VidPnSourceId;&#10;  [in]     D3DDDI_RATIONAL                RefreshRate;&#10;  [in/out] HANDLE                         hResource;&#10;  [in]     D3DDDI_RESOURCEFLAGS           Flags;&#10;  [in]     D3DDDI_ROTATION                Rotation;&#10;  [in]     D3DDDI_RESOURCEFLAGS2          Flags2;&#10;} D3DDDIARG_CREATERESOURCE2;">D3DDDIARG_CREATERESOURCE2</a> structure is a handle that's used to identify the resource. The user-mode display driver should store the value of <strong>hResource</strong> that was passed in the <em>CreateResource2</em> call and overwrite the value with another value that the Microsoft Direct3D runtime can use when the <em>CreateResource2</em> call returns. In other words, in calls to the runtime, the user-mode display driver uses the <strong>hResource</strong> value that was passed to <em>CreateResource2</em>; in calls to the user-mode display driver (for example, in calls to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_settexture">SetTexture</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_setstreamsource">SetStreamSource</a> functions), the runtime uses the <strong>hResource</strong> value that was returned from <em>CreateResource2</em>. Note that each surface does not have an explicit handle; if the surface must be referred to individually (for example in a call to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_blt">Blt</a> function), it is referred to by a handle and an index. The index identifies the surface within the resource. The index is the same as the index of the surface in the array that is contained in the <strong>pSurfList</strong> member of <strong><a href="d3dddiarg_createresource2" title="typedef struct _D3DDDIARG_CREATERESOURCE2 {&#10;  [in]     D3DDDIFORMAT                   Format;&#10;  [in]     D3DDDI_POOL                    Pool;&#10;  [in]     D3DDDIMULTISAMPLE_TYPE         MultisampleType;&#10;  [in]     UINT                           MultisampleQuality;&#10;  [in]     const D3DDDI_SURFACEINFO       *pSurfList;&#10;  [in]     UINT                           SurfCount;&#10;  [in]     UINT                           MipLevels;&#10;  [in]     UINT                           Fvf;&#10;  [in]     D3DDDI_VIDEO_PRESENT_SOURCE_ID VidPnSourceId;&#10;  [in]     D3DDDI_RATIONAL                RefreshRate;&#10;  [in/out] HANDLE                         hResource;&#10;  [in]     D3DDDI_RESOURCEFLAGS           Flags;&#10;  [in]     D3DDDI_ROTATION                Rotation;&#10;  [in]     D3DDDI_RESOURCEFLAGS2          Flags2;&#10;} D3DDDIARG_CREATERESOURCE2;">D3DDDIARG_CREATERESOURCE2</a></strong>.</p>

<p>Resources can be shared by multiple devices (<strong>hDevice</strong>) and processes. The runtime specifies that a resource is shared by setting the <strong>SharedResource</strong> bit-field flag in the <strong>Flags</strong> member of <a href="d3dddiarg_createresource2" title="typedef struct _D3DDDIARG_CREATERESOURCE2 {&#10;  [in]     D3DDDIFORMAT                   Format;&#10;  [in]     D3DDDI_POOL                    Pool;&#10;  [in]     D3DDDIMULTISAMPLE_TYPE         MultisampleType;&#10;  [in]     UINT                           MultisampleQuality;&#10;  [in]     const D3DDDI_SURFACEINFO       *pSurfList;&#10;  [in]     UINT                           SurfCount;&#10;  [in]     UINT                           MipLevels;&#10;  [in]     UINT                           Fvf;&#10;  [in]     D3DDDI_VIDEO_PRESENT_SOURCE_ID VidPnSourceId;&#10;  [in]     D3DDDI_RATIONAL                RefreshRate;&#10;  [in/out] HANDLE                         hResource;&#10;  [in]     D3DDDI_RESOURCEFLAGS           Flags;&#10;  [in]     D3DDDI_ROTATION                Rotation;&#10;  [in]     D3DDDI_RESOURCEFLAGS2          Flags2;&#10;} D3DDDIARG_CREATERESOURCE2;">D3DDDIARG_CREATERESOURCE2</a>. If this bit-field flag is set, the user-mode display driver must adhere to the following restrictions on shared resources:</p>

<ul>
<li>The user-mode display driver can call the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_allocatecb">pfnAllocateCb</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_deallocatecb">pfnDeallocateCb</a> functions exactly once each.</li>
<li>The user-mode display driver cannot create additional allocations for the resource after the resource is initially created and likewise can destroy the resource allocations only at the time that the resource itself is destroyed.</li>
<li>When the user-mode display driver's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_destroyresource">DestroyResource</a> function is called for a shared resource that was created or opened through a call to the driver's <em>CreateResource2</em> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_openresource">OpenResource</a> function, the driver must set the <strong>hResource</strong> member of the <a href="d3dddicb_deallocate" title="typedef struct _D3DDDICB_DEALLOCATE {&#10;  [in] HANDLE              hResource;&#10;  [in] UINT                NumAllocations;&#10;  [in] const D3DKMT_HANDLE *HandleList;&#10;} D3DDDICB_DEALLOCATE;">D3DDDICB_DEALLOCATE</a> structure to non-NULL and the <strong>NumAllocations</strong> member of <strong><a href="d3dddicb_deallocate" title="typedef struct _D3DDDICB_DEALLOCATE {&#10;  [in] HANDLE              hResource;&#10;  [in] UINT                NumAllocations;&#10;  [in] const D3DKMT_HANDLE *HandleList;&#10;} D3DDDICB_DEALLOCATE;">D3DDDICB_DEALLOCATE</a></strong> to zero in a call to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_deallocatecb">pfnDeallocateCb</a> function to destroy or close the resource. That is, allocations that are associated with a shared resource cannot be destroyed or closed individually; the resource must be destroyed or closed atomically in one call to <em>pfnDeallocateCb</em>.</li>
<li>The number of allocations must be consistent for the resource type (that is, another process that is creating the same resource type should generate the same number and type of allocations). Furthermore, renaming is not allowed for these resources.</li>
</ul>

<p>The bit-field flags that are specified in the <a href="d3dddi_resourceflags2" title="typedef struct _D3DDDI_RESOURCEFLAGS2 {&#10;  union {&#10;    struct {&#10;      UINT VideoEncoder : 1;&#10;      UINT UserMemory : 1;&#10;      UINT CrossAdapter : 1;&#10;      UINT IsDisplayable : 1;&#10;#if ...&#10;      UINT Reserved : 28;&#10;#elif&#10;      UINT Reserved : 29;&#10;#else&#10;      UINT Reserved : 30;&#10;#endif&#10;    };&#10;    UINT Value;&#10;  };&#10;} D3DDDI_RESOURCEFLAGS2;">D3DDDI_RESOURCEFLAGS2</a> structure are passed in the **Flags** member of <a href="d3dddiarg_createresource2" title="typedef struct _D3DDDIARG_CREATERESOURCE2 {&#10;  [in]     D3DDDIFORMAT                   Format;&#10;  [in]     D3DDDI_POOL                    Pool;&#10;  [in]     D3DDDIMULTISAMPLE_TYPE         MultisampleType;&#10;  [in]     UINT                           MultisampleQuality;&#10;  [in]     const D3DDDI_SURFACEINFO       *pSurfList;&#10;  [in]     UINT                           SurfCount;&#10;  [in]     UINT                           MipLevels;&#10;  [in]     UINT                           Fvf;&#10;  [in]     D3DDDI_VIDEO_PRESENT_SOURCE_ID VidPnSourceId;&#10;  [in]     D3DDDI_RATIONAL                RefreshRate;&#10;  [in/out] HANDLE                         hResource;&#10;  [in]     D3DDDI_RESOURCEFLAGS           Flags;&#10;  [in]     D3DDDI_ROTATION                Rotation;&#10;  [in]     D3DDDI_RESOURCEFLAGS2          Flags2;&#10;} D3DDDIARG_CREATERESOURCE2;">D3DDDIARG_CREATERESOURCE2</a>.</p>

<p><strong>Note</strong> A resource can be created without specifying any flags. Surfaces that are associated with such a resource can potentially be locked and can be a source or destination in a bit-block transfer (bitblt) operation. However, such surfaces cannot be used for anything else.</p>

<p><strong>Note</strong> Plain surfaces are differentiated from textures or stand-alone render targets by the absence of the <strong>Texture</strong> or <strong>Primary</strong> bit-field flag. For example, the presence of the <strong>Primary</strong> bit-field flag indicates a stand-alone render target and the absence of this flag indicates a render target that is a back buffer.</p>

<p><strong>Note</strong> To ensure that changes to the runtime do not break existing drivers, the drivers must not use the following reserved members of the <a href="d3dddiarg_createresource2" title="typedef struct _D3DDDIARG_CREATERESOURCE2 {&#10;  [in]     D3DDDIFORMAT                   Format;&#10;  [in]     D3DDDI_POOL                    Pool;&#10;  [in]     D3DDDIMULTISAMPLE_TYPE         MultisampleType;&#10;  [in]     UINT                           MultisampleQuality;&#10;  [in]     const D3DDDI_SURFACEINFO       *pSurfList;&#10;  [in]     UINT                           SurfCount;&#10;  [in]     UINT                           MipLevels;&#10;  [in]     UINT                           Fvf;&#10;  [in]     D3DDDI_VIDEO_PRESENT_SOURCE_ID VidPnSourceId;&#10;  [in]     D3DDDI_RATIONAL                RefreshRate;&#10;  [in/out] HANDLE                         hResource;&#10;  [in]     D3DDDI_RESOURCEFLAGS           Flags;&#10;  [in]     D3DDDI_ROTATION                Rotation;&#10;  [in]     D3DDDI_RESOURCEFLAGS2          Flags2;&#10;} D3DDDIARG_CREATERESOURCE2;">D3DDDIARG_CREATERESOURCE2</a> structure in calls to their <em>CreateResource2</em> function to affect the behavior of the drivers:</p>

<ul>
<li>The undefined bits of the <strong>Flags</strong> member are reserved.</li>
<li>If the <strong>Primary</strong> bit-field flag is not set in <strong>Flags</strong>, the <strong>RefreshRate</strong> and <strong>Output</strong> members are reserved.</li>
<li>If the <strong>RenderTarget</strong>, <strong>DecodeRenderTarget</strong>, or <strong>VideoProcessRenderTarget</strong> bit-field flag is not set in <strong>Flags</strong>, the <strong>MultisampleType</strong> and <strong>MultisampleQuality</strong> members are reserved.</li>
<li>If the <strong>VertexBuffer</strong> bit-field flag is not set in <strong>Flags</strong>, the <strong>Fvf</strong> member is reserved.</li>
<li>If the <strong>Texture</strong>, <strong>CubeMap</strong>, and <strong>Volume</strong> bit-field flags are not set in <strong>Flags</strong>, the <strong>MipLevels</strong> member is reserved.</li>
</ul>

<p>For more information about creating and destroying resources, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/display/handling-resource-creation-and-destruction">Handling Resource Creation and Destruction</a>.</p>

<p>For a system memory resource, the display miniport driver can chose to wrap an allocation around the system memory if the system memory is properly aligned for direct access by the graphics processing unit (GPU). The display miniport driver wraps an allocation around the system memory by setting the <strong>ExistingSysMem</strong> flag in the <strong>Flags</strong> member of the <a href="dxgk_allocationinfo" title="typedef struct _DXGK_ALLOCATIONINFO {&#10;  VOID                       *pPrivateDriverData;&#10;  UINT                       PrivateDriverDataSize;&#10;  union {&#10;    UINT Alignment;&#10;    struct {&#10;      UINT16 MinimumPageSize;&#10;      UINT16 RecommendedPageSize;&#10;    };&#10;  };&#10;  SIZE_T                     Size;&#10;  SIZE_T                     PitchAlignedSize;&#10;  DXGK_SEGMENTBANKPREFERENCE HintedBank;&#10;  DXGK_SEGMENTPREFERENCE     PreferredSegment;&#10;  union {&#10;    UINT SupportedReadSegmentSet;&#10;    UINT MmuSet;&#10;  };&#10;  UINT                       SupportedWriteSegmentSet;&#10;  UINT                       EvictionSegmentSet;&#10;...">DXGK_ALLOCATIONINFO</a> structure when creating the allocation by using its <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_createallocation">DxgkDdiCreateAllocation</a> function. If the display miniport driver cannot wrap an allocation around the system memory or the wrapping fails, the driver should still succeed the creation of the resource and use the CPU to access the resource.</p>

<p>If the runtime requests to create a vertex or index buffer and if the user-mode display driver cannot create the buffer for reasons other than out of memory (for example, a lack of hardware support), the driver must fail with <strong>D3DERR_NOTAVAILABLE</strong>.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_blt">Blt</a></p>

<p><a href="d3dddiarg_createresource2" title="typedef struct _D3DDDIARG_CREATERESOURCE2 {&#10;  [in]     D3DDDIFORMAT                   Format;&#10;  [in]     D3DDDI_POOL                    Pool;&#10;  [in]     D3DDDIMULTISAMPLE_TYPE         MultisampleType;&#10;  [in]     UINT                           MultisampleQuality;&#10;  [in]     const D3DDDI_SURFACEINFO       *pSurfList;&#10;  [in]     UINT                           SurfCount;&#10;  [in]     UINT                           MipLevels;&#10;  [in]     UINT                           Fvf;&#10;  [in]     D3DDDI_VIDEO_PRESENT_SOURCE_ID VidPnSourceId;&#10;  [in]     D3DDDI_RATIONAL                RefreshRate;&#10;  [in/out] HANDLE                         hResource;&#10;  [in]     D3DDDI_RESOURCEFLAGS           Flags;&#10;  [in]     D3DDDI_ROTATION                Rotation;&#10;  [in]     D3DDDI_RESOURCEFLAGS2          Flags2;&#10;} D3DDDIARG_CREATERESOURCE2;">D3DDDIARG_CREATERESOURCE2</a></p>

<p><a href="d3dddi_resourceflags2" title="typedef struct _D3DDDI_RESOURCEFLAGS2 {&#10;  union {&#10;    struct {&#10;      UINT VideoEncoder : 1;&#10;      UINT UserMemory : 1;&#10;      UINT CrossAdapter : 1;&#10;      UINT IsDisplayable : 1;&#10;#if ...&#10;      UINT Reserved : 28;&#10;#elif&#10;      UINT Reserved : 29;&#10;#else&#10;      UINT Reserved : 30;&#10;#endif&#10;    };&#10;    UINT Value;&#10;  };&#10;} D3DDDI_RESOURCEFLAGS2;">D3DDDI_RESOURCEFLAGS2</a></p>

<p><a href="dxgk_allocationinfo" title="typedef struct _DXGK_ALLOCATIONINFO {&#10;  VOID                       *pPrivateDriverData;&#10;  UINT                       PrivateDriverDataSize;&#10;  union {&#10;    UINT Alignment;&#10;    struct {&#10;      UINT16 MinimumPageSize;&#10;      UINT16 RecommendedPageSize;&#10;    };&#10;  };&#10;  SIZE_T                     Size;&#10;  SIZE_T                     PitchAlignedSize;&#10;  DXGK_SEGMENTBANKPREFERENCE HintedBank;&#10;  DXGK_SEGMENTPREFERENCE     PreferredSegment;&#10;  union {&#10;    UINT SupportedReadSegmentSet;&#10;    UINT MmuSet;&#10;  };&#10;  UINT                       SupportedWriteSegmentSet;&#10;  UINT                       EvictionSegmentSet;&#10;...">DXGK_ALLOCATIONINFO</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_createallocation">DxgkDdiCreateAllocation</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_setstreamsource">SetStreamSource</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_settexture">SetTexture</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_allocatecb">pfnAllocateCb</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_deallocatecb">pfnDeallocateCb</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_createresource2">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dumddi/nc-d3dumddi-pfnd3dddi_createresource2.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
