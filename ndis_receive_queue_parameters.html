<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="NDIS_RECEIVE_QUEUE_PARAMETERS - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>NDIS_RECEIVE_QUEUE_PARAMETERS - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            NDIS_RECEIVE_QUEUE_PARAMETERS - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntddndis.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _NDIS_RECEIVE_QUEUE_PARAMETERS {
  <a href="ndis_object_header" title="typedef struct _NDIS_OBJECT_HEADER {&#10;  UCHAR  Type;&#10;  UCHAR  Revision;&#10;  USHORT Size;&#10;} NDIS_OBJECT_HEADER, *PNDIS_OBJECT_HEADER;">NDIS_OBJECT_HEADER</a>          Header;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                       Flags;
  <a href="ndis_receive_queue_type" title="typedef enum _NDIS_RECEIVE_QUEUE_TYPE {&#10;  NdisReceiveQueueTypeUnspecified,&#10;  NdisReceiveQueueTypeVMQueue,&#10;  NdisReceiveQueueTypeMaximum&#10;} NDIS_RECEIVE_QUEUE_TYPE, *PNDIS_RECEIVE_QUEUE_TYPE;">NDIS_RECEIVE_QUEUE_TYPE</a>     QueueType;
  NDIS_RECEIVE_QUEUE_ID       QueueId;
  NDIS_RECEIVE_QUEUE_GROUP_ID QueueGroupId;
  <a href="group_affinity" title="typedef struct _GROUP_AFFINITY {&#10;  KAFFINITY Mask;&#10;  USHORT    Group;&#10;  USHORT    Reserved[3];&#10;} GROUP_AFFINITY, *PGROUP_AFFINITY;">GROUP_AFFINITY</a>              ProcessorAffinity;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                       NumSuggestedReceiveBuffers;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                       MSIXTableEntry;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                       LookaheadSize;
  NDIS_VM_NAME                VmName;
  NDIS_QUEUE_NAME             QueueName;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                       PortId;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                       InterruptCoalescingDomainId;
  NDIS_QOS_SQ_ID              QosSqId;
} NDIS_RECEIVE_QUEUE_PARAMETERS, *PNDIS_RECEIVE_QUEUE_PARAMETERS;</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_receive_queue_parameters">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ndis_receive_queue_parameters.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-ntddndis-_ndis_receive_queue_parameters)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_ndis_receive_queue_parameters-structure">_NDIS_RECEIVE_QUEUE_PARAMETERS structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>NDIS_RECEIVE_QUEUE_PARAMETERS</strong> structure contains the configuration parameters of a receive
queue.</p>

<h2 id="members">Members</h2>

<h3 id="header"><code>Header</code></h3>

<p>The type, revision, and size of the <strong>NDIS_RECEIVE_QUEUE_PARAMETERS</strong> structure. This member is formatted as an <a rel="noopener" target="_blank" href="ndis_object_header">NDIS_OBJECT_HEADER</a> structure.</p>

<p>The miniport driver must set the <strong>Type</strong> member of <strong>Header</strong> to NDIS_OBJECT_TYPE_DEFAULT. To specify the version of the <strong><a href="ndis_nic_switch_capabilities" title="typedef struct _NDIS_NIC_SWITCH_CAPABILITIES {&#10;  NDIS_OBJECT_HEADER Header;&#10;  ULONG              Flags;&#10;  ULONG              NdisReserved1;&#10;  ULONG              NumTotalMacAddresses;&#10;  ULONG              NumMacAddressesPerPort;&#10;  ULONG              NumVlansPerPort;&#10;  ULONG              NdisReserved2;&#10;  ULONG              NdisReserved3;&#10;  ULONG              NicSwitchCapabilities;&#10;  ULONG              MaxNumSwitches;&#10;  ULONG              MaxNumVPorts;&#10;  ULONG              NdisReserved4;&#10;  ULONG              MaxNumVFs;&#10;  ULONG              MaxNumQueuePairs;&#10;  ULONG              NdisReserved5;&#10;  ULONG              NdisReserved6;&#10;  ULONG              NdisReserved7;&#10;  ULONG              MaxNumQueuePairsPerNonDefaultVPort;&#10;  ULONG              NdisReserved8;&#10;...">NDIS_NIC_SWITCH_CAPABILITIES</a></strong> structure, the driver must set the <strong>Revision</strong> member of <strong>Header</strong> to one of the following values:</p>

<h4 id="ndis_nic_switch_vport_parameters_revision_3">NDIS_NIC_SWITCH_VPORT_PARAMETERS_REVISION_3</h4>

<p>Added the <strong>QosSqId</strong> field for NDIS 6.50.</p>

<p>Set the <strong>Size</strong> member to <strong>NDIS_SIZEOF_NIC_SWITCH_VPORT_PARAMETERS_REVISION_3</strong>.</p>

<h4 id="ndis_receive_queue_parameters_revision_2">NDIS_RECEIVE_QUEUE_PARAMETERS_REVISION_2</h4>

<p>Added additional members for NDIS 6.30.</p>

<p>Set the <strong>Size</strong> member to <strong>NDIS_SIZEOF_RECEIVE_QUEUE_PARAMETERS_REVISION_2</strong>.</p>

<h4 id="ndis_receive_queue_parameters_revision_1">NDIS_RECEIVE_QUEUE_PARAMETERS_REVISION_1</h4>

<p>Original version for NDIS 6.20.</p>

<p>Set the <strong>Size</strong> member to <strong>NDIS_SIZEOF_RECEIVE_QUEUE_PARAMETERS_REVISION_1</strong>.</p>

<h3 id="flags"><code>Flags</code></h3>

<p>A <strong><a href="ulong" title="typedef unsigned long ULONG;">ULONG</a></strong> value that contains a bitwise <strong>OR</strong> of the following flags. The following flags are valid for the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-allocate-queue">OID_RECEIVE_FILTER_ALLOCATE_QUEUE</a> OID and the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-queue-parameters">OID_RECEIVE_FILTER_QUEUE_PARAMETERS</a> set and query OID:</p>

<h4 id="ndis_receive_queue_parameters_per_queue_receive_indication">NDIS_RECEIVE_QUEUE_PARAMETERS_PER_QUEUE_RECEIVE_INDICATION</h4>

<p>The miniport driver must not mix network packets for other receive queues with the packets for this queue in a single call to the <a rel="noopener" target="_blank" href="ndismindicatereceivenetbufferlists">NdisMIndicateReceiveNetBufferLists</a> function.</p>

<h4 id="ndis_receive_queue_parameters_lookahead_split_required">NDIS_RECEIVE_QUEUE_PARAMETERS_LOOKAHEAD_SPLIT_REQUIRED</h4>

<p>The network adapter must split a received packet at an offset equal to or greater than the requested lookahead size and use DMA to transfer the lookahead data and the post-lookahead data to separate shared memory segments.</p>

<blockquote>
  <p>[!NOTE]
  Starting with NDIS 6.30, splitting packet data into separate lookahead buffers is no longer supported. Miniport drivers that support NDIS 6.30 or later versions must ignore this flag.</p>
</blockquote>

<p>The following flags are valid for the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-queue-parameters">OID_RECEIVE_FILTER_QUEUE_PARAMETERS</a> set OID and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-receive-filter-queue-parameters">NDIS_STATUS_RECEIVE_FILTER_QUEUE_PARAMETERS</a> status indication:</p>

<h4 id="ndis_receive_queue_parameters_flags_changed">NDIS_RECEIVE_QUEUE_PARAMETERS_FLAGS_CHANGED</h4>

<p>The setting in the <strong>Flags</strong> member changed.</p>

<h4 id="ndis_receive_queue_parameters_processor_affinity_changed">NDIS_RECEIVE_QUEUE_PARAMETERS_PROCESSOR_AFFINITY_CHANGED</h4>

<p>The setting in the <strong>ProcessorAffinity</strong> member changed.</p>

<h4 id="ndis_receive_queue_parameters_suggested_recv_buffer_numbers_changed">NDIS_RECEIVE_QUEUE_PARAMETERS_SUGGESTED_RECV_BUFFER_NUMBERS_CHANGED</h4>

<p>The setting in the <strong>NumSuggestedReceiveBuffers</strong> member changed.</p>

<h4 id="ndis_receive_queue_parameters_name_changed">NDIS_RECEIVE_QUEUE_PARAMETERS_NAME_CHANGED</h4>

<p>The setting in the <strong>QueueName</strong> member changed.</p>

<blockquote>
  <p>[!NOTE]
  A driver determines which receive queue parameters have been changed by executing a bitwise <strong>AND</strong> operation between the <strong>NDIS_RECEIVE_QUEUE_PARAMETERS_CHANGE_MASK</strong> definition and the value in the <strong>Flags</strong> member. If the result is zero, no receive queue parameters have been changed.</p>
</blockquote>

<h3 id="queuetype"><code>QueueType</code></h3>

<p>An <a rel="noopener" target="_blank" href="ndis_receive_queue_type">NDIS_RECEIVE_QUEUE_TYPE</a> enumeration value that specifies the type of the receive queue.</p>

<h3 id="queueid"><code>QueueId</code></h3>

<p>An <strong>NDIS_RECEIVE_QUEUE_ID</strong> type value that contains a receive queue identifier. This identifier is an integer value between zero and the number of queues that the network adapter supports. A value of <strong>NDIS_DEFAULT_RECEIVE_QUEUE_ID</strong> specifies the default receive queue.</p>

<h3 id="queuegroupid"><code>QueueGroupId</code></h3>

<p>This member is reserved for NDIS.</p>

<h3 id="processoraffinity"><code>ProcessorAffinity</code></h3>

<p>A <strong><a href="group_affinity" title="typedef struct _GROUP_AFFINITY {&#10;  KAFFINITY Mask;&#10;  USHORT    Group;&#10;  USHORT    Reserved[3];&#10;} GROUP_AFFINITY, *PGROUP_AFFINITY;">GROUP_AFFINITY</a></strong> value that specifies the group number and a bitmap of the CPUs that this queue can be associated with. At least one processor must be specified. Therefore, the value must not be zero.</p>

<h3 id="numsuggestedreceivebuffers"><code>NumSuggestedReceiveBuffers</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains a suggested value for the number of receive buffers that the network adapter should use to support the queue. This number can be adjusted relative to the resources that the miniport driver has available or in proportion to the number that the network adapter uses for other queues. For example, the actual number of receive buffers can be double or half of this suggested value.</p>

<h3 id="msixtableentry"><code>MSIXTableEntry</code></h3>

<p>This member is reserved for NDIS.</p>

<h3 id="lookaheadsize"><code>LookaheadSize</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value for the size, in bytes, of the lookahead size requirement for this queue. A network adapter that supports lookahead in VM queues splits a received packet at an offset equal to or greater than the requested lookahead size and uses DMA to transfer the lookahead data and the post-lookahead data to separate shared memory segments. If the <strong>LookaheadSize</strong> is zero, the miniport driver must not split the packet.</p>

<p><strong>LookaheadSize</strong> is valid when NDIS sets the <strong>NDIS_RECEIVE_QUEUE_PARAMETERS_LOOKAHEAD_SPLIT_REQUIRED</strong> flag in the <strong>Flags</strong> member. That is, the miniport driver must split the packet at the specified lookahead size if the flag is also set. If the flag is clear, a nonzero value for <strong>LookaheadSize</strong> is invalid.</p>

<blockquote>
  <p>[!NOTE]
  Starting with NDIS 6.30, splitting packet data into separate lookahead buffers is no longer supported. The value of this member must be zero.</p>
</blockquote>

<h3 id="vmname"><code>VmName</code></h3>

<p>An <strong>NDIS_VM_NAME</strong> value that contains the description of the virtual machine that users read.</p>

<h3 id="queuename"><code>QueueName</code></h3>

<p>An <strong>NDIS_QUEUE_NAME</strong> value that contains the description of the queue that users read.</p>

<h3 id="portid"><code>PortId</code></h3>

<p>A <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> value that contains the unique identifier of a port on the Hyper-V extensible switch to which the VM queue is attached.</p>

<h3 id="interruptcoalescingdomainid"><code>InterruptCoalescingDomainId</code></h3>

<p>This member is reserved for NDIS.</p>

<h3 id="qossqid"><code>QosSqId</code></h3>

<p>Associates a Virtual Machine Queue (VMQ) with a Scheduler Queue (SQ). Set this field to <strong>zero</strong> for no SQ association. For more information on <strong>NDIS_QOS_SQ_ID</strong>, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-qos-offload-create-sq">OID_QOS_OFFLOAD_CREATE_SQ</a>.</p>

<p>Hardware Quality of Service (QoS) support for legacy VMQ is not required. The miniport driver may return NDIS_STATUS_NOT_SUPPORTED if <strong>QosSqId</strong> is non-zero.</p>

<h2 id="remarks">Remarks</h2>

<p>The <strong>NDIS_RECEIVE_QUEUE_PARAMETERS</strong> structure is used in the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-allocate-queue">OID_RECEIVE_FILTER_ALLOCATE_QUEUE</a> OID and the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-queue-parameters">OID_RECEIVE_FILTER_QUEUE_PARAMETERS</a> OID.</p>

<p>In NDIS 6.30, the <strong>NDIS_RECEIVE_QUEUE_PARAMETERS</strong> structure is also used in <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-receive-filter-queue-parameters">NDIS_STATUS_RECEIVE_FILTER_QUEUE_PARAMETERS</a> status indications.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="ndis_object_header">NDIS_OBJECT_HEADER</a></p>

<p><a rel="noopener" target="_blank" href="ndis_receive_queue_type">NDIS_RECEIVE_QUEUE_TYPE</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/ndis-status-receive-filter-queue-parameters">NDIS_STATUS_RECEIVE_FILTER_QUEUE_PARAMETERS</a></p>

<p><a rel="noopener" target="_blank" href="ndismindicatereceivenetbufferlists">NdisMIndicateReceiveNetBufferLists</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-allocate-queue">OID_RECEIVE_FILTER_ALLOCATE_QUEUE</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/network/oid-receive-filter-queue-parameters">OID_RECEIVE_FILTER_QUEUE_PARAMETERS</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntddndis/ns-ntddndis-_ndis_receive_queue_parameters">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntddndis/ns-ntddndis-_ndis_receive_queue_parameters.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
