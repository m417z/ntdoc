<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PFNCOMPROPSHEET - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PFNCOMPROPSHEET - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PFNCOMPROPSHEET - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// compstui.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PFNCOMPROPSHEET Pfncompropsheet;

<a href="long_ptr" title="typedef [public] __int3264 LONG_PTR;">LONG_PTR</a> Pfncompropsheet(
  [in] HANDLE hComPropSheet,
  [in] <a href="uint" title="typedef unsigned int UINT;">UINT</a> Function,
  [in] LPARAM lParam1,
  [in] LPARAM lParam2
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/compstui/nc-compstui-pfncompropsheet">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pfncompropsheet.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-compstui-pfncompropsheet)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2>Description</h2>
<p>The <em>ComPropSheet</em> function is supplied by <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/common-property-sheet-user-interface">CPSUI</a> and can be called by CPSUI applications (including printer interface DLLs) to build property sheet pages.</p>
<h2>Parameters</h2>
<h3><code>hComPropSheet</code> [in]</h3>
<p>Caller-supplied handle to a property sheet <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/group-parent">group parent</a>. For more information, see the following Remarks section.</p>
<h3><code>Function</code> [in]</h3>
<p>Caller-supplied, CPSFUNC_-prefixed ComPropSheet function codes specifying the operation to be performed by the <em>ComPropSheet</em> function. See the <em>ComPropSheet</em> function codes table in the <strong>Remarks</strong> section below.</p>
<h3><code>lParam1</code> [in]</h3>
<p>Caller-supplied value that depends on the <em>ComPropSheet</em> function code supplied for <em>Function</em>.</p>
<h3><code>lParam2</code> [in]</h3>
<p>Caller-supplied value that depends on the <em>ComPropSheet</em> function code supplied for <em>Function</em>.</p>
<h2>Return value</h2>
<p>The return value depends on the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/_print/">ComPropSheet function code</a> supplied for <em>Function</em>.</p>
<h2>Remarks</h2>
<p>When CPSUI calls one of an application's <a href="pfnpropsheetui" title="PFNPROPSHEETUI Pfnpropsheetui;&#10;&#10;LONG Pfnpropsheetui(&#10;  PPROPSHEETUI_INFO pPSUIInfo,&#10;  LPARAM lParam&#10;)&#10;{...}">PFNPROPSHEETUI</a>-typed functions, it passes a pointer to the <em>ComPropSheet</em> function in a <a href="propsheetui_info" title="typedef struct _PROPSHEETUI_INFO {&#10;  WORD            cbSize;&#10;  WORD            Version;&#10;  WORD            Flags;&#10;  WORD            Reason;&#10;  HANDLE          hComPropSheet;&#10;  PFNCOMPROPSHEET pfnComPropSheet;&#10;  LPARAM          lParamInit;&#10;  ULONG_PTR       UserData;&#10;  ULONG_PTR       Result;&#10;} PROPSHEETUI_INFO, *PPROPSHEETUI_INFO;">PROPSHEETUI_INFO</a> structure. A <strong><a href="pfnpropsheetui" title="PFNPROPSHEETUI Pfnpropsheetui;&#10;&#10;LONG Pfnpropsheetui(&#10;  PPROPSHEETUI_INFO pPSUIInfo,&#10;  LPARAM lParam&#10;)&#10;{...}">PFNPROPSHEETUI</a></strong>-typed function can call the <em>ComPropSheet</em> function to describe property sheet pages to CPSUI.</p>
<p>A <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/printer-interface-dll">printer interface DLL</a> can call <em>ComPropSheet</em> from within its <a href="drvdocumentpropertysheets" title="LONG DrvDocumentPropertySheets(&#10;  [in, optional] PPROPSHEETUI_INFO pPSUIInfo,&#10;                 LPARAM            lParam&#10;);">DrvDocumentPropertySheets</a> function or its <a href="drvdevicepropertysheets" title="LONG DrvDevicePropertySheets(&#10;  [in, optional] PPROPSHEETUI_INFO pPSUIInfo,&#10;                 LPARAM            lParam&#10;);">DrvDevicePropertySheets</a> function.</p>
<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/user-interface-plug-ins">User interface plug-ins</a> for Microsoft's <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/">Unidrv</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/">Pscript</a> drivers can call <em>ComPropSheet</em> from within their <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/prcomoem/nf-prcomoem-iprintoemui-documentpropertysheets">IPrintOemUI::DocumentPropertySheets</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/prcomoem/nf-prcomoem-iprintoemui-devicepropertysheets">IPrintOemUI::DevicePropertySheets</a> methods.</p>
<p>The <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/group-parent">group parent</a> handle specified for the <em>hComPropSheet</em> parameter can be either of the following:</p>
<ul>
<li>

</li>
<li>

</li>
</ul>
<h3>ComPropSheet function codes</h3>
<p>The following function codes can be passed to the CPSUI's <strong>ComPropSheet</strong> function:</p>
<h4>CPSFUNC_ADD_HPROPSHEETPAGE</h4>
<p>The <strong>CPSFUNC_ADD_HPROPSHEETPAGE</strong> function code causes the <strong>ComPropSheet</strong> function to add a property sheet page that has been created by calling the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/prsht/nf-prsht-createpropertysheetpagew"><strong>CreatePropertySheetPage</strong></a> function.</p>
<h5>Parameters (CPSFUNC_ADD_HPROPSHEETPAGE)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_ADD_HPROPSHEETPAGE)</h5>
<p>If the operation succeeds, <strong>ComPropSheet</strong> returns a CPSUI handle to the added page; otherwise, it returns NULL.</p>
<h4>CPSFUNC_ADD_PCOMPROPSHEETUI</h4>
<p>The <strong>CPSFUNC_ADD_PCOMPROPSHEETUI</strong> function code causes the <strong>ComPropSheet</strong> function to add a set of one or more property sheet pages that are described by a <strong><a href="compropsheetui" title="typedef struct _COMPROPSHEETUI {&#10;  WORD           cbSize;&#10;  WORD           Flags;&#10;  HINSTANCE      hInstCaller;&#10;  LPTSTR         pCallerName;&#10;  ULONG_PTR      UserData;&#10;  LPTSTR         pHelpFile;&#10;  _CPSUICALLBACK pfnCallBack;&#10;  POPTITEM       pOptItem;&#10;  PDLGPAGE       pDlgPage;&#10;  WORD           cOptItem;&#10;  WORD           cDlgPage;&#10;  ULONG_PTR      IconID;&#10;  LPTSTR         pOptItemName;&#10;  WORD           CallerVersion;&#10;  WORD           OptItemVersion;&#10;  ULONG_PTR      dwReserved[4];&#10;} COMPROPSHEETUI, *PCOMPROPSHEETUI;">COMPROPSHEETUI</a></strong> structure.</p>
<h5>Parameters</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Return value</h5>
<p>If the operation succeeds, <strong>ComPropSheet</strong> returns a handle to the set of added pages; otherwise, the function returns NULL.</p>
<h4>CPSFUNC_ADD_PFNPROPSHEETUI</h4>
<p>The <strong>CPSFUNC_ADD_PFNPROPSHEETUI</strong> function code causes the <strong>ComPropSheet</strong> function to call the specified <a href="pfnpropsheetui" title="PFNPROPSHEETUI Pfnpropsheetui;&#10;&#10;LONG Pfnpropsheetui(&#10;  PPROPSHEETUI_INFO pPSUIInfo,&#10;  LPARAM lParam&#10;)&#10;{...}">PFNPROPSHEETUI</a>-typed function, which must add a set of one or more property sheet pages.</p>
<h5>Parameters (CPSFUNC_ADD_PFNPROPSHEETUI)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_ADD_PFNPROPSHEETUI)</h5>
<p>If the operation succeeds, <strong>ComPropSheet</strong> returns a handle to the set of added pages; otherwise, the function returns NULL.</p>
<h4>CPSFUNC_ADD_PROPSHEETPAGE</h4>
<p>The <strong>CPSFUNC_ADD_PROPSHEETPAGE</strong> function code causes the <strong>ComPropSheet</strong> function to add the type of property sheet page that is described by a <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/controls/pss-propsheetpage"><strong>PROPSHEETPAGE</strong></a> structure.</p>
<h5>Parameters (CPSFUNC_ADD_PROPSHEETPAGE)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_ADD_PROPSHEETPAGE)</h5>
<p>If the operation succeeds, <strong>ComPropSheet</strong> returns a CPSUI handle to the added page; otherwise, it returns NULL.</p>
<h4>CPSFUNC_DELETE_HCOMPROPSHEET</h4>
<p>The <strong>CPSFUNC_DELETE_HCOMPROPSHEET</strong> function code causes the <strong>ComPropSheet</strong> function to delete a set of property sheet pages that are specified by a CPSUI handle.</p>
<h5>Parameters (CPSFUNC_DELETE_HCOMPROPSHEET)</h5>
<ul>
<li>

</li>
<li>

</li>
<li><p><em>lParam1</em>: CPSUI handle that refers to the set of pages to be deleted. This handle must previously have been obtained by a call to <strong>ComPropSheet</strong> with one of the following function codes:</p>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul></li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_DELETE_HCOMPROPSHEET)</h5>
<p>The <strong>ComPropSheet</strong> function returns the number of property sheet pages that were deleted.</p>
<h4>CPSFUNC_DO_APPLY_CPSUI</h4>
<p>The <strong>CPSFUNC_DO_APPLY_CPSUI</strong> function code causes the <strong>ComPropSheet</strong> function to simulate the delivery of a PSN_APPLY notification message.</p>
<p>CPSUI responds to the <strong>CPSFUNC_DO_APPLY_CPSUI</strong> function code by delivering the <strong>CPSUICB_REASON_APPLYNOW</strong> reason to an application's <a href="_cpsuicallback" title="_CPSUICALLBACK Cpsuicallback;&#10;&#10;LONG Cpsuicallback(&#10;  PCPSUICBPARAM pCPSUICBParam&#10;)&#10;{...}">_CPSUICALLBACK</a>-typed callback function.</p>
<h5>Parameters (CPSFUNC_DO_APPLY_CPSUI)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li><p><em>lParam2</em>: This parameter is any combination of the following bit flags:</p>
<ul>
<li>

</li>
<li>

</li>
</ul></li>
</ul>
<h5>Return value (CPSFUNC_DO_APPLY_CPSUI)</h5>
<p>If the operation succeeds, the <strong>ComPropSheet</strong> function returns a nonzero value; otherwise it returns zero and the specified pages will become active.</p>
<p>If you use the <strong>CPSFUNC_IGNORE_CPSUI_PSN_APPLY</strong> function code to disable CPSUI's handling of the PSN_APPLY notification message, you must use the <strong>CPSFUNC_DO_APPLY_CPSUI</strong> function code to simulate delivery of the PSN_APPLY message. Otherwise, user changes to a property sheet page cannot be obtained.</p>
<h4>CPSFUNC_GET_HPSUIPAGES</h4>
<p>The <strong>CPSFUNC_GET_HPSUIPAGES</strong> function code causes the <strong>ComPropSheet</strong> function to return an array of CPSUI handles that point to property sheet pages. These handles identify the child pages associated with the specified group parent handle.</p>
<p>To use this function code, follow these steps:</p>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Parameters (CPSFUNC_GET_HPSUIPAGES)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_GET_HPSUIPAGES)</h5>
<p>The <strong>ComPropSheet</strong> function returns the number of handles that CPSUI places into the HANDLE array.</p>
<h4>CPSFUNC_GET_PAGECOUNT</h4>
<p>The <strong>CPSFUNC_GET_PAGECOUNT</strong> function code causes the <strong>ComPropSheet</strong> function to return the number of property sheet pages that are child pages of the specified group parent handle.</p>
<h5>Parameters (CPSFUNC_GET_PAGECOUNT)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_GET_PAGECOUNT)</h5>
<p>The <strong>ComPropSheet</strong> function returns the number of pages counted.</p>
<h4>CPSFUNC_GET_PFNPROPSHEETUI_ICON</h4>
<p>The <strong>CPSFUNC_GET_PFNPROPSHEETUI_ICON</strong> function code causes the <strong>ComPropSheet</strong> function to return a handle to the icon that is associated with a set of property sheet pages. The set of pages must have been previously created by a <a href="pfnpropsheetui" title="PFNPROPSHEETUI Pfnpropsheetui;&#10;&#10;LONG Pfnpropsheetui(&#10;  PPROPSHEETUI_INFO pPSUIInfo,&#10;  LPARAM lParam&#10;)&#10;{...}">PFNPROPSHEETUI</a>-typed function.</p>
<p>The <strong>ComPropSheet</strong> function calls the <a href="pfnpropsheetui" title="PFNPROPSHEETUI Pfnpropsheetui;&#10;&#10;LONG Pfnpropsheetui(&#10;  PPROPSHEETUI_INFO pPSUIInfo,&#10;  LPARAM lParam&#10;)&#10;{...}">PFNPROPSHEETUI</a>-typed function associated with the specified page handle, and passes a reason value of <strong>PROPSHEETUI_REASON_GET_ICON</strong>. The <a href="pfnpropsheetui" title="PFNPROPSHEETUI Pfnpropsheetui;&#10;&#10;LONG Pfnpropsheetui(&#10;  PPROPSHEETUI_INFO pPSUIInfo,&#10;  LPARAM lParam&#10;)&#10;{...}">PFNPROPSHEETUI</a>-typed function then calls <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winuser/nf-winuser-loadimagew"><strong>LoadImage</strong></a> and provides the icon size specified bylParam2 to load an icon resource.</p>
<h5>Parameters (CPSFUNC_GET_PFNPROPSHEETUI_ICON)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_GET_PFNPROPSHEETUI_ICON)</h5>
<p>If the operation succeeds, the <strong>ComPropSheet</strong> function returns an icon handle; otherwise it returns NULL.</p>
<h4>CPSFUNC_IGNORE_CPSUI_PSN_APPLY</h4>
<p>The <strong>CPSFUNC_IGNORE_CPSUI_PSN_APPLY</strong> function code causes the <strong>ComPropSheet</strong> function to disable or reenable CPSUI's handling of the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/controls/psn-apply">PSN_APPLY</a> notification message.</p>
<p>The system sends the PSN_APPLY notification message to CPSUI when a user selects a property sheet's OK or Cancel button. CPSUI responds to this message by delivering the <strong>CPSUICB_REASON_APPLYNOW</strong> reason to an application's <a href="_cpsuicallback" title="_CPSUICALLBACK Cpsuicallback;&#10;&#10;LONG Cpsuicallback(&#10;  PCPSUICBPARAM pCPSUICBParam&#10;)&#10;{...}">_CPSUICALLBACK</a>-typed callback function.</p>
<p>If you disable CPSUI's handling of the PSN_APPLY notification message, you must use the <strong>CPSFUNC_DO_APPLY_CPSUI</strong> function code to simulate delivery of the PSN_APPLY message. Otherwise, user changes to a property sheet page cannot be obtained.</p>
<p>If the <strong>CPSFUNC_IGNORE_CPSUI_PSN_APPLY</strong> function code is not used, CPSUI's handling of the PSN_APPLY notification message is enabled by default.</p>
<h5>Parameters (CPSFUNC_IGNORE_CPSUI_PSN_APPLY)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_IGNORE_CPSUI_PSN_APPLY)</h5>
<p>If the operation succeeds, the <strong>ComPropSheet</strong> function returns a nonzero value; otherwise it returns zero.</p>
<h4>CPSFUNC_INSERT_PSUIPAGE</h4>
<p>The <strong>CPSFUNC_INSERT_PSUIPAGE</strong> function code causes the <strong>ComPropSheet</strong> function to insert a set of property sheet pages at a specific position.</p>
<h5>Parameters (CPSFUNC_INSERT_PSUIPAGE)</h5>
<ul>
<li>

</li>
<li>

</li>
<li><p><em>lParam1</em>: Specifies a handle to a set of one or more property sheet pages. The new pages will be inserted before or after these pages, depending on the Mode member of the <strong><a href="insertpsuipage_info" title="typedef struct _INSERTPSUIPAGE_INFO {&#10;  WORD      cbSize;&#10;  BYTE      Type;&#10;  BYTE      Mode;&#10;  ULONG_PTR dwData1;&#10;  ULONG_PTR dwData2;&#10;  ULONG_PTR dwData3;&#10;} INSERTPSUIPAGE_INFO, *PINSERTPSUIPAGE_INFO;">INSERTPSUIPAGE_INFO</a></strong> structure pointed to by <em>lParam2</em>. This handle must previously have been obtained by a call to <strong>ComPropSheet</strong> with one of the following function codes:</p>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul></li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_INSERT_PSUIPAGE)</h5>
<p>If the operation succeeds, the <strong>ComPropSheet</strong> function returns a handle to the set of pages that were inserted; otherwise, the function returns NULL.</p>
<h4>CPSFUNC_LOAD_CPSUI_ICON</h4>
<p>The <strong>CPSFUNC_LOAD_CPSUI_ICON</strong> function code causes the <strong>ComPropSheet</strong> function to load a CPSUI-supplied icon resource.</p>
<p>CPSUI calls <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winuser/nf-winuser-loadimagew"><strong>LoadImage</strong></a> to load the specified icon resource.</p>
<h5>Parameters (CPSFUNC_LOAD_CPSUI_ICON)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_LOAD_CPSUI_ICON)</h5>
<p>If the operation succeeds, the <strong>ComPropSheet</strong> function returns an icon handle; otherwise it returns NULL.</p>
<h4>CPSFUNC_LOAD_CPSUI_STRING</h4>
<p>The <strong>CPSFUNC_LOAD_CPSUI_STRING</strong> function code causes the <strong>ComPropSheet</strong> function to load a CPSUI-supplied string resource.</p>
<p>The <strong>ComPropSheet</strong> function calls the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winuser/nf-winuser-loadstringw"><strong>LoadString</strong></a> function to load the specified string.</p>
<h5>Parameters (CPSFUNC_LOAD_CPSUI_STRING)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li><p><em>lParam2</em>: Contains the following two caller-supplied values:</p>
<ul>
<li>

</li>
<li>

</li>
</ul></li>
</ul>
<h5>Return value (CPSFUNC_LOAD_CPSUI_STRING)</h5>
<p>If the operation succeeds, the <strong>ComPropSheet</strong> function returns the length of the string. If an invalid resource identifier is specified, the function returns zero. If <em>lParam1</em> is NULL or <a href="loword" title="#define LOWORD(l) ((WORD)(((DWORD_PTR)(l)) &amp; 0xffff))">LOWORD</a>(<em>lParam2</em>) is zero, the function returns -1.</p>
<h4>CPSFUNC_QUERY_DATABLOCK</h4>
<p>The <strong>CPSFUNC_QUERY_DATABLOCK</strong> function code causes the <strong>ComPropSheet</strong> function to retrieve a caller-supplied data block that was previously stored using the <strong>CPSFUNC_SET_DATABLOCK</strong> function code.</p>
<p>Typically, this function code is used by a <a href="_cpsuicallback" title="_CPSUICALLBACK Cpsuicallback;&#10;&#10;LONG Cpsuicallback(&#10;  PCPSUICBPARAM pCPSUICBParam&#10;)&#10;{...}">_CPSUICALLBACK</a>-typed callback function (when the function's <strong><a href="cpsuicbparam" title="typedef struct _CPSUICBPARAM {&#10;  WORD      cbSize;&#10;  WORD      Reason;&#10;  HWND      hDlg;&#10;  POPTITEM  pOptItem;&#10;  WORD      cOptItem;&#10;  WORD      Flags;&#10;  POPTITEM  pCurItem;&#10;  union {&#10;    LONG   OldSel;&#10;    LPTSTR pOldSel;&#10;  } DUMMYUNIONNAME;&#10;  ULONG_PTR UserData;&#10;  ULONG_PTR Result;&#10;} CPSUICBPARAM, *PCPSUICBPARAM;">CPSUICBPARAM</a></strong> structure contains a Reason value of <strong>CPSUICB_REASON_SETACTIVE</strong>) to retrieve values associated with another page before the current page becomes inactive.</p>
<h5>Parameters (CPSFUNC_QUERY_DATABLOCK)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_QUERY_DATABLOCK)</h5>
<p>If the operation succeeds, the <strong>ComPropSheet</strong> function returns a value that represents the size of the retrieved data block. If <em>lParam1</em> is NULL, or if the value of any member of the supplied <strong><a href="cpsuidatablock" title="typedef struct _CPSUIDATABLOCK {&#10;  DWORD  cbData;&#10;  LPBYTE pbData;&#10;} CPSUIDATABLOCK, *PCPSUIDATABLOCK;">CPSUIDATABLOCK</a></strong> structure is zero, <strong>ComPropSheet</strong> returns the size required to store the data block. If an error occurs, the function returns a value less than or equal to zero.</p>
<h4>CPSFUNC_SET_DATABLOCK</h4>
<p>The <strong>CPSFUNC_SET_DATABLOCK</strong> function code causes the <strong>ComPropSheet</strong> function to store a caller-supplied data block. You can use this function code to make the information about a property sheet page available to other pages.</p>
<p>Typically, this function code is used by a <a href="_cpsuicallback" title="_CPSUICALLBACK Cpsuicallback;&#10;&#10;LONG Cpsuicallback(&#10;  PCPSUICBPARAM pCPSUICBParam&#10;)&#10;{...}">_CPSUICALLBACK</a>-typed callback function (when the function's <strong><a href="cpsuicbparam" title="typedef struct _CPSUICBPARAM {&#10;  WORD      cbSize;&#10;  WORD      Reason;&#10;  HWND      hDlg;&#10;  POPTITEM  pOptItem;&#10;  WORD      cOptItem;&#10;  WORD      Flags;&#10;  POPTITEM  pCurItem;&#10;  union {&#10;    LONG   OldSel;&#10;    LPTSTR pOldSel;&#10;  } DUMMYUNIONNAME;&#10;  ULONG_PTR UserData;&#10;  ULONG_PTR Result;&#10;} CPSUICBPARAM, *PCPSUICBPARAM;">CPSUICBPARAM</a></strong> structure contains a Reason value of <strong>CPSUICB_REASON_KILLACTIVE</strong>) to save values associated with a page before it becomes inactive.</p>
<h5>Parameters (CPSFUNC_SET_DATABLOCK)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_SET_DATABLOCK)</h5>
<p>If the operation is successful, the <strong>ComPropSheet</strong> function returns a value representing the number of bytes that were stored; otherwise it returns a value less than or equal to zero.</p>
<h4>CPSFUNC_SET_DMPUB_HIDEBITS</h4>
<p>The <strong>CPSFUNC_SET_DMPUB_HIDEBITS</strong> function code causes the <strong>ComPropSheet</strong> function to "hide" a specified set of document property options, so that they are not displayed.</p>
<p>You can use the <strong>CPSFUNC_SET_DMPUB_HIDEBITS</strong> function code if you want to define <a href="optitem" title="typedef struct _OPTITEM {&#10;  WORD      cbSize;&#10;  BYTE      Level;&#10;  BYTE      DlgPageIdx;&#10;  DWORD     Flags;&#10;  ULONG_PTR UserData;&#10;  LPTSTR    pName;&#10;  union {&#10;    LONG   Sel;&#10;    LPTSTR pSel;&#10;  } DUMMYUNIONNAME;&#10;  union {&#10;    PEXTCHKBOX pExtChkBox;&#10;    PEXTPUSH   pExtPush;&#10;  } DUMMYUNIONNAME2;&#10;  POPTTYPE  pOptType;&#10;  DWORD     HelpIndex;&#10;  BYTE      DMPubID;&#10;  BYTE      UserItemID;&#10;  WORD      wReserved;&#10;...">OPTITEM</a> structures for one or more document property sheet options, but you do not want the options to be user-modifiable. The property sheet page must be defined using the <strong><a href="compropsheetui" title="typedef struct _COMPROPSHEETUI {&#10;  WORD           cbSize;&#10;  WORD           Flags;&#10;  HINSTANCE      hInstCaller;&#10;  LPTSTR         pCallerName;&#10;  ULONG_PTR      UserData;&#10;  LPTSTR         pHelpFile;&#10;  _CPSUICALLBACK pfnCallBack;&#10;  POPTITEM       pOptItem;&#10;  PDLGPAGE       pDlgPage;&#10;  WORD           cOptItem;&#10;  WORD           cDlgPage;&#10;  ULONG_PTR      IconID;&#10;  LPTSTR         pOptItemName;&#10;  WORD           CallerVersion;&#10;  WORD           OptItemVersion;&#10;  ULONG_PTR      dwReserved[4];&#10;} COMPROPSHEETUI, *PCOMPROPSHEETUI;">COMPROPSHEETUI</a></strong> structure, and the structure's pDlgPage member must be <strong>CPSUI_PDLGPAGE_DOCPROP</strong> or <strong>CPSUI_PDLGPAGE_ADVDOCPROP</strong>.</p>
<p>If you use the <strong>CPSFUNC_SET_DMPUB_HIDEBITS</strong> function code, it must be specified to <strong>ComPropSheet</strong> before the <strong>CPSFUNC_ADD_PCOMPROPSHEETUI</strong> or <strong>CPSFUNC_INSERT_PSUIPAGE</strong> function code is used to create the page.</p>
<h5>Parameters (CPSFUNC_SET_DMPUB_HIDEBITS)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_SET_DMPUB_HIDEBITS)</h5>
<p>If the operation is successful, the <strong>ComPropSheet</strong> function returns the value specified for <em>lParam1</em>; otherwise it returns zero.</p>
<h4>CPSFUNC_SET_FUSION_CONTEXT</h4>
<p>The <strong>CPSFUNC_SET_FUSION_CONTEXT</strong> sets a Fusion activation context for the specified page.</p>
<p>When a page is about to be created or inserted and it does not specify an activation context in its <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/controls/pss-propsheetpage"><strong>PROPSHEETPAGE</strong></a> structure, it will be created in the parent's page activation context.</p>
<p>If the parent's activation context is not set, then Compstui.dll looks up the parent's parent, continuing until the top level parent is reached or until it finds a parent with an activation context properly set.</p>
<p>If none of the parents has an activation context set, then Compstui.dll will not specify an activation context in the <strong>PROPSHEETPAGE</strong> structure. This means that the page will be created in the activation context of the caller of the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/prsht/nf-prsht-propertysheetw"><strong>PropertySheet</strong></a> function.</p>
<h5>Parameters (CPSFUNC_SET_FUSION_CONTEXT)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_SET_FUSION_CONTEXT)</h5>
<p>If the operation is successful, the <strong>ComPropSheet</strong> function returns a value greater than zero. Otherwise, <strong>ComPropSheet</strong> returns a value that is less than or equal to zero. For information about the error, use the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror"><strong>GetLastError</strong></a> function.</p>
<h4>CPSFUNC_SET_HSTARTPAGE</h4>
<p>The <strong>CPSFUNC_SET_HSTARTPAGE</strong> function code causes the <strong>ComPropSheet</strong> function to mark a specified property sheet page to be the top page of the associated property sheet. If the property sheet is currently being displayed, the specified page becomes the active page.</p>
<h5>Parameters (CPSFUNC_SET_HSTARTPAGE)</h5>
<ul>
<li>

</li>
<li>

</li>
<li><p><em>lParam1</em>: Caller-supplied CPSUI page handle, previously obtained by a call to <strong>ComPropSheet</strong> with one of the following function codes:</p>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<p>If the handle represents a single page belonging to the group specified by <em>hComPropSheet</em>, CPSUI makes this page the top page.</p>
<p>If the handle represents a group parent handle (see <strong>CPSFUNC_INSERT_PSUIPAGE</strong>), then <em>lParam2</em> represents a zero-based index into the group's pages and the page represented by the index becomes the top page.</p></li>
<li><p><em>lParam2</em>: If lParam1 represents a group parent handle, this caller-supplied value is a zero-based index into the group's pages. If <em>lParam1</em> represents a single page belonging to the group specified by <em>hComPropSheet</em>, this parameter is not used. If the handle specified by <em>lParam1</em> was obtained using the <strong>CPSFUNC_ADD_PCOMPROPSHEETUI</strong> function code, and if the <strong>pDlgPage</strong> member of the associated <strong><a href="compropsheetui" title="typedef struct _COMPROPSHEETUI {&#10;  WORD           cbSize;&#10;  WORD           Flags;&#10;  HINSTANCE      hInstCaller;&#10;  LPTSTR         pCallerName;&#10;  ULONG_PTR      UserData;&#10;  LPTSTR         pHelpFile;&#10;  _CPSUICALLBACK pfnCallBack;&#10;  POPTITEM       pOptItem;&#10;  PDLGPAGE       pDlgPage;&#10;  WORD           cOptItem;&#10;  WORD           cDlgPage;&#10;  ULONG_PTR      IconID;&#10;  LPTSTR         pOptItemName;&#10;  WORD           CallerVersion;&#10;  WORD           OptItemVersion;&#10;  ULONG_PTR      dwReserved[4];&#10;} COMPROPSHEETUI, *PCOMPROPSHEETUI;">COMPROPSHEETUI</a></strong> structure was set to <strong>CPSUI_PDLGPAGE_DOCPROP</strong>, then one of the following values can be specified for <em>lParam2</em>:</p>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
</ul></li>
</ul>
<h5>Return value (CPSFUNC_SET_HSTARTPAGE)</h5>
<p>If the operation is successful, the <strong>ComPropSheet</strong> function returns the value specified for <em>lParam1</em>; otherwise it returns zero.</p>
<h4>CPSFUNC_SET_PSUIPAGE_ICON</h4>
<p>The <strong>CPSFUNC_SET_PSUIPAGE_ICON</strong> function code causes the <strong>ComPropSheet</strong> function to add, replace, or remove the icon assigned to the tab of a property sheet page.</p>
<p>If lParam2 contains an icon handle, and if the page specified by lParam1 is currently being displayed, CPSUI adds the icon to the specified page's tab. If an icon is already assigned to the page, the old icon is replaced with the new one. If lParam2 is zero, the current icon (if one exists) is removed.</p>
<p>For all icons specified with the <strong>CPSFUNC_SET_PSUIPAGE_ICON</strong> function code, CPSUI sets the image size to 16 by 16 pixels.</p>
<p>Icon handles should be obtained by calling <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/winuser/nf-winuser-loadimagew"><strong>LoadImage</strong></a>.</p>
<h5>Parameters (CPSFUNC_SET_PSUIPAGE_ICON)</h5>
<ul>
<li>

</li>
<li>

</li>
<li><p><em>lParam1</em>: Caller-supplied CPSUI page handle, previously obtained by a call to <strong>ComPropSheet</strong> with one of the following function codes:</p>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
</ul></li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_SET_PSUIPAGE_ICON)</h5>
<p>If the operation is successful, the <strong>ComPropSheet</strong> function returns 1. If an error is encountered, or if the specified page is not currently being displayed, the function returns zero.</p>
<h4>CPSFUNC_SET_PSUIPAGE_TITLE</h4>
<p>The <strong>CPSFUNC_SET_PSUIPAGE_TITLE</strong> function code causes the <strong>ComPropSheet</strong> function to set the tab title for a property sheet page.</p>
<h5>Parameters (CPSFUNC_SET_PSUIPAGE_TITLE)</h5>
<ul>
<li>

</li>
<li>

</li>
<li><p><em>lParam1</em>: Caller-supplied CPSUI page handle, previously obtained by a call to <strong>ComPropSheet</strong> with one of the following function codes:</p>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
</ul></li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_SET_PSUIPAGE_TITLE)</h5>
<p>If the operation is successful, the <strong>ComPropSheet</strong> function returns 1. If an error is encountered, or if the specified page is not currently being displayed, the function returns zero.</p>
<h4>CPSFUNC_SET_RESULT</h4>
<p>The <strong>CPSFUNC_SET_RESULT</strong> function code causes the <strong>ComPropSheet</strong> function to pass a specified result value to all <a href="pfnpropsheetui" title="PFNPROPSHEETUI Pfnpropsheetui;&#10;&#10;LONG Pfnpropsheetui(&#10;  PPROPSHEETUI_INFO pPSUIInfo,&#10;  LPARAM lParam&#10;)&#10;{...}">PFNPROPSHEETUI</a>-typed functions associated with a specified page and its parents.</p>
<p>For more information about how to set result values, see the description of the <strong><a href="setresult_info" title="typedef struct _SETRESULT_INFO {&#10;  WORD    cbSize;&#10;  WORD    wReserved;&#10;  HANDLE  hSetResult;&#10;  LRESULT Result;&#10;} SETRESULT_INFO, *PSETRESULT_INFO;">SETRESULT_INFO</a></strong> structure.</p>
<p>The following caution applies to Unidrv- or Pscript5-based IHV UI plug-in with custom UI property sheets, and for which user settings made in the property sheets should be persistent. When the plug-in calls the <strong>ComPropSheet</strong> function with the Function parameter set to <strong>CPSFUNC_SET_RESULT</strong>, the plug-in must set the lParam2 parameter to <strong>CPSUI_OK</strong>.</p>
<h5>Parameters (CPSFUNC_SET_RESULT)</h5>
<ul>
<li>

</li>
<li>

</li>
<li>

</li>
<li>

</li>
</ul>
<h5>Return value (CPSFUNC_SET_RESULT)</h5>
<p>If the operation is successful, the <strong>ComPropSheet</strong> function returns the number of <a href="pfnpropsheetui" title="PFNPROPSHEETUI Pfnpropsheetui;&#10;&#10;LONG Pfnpropsheetui(&#10;  PPROPSHEETUI_INFO pPSUIInfo,&#10;  LPARAM lParam&#10;)&#10;{...}">PFNPROPSHEETUI</a>-typed functions that were called. If the handle specified for <em>lParam1</em> is invalid, the function returns -1.</p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/compstui/nc-compstui-pfncompropsheet">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/compstui/nc-compstui-pfncompropsheet.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
