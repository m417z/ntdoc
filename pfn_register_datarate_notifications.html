<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PFN_REGISTER_DATARATE_NOTIFICATIONS - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PFN_REGISTER_DATARATE_NOTIFICATIONS - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PFN_REGISTER_DATARATE_NOTIFICATIONS - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// netdispumdddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PFN_REGISTER_DATARATE_NOTIFICATIONS PfnRegisterDatarateNotifications;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> PfnRegisterDatarateNotifications(
  [in]           HANDLE hMiracastDeviceHandle,
  [in, optional] PVOID pNotificationContext,
  [in, optional] <a href="pfn_datarate_notification" title="PFN_DATARATE_NOTIFICATION PfnDatarateNotification;&#10;&#10;void PfnDatarateNotification(&#10;  [in]           PVOID context,&#10;  [in, optional] MIRACAST_DATARATE_STATS *pDataRateStats&#10;)&#10;{...}">PFN_DATARATE_NOTIFICATION</a> pfnDataRateNotify
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_register_datarate_notifications">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pfn_register_datarate_notifications.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-netdispumdddi-pfn_register_datarate_notifications)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pfn_register_datarate_notifications-callback-function">PFN_REGISTER_DATARATE_NOTIFICATIONS callback function</h1>

<h2 id="description">Description</h2>

<p>Called by the user-mode driver to register with the operating system to receive network quality of service (QoS) notifications and the current network bandwidth of the Miracast connection.The data type of this function is <strong>PFN_REGISTER_DATARATE_NOTIFICATIONS</strong>.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="hmiracastdevicehandle-in"><code>hMiracastDeviceHandle</code> [in]</h3>

<p>A handle that represents a Miracast device. The Miracast user-mode driver previously obtained this handle as the <em>hMiracastDeviceHandle</em> parameter in a call to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_create_miracast_context">CreateMiracastContext</a> function.</p>

<h3 id="pnotificationcontext-in-optional"><code>pNotificationContext</code> [in, optional]</h3>

<p>The context that will be passed to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_datarate_notification">pfnDataRateNotify</a> function when the Miracast data rate changes.</p>

<h3 id="pfndataratenotify-in-optional"><code>pfnDataRateNotify</code> [in, optional]</h3>

<p>A pointer to the driver routine that will be called when the bit rate of the Miracast network link has changed. See Remarks for more info.</p>

<p>The driver can supply a <strong>NULL</strong> value to unregister for notifications.</p>

<h2 id="return-value">Return value</h2>

<p>If the operating system successfully registers or unregisters the driver for notifications, it returns <strong><a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a></strong>.</p>

<p>Otherwise, these error codes can be returned:</p>

<table>
<thead>
<tr>
  <th style="text-align:left;"><strong>Return code</strong></th>
  <th style="text-align:left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:left;"><strong>STATUS_INVALID_PARAMETER</strong></td>
  <td style="text-align:left;">One or more parameters are invalid.</td>
</tr>
<tr>
  <td style="text-align:left;"><strong>STATUS_NOT_SUPPORTED</strong></td>
  <td style="text-align:left;">The operating system cannot support quality of service (QoS) notifications, or the call to the function is made outside of the calling thread in which the operating system called <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_start_miracast_session">StartMiracastSession</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_stop_miracast_session">StopMiracastSession</a> functions.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>The user-mode driver can optionally call this function to register for automatic calls to data rate notification callback functions once a second.</p>

<p>To unregister from notifications, the driver should supply a value of <strong>NULL</strong> for the <em>pfnDataRateNotify</em> parameter and for the <strong>CurrentBitRate</strong> member of the <a href="miracast_wfd_connection_stats" title="typedef struct {&#10;  UINT64 CurrentBitRate;&#10;  UINT64 LocalMaxBitRate;&#10;  UINT64 RemoteMaxBitRate;&#10;} MIRACAST_WFD_CONNECTION_STATS;">MIRACAST_WFD_CONNECTION_STATS</a> structure
pointed to by the <em>pWfdConnectionStats</em> parameter when it calls the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_start_miracast_session">StartMiracastSession</a> function. When the operating system receives <strong>NULL</strong> for both <em>pfnDataRateNotify</em> and <strong>CurrentBitRate</strong>, it will no longer provide notifications.</p>

<p>Also, if the operating system can no longer provide QoS data, it sets the <em>pDataRateStats</em> parameter to <strong>NULL</strong> when the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_datarate_notification">pfnDataRateNotify</a> function is called.</p>

<p>The function fails if the driver attempts to register while it is already registered, or if it attempts to unregister if it has already unregistered. The function fails if the call is made outside of the calling thread in which the operating system called <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_start_miracast_session">StartMiracastSession</a> or <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_stop_miracast_session">StopMiracastSession</a> functions.</p>

<h2 id="see-also">See also</h2>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_create_miracast_context">CreateMiracastContext</a></p>

<p><a href="miracast_wfd_connection_stats" title="typedef struct {&#10;  UINT64 CurrentBitRate;&#10;  UINT64 LocalMaxBitRate;&#10;  UINT64 RemoteMaxBitRate;&#10;} MIRACAST_WFD_CONNECTION_STATS;">MIRACAST_WFD_CONNECTION_STATS</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_start_miracast_session">StartMiracastSession</a></p>

<p><a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_datarate_notification">pfnDataRateNotify</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/netdispumdddi/nc-netdispumdddi-pfn_register_datarate_notifications">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/netdispumdddi/nc-netdispumdddi-pfn_register_datarate_notifications.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
