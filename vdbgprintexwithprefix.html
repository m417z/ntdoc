<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="vDbgPrintExWithPrefix - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>vDbgPrintExWithPrefix - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            vDbgPrintExWithPrefix - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTDBG_H

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NTSYSAPI
<a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>
NTAPI
vDbgPrintExWithPrefix(
    _In_z_ PCCH Prefix,
    _In_ <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> ComponentId,
    _In_ <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> Level,
    _In_z_ PCCH Format,
    _In_ va_list arglist
    );
</span><span class="ntdoc-code-footer">
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/addd49805cb586a891f7c6f31d88a43545cc1c80/phnt/include/ntdbg.h#L71">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// wdm.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NTSYSAPI <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> vDbgPrintExWithPrefix(
  [in] PCCH    Prefix,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>   ComponentId,
  [in] <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>   Level,
  [in] PCCH    Format,
  [in] va_list arglist
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-vdbgprintexwithprefix">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<p>This function is <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-vdbgprintexwithprefix">documented in Windows Driver Kit</a>.</p>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/vdbgprintexwithprefix.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-wdm-vdbgprintexwithprefix)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="vdbgprintexwithprefix-function">vDbgPrintExWithPrefix function</h1>

<h2 id="description">Description</h2>

<p>The <strong>vDbgPrintExWithPrefix</strong> routine sends a string to the kernel debugger if certain conditions that you specify are met. This routine can append a prefix to debugger output to help organize debugging results.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="prefix-in"><code>Prefix</code> [in]</h3>

<p>A string that is appended at the start of debugger output. You can use this string to organize debugger output by adding a unique identifier.</p>

<p>For example, a component-specific routine could specify the component's name when it calls <strong>vDbgPrintExWithPrefix</strong>. This routine would automatically add the component name to the beginning of all debug output that is passed to the component's debug print routine.</p>

<h3 id="componentid-in"><code>ComponentId</code> [in]</h3>

<p>The component that is calling this routine. This parameter must be one of the component name filter IDs that are defined in Dpfilter.h. To avoid mixing your driver's output with the output of Windows components, you should use only the following values for <em>ComponentId</em>:</p>

<ul>
<li>DPFLTR_IHVVIDEO_ID</li>
<li>DPFLTR_IHVAUDIO_ID</li>
<li>DPFLTR_IHVNETWORK_ID</li>
<li>DPFLTR_IHVSTREAMING_ID</li>
<li>DPFLTR_IHVBUS_ID</li>
<li>DPFLTR_IHVDRIVER_ID</li>
</ul>

<h3 id="level-in"><code>Level</code> [in]</h3>

<p>The severity of the message that is being sent. This parameter can be any 32-bit integer. Values between 0 and 31 (inclusive) are treated differently than values between 32 and 0xFFFFFFFF. For more information about how the values are treated, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/reading-and-filtering-debugging-messages">Reading and Filtering Debugging Messages</a>.</p>

<h3 id="format-in"><code>Format</code> [in]</h3>

<p>A pointer to the format string to print. The <em>Format</em> string supports most of the <strong>printf</strong>-style formatting codes. However, you can use the Unicode format codes (<strong>%C</strong>, <strong>%S</strong>, <strong>%lc</strong>, <strong>%ls</strong>, <strong>%wc</strong>, <strong>%ws</strong>, and <strong>%wZ</strong>) only with IRQL = PASSIVE_LEVEL. The <strong>vDbgPrintExWithPrefix</strong> routine does not support any of the floating point types (<strong>%f</strong>, <strong>%e</strong>, <strong>%E</strong>, <strong>%g</strong>, <strong>%G</strong>, <strong>%a</strong>, or <strong>%A</strong>).</p>

<h3 id="arglist-in"><code>arglist</code> [in]</h3>

<p>An argument list for the format string. The <strong>vDbgPrintExWithPrefix</strong> routine uses this list in the same way that <strong>vprintf</strong> does.</p>

<h2 id="return-value">Return value</h2>

<p><strong>vDbgPrintExWithPrefix</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if the operation succeeds. Otherwise, this routine returns the appropriate error code.</p>

<h2 id="remarks">Remarks</h2>

<p>Only kernel-mode drivers can call the <strong>vDbgPrintExWithPrefix</strong> routine.</p>

<p><strong>vDbgPrintExWithPrefix</strong> can be called at IRQL &lt;= DIRQL. However, you can use Unicode format codes (<strong>%wc</strong> and <strong>%ws</strong>) only at IRQL = PASSIVE_LEVEL. Also, because the debugger uses interprocess interrupts (IPIs) to communicate with other processors, a call to <strong>vDbgPrintExWithPrefix</strong> at IRQL &gt; DIRQL can cause deadlocks.</p>

<p><strong>vDbgPrintExWithPrefix</strong> either passes the string that it creates to the kernel debugger or does nothing at all, depending on the values of <em>ComponentId</em>, <em>Level</em>, and the corresponding component filter masks. For more information about what <em><a href="vdbgprintex" title="NTSYSAPI&#10;ULONG&#10;NTAPI&#10;vDbgPrintEx(&#10;    _In_ ULONG ComponentId,&#10;    _In_ ULONG Level,&#10;    _In_z_ PCCH Format,&#10;    _In_ va_list arglist&#10;    );">vDbgPrintEx</a></em> does, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/reading-and-filtering-debugging-messages">Reading and Filtering Debugging Messages</a>.</p>

<p>Unless it is absolutely necessary, you should not obtain a string from user input or another process and pass it to <strong>vDbgPrintExWithPrefix</strong>. If you do use a string that you did not create, you must verify that this string is a valid format string and that the format codes match the argument list in type and quantity. The best coding practice is for all <em>Format</em> strings to be static and defined at compile time.</p>

<p>There is no upper limit to the size of the <em>Format</em> string or the number of arguments in the <em>arglist</em> list. However, any single call to <strong>vDbgPrintExWithPrefix</strong> transmits only 512 bytes of information.</p>

<p>There is also a limit to the size of the buffer that the debugger uses. For more information about this limit, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/devtest/reading-and-filtering-debugging-messages">The DbgPrint Buffer and the Debugger</a>.</p>

<p>This routine is defined in Wdm.h. Component filter IDs are defined in Dpfilter.h.</p>

<h2 id="see-also">See also</h2>

<p><a href="dbgprintex" title="NTSYSAPI&#10;ULONG&#10;STDAPIVCALLTYPE&#10;DbgPrintEx(&#10;    _In_ ULONG ComponentId,&#10;    _In_ ULONG Level,&#10;    _In_z_ _Printf_format_string_ PCCH Format,&#10;    ...&#10;    );">DbgPrintEx</a></p>

<p><a href="vdbgprintex" title="NTSYSAPI&#10;ULONG&#10;NTAPI&#10;vDbgPrintEx(&#10;    _In_ ULONG ComponentId,&#10;    _In_ ULONG Level,&#10;    _In_z_ PCCH Format,&#10;    _In_ va_list arglist&#10;    );">vDbgPrintEx</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-vdbgprintexwithprefix">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/wdm/nf-wdm-vdbgprintexwithprefix.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
