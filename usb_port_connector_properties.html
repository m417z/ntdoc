<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="USB_PORT_CONNECTOR_PROPERTIES - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>USB_PORT_CONNECTOR_PROPERTIES - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            USB_PORT_CONNECTOR_PROPERTIES - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// usbioctl.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef struct _USB_PORT_CONNECTOR_PROPERTIES {
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>               ConnectionIndex;
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>               ActualLength;
  <a href="usb_port_properties" title="typedef union _USB_PORT_PROPERTIES {&#10;  ULONG  ul;&#10;  struct {&#10;    ULONG PortIsUserConnectable : 1;&#10;    ULONG PortIsDebugCapable : 1;&#10;    ULONG PortHasMultipleCompanions : 1;&#10;    ULONG PortConnectorIsTypeC : 1;&#10;    ULONG ReservedMBZ : 28;&#10;  };&#10;} USB_PORT_PROPERTIES, *PUSB_PORT_PROPERTIES;">USB_PORT_PROPERTIES</a> UsbPortProperties;
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>              CompanionIndex;
  <a href="ushort" title="typedef unsigned short USHORT;">USHORT</a>              CompanionPortNumber;
  WCHAR               CompanionHubSymbolicLinkName[1];
} USB_PORT_CONNECTOR_PROPERTIES, *PUSB_PORT_CONNECTOR_PROPERTIES;</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/usbioctl/ns-usbioctl-_usb_port_connector_properties">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/usb_port_connector_properties.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-usbioctl-_usb_port_connector_properties)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="_usb_port_connector_properties-structure">_USB_PORT_CONNECTOR_PROPERTIES structure</h1>

<h2 id="description">Description</h2>

<p>The <strong>USB_PORT_CONNECTOR_PROPERTIES</strong> structure is used with the <a href="ioctl_usb_get_port_connector_properties" title="// CTL_CODE(0x0022, 0x116, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES 0x00220458">IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES</a> I/O control request to retrieve information about a port on a particular SuperSpeed hub.</p>

<h2 id="members">Members</h2>

<h3 id="connectionindex"><code>ConnectionIndex</code></h3>

<p>The port number being queried in the request. <strong>ConnectionIndex</strong> is specified by the caller. If there are <em>n</em> ports on the SuperSpeed hub, the ports are numbered from 1 to <em>n</em>. To get the number of ports, the caller first sends an <a href="ioctl_usb_get_hub_information_ex" title="// CTL_CODE(0x0022, 0x115, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_USB_GET_HUB_INFORMATION_EX 0x00220454">IOCTL_USB_GET_HUB_INFORMATION_EX</a> I/O control request. The request retrieves the highest port number on the hub.</p>

<h3 id="actuallength"><code>ActualLength</code></h3>

<p>The number of bytes required to hold the entire <strong>USB_PORT_CONNECTOR_PROPERTIES</strong>
structure including the string that contains the symbolic link name of the companion hub. That string is stored in the <strong>CompanionHubSymbolicLinkName</strong> member. The <strong>ActualLength</strong> value is returned by the <a href="ioctl_usb_get_port_connector_properties" title="// CTL_CODE(0x0022, 0x116, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES 0x00220458">IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES</a> request and used by the caller to allocate a buffer to hold the received information. For details, see <strong><a href="ioctl_usb_get_port_connector_properties" title="// CTL_CODE(0x0022, 0x116, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES 0x00220458">IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES</a></strong>.</p>

<h3 id="usbportproperties"><code>UsbPortProperties</code></h3>

<p>The port properties. Upon completion of the <a href="ioctl_usb_get_port_connector_properties" title="// CTL_CODE(0x0022, 0x116, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES 0x00220458">IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES</a> request, <strong>UsbPortProperties</strong> contains a bitwise <strong>OR</strong> of one or more flags indicating the properties and capabilities of the port. The flags are defined in <a href="usb_port_properties" title="typedef union _USB_PORT_PROPERTIES {&#10;  ULONG  ul;&#10;  struct {&#10;    ULONG PortIsUserConnectable : 1;&#10;    ULONG PortIsDebugCapable : 1;&#10;    ULONG PortHasMultipleCompanions : 1;&#10;    ULONG PortConnectorIsTypeC : 1;&#10;    ULONG ReservedMBZ : 28;&#10;  };&#10;} USB_PORT_PROPERTIES, *PUSB_PORT_PROPERTIES;">USB_PORT_PROPERTIES</a>.</p>

<h3 id="companionindex"><code>CompanionIndex</code></h3>

<p>The index of the companion port that is associated with the port being queried (specified by <strong>ConnectionIndex</strong>). If there are <em>n</em> companion ports, those ports are indexed from 0 to <em>n</em>â€“1.</p>

<p>If a port is mapped to more than one companion port, <strong>CompanionIndex</strong> is incremented on multiple queries to enumerate all companion ports.</p>

<p>For SuperSpeed hubs and xHCI controllers, <strong>CompanionIndex</strong> is always 0. For more information, see Remarks.</p>

<h3 id="companionportnumber"><code>CompanionPortNumber</code></h3>

<p>The port number of the companion port that is given by <strong>CompanionIndex</strong>. If the port being queried shares a USB connector with a port on another hub, <strong>CompanionPortNumber</strong> indicates the port number of the port on the other hub.</p>

<p><strong>Note</strong> For root hub of an xHCI controller, the shared port might be on the same hub.</p>

<h3 id="companionhubsymboliclinkname"><code>CompanionHubSymbolicLinkName</code></h3>

<p>The Unicode string that contains the symbolic link of the companion hub that shares the USB connector. If a companion hub exists, <strong>CompanionPortNumber</strong> is nonzero. Otherwise, <strong>CompanionHubSymbolicLinkName [0]</strong> is <strong>NULL</strong>.</p>

<h2 id="remarks">Remarks</h2>

<p>A SuperSpeed 3.0 hub contains two independent hub implementations. One is for USB 2.0 devices, and the hub implementation is similar to existing 2.0 hubs. The other hub is only for SuperSpeed devices. Because the USB 2.0 and 3.0 bus signaling are electrically independent, both of those hubs operate simultaneously. Therefore, when a SuperSpeed hub is connected to the host, Windows enumerates the two hubs independently; one hub is associated with a USB 2.0 port, and the other hub with a USB 3.0 port. Each hub has its downstream and upstream ports. USB physical connectors are shared between ports that are associated with those two hub implementations.</p>

<p>Similarly, an xHCI controller must be able to handle SuperSpeed, high-speed, full-speed, and low-speed devices. The USB 3.0 specification requires an xHCI controller to contain two independent execution units each for USB 3.0 and USB 2.0 bus speeds. The USB 3.0 execution unit handles SuperSpeed traffic on the bus. The USB 2.0 execution unit must handle low, full, and high speed traffic. That requirement can be met in many ways. For instance, in one implementation, the USB 2.0 execution unit can have either a downstream USB 1.1 execution unit or a downstream USB 2.0 hub. The other execution unit handles SuperSpeed traffic on the bus. For instance, in one implementation, the xHCI controller can have a downstream USB 2.0 hub (instead of a USB 2.0 host controller) with a transaction translator to handle full-speed and low-speed traffic. That downstream hub shares connectors with the ports of the SuperSpeed root hub.</p>

<p>In cases where USB connectors are shared, the port that is being queried through the <a href="ioctl_usb_get_port_connector_properties" title="// CTL_CODE(0x0022, 0x116, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES 0x00220458">IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES</a> I/O control request is specified by <strong>ConnectionIndex</strong>, and the port that shares the connector is called the <em>companion port</em>. Upon completion of the request, the <strong>CompanionIndex</strong>, <strong>CompanionPortNumber</strong>, and <strong>CompanionHubSymbolicLinkName</strong> members of <strong>USB_PORT_CONNECTOR_PROPERTIES</strong> can be used to determine the port routing in those cases.</p>

<p>If more than one companion port is associated with the port that is being queried, the application can get information about all companion ports by sending the <a href="ioctl_usb_get_port_connector_properties" title="// CTL_CODE(0x0022, 0x116, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES 0x00220458">IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES</a> I/O control request in a loop and incrementing the <strong>CompanionIndex</strong> value in each iteration. When all of the ports have been enumerated and there is no port associated with the index specified in <strong>CompanionIndex</strong>, the request completes successfully, <strong>CompanionPortNumber</strong> is set to 0, and <strong>CompanionHubSymbolicLinkName</strong> is NULL.</p>

<p>To get information about the operating speed of a device attached to a particular port, the application can send the <a href="ioctl_usb_get_node_connection_information_ex_v2" title="// CTL_CODE(0x0022, 0x117, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_USB_GET_NODE_CONNECTION_INFORMATION_EX_V2 0x0022045C">IOCTL_USB_GET_NODE_CONNECTION_INFORMATION_EX_V2</a> I/O control request.</p>

<h2 id="see-also">See also</h2>

<p><a href="ioctl_usb_get_node_connection_information_ex_v2" title="// CTL_CODE(0x0022, 0x117, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_USB_GET_NODE_CONNECTION_INFORMATION_EX_V2 0x0022045C">IOCTL_USB_GET_NODE_CONNECTION_INFORMATION_EX_V2</a></p>

<p><a href="ioctl_usb_get_port_connector_properties" title="// CTL_CODE(0x0022, 0x116, METHOD_BUFFERED, FILE_ANY_ACCESS)&#10;#define IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES 0x00220458">IOCTL_USB_GET_PORT_CONNECTOR_PROPERTIES</a></p>

<p><a href="usb_hub_information_ex" title="typedef struct _USB_HUB_INFORMATION_EX {&#10;  USB_HUB_TYPE HubType;&#10;  USHORT       HighestPortNumber;&#10;  union {&#10;    USB_HUB_DESCRIPTOR    UsbHubDescriptor;&#10;    USB_30_HUB_DESCRIPTOR Usb30HubDescriptor;&#10;  } u;&#10;} USB_HUB_INFORMATION_EX, *PUSB_HUB_INFORMATION_EX;">USB_HUB_INFORMATION_EX</a></p>

<p>USB_PORT_CONNECTOR_PROPERTIES</p>

<p><a href="usb_port_properties" title="typedef union _USB_PORT_PROPERTIES {&#10;  ULONG  ul;&#10;  struct {&#10;    ULONG PortIsUserConnectable : 1;&#10;    ULONG PortIsDebugCapable : 1;&#10;    ULONG PortHasMultipleCompanions : 1;&#10;    ULONG PortConnectorIsTypeC : 1;&#10;    ULONG ReservedMBZ : 28;&#10;  };&#10;} USB_PORT_PROPERTIES, *PUSB_PORT_PROPERTIES;">USB_PORT_PROPERTIES</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/usbioctl/ns-usbioctl-_usb_port_connector_properties">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/usbioctl/ns-usbioctl-_usb_port_connector_properties.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
