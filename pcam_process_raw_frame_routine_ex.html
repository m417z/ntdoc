<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="PCAM_PROCESS_RAW_FRAME_ROUTINE_EX - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PCAM_PROCESS_RAW_FRAME_ROUTINE_EX - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            PCAM_PROCESS_RAW_FRAME_ROUTINE_EX - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// usbcamdi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">PCAM_PROCESS_RAW_FRAME_ROUTINE_EX PcamProcessRawFrameRoutineEx;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> PcamProcessRawFrameRoutineEx(
  <a href="device_object" title="typedef struct _DEVICE_OBJECT {&#10;  CSHORT                   Type;&#10;  USHORT                   Size;&#10;  LONG                     ReferenceCount;&#10;  struct _DRIVER_OBJECT    *DriverObject;&#10;  struct _DEVICE_OBJECT    *NextDevice;&#10;  struct _DEVICE_OBJECT    *AttachedDevice;&#10;  struct _IRP              *CurrentIrp;&#10;  PIO_TIMER                Timer;&#10;  ULONG                    Flags;&#10;  ULONG                    Characteristics;&#10;  __volatile PVPB          Vpb;&#10;  PVOID                    DeviceExtension;&#10;  DEVICE_TYPE              DeviceType;&#10;  CCHAR                    StackSize;&#10;  union {&#10;    LIST_ENTRY         ListEntry;&#10;    WAIT_CONTEXT_BLOCK Wcb;&#10;  } Queue;&#10;  ULONG                    AlignmentRequirement;&#10;...">PDEVICE_OBJECT</a> BusDeviceObject,
  PVOID DeviceContext,
  PVOID FrameContext,
  PVOID FrameBuffer,
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> FrameLength,
  PVOID RawFrameBuffer,
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> RawFrameLength,
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> NumberOfPackets,
  PULONG BytesReturned,
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> ActualRawFrameLength,
  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a> StreamNumber
)
{...}</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/usbcamdi/nc-usbcamdi-pcam_process_raw_frame_routine_ex">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/pcam_process_raw_frame_routine_ex.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-usbcamdi-pcam_process_raw_frame_routine_ex)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="pcam_process_raw_frame_routine_ex-callback-function">PCAM_PROCESS_RAW_FRAME_ROUTINE_EX callback function</h1>

<h2 id="description">Description</h2>

<p>A camera minidriver's <strong>CamProcessRawVideoFrameEx</strong> callback function decodes a raw video frame.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="busdeviceobject"><code>BusDeviceObject</code></h3>

<p>Pointer to the camera minidriver's device object created by the USB hub.</p>

<h3 id="devicecontext"><code>DeviceContext</code></h3>

<p>Pointer to the camera minidriver's device context.</p>

<h3 id="framecontext"><code>FrameContext</code></h3>

<p>Pointer to the minidriver's frame context.</p>

<h3 id="framebuffer"><code>FrameBuffer</code></h3>

<p>Pointer to the buffer that receives the final processed video frame. See the Remarks section for more information about how USBCAMD uses this parameter.</p>

<h3 id="framelength"><code>FrameLength</code></h3>

<p>Specifies the length of the frame buffer (from the original read request) in bytes.</p>

<h3 id="rawframebuffer"><code>RawFrameBuffer</code></h3>

<p>Pointer to the buffer containing the received USB packets. See the Remarks section for more information about how USBCAMD uses this parameter.</p>

<h3 id="rawframelength"><code>RawFrameLength</code></h3>

<p>Specifies the length of <em>RawFrameBuffer</em> in bytes.</p>

<h3 id="numberofpackets"><code>NumberOfPackets</code></h3>

<p>Specifies the number of USB packets received into <em>RawFrameBuffer</em>.</p>

<h3 id="bytesreturned"><code>BytesReturned</code></h3>

<p>Pointer to the number of bytes transferred. The minidriver must set this to zero if it encounters any errors during processing, as described in <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/stream/data-flow-using-isochronous-pipes">Data Flow Using Isochronous Pipes</a>. See the Remarks section for more information about how USBCAMD uses this parameter.</p>

<h3 id="actualrawframelength"><code>ActualRawFrameLength</code></h3>

<p>Contains the length of the actual buffer received from the camera. This value is specified in bytes.</p>

<h3 id="streamnumber"><code>StreamNumber</code></h3>

<p>Indicates the stream number with which this frame is associated with.</p>

<h2 id="return-value">Return value</h2>

<p><strong>CamProcessRawVideoFrameEx</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> or an appropriate error code.</p>

<h2 id="remarks">Remarks</h2>

<p>Before USBCAMD calls the minidriver's <strong>CamProcessRawVideoFrameEx</strong> callback, it sets the first <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> in the buffer pointed to by the <em>FrameBuffer</em> parameter to the value <em>0xdeadbeef.</em> After calling the minidriver's <strong>CamProcessRawVideoFrameEx</strong> callback USBCAMD checks the first <a href="dword" title="typedef unsigned long DWORD;">DWORD</a> in the buffer pointed to by the <em>FrameBuffer</em> parameter for the value <em>0xdeadbeef</em> to determine if <strong>CamProcessRawVideoFrameEx</strong> successfully copied the video frame from the buffer pointed to by the <em>RawFrameBuffer</em> parameter into the buffer pointed to by the <em>FrameBuffer</em> parameter.</p>

<p>This function is not called if either one of the following bits are set in the <em>CamControlFlag</em> argument passed to the <a href="usbcamd_initializenewinterface" title="ULONG USBCAMD_InitializeNewInterface(&#10;  [in] PVOID DeviceContext,&#10;  [in] PVOID DeviceData,&#10;  [in] ULONG Version,&#10;  [in] ULONG CamControlFlag&#10;);">USBCAMD_InitializeNewInterface</a> function:</p>

<p>USBCAMD_CamControlFlag_NoVideoRawProcessing</p>

<p>USBCAMD_CamControlFlag_NoStillRawProcessing</p>

<p>USBCAMD clears the stream header options flag before passing the raw frame to the minidriver. The default flag is key frames only. The camera minidriver should set the stream header option flags appropriately if it needs to indicate anything other than key frames.</p>

<p>The original USBCAMD does not call <strong>CamProcessRawVideoFrameEx</strong>.</p>

<p>This function is optional.</p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/usbcamdi/nc-usbcamdi-pcam_process_raw_frame_routine_ex">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/usbcamdi/nc-usbcamdi-pcam_process_raw_frame_routine_ex.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
