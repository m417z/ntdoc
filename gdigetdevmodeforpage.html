<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="GdiGetDevmodeForPage - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>GdiGetDevmodeForPage - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            GdiGetDevmodeForPage - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// winppi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">BOOL GdiGetDevmodeForPage(
  HANDLE    SpoolFileHandle,
  <a href="dword" title="typedef unsigned long DWORD;">DWORD</a>     dwPageNumber,
  PDEVMODEW *pCurrDM,
  PDEVMODEW *pLastDM
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winppi/nf-winppi-gdigetdevmodeforpage">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/gdigetdevmodeforpage.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-winppi-gdigetdevmodeforpage)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="gdigetdevmodeforpage-function">GdiGetDevmodeForPage function</h1>

<h2 id="description">Description</h2>

<p>The <strong>GdiGetDevmodeForPage</strong> function returns <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/wingdi/ns-wingdi-devmodew">DEVMODEW</a> structures for the specified and previous pages of a print job.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="spoolfilehandle"><code>SpoolFileHandle</code></h3>

<p>Caller-supplied spool file handle, obtained by a previous call to <a href="gdigetspoolfilehandle" title="HANDLE GdiGetSpoolFileHandle(&#10;  LPWSTR     pwszPrinterName,&#10;  LPDEVMODEW pDevmode,&#10;  LPWSTR     pwszDocName&#10;);">GdiGetSpoolFileHandle</a>.</p>

<h3 id="dwpagenumber"><code>dwPageNumber</code></h3>

<p>Caller-supplied number of the page for which <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows/win32/api/wingdi/ns-wingdi-devmodew">DEVMODEW</a> contents are to be returned.</p>

<h3 id="pcurrdm"><code>pCurrDM</code></h3>

<p>Caller-supplied location to receive a pointer to a DEVMODE structure for the page specified by <em>dwPageNumber</em>.</p>

<h3 id="plastdm"><code>pLastDM</code></h3>

<p>Caller-supplied location to receive a pointer to a DEVMODE structure for the page previous to the one specified by <em>dwPageNumber</em>.</p>

<h2 id="return-value">Return value</h2>

<p>If the operation succeeds, the function returns <strong>TRUE</strong>. Otherwise it returns <strong>FALSE</strong>.</p>

<h2 id="remarks">Remarks</h2>

<p>The <strong>GdiGetDevmodeForPage</strong> function is exported by gdi32.dll for use within a print processor's <a href="printdocumentonprintprocessor" title="BOOL PrintDocumentOnPrintProcessor(&#10;  [in] HANDLE hPrintProcessor,&#10;  [in] LPWSTR pDocumentName&#10;);">PrintDocumentOnPrintProcessor</a> function.</p>

<p>Before calling <a href="gdiplaypageemf" title="BOOL GdiPlayPageEMF(&#10;  HANDLE SpoolFileHandle,&#10;  HANDLE hemf,&#10;  RECT   *prectDocument,&#10;  RECT   *prectBorder,&#10;  RECT   *prectClip&#10;);">GdiPlayPageEMF</a> to execute a page's EMF instructions, a print processor must call <strong>GdiGetDevmodeForPage</strong> to determine if the DEVMODE structure associated with the page to be printed is the same as that of the last page printed. If the two returned DEVMODE structures are not identical, the print processor must perform the following steps, in order, before calling <strong><a href="gdiplaypageemf" title="BOOL GdiPlayPageEMF(&#10;  HANDLE SpoolFileHandle,&#10;  HANDLE hemf,&#10;  RECT   *prectDocument,&#10;  RECT   *prectBorder,&#10;  RECT   *prectClip&#10;);">GdiPlayPageEMF</a></strong> for the page:</p>

<ol>
<li>Call <a href="gdiendpageemf" title="BOOL GdiEndPageEMF(&#10;  HANDLE SpoolFileHandle,&#10;  DWORD  dwOptimization&#10;);">GdiEndPageEMF</a>.</li>
<li>Call <a href="gdiresetdcemf" title="BOOL GdiResetDCEMF(&#10;  HANDLE    SpoolFileHandle,&#10;  PDEVMODEW pCurrDM&#10;);">GdiResetDCEMF</a>, specifying the DEVMODE pointed to by <em>pCurrDM</em>.</li>
<li>Call <a href="gdistartpageemf" title="BOOL GdiStartPageEMF(&#10;  HANDLE SpoolFileHandle&#10;);">GdiStartPageEMF</a>.</li>
</ol>

<p>For additional information, see <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/print/using-gdi-functions-in-print-processors">Using GDI Functions in Print Processors</a>.</p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/winppi/nf-winppi-gdigetdevmodeforpage">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/winppi/nf-winppi-gdigetdevmodeforpage.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
