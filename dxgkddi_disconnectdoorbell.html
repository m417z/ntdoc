<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="DXGKDDI_DISCONNECTDOORBELL - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>DXGKDDI_DISCONNECTDOORBELL - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            DXGKDDI_DISCONNECTDOORBELL - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// d3dkmddi.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">DXGKDDI_DISCONNECTDOORBELL DxgkddiDisconnectdoorbell;

<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> DxgkddiDisconnectdoorbell(
  INOUT_PDXGKARG_DISCONNECTDOORBELL pArgs
)
{...}</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_disconnectdoorbell">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/dxgkddi_disconnectdoorbell.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nc-d3dkmddi-dxgkddi_disconnectdoorbell)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h2>Description</h2>
<p>The <strong>DxgkDdiDisconnectDoorbell</strong> function disconnects a previously connected doorbell from a hardware queue.</p>
<h2>Parameters</h2>
<h3><code>pArgs</code></h3>
<p>[in/out] Pointer to a <strong><a href="dxgkarg_disconnectdoorbell" title="typedef struct _DXGKARG_DISCONNECTDOORBELL {&#10;  HANDLE                           hDoorbell;&#10;  DXGKARG_DISCONNECTDOORBELL_FLAGS Flags;&#10;} DXGKARG_DISCONNECTDOORBELL;">DXGKARG_DISCONNECTDOORBELL</a></strong> structure that describes the doorbell to disconnect.</p>
<h2>Return value</h2>
<p><strong>DxgkDdiDisconnectDoorbell</strong> must succeed and return <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a>.</p>
<h2>Remarks</h2>
<p>The OS calls <strong>DxgkDdiDisconnectDoorbell</strong> to unmap the physical doorbell location assigned to this doorbell. KMD should disconnect the hardware queue, doorbell physical address and engine, etc. The physical doorbell location can be assigned to some other logical doorbell object.</p>
<p>KMD should not destroy or free any other objects associated with <strong>hDoorbell</strong> because the doorbell object is not being destroyed and can be reconnected at a later point.</p>
<p>On return from this DDI call, <em>Dxgkrnl</em> does the following steps to disconnect the doorbell:</p>
<ul>
<li>Rotates the user-mode <a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmthk/ns-d3dkmthk-d3dkmt_create_doorbell"><strong>DoorbellCpuVirtualAddress</strong></a> to a dummy page so that UMD can no longer write to the physical doorbell location.</li>
<li>Writes <a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dukmdt/ne-d3dukmdt-d3dddi_doorbellstatus">D3DDDI_DOORBELL_STATUS_DISCONNECTED_RETRY</a> into <strong>DoorbellStatusCpuVirtualAddress</strong> so that UMD knows the doorbell is disconnected.</li>
</ul>
<p>For more information, see <a href="https://learn.microsoft.com/windows-hardware/drivers/display/user-mode-work-submission">User-mode work submission</a>.</p>
<h2>See also</h2>
<p><strong><a href="d3dddi_doorbellstatus" title="typedef enum _D3DDDI_DOORBELLSTATUS {&#10;  D3DDDI_DOORBELLSTATUS_CONNECTED,&#10;  D3DDDI_DOORBELLSTATUS_CONNECTED_NOTIFY_KMD,&#10;  D3DDDI_DOORBELLSTATUS_DISCONNECTED_RETRY,&#10;  D3DDDI_DOORBELLSTATUS_DISCONNECTED_ABORT&#10;} D3DDDI_DOORBELLSTATUS;">D3DDDI_DOORBELLSTATUS</a></strong></p>
<p><strong><a href="d3dkmt_create_doorbell" title="typedef struct _D3DKMT_CREATE_DOORBELL {&#10;  D3DKMT_HANDLE                hHwQueue;&#10;  D3DKMT_HANDLE                hRingBuffer;&#10;  D3DKMT_HANDLE                hRingBufferControl;&#10;  D3DKMT_CREATE_DOORBELL_FLAGS Flags;&#10;  UINT                         PrivateDriverDataSize;&#10;  VOID                         *PrivateDriverData;&#10;  VOID                         *DoorbellCPUVirtualAddress;&#10;  VOID                         *DoorbellSecondaryCPUVirtualAddress;&#10;  VOID                         *DoorbellStatusCPUVirtualAddress;&#10;  VOID                         *HwQueueProgressFenceLastQueuedValueCPUVirtualAddress;&#10;  D3DKMT_HANDLE                hDoorbell;&#10;} D3DKMT_CREATE_DOORBELL;">D3DKMT_CREATE_DOORBELL</a></strong></p>
<p><strong><a href="dxgkarg_disconnectdoorbell" title="typedef struct _DXGKARG_DISCONNECTDOORBELL {&#10;  HANDLE                           hDoorbell;&#10;  DXGKARG_DISCONNECTDOORBELL_FLAGS Flags;&#10;} DXGKARG_DISCONNECTDOORBELL;">DXGKARG_DISCONNECTDOORBELL</a></strong></p>
<p><a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_connectdoorbell"><strong>DxgkDdiConnectDoorbell</strong></a></p>
<p><a href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkcb_disconnectdoorbell"><strong>DxgkDdiDisconnectDoorbellCB</strong></a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_disconnectdoorbell">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/d3dkmddi/nc-d3dkmddi-dxgkddi_disconnectdoorbell.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
