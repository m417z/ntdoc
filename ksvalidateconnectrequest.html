<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="KsValidateConnectRequest - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>KsValidateConnectRequest - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            KsValidateConnectRequest - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ks.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">KSDDKAPI <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> KsValidateConnectRequest(
  [in]  PIRP                   Irp,
  [in]  <a href="ulong" title="typedef unsigned long ULONG;">ULONG</a>                  DescriptorsCount,
  [in]  const <a href="kspin_descriptor" title="typedef struct {&#10;  ULONG                 InterfacesCount;&#10;  const KSPIN_INTERFACE *Interfaces;&#10;  ULONG                 MediumsCount;&#10;  const KSPIN_MEDIUM    *Mediums;&#10;  ULONG                 DataRangesCount;&#10;  const PKSDATARANGE    *DataRanges;&#10;  KSPIN_DATAFLOW        DataFlow;&#10;  KSPIN_COMMUNICATION   Communication;&#10;  const GUID            *Category;&#10;  const GUID            *Name;&#10;  union {&#10;    LONGLONG Reserved;&#10;    struct {&#10;      ULONG        ConstrainedDataRangesCount;&#10;      PKSDATARANGE *ConstrainedDataRanges;&#10;    };&#10;  };&#10;} KSPIN_DESCRIPTOR, *PKSPIN_DESCRIPTOR;">KSPIN_DESCRIPTOR</a> *Descriptor,
  [out] <a href="kspin_connect" title="typedef struct {&#10;  KSPIN_INTERFACE Interface;&#10;  KSPIN_MEDIUM    Medium;&#10;  ULONG           PinId;&#10;  HANDLE          PinToHandle;&#10;  KSPRIORITY      Priority;&#10;} KSPIN_CONNECT, *PKSPIN_CONNECT;">PKSPIN_CONNECT</a>         *Connect
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/nf-ks-ksvalidateconnectrequest">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ksvalidateconnectrequest.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ks-ksvalidateconnectrequest)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="ksvalidateconnectrequest-function">KsValidateConnectRequest function</h1>

<h2 id="description">Description</h2>

<p>The <strong>KsValidateConnectRequest</strong> function validates a connection request and returns a pointer to the connection structure associated with the request.</p>

<p>This function can only be called at PASSIVE_LEVEL.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="irp-in"><code>Irp</code> [in]</h3>

<p>Pointer to an <a href="irp" title="typedef struct _IRP {&#10;  CSHORT                    Type;&#10;  USHORT                    Size;&#10;  PMDL                      MdlAddress;&#10;  ULONG                     Flags;&#10;  union {&#10;    struct _IRP     *MasterIrp;&#10;    __volatile LONG IrpCount;&#10;    PVOID           SystemBuffer;&#10;  } AssociatedIrp;&#10;  LIST_ENTRY                ThreadListEntry;&#10;  IO_STATUS_BLOCK           IoStatus;&#10;  KPROCESSOR_MODE           RequestorMode;&#10;  BOOLEAN                   PendingReturned;&#10;  CHAR                      StackCount;&#10;  CHAR                      CurrentLocation;&#10;  BOOLEAN                   Cancel;&#10;  KIRQL                     CancelIrql;&#10;  CCHAR                     ApcEnvironment;&#10;  UCHAR                     AllocationFlags;&#10;...">IRP</a> specifying the connection request.</p>

<h3 id="descriptorscount-in"><code>DescriptorsCount</code> [in]</h3>

<p>Specifies the number of pin descriptors passed.</p>

<h3 id="descriptor-in"><code>Descriptor</code> [in]</h3>

<p>Specifies a pointer to the list of <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/ns-ks-kspin_descriptor">KSPIN_DESCRIPTOR</a> structures.</p>

<h3 id="connect-out"><code>Connect</code> [out]</h3>

<p>Specifies a location in which to place a pointer to the <a rel="noopener" target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/ns-ks-kspin_connect">KSPIN_CONNECT</a> pointer passed to the create request. If <strong>KsValidateConnectRequest</strong> returns success, then Connect+1 will contain a pointer to the <a href="ksdataformat" title="typedef struct {&#10;  ULONG FormatSize;&#10;  ULONG Flags;&#10;  ULONG SampleSize;&#10;  ULONG Reserved;&#10;  GUID  MajorFormat;&#10;  GUID  SubFormat;&#10;  GUID  Specifier;&#10;} KSDATAFORMAT, *PKSDATAFORMAT, KSDATARANGE, *PKSDATARANGE;">KSDATAFORMAT</a> with which the pin was opened.</p>

<h2 id="return-value">Return value</h2>

<p>The <strong>KsValidateConnectRequest</strong> function returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> if successful, or it returns an error.</p>

<h2 id="remarks">Remarks</h2>

<p>The <strong>KsValidateConnectRequest</strong> function handles basic connection structure access exceptions and validates the communication requirements, medium, protocol, and basic data format. The validation performed on the data format passed is based on the data range list for the specified pin against which a pin instance is to be created. Validation is successful in three instances: if a range major format is a wildcard, the range major format matches and the range subformat is a wildcard, or the range major format, range subformat, and the range specifier all match.</p>

<p>The buffer is passed a copy of the original input buffer, if the originator was not in kernel mode, and is therefore safe to access.</p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/nf-ks-ksvalidateconnectrequest">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ks/nf-ks-ksvalidateconnectrequest.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
