<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="QUEUE_USER_APC_FLAGS_SPECIAL_USER_APC - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>QUEUE_USER_APC_FLAGS_SPECIAL_USER_APC - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            QUEUE_USER_APC_FLAGS_SPECIAL_USER_APC - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTPSAPI_H
//
// Threads
//
#if (PHNT_MODE != PHNT_MODE_KERNEL)

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">#define QUEUE_USER_APC_FLAGS_SPECIAL_USER_APC 0x00000001
</span><span class="ntdoc-code-footer">
#endif
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/d5d251753fa24f499216d316a9583efdd7843057/phnt/include/ntpsapi.h#L2774">View code on GitHub</a></span></code></pre></div>
</div>
<div class="ntdoc-description">
<p>This flags indicates the use of a <em>special user-mode APC</em> that does not require the thread to enter an alertable state. The APC will be executed on the next thread's transition to user mode.</p>

<h1 id="applicable-to">Applicable to</h1>

<ul>
<li><code><a href="ntqueueapcthreadex2" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQueueApcThreadEx2(&#10;    _In_ HANDLE ThreadHandle,&#10;    _In_opt_ HANDLE ReserveHandle, // NtAllocateReserveObject&#10;    _In_ ULONG ApcFlags, // QUEUE_USER_APC_FLAGS&#10;    _In_ PPS_APC_ROUTINE ApcRoutine, // RtlDispatchAPC&#10;    _In_opt_ PVOID ApcArgument1,&#10;    _In_opt_ PVOID ApcArgument2,&#10;    _In_opt_ PVOID ApcArgument3&#10;    );">NtQueueApcThreadEx2</a></code></li>
</ul>

<h1 id="related-flags">Related flags</h1>

<ul>
<li><code><a href="queue_user_apc_flags_none" title="#define QUEUE_USER_APC_FLAGS_NONE 0x00000000">QUEUE_USER_APC_FLAGS_NONE</a></code></li>
<li><code><a href="queue_user_apc_flags_callback_data_context" title="#define QUEUE_USER_APC_FLAGS_CALLBACK_DATA_CONTEXT 0x00010000 // APC_CALLBACK_DATA_CONTEXT">QUEUE_USER_APC_FLAGS_CALLBACK_DATA_CONTEXT</a></code></li>
</ul>

<h1 id="remarks">Remarks</h1>

<p>For the introduction to special user-mode APCs, see <a rel="noopener" target="_blank" href="https://repnz.github.io/posts/apc/user-apc/#ntqueueapcthreadex-meet-special-user-apc">this blog post</a>.</p>

<p>Because execution of special APCs is not synchronized with the target thread (which might happen to acquire locks), it is crucial to keep the amount and complexity of the code invoked by the special APC routine to a minimum.</p>

<h1 id="required-os-version">Required OS version</h1>

<p>This flag was introduced in Windows 11.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/queue_user_apc_flags_special_user_apc.md">Edit description on GitHub</a>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
