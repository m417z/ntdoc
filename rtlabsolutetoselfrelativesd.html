<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="RtlAbsoluteToSelfRelativeSD - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>RtlAbsoluteToSelfRelativeSD - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            RtlAbsoluteToSelfRelativeSD - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTRTL_H

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NTSYSAPI
<a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a>
NTAPI
RtlAbsoluteToSelfRelativeSD(
    _In_ PSECURITY_DESCRIPTOR AbsoluteSecurityDescriptor,
    _Out_writes_bytes_to_opt_(*BufferLength, *BufferLength) PSECURITY_DESCRIPTOR SelfRelativeSecurityDescriptor,
    _Inout_ PULONG BufferLength
    );
</span><span class="ntdoc-code-footer">
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/78124af1f54187762af94ebc9aab9a9818a53adf/phnt/include/ntrtl.h#L8989">View code on GitHub</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ntifs.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">NTSYSAPI <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> RtlAbsoluteToSelfRelativeSD(
  [in]      PSECURITY_DESCRIPTOR AbsoluteSecurityDescriptor,
  [out]     PSECURITY_DESCRIPTOR SelfRelativeSecurityDescriptor,
  [in, out] PULONG               BufferLength
);</span><span class="ntdoc-code-footer"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-rtlabsolutetoselfrelativesd">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<p>This function is <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/nf-ntifs-rtlabsolutetoselfrelativesd">documented in Windows Driver Kit</a>.</p>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/rtlabsolutetoselfrelativesd.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ntifs-rtlabsolutetoselfrelativesd)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="rtlabsolutetoselfrelativesd-function">RtlAbsoluteToSelfRelativeSD function</h1>

<h2 id="description">Description</h2>

<p>The <strong>RtlAbsoluteToSelfRelativeSD</strong> routine creates a new security descriptor in self-relative format by using a security descriptor in absolute format as a template.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="absolutesecuritydescriptor-in"><code>AbsoluteSecurityDescriptor</code> [in]</h3>

<p>Pointer to a caller-allocated buffer that contains a <a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a> structure in absolute format. <strong>RtlAbsoluteToSelfRelativeSD</strong> creates a version of this security descriptor in self-relative format without modifying the original.</p>

<h3 id="selfrelativesecuritydescriptor-out"><code>SelfRelativeSecurityDescriptor</code> [out]</h3>

<p>Pointer to a caller-allocated buffer that receives a security descriptor in self-relative format.</p>

<h3 id="bufferlength-in-out"><code>BufferLength</code> [in, out]</h3>

<p>Pointer to a caller-allocated variable that specifies the size, in bytes, of the buffer pointed to by the <em>SelfRelativeSecurityDescriptor</em> parameter. If the buffer is not large enough to hold the security descriptor, <strong>RtlAbsoluteToSelfRelativeSD</strong> returns STATUS_BUFFER_TOO_SMALL and sets this variable to the minimum required size.</p>

<h2 id="return-value">Return value</h2>

<p><strong>RtlAbsoluteToSelfRelativeSD</strong> returns <a href="status_success" title="#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)">STATUS_SUCCESS</a> or an appropriate <a href="ntstatus" title="typedef _Return_type_success_(return &gt;= 0) long NTSTATUS;">NTSTATUS</a> value such as one of the following:</p>

<table>
<thead>
<tr>
  <th>Return code</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>STATUS_BAD_DESCRIPTOR_FORMAT</strong></td>
  <td>The buffer pointed to by the <em>AbsoluteSecurityDescriptor</em> parameter did not contain a <a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a> structure in absolute format. STATUS_BAD_DESCRIPTOR_FORMAT is an error code.</td>
</tr>
<tr>
  <td><strong>STATUS_BUFFER_TOO_SMALL</strong></td>
  <td>The buffer pointed to by the <em>SelfRelativeSecurityDescriptor</em> parameter was too small to contain the security descriptor in self-relative format. STATUS_BUFFER_TOO_SMALL is an error code.</td>
</tr>
</tbody>
</table>

<h2 id="remarks">Remarks</h2>

<p>A security descriptor in absolute format contains pointers to the information it contains, rather than containing the information itself. A security descriptor in self-relative format contains the information in a contiguous block of memory. In a self-relative security descriptor, a <a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a> structure always starts the information, but the security descriptor's other components can follow the <a href="pisecurity_descriptor" title="typedef struct _SECURITY_DESCRIPTOR {&#10;  UCHAR                       Revision;&#10;  UCHAR                       Sbz1;&#10;  SECURITY_DESCRIPTOR_CONTROL Control;&#10;  PSID                        Owner;&#10;  PSID                        Group;&#10;  PACL                        Sacl;&#10;  PACL                        Dacl;&#10;} SECURITY_DESCRIPTOR, *PISECURITY_DESCRIPTOR;">SECURITY_DESCRIPTOR</a> structure in any order. Instead of using memory addresses, the components of the security descriptor are identified by offsets from the beginning of the security descriptor. This format is useful when a security descriptor must be stored on a disk or transmitted by means of a communications protocol.</p>

<p>To create a new security descriptor in absolute format by using a security descriptor in self-relative format as a template, use <a href="rtlselfrelativetoabsolutesd" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlSelfRelativeToAbsoluteSD(&#10;    _In_ PSECURITY_DESCRIPTOR SelfRelativeSecurityDescriptor,&#10;    _Out_writes_bytes_to_opt_(*AbsoluteSecurityDescriptorSize, *AbsoluteSecurityDescriptorSize) PSECURITY_DESCRIPTOR AbsoluteSecurityDescriptor,&#10;    _Inout_ PULONG AbsoluteSecurityDescriptorSize,&#10;    _Out_writes_bytes_to_opt_(*DaclSize, *DaclSize) PACL Dacl,&#10;    _Inout_ PULONG DaclSize,&#10;    _Out_writes_bytes_to_opt_(*SaclSize, *SaclSize) PACL Sacl,&#10;    _Inout_ PULONG SaclSize,&#10;    _Out_writes_bytes_to_opt_(*OwnerSize, *OwnerSize) PSID Owner,&#10;    _Inout_ PULONG OwnerSize,&#10;    _Out_writes_bytes_to_opt_(*PrimaryGroupSize, *PrimaryGroupSize) PSID PrimaryGroup,&#10;    _Inout_ PULONG PrimaryGroupSize&#10;    );">RtlSelfRelativeToAbsoluteSD</a>.</p>

<p>For more information about security and access control, see the Microsoft Windows SDK documentation.</p>

<h2 id="see-also">See also</h2>

<p><a href="acl" title="typedef struct _ACL {&#10;  UCHAR  AclRevision;&#10;  UCHAR  Sbz1;&#10;  USHORT AclSize;&#10;  USHORT AceCount;&#10;  USHORT Sbz2;&#10;} ACL;">ACL</a></p>

<p><a href="rtlcreatesecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlCreateSecurityDescriptor(&#10;    _Out_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_ ULONG Revision&#10;    );">RtlCreateSecurityDescriptor</a></p>

<p><a href="rtllengthsecuritydescriptor" title="NTSYSAPI&#10;ULONG&#10;NTAPI&#10;RtlLengthSecurityDescriptor(&#10;    _In_ PSECURITY_DESCRIPTOR SecurityDescriptor&#10;    );">RtlLengthSecurityDescriptor</a></p>

<p><a href="rtlselfrelativetoabsolutesd" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlSelfRelativeToAbsoluteSD(&#10;    _In_ PSECURITY_DESCRIPTOR SelfRelativeSecurityDescriptor,&#10;    _Out_writes_bytes_to_opt_(*AbsoluteSecurityDescriptorSize, *AbsoluteSecurityDescriptorSize) PSECURITY_DESCRIPTOR AbsoluteSecurityDescriptor,&#10;    _Inout_ PULONG AbsoluteSecurityDescriptorSize,&#10;    _Out_writes_bytes_to_opt_(*DaclSize, *DaclSize) PACL Dacl,&#10;    _Inout_ PULONG DaclSize,&#10;    _Out_writes_bytes_to_opt_(*SaclSize, *SaclSize) PACL Sacl,&#10;    _Inout_ PULONG SaclSize,&#10;    _Out_writes_bytes_to_opt_(*OwnerSize, *OwnerSize) PSID Owner,&#10;    _Inout_ PULONG OwnerSize,&#10;    _Out_writes_bytes_to_opt_(*PrimaryGroupSize, *PrimaryGroupSize) PSID PrimaryGroup,&#10;    _Inout_ PULONG PrimaryGroupSize&#10;    );">RtlSelfRelativeToAbsoluteSD</a></p>

<p><a href="rtlsetdaclsecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlSetDaclSecurityDescriptor(&#10;    _Inout_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_ BOOLEAN DaclPresent,&#10;    _In_opt_ PACL Dacl,&#10;    _In_ BOOLEAN DaclDefaulted&#10;    );">RtlSetDaclSecurityDescriptor</a></p>

<p><a href="rtlsetownersecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlSetOwnerSecurityDescriptor(&#10;    _Inout_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_opt_ PSID Owner,&#10;    _In_ BOOLEAN OwnerDefaulted&#10;    );">RtlSetOwnerSecurityDescriptor</a></p>

<p><a href="rtlvalidsecuritydescriptor" title="_Check_return_&#10;NTSYSAPI&#10;BOOLEAN&#10;NTAPI&#10;RtlValidSecurityDescriptor(&#10;    _In_ PSECURITY_DESCRIPTOR SecurityDescriptor&#10;    );">RtlValidSecurityDescriptor</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-rtlabsolutetoselfrelativesd">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ntifs/nf-ntifs-rtlabsolutetoselfrelativesd.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
