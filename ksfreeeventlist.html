<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="KsFreeEventList - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>KsFreeEventList - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            KsFreeEventList - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">// ks.h

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">KSDDKAPI VOID KsFreeEventList(
  [in]      <a href="file_object" title="typedef struct _FILE_OBJECT {&#10;  CSHORT                                Type;&#10;  CSHORT                                Size;&#10;  PDEVICE_OBJECT                        DeviceObject;&#10;  PVPB                                  Vpb;&#10;  PVOID                                 FsContext;&#10;  PVOID                                 FsContext2;&#10;  PSECTION_OBJECT_POINTERS              SectionObjectPointer;&#10;  PVOID                                 PrivateCacheMap;&#10;  NTSTATUS                              FinalStatus;&#10;  struct _FILE_OBJECT                   *RelatedFileObject;&#10;  BOOLEAN                               LockOperation;&#10;  BOOLEAN                               DeletePending;&#10;  BOOLEAN                               ReadAccess;&#10;  BOOLEAN                               WriteAccess;&#10;  BOOLEAN                               DeleteAccess;&#10;  BOOLEAN                               SharedRead;&#10;  BOOLEAN                               SharedWrite;&#10;  BOOLEAN                               SharedDelete;&#10;  ULONG                                 Flags;&#10;...">PFILE_OBJECT</a>      FileObject,
  [in, out] <a href="list_entry" title="typedef struct _LIST_ENTRY LIST_ENTRY, *PLIST_ENTRY;">PLIST_ENTRY</a>       EventsList,
  [in]      <a href="ksevents_locktype" title="typedef enum {&#10;  KSEVENTS_NONE,&#10;  KSEVENTS_SPINLOCK,&#10;  KSEVENTS_MUTEX,&#10;  KSEVENTS_FMUTEX,&#10;  KSEVENTS_FMUTEXUNSAFE,&#10;  KSEVENTS_INTERRUPT,&#10;  KSEVENTS_ERESOURCE&#10;} KSEVENTS_LOCKTYPE;">KSEVENTS_LOCKTYPE</a> EventsFlags,
  [in]      PVOID             EventsLock
);</span><span class="ntdoc-code-footer">
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/nf-ks-ksfreeeventlist">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ksfreeeventlist.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (nf-ks-ksfreeeventlist)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1 id="ksfreeeventlist-function">KsFreeEventList function</h1>

<h2 id="description">Description</h2>

<p>The <strong>KsFreeEventList</strong> function handles freeing all events from a specified list, with the assumption that these events are composed of <strong><a href="ksevent_entry" title="typedef struct _KSEVENT_ENTRY {&#10;  LIST_ENTRY         ListEntry;&#10;  PVOID              Object;&#10;  union {&#10;    PKSDPC_ITEM    DpcItem;&#10;    PKSBUFFER_ITEM BufferItem;&#10;  };&#10;  PKSEVENTDATA       EventData;&#10;  ULONG              NotificationType;&#10;  const KSEVENT_SET  *EventSet;&#10;  const KSEVENT_ITEM *EventItem;&#10;  PFILE_OBJECT       FileObject;&#10;  ULONG              SemaphoreAdjustment;&#10;  ULONG              Reserved;&#10;  ULONG              Flags;&#10;} KSEVENT_ENTRY, *PKSEVENT_ENTRY;">KSEVENT_ENTRY</a></strong> structures. This function can only be called at PASSIVE_LEVEL.</p>

<h2 id="parameters">Parameters</h2>

<h3 id="fileobject-in"><code>FileObject</code> [in]</h3>

<p>Specifies the file object passed to the removal function for context information. The file object associated is used to compare against the file object originally specified when enabling the event. This allows a single event list to be used for multiple clients differentiated by file objects.</p>

<h3 id="eventslist-in-out"><code>EventsList</code> [in, out]</h3>

<p>Points to the head of the list of <a href="ksevent_entry" title="typedef struct _KSEVENT_ENTRY {&#10;  LIST_ENTRY         ListEntry;&#10;  PVOID              Object;&#10;  union {&#10;    PKSDPC_ITEM    DpcItem;&#10;    PKSBUFFER_ITEM BufferItem;&#10;  };&#10;  PKSEVENTDATA       EventData;&#10;  ULONG              NotificationType;&#10;  const KSEVENT_SET  *EventSet;&#10;  const KSEVENT_ITEM *EventItem;&#10;  PFILE_OBJECT       FileObject;&#10;  ULONG              SemaphoreAdjustment;&#10;  ULONG              Reserved;&#10;  ULONG              Flags;&#10;} KSEVENT_ENTRY, *PKSEVENT_ENTRY;">KSEVENT_ENTRY</a> items to be freed. If any events on the list are currently being disabled, they are passed over. If any new elements are added to the list while it is being processed, they may not be freed.</p>

<h3 id="eventsflags-in"><code>EventsFlags</code> [in]</h3>

<p>Specifies a <a href="ksevents_locktype" title="typedef enum {&#10;  KSEVENTS_NONE,&#10;  KSEVENTS_SPINLOCK,&#10;  KSEVENTS_MUTEX,&#10;  KSEVENTS_FMUTEX,&#10;  KSEVENTS_FMUTEXUNSAFE,&#10;  KSEVENTS_INTERRUPT,&#10;  KSEVENTS_ERESOURCE&#10;} KSEVENTS_LOCKTYPE;">KSEVENTS_LOCKTYPE</a> flag specifying the type of exclusion lock to be used in accessing the event list. If no flag is set, then no lock is taken.</p>

<h3 id="eventslock-in"><code>EventsLock</code> [in]</h3>

<p>Used to synchronize access to an element on the list. After the element has been accessed, it is marked as being deleted so subsequent removal requests fail. The lock is then released after calling the removal function, if any. The removal function must synchronize with event generation before actually removing the element from the list.</p>

<h2 id="return-value">Return value</h2>

<p>None</p>

<h2 id="remarks">Remarks</h2>

<p>The <strong>KsFreeEventList</strong> function calls the remove handler, and then it calls <strong><a href="ksdiscardevent" title="KSDDKAPI VOID KsDiscardEvent(&#10;  [in] PKSEVENT_ENTRY EventEntry&#10;);">KsDiscardEvent</a></strong> for each event. It does not assume that the caller is the event owner.</p>

<h2 id="see-also">See also</h2>

<p><a href="ksdiscardevent" title="KSDDKAPI VOID KsDiscardEvent(&#10;  [in] PKSEVENT_ENTRY EventEntry&#10;);">KsDiscardEvent</a></p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/ks/nf-ks-ksfreeeventlist">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/ks/nf-ks-ksfreeeventlist.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
