<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github.ntdoc.min.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/highlight.js/styles/github-dark-dimmed.ntdoc.min.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header language-cpp">// minitape.h

</span><span class="ntdoc-code-intro language-cpp"></span><span class="ntdoc-code-body language-cpp">typedef struct _SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE {
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> PageCode;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> SubEnclosureId;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> PageLength[2];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> ExpectedGenerationCode[4];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> Mode;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> Reserved[2];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> BufferID;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> BufferOffset[4];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> ImageLength[4];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> DataLength[4];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> Data[ANYSIZE_ARRAY];
} SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE, *PSES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE;</span><span class="ntdoc-code-footer language-cpp"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/minitape/ns-minitape-_ses_download_microcode_control_diagnostic_page">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header language-cpp">// scsi.h

</span><span class="ntdoc-code-intro language-cpp"></span><span class="ntdoc-code-body language-cpp">typedef struct _SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE {
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> PageCode;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> SubEnclosureId;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> PageLength[2];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> ExpectedGenerationCode[4];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> Mode;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> Reserved[2];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> BufferID;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> BufferOffset[4];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> ImageLength[4];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> DataLength[4];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> Data[ANYSIZE_ARRAY];
} SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE, *PSES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE;</span><span class="ntdoc-code-footer language-cpp"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/scsi/ns-scsi-_ses_download_microcode_control_diagnostic_page">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header language-cpp">// storport.h

</span><span class="ntdoc-code-intro language-cpp"></span><span class="ntdoc-code-body language-cpp">typedef struct _SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE {
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> PageCode;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> SubEnclosureId;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> PageLength[2];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> ExpectedGenerationCode[4];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> Mode;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> Reserved[2];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> BufferID;
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> BufferOffset[4];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> ImageLength[4];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> DataLength[4];
  <a href="uchar" title="typedef unsigned char UCHAR;">UCHAR</a> Data[ANYSIZE_ARRAY];
} SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE, *PSES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE;</span><span class="ntdoc-code-footer language-cpp"></span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/storport/ns-storport-_ses_download_microcode_control_diagnostic_page">View the official Windows Driver Kit DDI reference</a></span></code></pre></div>
</div>
<div class="ntdoc-descriptions">
<div class="ntdoc-description-title">
<h1>NtDoc</h1>
</div>
<div class="ntdoc-description">
<div class="ntdoc-description-none">
<p>No description available.</p>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/ses_download_microcode_control_diagnostic_page.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-minitape-_ses_download_microcode_control_diagnostic_page)</h1>
</div>
<div class="ntdoc-description ntdoc-description-selected">
<h1>_SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE structure (minitape.h)</h1>
<h2>Description</h2>
<p>The <strong>SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE</strong> structure contains a vendor specific microcode (i.e., firmware) image
for use by the enclosure services process.</p>
<h2>Members</h2>
<h3><code>PageCode</code></h3>
<p>Specifies the diagnostic page being sent or requested based on the value. For a Microcode Control diagnostic page, the value should be 0x0E.</p>
<h3><code>SubEnclosureId</code></h3>
<p>Specifies the sub enclosure to which the application client is
sending the microcode image. If the value does not match a valid SUBENCLOSURE_IDENTIFIER field value found in the <a href="ses_configuration_diagnostic_page" title="typedef struct _SES_CONFIGURATION_DIAGNOSTIC_PAGE {&#10;  UCHAR                    PageCode;&#10;  UCHAR                    NumberOfSecondarySubEnclosures;&#10;  UCHAR                    PageLength[2];&#10;  UCHAR                    GenerationCode[4];&#10;  SES_ENCLOSURE_DESCRIPTOR Descriptors[ANYSIZE_ARRAY];&#10;} SES_CONFIGURATION_DIAGNOSTIC_PAGE, *PSES_CONFIGURATION_DIAGNOSTIC_PAGE;">SES_CONFIGURATION_DIAGNOSTIC_PAGE</a>, then the enclosure services
process shall abort the download microcode operation with a status of 0x80.</p>
<h3><code>PageLength</code></h3>
<p>Specifies the number of bytes that follow in the diagnostic page.</p>
<h3><code>ExpectedGenerationCode</code></h3>
<p>Specifies the expected value of the generation code. If this parameter is not set to the current generation code, then the enclosure services
process shall abort the download microcode operation with a status of 0x80.</p>
<h3><code>Mode</code></h3>
<p>Specifies which mode to download the microcode with.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Download microcode with offsets, save, and activate</strong><br /><br />0x07</td>
<td>After the last SEND DIAGNOSTIC command delivers a Download Microcode Control diagnostic page to the subenclosure completes, the enclosure services process shall verify the complete microcode image (e.g., perform a vendor specific checksum) and save the new microcode image into nonvolatile storage.<br /><br /> If there are no errors in the microcode image or in the save operation, then the enclosure services process shall perform one of the following actions:<br /><br />* Set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x10, if   requested, and activate the new microcode image after either returning the Download Microcode Status diagnostic page, power on, or for standalone enclosure services processes, a hard reset.<br />* Set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x11, if   requested, and for standalone enclosure services processes only,   activate the new microcode image after either power on or hard reset.<br />* Set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x12, if   requested, and activate the new microcode image after power on.</td>
</tr>
<tr>
<td><strong>Download microcode with offsets, save, and defer activate</strong><br /><br />0x0E</td>
<td>After the last SEND DIAGNOSTIC command delivering a <strong>SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE</strong> to the subenclosure completes, the enclosure services process shall verify the complete microcode image (e.g., perform a vendor specific checksum), save the new microcode image into nonvolatile storage (e.g., flash ROM), and defer activation of the new microcode.<br /><br />If there are no errors in the microcode image or in the save operation, then the enclosure services process shall set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x13 in the <a href="ses_download_microcode_status_diagnostic_page" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE {&#10;  UCHAR                                    PageCode;&#10;  UCHAR                                    NumberOfSecondarySubEnclosures;&#10;  UCHAR                                    PageLength[2];&#10;  UCHAR                                    GenerationCode[4];&#10;  SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR Descriptors[ANYSIZE_ARRAY];&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE, *PSES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE;">SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE</a>, if requested, and activate the new microcode after either:<br /><br />* Processing this structure with the   <strong>Mode</strong> field set to 0x0F (i.e., Activate deferred   microcode)<br />* A power on<br />* A hard reset</td>
</tr>
<tr>
<td><strong>Activate deferred microcode</strong><br /><br />0x0F</td>
<td>After the SEND DIAGNOSTIC command specifying this mode completes, the enclosure services process shall activate the deferred microcode image, if any.</td>
</tr>
<tr>
<td><strong>Reserved</strong><br /><br />All other values</td>
<td>Reserved for future use.</td>
</tr>
</tbody>
</table>
<h3><code>Reserved</code></h3>
<p>Reserved for future use.</p>
<h3><code>BufferID</code></h3>
<p>Specifies a specific buffer within the enclosure services process to receive the microcode
image. The enclosure services process assigns vendor specific buffer ID codes to buffers (e.g., the main
firmware image may be stored in buffer 00h and a backup firmware image may be stored in buffer 01h). The
enclosure services process shall support a buffer ID value of 00h. If more than one buffer is supported, then
the enclosure services process shall assign additional buffer ID codes contiguously, beginning with 01h. If the
enclosure services process receives an unsupported buffer ID code, then it shall abort the download
microcode operation and set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x80 in the <a href="ses_download_microcode_status_diagnostic_page" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE {&#10;  UCHAR                                    PageCode;&#10;  UCHAR                                    NumberOfSecondarySubEnclosures;&#10;  UCHAR                                    PageLength[2];&#10;  UCHAR                                    GenerationCode[4];&#10;  SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR Descriptors[ANYSIZE_ARRAY];&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE, *PSES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE;">SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE</a> structure.</p>
<h3><code>BufferOffset</code></h3>
<p>Specifies the offset in bytes within the buffer to which the microcode data is written in multiples of four. The enclosure services process may require that this field be contiguously increasing in consecutive SEND DIAGNOSTIC commands.</p>
<h3><code>ImageLength</code></h3>
<p>specifies the total number of bytes in the microcode image the application
intends to send to the specified <strong>BufferID</strong>.</p>
<h3><code>DataLength</code></h3>
<p>Specifies the length of <strong>Data</strong>, in bytes.</p>
<h3><code>Data</code></h3>
<p>Contains part of the vendor specific microcode image.</p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/minitape/ns-minitape-_ses_download_microcode_control_diagnostic_page">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/minitape/ns-minitape-_ses_download_microcode_control_diagnostic_page.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-scsi-_ses_download_microcode_control_diagnostic_page)</h1>
</div>
<div class="ntdoc-description">
<h1>_SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE structure (scsi.h)</h1>
<h2>Description</h2>
<p>The <strong>SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE</strong> structure contains a vendor specific microcode (i.e., firmware) image
for use by the enclosure services process.</p>
<h2>Members</h2>
<h3><code>PageCode</code></h3>
<p>Specifies the diagnostic page being sent or requested based on the value. For a Microcode Control diagnostic page, the value should be 0x0E.</p>
<h3><code>SubEnclosureId</code></h3>
<p>Specifies the sub enclosure to which the application client is
sending the microcode image. If the value does not match a valid SUBENCLOSURE_IDENTIFIER field value found in the <a href="ses_configuration_diagnostic_page" title="typedef struct _SES_CONFIGURATION_DIAGNOSTIC_PAGE {&#10;  UCHAR                    PageCode;&#10;  UCHAR                    NumberOfSecondarySubEnclosures;&#10;  UCHAR                    PageLength[2];&#10;  UCHAR                    GenerationCode[4];&#10;  SES_ENCLOSURE_DESCRIPTOR Descriptors[ANYSIZE_ARRAY];&#10;} SES_CONFIGURATION_DIAGNOSTIC_PAGE, *PSES_CONFIGURATION_DIAGNOSTIC_PAGE;">SES_CONFIGURATION_DIAGNOSTIC_PAGE</a>, then the enclosure services
process shall abort the download microcode operation with a status of 0x80.</p>
<h3><code>PageLength</code></h3>
<p>Specifies the number of bytes that follow in the diagnostic page.</p>
<h3><code>ExpectedGenerationCode</code></h3>
<p>Specifies the expected value of the generation code. If this parameter is not set to the current generation code, then the enclosure services
process shall abort the download microcode operation with a status of 0x80.</p>
<h3><code>Mode</code></h3>
<p>Specifies which mode to download the microcode with.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Download microcode with offsets, save, and activate</strong><br /><br />0x07</td>
<td>After the last SEND DIAGNOSTIC command delivers a Download Microcode Control diagnostic page to the subenclosure completes, the enclosure services process shall verify the complete microcode image (e.g., perform a vendor specific checksum) and save the new microcode image into nonvolatile storage.<br /><br /> If there are no errors in the microcode image or in the save operation, then the enclosure services process shall perform one of the following actions:<br /><br />* Set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x10, if   requested, and activate the new microcode image after either returning the Download Microcode Status diagnostic page, power on, or for standalone enclosure services processes, a hard reset.<br />* Set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x11, if   requested, and for standalone enclosure services processes only,   activate the new microcode image after either power on or hard reset.<br />* Set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x12, if   requested, and activate the new microcode image after power on.</td>
</tr>
<tr>
<td><strong>Download microcode with offsets, save, and defer activate</strong><br /><br />0x0E</td>
<td>After the last SEND DIAGNOSTIC command delivering a <strong>SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE</strong> to the subenclosure completes, the enclosure services process shall verify the complete microcode image (e.g., perform a vendor specific checksum), save the new microcode image into nonvolatile storage (e.g., flash ROM), and defer activation of the new microcode.<br /><br />If there are no errors in the microcode image or in the save operation, then the enclosure services process shall set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x13 in the <a href="ses_download_microcode_status_diagnostic_page" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE {&#10;  UCHAR                                    PageCode;&#10;  UCHAR                                    NumberOfSecondarySubEnclosures;&#10;  UCHAR                                    PageLength[2];&#10;  UCHAR                                    GenerationCode[4];&#10;  SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR Descriptors[ANYSIZE_ARRAY];&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE, *PSES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE;">SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE</a>, if requested, and activate the new microcode after either:<br /><br />* Processing this structure with the   <strong>Mode</strong> field set to 0x0F (i.e., Activate deferred   microcode)<br />* A power on<br />* A hard reset</td>
</tr>
<tr>
<td><strong>Activate deferred microcode</strong><br /><br />0x0F</td>
<td>After the SEND DIAGNOSTIC command specifying this mode completes, the enclosure services process shall activate the deferred microcode image, if any.</td>
</tr>
<tr>
<td><strong>Reserved</strong><br /><br />All other values</td>
<td>Reserved for future use.</td>
</tr>
</tbody>
</table>
<h3><code>Reserved</code></h3>
<p>Reserved for future use.</p>
<h3><code>BufferID</code></h3>
<p>Specifies a specific buffer within the enclosure services process to receive the microcode
image. The enclosure services process assigns vendor specific buffer ID codes to buffers (e.g., the main
firmware image may be stored in buffer 00h and a backup firmware image may be stored in buffer 01h). The
enclosure services process shall support a buffer ID value of 00h. If more than one buffer is supported, then
the enclosure services process shall assign additional buffer ID codes contiguously, beginning with 01h. If the
enclosure services process receives an unsupported buffer ID code, then it shall abort the download
microcode operation and set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x80 in the <a href="ses_download_microcode_status_diagnostic_page" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE {&#10;  UCHAR                                    PageCode;&#10;  UCHAR                                    NumberOfSecondarySubEnclosures;&#10;  UCHAR                                    PageLength[2];&#10;  UCHAR                                    GenerationCode[4];&#10;  SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR Descriptors[ANYSIZE_ARRAY];&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE, *PSES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE;">SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE</a> structure.</p>
<h3><code>BufferOffset</code></h3>
<p>Specifies the offset in bytes within the buffer to which the microcode data is written in multiples of four. The enclosure services process may require that this field be contiguously increasing in consecutive SEND DIAGNOSTIC commands.</p>
<h3><code>ImageLength</code></h3>
<p>specifies the total number of bytes in the microcode image the application
intends to send to the specified <strong>BufferID</strong>.</p>
<h3><code>DataLength</code></h3>
<p>Specifies the length of <strong>Data</strong>, in bytes.</p>
<h3><code>Data</code></h3>
<p>Contains part of the vendor specific microcode image.</p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/scsi/ns-scsi-_ses_download_microcode_control_diagnostic_page">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/scsi/ns-scsi-_ses_download_microcode_control_diagnostic_page.md">Edit description on GitHub</a>
</div>
</div>
<div class="ntdoc-description-title">
<h1>Windows Driver Kit DDI reference (ns-storport-_ses_download_microcode_control_diagnostic_page)</h1>
</div>
<div class="ntdoc-description">
<h1>_SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE structure (storport.h)</h1>
<h2>Description</h2>
<p>The <strong>SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE</strong> structure contains a vendor specific microcode (i.e., firmware) image
for use by the enclosure services process.</p>
<h2>Members</h2>
<h3><code>PageCode</code></h3>
<p>Specifies the diagnostic page being sent or requested based on the value. For a Microcode Control diagnostic page, the value should be 0x0E.</p>
<h3><code>SubEnclosureId</code></h3>
<p>Specifies the sub enclosure to which the application client is
sending the microcode image. If the value does not match a valid SUBENCLOSURE_IDENTIFIER field value found in the <a href="ses_configuration_diagnostic_page" title="typedef struct _SES_CONFIGURATION_DIAGNOSTIC_PAGE {&#10;  UCHAR                    PageCode;&#10;  UCHAR                    NumberOfSecondarySubEnclosures;&#10;  UCHAR                    PageLength[2];&#10;  UCHAR                    GenerationCode[4];&#10;  SES_ENCLOSURE_DESCRIPTOR Descriptors[ANYSIZE_ARRAY];&#10;} SES_CONFIGURATION_DIAGNOSTIC_PAGE, *PSES_CONFIGURATION_DIAGNOSTIC_PAGE;">SES_CONFIGURATION_DIAGNOSTIC_PAGE</a>, then the enclosure services
process shall abort the download microcode operation with a status of 0x80.</p>
<h3><code>PageLength</code></h3>
<p>Specifies the number of bytes that follow in the diagnostic page.</p>
<h3><code>ExpectedGenerationCode</code></h3>
<p>Specifies the expected value of the generation code. If this parameter is not set to the current generation code, then the enclosure services
process shall abort the download microcode operation with a status of 0x80.</p>
<h3><code>Mode</code></h3>
<p>Specifies which mode to download the microcode with.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Download microcode with offsets, save, and activate</strong><br /><br />0x07</td>
<td>After the last SEND DIAGNOSTIC command delivers a Download Microcode Control diagnostic page to the subenclosure completes, the enclosure services process shall verify the complete microcode image (e.g., perform a vendor specific checksum) and save the new microcode image into nonvolatile storage.<br /><br /> If there are no errors in the microcode image or in the save operation, then the enclosure services process shall perform one of the following actions:<br /><br />* Set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x10, if   requested, and activate the new microcode image after either returning the Download Microcode Status diagnostic page, power on, or for standalone enclosure services processes, a hard reset.<br />* Set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x11, if   requested, and for standalone enclosure services processes only,   activate the new microcode image after either power on or hard reset.<br />* Set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x12, if   requested, and activate the new microcode image after power on.</td>
</tr>
<tr>
<td><strong>Download microcode with offsets, save, and defer activate</strong><br /><br />0x0E</td>
<td>After the last SEND DIAGNOSTIC command delivering a <strong>SES_DOWNLOAD_MICROCODE_CONTROL_DIAGNOSTIC_PAGE</strong> to the subenclosure completes, the enclosure services process shall verify the complete microcode image (e.g., perform a vendor specific checksum), save the new microcode image into nonvolatile storage (e.g., flash ROM), and defer activation of the new microcode.<br /><br />If there are no errors in the microcode image or in the save operation, then the enclosure services process shall set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x13 in the <a href="ses_download_microcode_status_diagnostic_page" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE {&#10;  UCHAR                                    PageCode;&#10;  UCHAR                                    NumberOfSecondarySubEnclosures;&#10;  UCHAR                                    PageLength[2];&#10;  UCHAR                                    GenerationCode[4];&#10;  SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR Descriptors[ANYSIZE_ARRAY];&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE, *PSES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE;">SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE</a>, if requested, and activate the new microcode after either:<br /><br />* Processing this structure with the   <strong>Mode</strong> field set to 0x0F (i.e., Activate deferred   microcode)<br />* A power on<br />* A hard reset</td>
</tr>
<tr>
<td><strong>Activate deferred microcode</strong><br /><br />0x0F</td>
<td>After the SEND DIAGNOSTIC command specifying this mode completes, the enclosure services process shall activate the deferred microcode image, if any.</td>
</tr>
<tr>
<td><strong>Reserved</strong><br /><br />All other values</td>
<td>Reserved for future use.</td>
</tr>
</tbody>
</table>
<h3><code>Reserved</code></h3>
<p>Reserved for future use.</p>
<h3><code>BufferID</code></h3>
<p>Specifies a specific buffer within the enclosure services process to receive the microcode
image. The enclosure services process assigns vendor specific buffer ID codes to buffers (e.g., the main
firmware image may be stored in buffer 00h and a backup firmware image may be stored in buffer 01h). The
enclosure services process shall support a buffer ID value of 00h. If more than one buffer is supported, then
the enclosure services process shall assign additional buffer ID codes contiguously, beginning with 01h. If the
enclosure services process receives an unsupported buffer ID code, then it shall abort the download
microcode operation and set the <strong>Status</strong> field in <a href="ses_download_microcode_status_descriptor" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR {&#10;  UCHAR Reserved1;&#10;  UCHAR SubEnclosureId;&#10;  UCHAR Status;&#10;  UCHAR AdditionalStatus;&#10;  UCHAR MaximumImageSize[4];&#10;  UCHAR Reserved2[3];&#10;  UCHAR ExpectedBufferId;&#10;  UCHAR ExpectedBufferOffset;&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR, *PSES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR;">SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR</a> to 0x80 in the <a href="ses_download_microcode_status_diagnostic_page" title="typedef struct _SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE {&#10;  UCHAR                                    PageCode;&#10;  UCHAR                                    NumberOfSecondarySubEnclosures;&#10;  UCHAR                                    PageLength[2];&#10;  UCHAR                                    GenerationCode[4];&#10;  SES_DOWNLOAD_MICROCODE_STATUS_DESCRIPTOR Descriptors[ANYSIZE_ARRAY];&#10;} SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE, *PSES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE;">SES_DOWNLOAD_MICROCODE_STATUS_DIAGNOSTIC_PAGE</a> structure.</p>
<h3><code>BufferOffset</code></h3>
<p>Specifies the offset in bytes within the buffer to which the microcode data is written in multiples of four. The enclosure services process may require that this field be contiguously increasing in consecutive SEND DIAGNOSTIC commands.</p>
<h3><code>ImageLength</code></h3>
<p>specifies the total number of bytes in the microcode image the application
intends to send to the specified <strong>BufferID</strong>.</p>
<h3><code>DataLength</code></h3>
<p>Specifies the length of <strong>Data</strong>, in bytes.</p>
<h3><code>Data</code></h3>
<p>Contains part of the vendor specific microcode image.</p>
<hr>
<div class="ntdoc-description-links">
<p>
<a target="_blank" href="https://learn.microsoft.com/windows-hardware/drivers/ddi/storport/ns-storport-_ses_download_microcode_control_diagnostic_page">View the official Windows Driver Kit DDI reference</a>
</p>
<a target="_blank" href="https://github.com/MicrosoftDocs/windows-driver-docs-ddi/blob/staging/wdk-ddi-src/content/storport/ns-storport-_ses_download_microcode_control_diagnostic_page.md">Edit description on GitHub</a>
</div>
</div>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script src="modules/highlight.js/highlight.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
